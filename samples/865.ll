; ModuleID = 'samples/865.bc'
source_filename = "ssl_tls.c"
target datalayout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128"
target triple = "x86_64-unknown-linux-gnu"

%struct.mbedtls_x509_crt_profile = type { i32, i32, i32, i32 }
%struct.mbedtls_ssl_context = type { ptr, i32, i32, i32, i32, i32, i32, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, i32, i64, i64, i16, i64, i64, i64, i64, i32, i32, i8, ptr, ptr, ptr, ptr, ptr, ptr, i32, i64, i64, [8 x i8], i16, i8, i32, ptr, ptr, ptr, i64, i32, i64, [12 x i8], [12 x i8] }
%struct.mbedtls_ssl_transform = type { ptr, i32, i64, i64, i64, i64, [16 x i8], [16 x i8], %struct.mbedtls_md_context_t, %struct.mbedtls_md_context_t, %struct.mbedtls_cipher_context_t, %struct.mbedtls_cipher_context_t }
%struct.mbedtls_md_context_t = type { ptr, ptr, ptr }
%struct.mbedtls_cipher_context_t = type { ptr, i32, i32, ptr, ptr, [16 x i8], i64, [16 x i8], i64, ptr }
%struct.mbedtls_ssl_ciphersuite_t = type { i32, ptr, i32, i32, i32, i32, i32, i32, i32, i8 }
%struct.mbedtls_ssl_handshake_params = type { %struct.mbedtls_ssl_sig_hash_set_t, %struct.mbedtls_dhm_context, %struct.mbedtls_ecdh_context, ptr, ptr, i64, ptr, i32, ptr, ptr, ptr, i32, i32, ptr, i8, i32, i8, ptr, ptr, ptr, i32, ptr, [8 x i8], %struct.anon, i16, %struct.mbedtls_md5_context, %struct.mbedtls_sha1_context, %struct.mbedtls_sha256_context, %struct.mbedtls_sha512_context, ptr, ptr, ptr, ptr, i64, [64 x i8], [1060 x i8], i32, i32, i32, i32, i32, i32 }
%struct.mbedtls_ssl_sig_hash_set_t = type { i32, i32 }
%struct.mbedtls_dhm_context = type { i64, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi }
%struct.mbedtls_mpi = type { i32, i64, ptr }
%struct.mbedtls_ecdh_context = type { %struct.mbedtls_ecp_group, %struct.mbedtls_mpi, %struct.mbedtls_ecp_point, %struct.mbedtls_ecp_point, %struct.mbedtls_mpi, i32, %struct.mbedtls_ecp_point, %struct.mbedtls_ecp_point, %struct.mbedtls_mpi }
%struct.mbedtls_ecp_group = type { i32, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_ecp_point, %struct.mbedtls_mpi, i64, i64, i32, ptr, ptr, ptr, ptr, ptr, i64 }
%struct.mbedtls_ecp_point = type { %struct.mbedtls_mpi, %struct.mbedtls_mpi, %struct.mbedtls_mpi }
%struct.anon = type { i64, i8, [4 x %struct.mbedtls_ssl_hs_buffer], %struct.anon.0 }
%struct.mbedtls_ssl_hs_buffer = type { i8, ptr, i64 }
%struct.anon.0 = type { ptr, i64, i32 }
%struct.mbedtls_md5_context = type { [2 x i32], [4 x i32], [64 x i8] }
%struct.mbedtls_sha1_context = type { [2 x i32], [5 x i32], [64 x i8] }
%struct.mbedtls_sha256_context = type { [2 x i32], [8 x i32], [64 x i8], i32 }
%struct.mbedtls_sha512_context = type { [2 x i64], [8 x i64], [128 x i8], i32 }
%struct.mbedtls_ssl_session = type { i64, i32, i32, i64, [32 x i8], [48 x i8], ptr, i32, ptr, i64, i32, i8, i32, i32 }
%struct.mbedtls_cipher_info_t = type { i32, i32, i32, ptr, i32, i32, i32, ptr }
%struct.mbedtls_ssl_config = type { [4 x ptr], ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, ptr, %struct.mbedtls_mpi, %struct.mbedtls_mpi, ptr, i64, ptr, i64, ptr, i32, i32, i32, i32, [8 x i8], i32, i32, i8, i8, i8, i8, i24 }
%struct.mbedtls_ssl_flight_item = type { ptr, i64, i8, ptr }
%struct.mbedtls_x509_crt = type { %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_buf, i32, %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_named_data, %struct.mbedtls_asn1_named_data, %struct.mbedtls_x509_time, %struct.mbedtls_x509_time, %struct.mbedtls_pk_context, %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_sequence, i32, i32, i32, i32, %struct.mbedtls_asn1_sequence, i8, %struct.mbedtls_asn1_buf, i32, i32, ptr, ptr }
%struct.mbedtls_asn1_named_data = type { %struct.mbedtls_asn1_buf, %struct.mbedtls_asn1_buf, ptr, i8 }
%struct.mbedtls_x509_time = type { i32, i32, i32, i32, i32, i32 }
%struct.mbedtls_pk_context = type { ptr, ptr }
%struct.mbedtls_asn1_sequence = type { %struct.mbedtls_asn1_buf, ptr }
%struct.mbedtls_asn1_buf = type { i32, i64, ptr }
%struct.mbedtls_ssl_key_cert = type { ptr, ptr, ptr }
%struct.mbedtls_ecp_keypair = type { %struct.mbedtls_ecp_group, %struct.mbedtls_mpi, %struct.mbedtls_ecp_point }

@.str = private unnamed_addr constant [10 x i8] c"ssl_tls.c\00", align 1
@.str.1 = private unnamed_addr constant [15 x i8] c"=> derive keys\00", align 1
@.str.2 = private unnamed_addr constant [29 x i8] c"cipher info for %d not found\00", align 1
@.str.3 = private unnamed_addr constant [33 x i8] c"mbedtls_md info for %d not found\00", align 1
@.str.4 = private unnamed_addr constant [20 x i8] c"should never happen\00", align 1
@.str.5 = private unnamed_addr constant [17 x i8] c"premaster secret\00", align 1
@.str.6 = private unnamed_addr constant [29 x i8] c"using extended master secret\00", align 1
@.str.7 = private unnamed_addr constant [13 x i8] c"session hash\00", align 1
@.str.8 = private unnamed_addr constant [23 x i8] c"extended master secret\00", align 1
@.str.9 = private unnamed_addr constant [4 x i8] c"prf\00", align 1
@.str.10 = private unnamed_addr constant [14 x i8] c"master secret\00", align 1
@.str.11 = private unnamed_addr constant [31 x i8] c"no premaster (session resumed)\00", align 1
@.str.12 = private unnamed_addr constant [14 x i8] c"key expansion\00", align 1
@.str.13 = private unnamed_addr constant [17 x i8] c"ciphersuite = %s\00", align 1
@.str.14 = private unnamed_addr constant [13 x i8] c"random bytes\00", align 1
@.str.15 = private unnamed_addr constant [10 x i8] c"key block\00", align 1
@.str.16 = private unnamed_addr constant [17 x i8] c"mbedtls_md_setup\00", align 1
@.str.17 = private unnamed_addr constant [46 x i8] c"keylen: %d, minlen: %d, ivlen: %d, maclen: %d\00", align 1
@.str.18 = private unnamed_addr constant [21 x i8] c"mbedtls_cipher_setup\00", align 1
@.str.19 = private unnamed_addr constant [22 x i8] c"mbedtls_cipher_setkey\00", align 1
@.str.20 = private unnamed_addr constant [32 x i8] c"mbedtls_cipher_set_padding_mode\00", align 1
@.str.21 = private unnamed_addr constant [15 x i8] c"<= derive keys\00", align 1
@.str.22 = private unnamed_addr constant [24 x i8] c"mbedtls_dhm_calc_secret\00", align 1
@.str.23 = private unnamed_addr constant [8 x i8] c"DHM: K \00", align 1
@.str.24 = private unnamed_addr constant [25 x i8] c"mbedtls_ecdh_calc_secret\00", align 1
@.str.25 = private unnamed_addr constant [15 x i8] c"=> fetch input\00", align 1
@.str.26 = private unnamed_addr constant [60 x i8] c"Bad usage of mbedtls_ssl_set_bio() or mbedtls_ssl_set_bio()\00", align 1
@.str.27 = private unnamed_addr constant [31 x i8] c"requesting more data than fits\00", align 1
@.str.28 = private unnamed_addr constant [49 x i8] c"You must use mbedtls_ssl_set_timer_cb() for DTLS\00", align 1
@.str.29 = private unnamed_addr constant [41 x i8] c"next record in same datagram, offset: %d\00", align 1
@.str.30 = private unnamed_addr constant [25 x i8] c"in_left: %d, nb_want: %d\00", align 1
@.str.31 = private unnamed_addr constant [15 x i8] c"<= fetch input\00", align 1
@.str.32 = private unnamed_addr constant [18 x i8] c"timer has expired\00", align 1
@.str.33 = private unnamed_addr constant [22 x i8] c"f_recv_timeout: %u ms\00", align 1
@.str.34 = private unnamed_addr constant [22 x i8] c"ssl->f_recv(_timeout)\00", align 1
@.str.35 = private unnamed_addr constant [8 x i8] c"timeout\00", align 1
@.str.36 = private unnamed_addr constant [18 x i8] c"handshake timeout\00", align 1
@.str.37 = private unnamed_addr constant [19 x i8] c"mbedtls_ssl_resend\00", align 1
@.str.38 = private unnamed_addr constant [25 x i8] c"ssl_resend_hello_request\00", align 1
@.str.39 = private unnamed_addr constant [53 x i8] c"f_recv returned %d bytes but only %lu were requested\00", align 1
@.str.40 = private unnamed_addr constant [16 x i8] c"=> flush output\00", align 1
@.str.41 = private unnamed_addr constant [16 x i8] c"<= flush output\00", align 1
@.str.42 = private unnamed_addr constant [33 x i8] c"message length: %d, out_left: %d\00", align 1
@.str.43 = private unnamed_addr constant [12 x i8] c"ssl->f_send\00", align 1
@.str.44 = private unnamed_addr constant [54 x i8] c"f_send returned %d bytes but only %lu bytes were sent\00", align 1
@.str.45 = private unnamed_addr constant [22 x i8] c"=> mbedtls_ssl_resend\00", align 1
@.str.46 = private unnamed_addr constant [22 x i8] c"<= mbedtls_ssl_resend\00", align 1
@.str.47 = private unnamed_addr constant [31 x i8] c"=> mbedtls_ssl_flight_transmit\00", align 1
@.str.48 = private unnamed_addr constant [31 x i8] c"initialise flight transmission\00", align 1
@.str.49 = private unnamed_addr constant [37 x i8] c"swap epochs to send finished message\00", align 1
@.str.50 = private unnamed_addr constant [40 x i8] c"fragmenting handshake message (%u > %u)\00", align 1
@.str.51 = private unnamed_addr constant [17 x i8] c"handshake header\00", align 1
@.str.52 = private unnamed_addr constant [25 x i8] c"mbedtls_ssl_write_record\00", align 1
@.str.53 = private unnamed_addr constant [31 x i8] c"<= mbedtls_ssl_flight_transmit\00", align 1
@.str.54 = private unnamed_addr constant [27 x i8] c"=> write handshake message\00", align 1
@.str.55 = private unnamed_addr constant [38 x i8] c"Record too large: size %u, maximum %u\00", align 1
@.str.56 = private unnamed_addr constant [54 x i8] c"DTLS handshake message too large: size %u, maximum %u\00", align 1
@.str.57 = private unnamed_addr constant [18 x i8] c"ssl_flight_append\00", align 1
@.str.58 = private unnamed_addr constant [17 x i8] c"ssl_write_record\00", align 1
@.str.59 = private unnamed_addr constant [27 x i8] c"<= write handshake message\00", align 1
@.str.60 = private unnamed_addr constant [16 x i8] c"=> write record\00", align 1
@.str.61 = private unnamed_addr constant [16 x i8] c"ssl_encrypt_buf\00", align 1
@.str.62 = private unnamed_addr constant [60 x i8] c"output record: msgtype = %d, version = [%d:%d], msglen = %d\00", align 1
@.str.63 = private unnamed_addr constant [30 x i8] c"output record sent to network\00", align 1
@.str.64 = private unnamed_addr constant [36 x i8] c"outgoing message counter would wrap\00", align 1
@.str.65 = private unnamed_addr constant [38 x i8] c"ssl_get_remaining_payload_in_datagram\00", align 1
@.str.66 = private unnamed_addr constant [45 x i8] c"Still %u bytes available in current datagram\00", align 1
@.str.67 = private unnamed_addr constant [25 x i8] c"mbedtls_ssl_flush_output\00", align 1
@.str.68 = private unnamed_addr constant [16 x i8] c"<= write record\00", align 1
@.str.69 = private unnamed_addr constant [32 x i8] c"handshake message too short: %d\00", align 1
@.str.70 = private unnamed_addr constant [54 x i8] c"handshake message: msglen = %d, type = %d, hslen = %d\00", align 1
@.str.71 = private unnamed_addr constant [25 x i8] c"invalid handshake header\00", align 1
@.str.72 = private unnamed_addr constant [66 x i8] c"received future handshake message of sequence number %u (next %u)\00", align 1
@.str.73 = private unnamed_addr constant [74 x i8] c"received message from last flight, message_seq = %d, start_of_flight = %d\00", align 1
@.str.74 = private unnamed_addr constant [66 x i8] c"dropping out-of-sequence message: message_seq = %d, expected = %d\00", align 1
@.str.75 = private unnamed_addr constant [40 x i8] c"found fragmented DTLS handshake message\00", align 1
@.str.76 = private unnamed_addr constant [42 x i8] c"TLS handshake fragmentation not supported\00", align 1
@.str.77 = private unnamed_addr constant [15 x i8] c"=> read record\00", align 1
@.str.78 = private unnamed_addr constant [20 x i8] c"ssl_get_next_record\00", align 1
@.str.79 = private unnamed_addr constant [32 x i8] c"mbedtls_ssl_handle_message_type\00", align 1
@.str.80 = private unnamed_addr constant [30 x i8] c"reuse previously read message\00", align 1
@.str.81 = private unnamed_addr constant [15 x i8] c"<= read record\00", align 1
@.str.82 = private unnamed_addr constant [29 x i8] c"invalid CCS message, len: %d\00", align 1
@.str.83 = private unnamed_addr constant [35 x i8] c"invalid CCS message, content: %02x\00", align 1
@.str.84 = private unnamed_addr constant [44 x i8] c"dropping ChangeCipherSpec outside handshake\00", align 1
@.str.85 = private unnamed_addr constant [50 x i8] c"received out-of-order ChangeCipherSpec - remember\00", align 1
@.str.86 = private unnamed_addr constant [31 x i8] c"invalid alert message, len: %d\00", align 1
@.str.87 = private unnamed_addr constant [36 x i8] c"got an alert message, type: [%d:%d]\00", align 1
@.str.88 = private unnamed_addr constant [34 x i8] c"is a fatal alert message (msg %d)\00", align 1
@.str.89 = private unnamed_addr constant [26 x i8] c"is a close notify message\00", align 1
@.str.90 = private unnamed_addr constant [34 x i8] c"is a SSLv3 no renegotiation alert\00", align 1
@.str.91 = private unnamed_addr constant [22 x i8] c"=> send alert message\00", align 1
@.str.92 = private unnamed_addr constant [31 x i8] c"send alert level=%u message=%u\00", align 1
@.str.93 = private unnamed_addr constant [22 x i8] c"<= send alert message\00", align 1
@.str.94 = private unnamed_addr constant [21 x i8] c"=> write certificate\00", align 1
@.str.95 = private unnamed_addr constant [26 x i8] c"<= skip write certificate\00", align 1
@.str.96 = private unnamed_addr constant [27 x i8] c"got no certificate to send\00", align 1
@.str.97 = private unnamed_addr constant [16 x i8] c"own certificate\00", align 1
@.str.98 = private unnamed_addr constant [31 x i8] c"certificate too large, %d > %d\00", align 1
@.str.99 = private unnamed_addr constant [32 x i8] c"mbedtls_ssl_write_handshake_msg\00", align 1
@.str.100 = private unnamed_addr constant [21 x i8] c"<= write certificate\00", align 1
@.str.101 = private unnamed_addr constant [21 x i8] c"=> parse certificate\00", align 1
@.str.102 = private unnamed_addr constant [26 x i8] c"<= skip parse certificate\00", align 1
@.str.103 = private unnamed_addr constant [24 x i8] c"mbedtls_ssl_read_record\00", align 1
@.str.104 = private unnamed_addr constant [17 x i8] c"x509_verify_cert\00", align 1
@.str.105 = private unnamed_addr constant [31 x i8] c"bad certificate (EC key curve)\00", align 1
@.str.106 = private unnamed_addr constant [35 x i8] c"bad certificate (usage extensions)\00", align 1
@.str.107 = private unnamed_addr constant [16 x i8] c"got no CA chain\00", align 1
@.str.108 = private unnamed_addr constant [36 x i8] c"! Certificate verification flags %x\00", align 1
@.str.109 = private unnamed_addr constant [37 x i8] c"Certificate verification flags clear\00", align 1
@.str.110 = private unnamed_addr constant [21 x i8] c"<= parse certificate\00", align 1
@.str.111 = private unnamed_addr constant [28 x i8] c"=> write change cipher spec\00", align 1
@.str.112 = private unnamed_addr constant [28 x i8] c"<= write change cipher spec\00", align 1
@.str.113 = private unnamed_addr constant [28 x i8] c"=> parse change cipher spec\00", align 1
@.str.114 = private unnamed_addr constant [31 x i8] c"bad change cipher spec message\00", align 1
@.str.115 = private unnamed_addr constant [49 x i8] c"switching to new transform spec for inbound data\00", align 1
@.str.116 = private unnamed_addr constant [22 x i8] c"DTLS epoch would wrap\00", align 1
@.str.117 = private unnamed_addr constant [28 x i8] c"<= parse change cipher spec\00", align 1
@.str.118 = private unnamed_addr constant [20 x i8] c"=> handshake wrapup\00", align 1
@.str.119 = private unnamed_addr constant [28 x i8] c"cache did not store session\00", align 1
@.str.120 = private unnamed_addr constant [37 x i8] c"skip freeing handshake and transform\00", align 1
@.str.121 = private unnamed_addr constant [20 x i8] c"<= handshake wrapup\00", align 1
@.str.122 = private unnamed_addr constant [18 x i8] c"=> write finished\00", align 1
@.str.123 = private unnamed_addr constant [50 x i8] c"switching to new transform spec for outbound data\00", align 1
@.str.124 = private unnamed_addr constant [28 x i8] c"mbedtls_ssl_flight_transmit\00", align 1
@.str.125 = private unnamed_addr constant [18 x i8] c"<= write finished\00", align 1
@.str.126 = private unnamed_addr constant [18 x i8] c"=> parse finished\00", align 1
@.str.127 = private unnamed_addr constant [21 x i8] c"bad finished message\00", align 1
@.str.128 = private unnamed_addr constant [18 x i8] c"<= parse finished\00", align 1
@.str.129 = private unnamed_addr constant [23 x i8] c"alloc(%d bytes) failed\00", align 1
@.str.130 = private unnamed_addr constant [51 x i8] c"ssl_check_pending: record held back for processing\00", align 1
@.str.131 = private unnamed_addr constant [56 x i8] c"ssl_check_pending: more records within current datagram\00", align 1
@.str.132 = private unnamed_addr constant [65 x i8] c"ssl_check_pending: more handshake messages within current record\00", align 1
@.str.133 = private unnamed_addr constant [62 x i8] c"ssl_check_pending: application data record is being processed\00", align 1
@.str.134 = private unnamed_addr constant [35 x i8] c"ssl_check_pending: nothing pending\00", align 1
@.str.135 = private unnamed_addr constant [9 x i8] c"DTLSv1.0\00", align 1
@.str.136 = private unnamed_addr constant [9 x i8] c"DTLSv1.2\00", align 1
@.str.137 = private unnamed_addr constant [15 x i8] c"unknown (DTLS)\00", align 1
@.str.138 = private unnamed_addr constant [8 x i8] c"SSLv3.0\00", align 1
@.str.139 = private unnamed_addr constant [8 x i8] c"TLSv1.0\00", align 1
@.str.140 = private unnamed_addr constant [8 x i8] c"TLSv1.1\00", align 1
@.str.141 = private unnamed_addr constant [8 x i8] c"TLSv1.2\00", align 1
@.str.142 = private unnamed_addr constant [8 x i8] c"unknown\00", align 1
@.str.143 = private unnamed_addr constant [33 x i8] c"MTU too low for record expansion\00", align 1
@.str.144 = private unnamed_addr constant [13 x i8] c"=> handshake\00", align 1
@.str.145 = private unnamed_addr constant [13 x i8] c"<= handshake\00", align 1
@.str.146 = private unnamed_addr constant [24 x i8] c"ssl_start_renegotiation\00", align 1
@.str.147 = private unnamed_addr constant [22 x i8] c"mbedtls_ssl_handshake\00", align 1
@.str.148 = private unnamed_addr constant [8 x i8] c"=> read\00", align 1
@.str.149 = private unnamed_addr constant [26 x i8] c"ssl_check_ctr_renegotiate\00", align 1
@.str.150 = private unnamed_addr constant [27 x i8] c"received handshake message\00", align 1
@.str.151 = private unnamed_addr constant [38 x i8] c"handshake received (not HelloRequest)\00", align 1
@.str.152 = private unnamed_addr constant [37 x i8] c"handshake received (not ClientHello)\00", align 1
@.str.153 = private unnamed_addr constant [38 x i8] c"refusing renegotiation, sending alert\00", align 1
@.str.154 = private unnamed_addr constant [51 x i8] c"renegotiation requested, but not honored by client\00", align 1
@.str.155 = private unnamed_addr constant [37 x i8] c"ignoring non-fatal non-closure alert\00", align 1
@.str.156 = private unnamed_addr constant [29 x i8] c"bad application data message\00", align 1
@.str.157 = private unnamed_addr constant [8 x i8] c"<= read\00", align 1
@.str.158 = private unnamed_addr constant [9 x i8] c"=> write\00", align 1
@.str.159 = private unnamed_addr constant [9 x i8] c"<= write\00", align 1
@.str.160 = private unnamed_addr constant [22 x i8] c"=> write close notify\00", align 1
@.str.161 = private unnamed_addr constant [31 x i8] c"mbedtls_ssl_send_alert_message\00", align 1
@.str.162 = private unnamed_addr constant [22 x i8] c"<= write close notify\00", align 1
@.str.163 = private unnamed_addr constant [8 x i8] c"=> free\00", align 1
@.str.164 = private unnamed_addr constant [8 x i8] c"<= free\00", align 1
@__const.mbedtls_ssl_config_defaults.dhm_p = private unnamed_addr constant [256 x i8] c"\FF\FF\FF\FF\FF\FF\FF\FF\C9\0F\DA\A2!h\C24\C4\C6b\8B\80\DC\1C\D1)\02N\08\8Ag\CCt\02\0B\BE\A6;\13\9B\22QJ\08y\8E4\04\DD\EF\95\19\B3\CD:C\1B0+\0Am\F2_\147O\E15mmQ\C2E\E4\85\B5vb^~\C6\F4LB\E9\A67\EDk\0B\FF\\\B6\F4\06\B7\ED\EE8k\FBZ\89\9F\A5\AE\9F$\11|K\1F\E6I(fQ\EC\E4[=\C2\00|\B8\A1c\BF\05\98\DAH6\1CU\D3\9Ai\16?\A8\FD$\CF_\83e]#\DC\A3\AD\96\1Cb\F3V \85R\BB\9E\D5)\07p\96\96mg\0C5NJ\BC\98\04\F1tl\08\CA\18!|2\90^F.6\CE;\E3\9Ew,\18\0E\86\03\9B'\83\A2\EC\07\A2\8F\B5\C5]\F0oLR\C9\DE+\CB\F6\95X\17\189\95I|\EA\95j\E5\15\D2&\18\98\FA\05\10\15r\8EZ\8A\AC\AAh\FF\FF\FF\FF\FF\FF\FF\FF", align 16
@__const.mbedtls_ssl_config_defaults.dhm_g = private unnamed_addr constant [1 x i8] c"\02", align 1
@ssl_preset_suiteb_ciphersuites = internal global [3 x i32] [i32 49195, i32 49196, i32 0], align 4
@mbedtls_x509_crt_profile_suiteb = external constant %struct.mbedtls_x509_crt_profile, align 4
@ssl_preset_suiteb_hashes = internal global [3 x i32] [i32 6, i32 7, i32 0], align 4
@ssl_preset_suiteb_curves = internal global [3 x i32] [i32 3, i32 4, i32 0], align 4
@mbedtls_x509_crt_profile_default = external constant %struct.mbedtls_x509_crt_profile, align 4
@ssl_preset_default_hashes = internal global [6 x i32] [i32 8, i32 7, i32 6, i32 5, i32 4, i32 0], align 16
@.str.165 = private unnamed_addr constant [9 x i8] c"+\06\01\05\05\07\03\01\00", align 1
@.str.166 = private unnamed_addr constant [9 x i8] c"+\06\01\05\05\07\03\02\00", align 1
@.str.167 = private unnamed_addr constant [23 x i8] c"mbedtls_md5_starts_ret\00", align 1
@.str.168 = private unnamed_addr constant [23 x i8] c"mbedtls_md5_update_ret\00", align 1
@.str.169 = private unnamed_addr constant [23 x i8] c"mbedtls_md5_finish_ret\00", align 1
@.str.170 = private unnamed_addr constant [24 x i8] c"mbedtls_sha1_starts_ret\00", align 1
@.str.171 = private unnamed_addr constant [24 x i8] c"mbedtls_sha1_update_ret\00", align 1
@.str.172 = private unnamed_addr constant [24 x i8] c"mbedtls_sha1_finish_ret\00", align 1
@.str.173 = private unnamed_addr constant [18 x i8] c"mbedtls_md_starts\00", align 1
@.str.174 = private unnamed_addr constant [18 x i8] c"mbedtls_md_update\00", align 1
@.str.175 = private unnamed_addr constant [18 x i8] c"mbedtls_md_finish\00", align 1
@.str.176 = private unnamed_addr constant [19 x i8] c"=> calc verify tls\00", align 1
@.str.177 = private unnamed_addr constant [25 x i8] c"calculated verify result\00", align 1
@.str.178 = private unnamed_addr constant [15 x i8] c"<= calc verify\00", align 1
@.str.179 = private unnamed_addr constant [22 x i8] c"=> calc verify sha256\00", align 1
@.str.180 = private unnamed_addr constant [22 x i8] c"=> calc verify sha384\00", align 1
@.str.181 = private unnamed_addr constant [14 x i8] c"timer expired\00", align 1
@.str.182 = private unnamed_addr constant [19 x i8] c"set_timer to %d ms\00", align 1
@.str.183 = private unnamed_addr constant [30 x i8] c"mtu autoreduction to %d bytes\00", align 1
@.str.184 = private unnamed_addr constant [37 x i8] c"update timeout value to %d millisecs\00", align 1
@.str.185 = private unnamed_addr constant [39 x i8] c"no longer retransmitting hello request\00", align 1
@.str.186 = private unnamed_addr constant [17 x i8] c"skip swap epochs\00", align 1
@.str.187 = private unnamed_addr constant [12 x i8] c"swap epochs\00", align 1
@.str.188 = private unnamed_addr constant [21 x i8] c"=> ssl_flight_append\00", align 1
@.str.189 = private unnamed_addr constant [27 x i8] c"message appended to flight\00", align 1
@.str.190 = private unnamed_addr constant [22 x i8] c"alloc %d bytes failed\00", align 1
@.str.191 = private unnamed_addr constant [21 x i8] c"<= ssl_flight_append\00", align 1
@.str.192 = private unnamed_addr constant [15 x i8] c"=> encrypt buf\00", align 1
@.str.193 = private unnamed_addr constant [31 x i8] c"before encrypt: output payload\00", align 1
@.str.194 = private unnamed_addr constant [13 x i8] c"computed mac\00", align 1
@.str.195 = private unnamed_addr constant [59 x i8] c"before encrypt: msglen = %d, including %d bytes of padding\00", align 1
@.str.196 = private unnamed_addr constant [21 x i8] c"mbedtls_cipher_crypt\00", align 1
@.str.197 = private unnamed_addr constant [25 x i8] c"additional data for AEAD\00", align 1
@.str.198 = private unnamed_addr constant [19 x i8] c"IV used (internal)\00", align 1
@.str.199 = private unnamed_addr constant [22 x i8] c"IV used (transmitted)\00", align 1
@.str.200 = private unnamed_addr constant [58 x i8] c"before encrypt: msglen = %d, including 0 bytes of padding\00", align 1
@.str.201 = private unnamed_addr constant [28 x i8] c"mbedtls_cipher_auth_encrypt\00", align 1
@.str.202 = private unnamed_addr constant [19 x i8] c"after encrypt: tag\00", align 1
@.str.203 = private unnamed_addr constant [78 x i8] c"before encrypt: msglen = %d, including %d bytes of IV and %d bytes of padding\00", align 1
@.str.204 = private unnamed_addr constant [23 x i8] c"using encrypt then mac\00", align 1
@.str.205 = private unnamed_addr constant [16 x i8] c"MAC'd meta-data\00", align 1
@.str.206 = private unnamed_addr constant [15 x i8] c"<= encrypt buf\00", align 1
@.str.207 = private unnamed_addr constant [4 x i8] zeroinitializer, align 1
@.str.208 = private unnamed_addr constant [30 x i8] c"=> ssl_load_buffered_messsage\00", align 1
@.str.209 = private unnamed_addr constant [35 x i8] c"CCS not seen in the current flight\00", align 1
@.str.210 = private unnamed_addr constant [31 x i8] c"Injecting buffered CCS message\00", align 1
@.str.211 = private unnamed_addr constant [52 x i8] c"Future message with sequence number %u %s buffered.\00", align 1
@.str.212 = private unnamed_addr constant [6 x i8] c"fully\00", align 1
@.str.213 = private unnamed_addr constant [10 x i8] c"partially\00", align 1
@.str.214 = private unnamed_addr constant [48 x i8] c"Next handshake message has been buffered - load\00", align 1
@.str.215 = private unnamed_addr constant [42 x i8] c"Buffered handshake message (incl. header)\00", align 1
@.str.216 = private unnamed_addr constant [58 x i8] c"Next handshake message %u not or only partially bufffered\00", align 1
@.str.217 = private unnamed_addr constant [29 x i8] c"<= ssl_load_buffered_message\00", align 1
@.str.218 = private unnamed_addr constant [22 x i8] c"=> ssl_buffer_message\00", align 1
@.str.219 = private unnamed_addr constant [21 x i8] c"Remember CCS message\00", align 1
@.str.220 = private unnamed_addr constant [75 x i8] c"Ignore future HS message with sequence number %u, buffering window %u - %u\00", align 1
@.str.221 = private unnamed_addr constant [57 x i8] c"Buffering HS message with sequence number %u, offset %u \00", align 1
@.str.222 = private unnamed_addr constant [117 x i8] c"Buffering of future message of size %u would exceed the compile-time limit %u (already %u bytes buffered) -- ignore\0A\00", align 1
@.str.223 = private unnamed_addr constant [168 x i8] c"Buffering of future message of size %u would exceed the compile-time limit %u (already %u bytes buffered) -- attempt to make space by freeing buffered future messages\0A\00", align 1
@.str.224 = private unnamed_addr constant [131 x i8] c"Reassembly of next message of size %u (%u with bitmap) would exceed the compile-time limit %u (already %u bytes buffered) -- fail\0A\00", align 1
@.str.225 = private unnamed_addr constant [41 x i8] c"initialize reassembly, total length = %d\00", align 1
@.str.226 = private unnamed_addr constant [34 x i8] c"Fragment header mismatch - ignore\00", align 1
@.str.227 = private unnamed_addr constant [42 x i8] c"adding fragment, offset = %d, length = %d\00", align 1
@.str.228 = private unnamed_addr constant [19 x i8] c"message %scomplete\00", align 1
@.str.229 = private unnamed_addr constant [1 x i8] zeroinitializer, align 1
@.str.230 = private unnamed_addr constant [9 x i8] c"not yet \00", align 1
@.str.231 = private unnamed_addr constant [22 x i8] c"<= ssl_buffer_message\00", align 1
@.str.232 = private unnamed_addr constant [61 x i8] c"Attempt to free buffered messages to have %u bytes available\00", align 1
@.str.233 = private unnamed_addr constant [57 x i8] c"Enough space available after freeing future epoch record\00", align 1
@.str.234 = private unnamed_addr constant [78 x i8] c"Free buffering slot %d to make space for reassembly of next handshake message\00", align 1
@.str.235 = private unnamed_addr constant [58 x i8] c"Enough space available after freeing buffered HS messages\00", align 1
@.str.236 = private unnamed_addr constant [28 x i8] c"remaining content in record\00", align 1
@.str.237 = private unnamed_addr constant [24 x i8] c"mbedtls_ssl_fetch_input\00", align 1
@.str.238 = private unnamed_addr constant [38 x i8] c"discarding unexpected record (header)\00", align 1
@.str.239 = private unnamed_addr constant [35 x i8] c"discarding invalid record (header)\00", align 1
@.str.240 = private unnamed_addr constant [37 x i8] c"more than one record within datagram\00", align 1
@.str.241 = private unnamed_addr constant [30 x i8] c"too many records with bad MAC\00", align 1
@.str.242 = private unnamed_addr constant [32 x i8] c"discarding invalid record (mac)\00", align 1
@.str.243 = private unnamed_addr constant [28 x i8] c"=> ssl_load_buffered_record\00", align 1
@.str.244 = private unnamed_addr constant [40 x i8] c"Buffered record not from current epoch.\00", align 1
@.str.245 = private unnamed_addr constant [48 x i8] c"Found buffered record from current epoch - load\00", align 1
@.str.246 = private unnamed_addr constant [28 x i8] c"<= ssl_load_buffered_record\00", align 1
@.str.247 = private unnamed_addr constant [20 x i8] c"input record header\00", align 1
@.str.248 = private unnamed_addr constant [59 x i8] c"input record: msgtype = %d, version = [%d:%d], msglen = %d\00", align 1
@.str.249 = private unnamed_addr constant [20 x i8] c"unknown record type\00", align 1
@.str.250 = private unnamed_addr constant [23 x i8] c"major version mismatch\00", align 1
@.str.251 = private unnamed_addr constant [23 x i8] c"minor version mismatch\00", align 1
@.str.252 = private unnamed_addr constant [19 x i8] c"bad message length\00", align 1
@.str.253 = private unnamed_addr constant [52 x i8] c"record from another epoch: expected %d, received %d\00", align 1
@.str.254 = private unnamed_addr constant [45 x i8] c"possible client reconnect from the same port\00", align 1
@.str.255 = private unnamed_addr constant [30 x i8] c"Consider record for buffering\00", align 1
@.str.256 = private unnamed_addr constant [16 x i8] c"replayed record\00", align 1
@.str.257 = private unnamed_addr constant [36 x i8] c"dropping unexpected ApplicationData\00", align 1
@.str.258 = private unnamed_addr constant [29 x i8] c"ssl_check_dtls_clihlo_cookie\00", align 1
@.str.259 = private unnamed_addr constant [6 x i8] c"reset\00", align 1
@.str.260 = private unnamed_addr constant [122 x i8] c"Buffering of future epoch record of size %u would exceed the compile-time limit %u (already %u bytes buffered) -- ignore\0A\00", align 1
@.str.261 = private unnamed_addr constant [28 x i8] c"Buffer record from epoch %u\00", align 1
@.str.262 = private unnamed_addr constant [16 x i8] c"Buffered record\00", align 1
@.str.263 = private unnamed_addr constant [26 x i8] c"input record from network\00", align 1
@.str.264 = private unnamed_addr constant [16 x i8] c"ssl_decrypt_buf\00", align 1
@.str.265 = private unnamed_addr constant [28 x i8] c"input payload after decrypt\00", align 1
@.str.266 = private unnamed_addr constant [15 x i8] c"=> decrypt buf\00", align 1
@.str.267 = private unnamed_addr constant [29 x i8] c"in_msglen (%d) < minlen (%d)\00", align 1
@.str.268 = private unnamed_addr constant [49 x i8] c"msglen (%d) < explicit_iv_len (%d) + taglen (%d)\00", align 1
@.str.269 = private unnamed_addr constant [8 x i8] c"IV used\00", align 1
@.str.270 = private unnamed_addr constant [9 x i8] c"TAG used\00", align 1
@.str.271 = private unnamed_addr constant [28 x i8] c"mbedtls_cipher_auth_decrypt\00", align 1
@.str.272 = private unnamed_addr constant [62 x i8] c"msglen (%d) < max( ivlen(%d), maclen (%d) + 1 ) ( + expl IV )\00", align 1
@.str.273 = private unnamed_addr constant [13 x i8] c"message  mac\00", align 1
@.str.274 = private unnamed_addr constant [13 x i8] c"expected mac\00", align 1
@.str.275 = private unnamed_addr constant [27 x i8] c"message mac does not match\00", align 1
@.str.276 = private unnamed_addr constant [31 x i8] c"msglen (%d) %% ivlen (%d) != 0\00", align 1
@.str.277 = private unnamed_addr constant [37 x i8] c"invalid zero-length message type: %d\00", align 1
@.str.278 = private unnamed_addr constant [62 x i8] c"received four consecutive empty messages, possible DoS attack\00", align 1
@.str.279 = private unnamed_addr constant [36 x i8] c"incoming message counter would wrap\00", align 1
@.str.280 = private unnamed_addr constant [15 x i8] c"<= decrypt buf\00", align 1
@.str.281 = private unnamed_addr constant [32 x i8] c"TLSv1 client has no certificate\00", align 1
@.str.282 = private unnamed_addr constant [24 x i8] c"bad certificate message\00", align 1
@.str.283 = private unnamed_addr constant [28 x i8] c" mbedtls_x509_crt_parse_der\00", align 1
@.str.284 = private unnamed_addr constant [17 x i8] c"peer certificate\00", align 1
@.str.285 = private unnamed_addr constant [37 x i8] c"new server cert during renegotiation\00", align 1
@.str.286 = private unnamed_addr constant [41 x i8] c"server cert changed during renegotiation\00", align 1
@.str.287 = private unnamed_addr constant [22 x i8] c"=> calc  finished tls\00", align 1
@.str.288 = private unnamed_addr constant [20 x i8] c"finished  md5 state\00", align 1
@.str.289 = private unnamed_addr constant [20 x i8] c"finished sha1 state\00", align 1
@.str.290 = private unnamed_addr constant [16 x i8] c"client finished\00", align 1
@.str.291 = private unnamed_addr constant [16 x i8] c"server finished\00", align 1
@.str.292 = private unnamed_addr constant [21 x i8] c"calc finished result\00", align 1
@.str.293 = private unnamed_addr constant [18 x i8] c"<= calc  finished\00", align 1
@.str.294 = private unnamed_addr constant [29 x i8] c"=> calc  finished tls sha256\00", align 1
@.str.295 = private unnamed_addr constant [20 x i8] c"finished sha2 state\00", align 1
@.str.296 = private unnamed_addr constant [29 x i8] c"=> calc  finished tls sha384\00", align 1
@.str.297 = private unnamed_addr constant [22 x i8] c"finished sha512 state\00", align 1
@.str.298 = private unnamed_addr constant [32 x i8] c"=> handshake wrapup: final free\00", align 1
@.str.299 = private unnamed_addr constant [32 x i8] c"<= handshake wrapup: final free\00", align 1
@.str.300 = private unnamed_addr constant [35 x i8] c"alloc() of ssl sub-contexts failed\00", align 1
@.str.301 = private unnamed_addr constant [23 x i8] c"=> write hello request\00", align 1
@.str.302 = private unnamed_addr constant [23 x i8] c"<= write hello request\00", align 1
@.str.303 = private unnamed_addr constant [15 x i8] c"=> renegotiate\00", align 1
@.str.304 = private unnamed_addr constant [15 x i8] c"<= renegotiate\00", align 1
@.str.305 = private unnamed_addr constant [42 x i8] c"record counter limit reached: renegotiate\00", align 1
@.str.306 = private unnamed_addr constant [39 x i8] c"mbedtls_ssl_get_max_out_record_payload\00", align 1
@.str.307 = private unnamed_addr constant [71 x i8] c"fragment larger than the (negotiated) maximum fragment length: %d > %d\00", align 1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_derive_keys(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %tmp = alloca [64 x i8], align 16
  %keyblk = alloca [256 x i8], align 16
  %key1 = alloca ptr, align 8
  %key2 = alloca ptr, align 8
  %mac_enc = alloca ptr, align 8
  %mac_dec = alloca ptr, align 8
  %mac_key_len = alloca i64, align 8
  %iv_copy_len = alloca i64, align 8
  %cipher_info = alloca ptr, align 8
  %md_info = alloca ptr, align 8
  %session = alloca ptr, align 8
  %transform = alloca ptr, align 8
  %handshake = alloca ptr, align 8
  %session_hash = alloca [48 x i8], align 16
  %hash_len = alloca i64, align 8
  %taglen = alloca i64, align 8
  %explicit_ivlen = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 0, ptr %ret, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 14
  %1 = load ptr, ptr %session_negotiate, align 8
  store ptr %1, ptr %session, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 19
  %3 = load ptr, ptr %transform_negotiate, align 8
  store ptr %3, ptr %transform, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %handshake1, align 8
  store ptr %5, ptr %handshake, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 2, ptr noundef @.str, i32 noundef 628, ptr noundef @.str.1)
  %7 = load ptr, ptr %transform, align 8
  %ciphersuite_info = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %7, i32 0, i32 0
  %8 = load ptr, ptr %ciphersuite_info, align 8
  %cipher = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %8, i32 0, i32 2
  %9 = load i32, ptr %cipher, align 8
  %call = call ptr @mbedtls_cipher_info_from_type(i32 noundef %9)
  store ptr %call, ptr %cipher_info, align 8
  %10 = load ptr, ptr %cipher_info, align 8
  %cmp = icmp eq ptr %10, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  %12 = load ptr, ptr %transform, align 8
  %ciphersuite_info2 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %12, i32 0, i32 0
  %13 = load ptr, ptr %ciphersuite_info2, align 8
  %cipher3 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %13, i32 0, i32 2
  %14 = load i32, ptr %cipher3, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %11, i32 noundef 1, ptr noundef @.str, i32 noundef 634, ptr noundef @.str.2, i32 noundef %14)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %15 = load ptr, ptr %transform, align 8
  %ciphersuite_info4 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %15, i32 0, i32 0
  %16 = load ptr, ptr %ciphersuite_info4, align 8
  %mac = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %16, i32 0, i32 3
  %17 = load i32, ptr %mac, align 4
  %call5 = call ptr @mbedtls_md_info_from_type(i32 noundef %17)
  store ptr %call5, ptr %md_info, align 8
  %18 = load ptr, ptr %md_info, align 8
  %cmp6 = icmp eq ptr %18, null
  br i1 %cmp6, label %if.then7, label %if.end10

if.then7:                                         ; preds = %if.end
  %19 = load ptr, ptr %ssl.addr, align 8
  %20 = load ptr, ptr %transform, align 8
  %ciphersuite_info8 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %20, i32 0, i32 0
  %21 = load ptr, ptr %ciphersuite_info8, align 8
  %mac9 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %21, i32 0, i32 3
  %22 = load i32, ptr %mac9, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %19, i32 noundef 1, ptr noundef @.str, i32 noundef 642, ptr noundef @.str.3, i32 noundef %22)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.end
  %23 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 5
  %24 = load i32, ptr %minor_ver, align 8
  %cmp11 = icmp slt i32 %24, 3
  br i1 %cmp11, label %if.then12, label %if.else

if.then12:                                        ; preds = %if.end10
  %25 = load ptr, ptr %handshake, align 8
  %tls_prf = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %25, i32 0, i32 32
  store ptr @tls1_prf, ptr %tls_prf, align 8
  %26 = load ptr, ptr %handshake, align 8
  %calc_verify = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %26, i32 0, i32 30
  store ptr @ssl_calc_verify_tls, ptr %calc_verify, align 8
  %27 = load ptr, ptr %handshake, align 8
  %calc_finished = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %27, i32 0, i32 31
  store ptr @ssl_calc_finished_tls, ptr %calc_finished, align 8
  br label %if.end32

if.else:                                          ; preds = %if.end10
  %28 = load ptr, ptr %ssl.addr, align 8
  %minor_ver13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 5
  %29 = load i32, ptr %minor_ver13, align 8
  %cmp14 = icmp eq i32 %29, 3
  br i1 %cmp14, label %land.lhs.true, label %if.else22

land.lhs.true:                                    ; preds = %if.else
  %30 = load ptr, ptr %transform, align 8
  %ciphersuite_info15 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %30, i32 0, i32 0
  %31 = load ptr, ptr %ciphersuite_info15, align 8
  %mac16 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %31, i32 0, i32 3
  %32 = load i32, ptr %mac16, align 4
  %cmp17 = icmp eq i32 %32, 7
  br i1 %cmp17, label %if.then18, label %if.else22

if.then18:                                        ; preds = %land.lhs.true
  %33 = load ptr, ptr %handshake, align 8
  %tls_prf19 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %33, i32 0, i32 32
  store ptr @tls_prf_sha384, ptr %tls_prf19, align 8
  %34 = load ptr, ptr %handshake, align 8
  %calc_verify20 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %34, i32 0, i32 30
  store ptr @ssl_calc_verify_tls_sha384, ptr %calc_verify20, align 8
  %35 = load ptr, ptr %handshake, align 8
  %calc_finished21 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %35, i32 0, i32 31
  store ptr @ssl_calc_finished_tls_sha384, ptr %calc_finished21, align 8
  br label %if.end31

if.else22:                                        ; preds = %land.lhs.true, %if.else
  %36 = load ptr, ptr %ssl.addr, align 8
  %minor_ver23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 5
  %37 = load i32, ptr %minor_ver23, align 8
  %cmp24 = icmp eq i32 %37, 3
  br i1 %cmp24, label %if.then25, label %if.else29

if.then25:                                        ; preds = %if.else22
  %38 = load ptr, ptr %handshake, align 8
  %tls_prf26 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %38, i32 0, i32 32
  store ptr @tls_prf_sha256, ptr %tls_prf26, align 8
  %39 = load ptr, ptr %handshake, align 8
  %calc_verify27 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %39, i32 0, i32 30
  store ptr @ssl_calc_verify_tls_sha256, ptr %calc_verify27, align 8
  %40 = load ptr, ptr %handshake, align 8
  %calc_finished28 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %40, i32 0, i32 31
  store ptr @ssl_calc_finished_tls_sha256, ptr %calc_finished28, align 8
  br label %if.end30

if.else29:                                        ; preds = %if.else22
  %41 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %41, i32 noundef 1, ptr noundef @.str, i32 noundef 689, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end30:                                         ; preds = %if.then25
  br label %if.end31

if.end31:                                         ; preds = %if.end30, %if.then18
  br label %if.end32

if.end32:                                         ; preds = %if.end31, %if.then12
  %42 = load ptr, ptr %handshake, align 8
  %resume = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %42, i32 0, i32 36
  %43 = load i32, ptr %resume, align 4
  %cmp33 = icmp eq i32 %43, 0
  br i1 %cmp33, label %if.then34, label %if.else79

if.then34:                                        ; preds = %if.end32
  %44 = load ptr, ptr %ssl.addr, align 8
  %45 = load ptr, ptr %handshake, align 8
  %premaster = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %45, i32 0, i32 35
  %arraydecay = getelementptr inbounds [1060 x i8], ptr %premaster, i64 0, i64 0
  %46 = load ptr, ptr %handshake, align 8
  %pmslen = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %46, i32 0, i32 33
  %47 = load i64, ptr %pmslen, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %44, i32 noundef 3, ptr noundef @.str, i32 noundef 706, ptr noundef @.str.5, ptr noundef %arraydecay, i64 noundef %47)
  %48 = load ptr, ptr %ssl.addr, align 8
  %handshake35 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %48, i32 0, i32 15
  %49 = load ptr, ptr %handshake35, align 8
  %extended_ms = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %49, i32 0, i32 41
  %50 = load i32, ptr %extended_ms, align 8
  %cmp36 = icmp eq i32 %50, 1
  br i1 %cmp36, label %if.then37, label %if.else64

if.then37:                                        ; preds = %if.then34
  %51 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %51, i32 noundef 3, ptr noundef @.str, i32 noundef 714, ptr noundef @.str.6)
  %52 = load ptr, ptr %ssl.addr, align 8
  %handshake38 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 15
  %53 = load ptr, ptr %handshake38, align 8
  %calc_verify39 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %53, i32 0, i32 30
  %54 = load ptr, ptr %calc_verify39, align 8
  %55 = load ptr, ptr %ssl.addr, align 8
  %arraydecay40 = getelementptr inbounds [48 x i8], ptr %session_hash, i64 0, i64 0
  call void %54(ptr noundef %55, ptr noundef %arraydecay40)
  %56 = load ptr, ptr %ssl.addr, align 8
  %minor_ver41 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %56, i32 0, i32 5
  %57 = load i32, ptr %minor_ver41, align 8
  %cmp42 = icmp eq i32 %57, 3
  br i1 %cmp42, label %if.then43, label %if.else51

if.then43:                                        ; preds = %if.then37
  %58 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate44 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 19
  %59 = load ptr, ptr %transform_negotiate44, align 8
  %ciphersuite_info45 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %59, i32 0, i32 0
  %60 = load ptr, ptr %ciphersuite_info45, align 8
  %mac46 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %60, i32 0, i32 3
  %61 = load i32, ptr %mac46, align 4
  %cmp47 = icmp eq i32 %61, 7
  br i1 %cmp47, label %if.then48, label %if.else49

if.then48:                                        ; preds = %if.then43
  store i64 48, ptr %hash_len, align 8
  br label %if.end50

if.else49:                                        ; preds = %if.then43
  store i64 32, ptr %hash_len, align 8
  br label %if.end50

if.end50:                                         ; preds = %if.else49, %if.then48
  br label %if.end52

if.else51:                                        ; preds = %if.then37
  store i64 36, ptr %hash_len, align 8
  br label %if.end52

if.end52:                                         ; preds = %if.else51, %if.end50
  %62 = load ptr, ptr %ssl.addr, align 8
  %arraydecay53 = getelementptr inbounds [48 x i8], ptr %session_hash, i64 0, i64 0
  %63 = load i64, ptr %hash_len, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %62, i32 noundef 3, ptr noundef @.str, i32 noundef 735, ptr noundef @.str.7, ptr noundef %arraydecay53, i64 noundef %63)
  %64 = load ptr, ptr %handshake, align 8
  %tls_prf54 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %64, i32 0, i32 32
  %65 = load ptr, ptr %tls_prf54, align 8
  %66 = load ptr, ptr %handshake, align 8
  %premaster55 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %66, i32 0, i32 35
  %arraydecay56 = getelementptr inbounds [1060 x i8], ptr %premaster55, i64 0, i64 0
  %67 = load ptr, ptr %handshake, align 8
  %pmslen57 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %67, i32 0, i32 33
  %68 = load i64, ptr %pmslen57, align 8
  %arraydecay58 = getelementptr inbounds [48 x i8], ptr %session_hash, i64 0, i64 0
  %69 = load i64, ptr %hash_len, align 8
  %70 = load ptr, ptr %session, align 8
  %master = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %70, i32 0, i32 5
  %arraydecay59 = getelementptr inbounds [48 x i8], ptr %master, i64 0, i64 0
  %call60 = call i32 %65(ptr noundef %arraydecay56, i64 noundef %68, ptr noundef @.str.8, ptr noundef %arraydecay58, i64 noundef %69, ptr noundef %arraydecay59, i64 noundef 48)
  store i32 %call60, ptr %ret, align 4
  %71 = load i32, ptr %ret, align 4
  %cmp61 = icmp ne i32 %71, 0
  br i1 %cmp61, label %if.then62, label %if.end63

if.then62:                                        ; preds = %if.end52
  %72 = load ptr, ptr %ssl.addr, align 8
  %73 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %72, i32 noundef 1, ptr noundef @.str, i32 noundef 743, ptr noundef @.str.9, i32 noundef %73)
  %74 = load i32, ptr %ret, align 4
  store i32 %74, ptr %retval, align 4
  br label %return

if.end63:                                         ; preds = %if.end52
  br label %if.end73

if.else64:                                        ; preds = %if.then34
  %75 = load ptr, ptr %handshake, align 8
  %tls_prf65 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %75, i32 0, i32 32
  %76 = load ptr, ptr %tls_prf65, align 8
  %77 = load ptr, ptr %handshake, align 8
  %premaster66 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %77, i32 0, i32 35
  %arraydecay67 = getelementptr inbounds [1060 x i8], ptr %premaster66, i64 0, i64 0
  %78 = load ptr, ptr %handshake, align 8
  %pmslen68 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %78, i32 0, i32 33
  %79 = load i64, ptr %pmslen68, align 8
  %80 = load ptr, ptr %handshake, align 8
  %randbytes = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %80, i32 0, i32 34
  %arraydecay69 = getelementptr inbounds [64 x i8], ptr %randbytes, i64 0, i64 0
  %81 = load ptr, ptr %session, align 8
  %master70 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %81, i32 0, i32 5
  %arraydecay71 = getelementptr inbounds [48 x i8], ptr %master70, i64 0, i64 0
  %call72 = call i32 %76(ptr noundef %arraydecay67, i64 noundef %79, ptr noundef @.str.10, ptr noundef %arraydecay69, i64 noundef 64, ptr noundef %arraydecay71, i64 noundef 48)
  store i32 %call72, ptr %ret, align 4
  br label %if.end73

if.end73:                                         ; preds = %if.else64, %if.end63
  %82 = load i32, ptr %ret, align 4
  %cmp74 = icmp ne i32 %82, 0
  br i1 %cmp74, label %if.then75, label %if.end76

if.then75:                                        ; preds = %if.end73
  %83 = load ptr, ptr %ssl.addr, align 8
  %84 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %83, i32 noundef 1, ptr noundef @.str, i32 noundef 756, ptr noundef @.str.9, i32 noundef %84)
  %85 = load i32, ptr %ret, align 4
  store i32 %85, ptr %retval, align 4
  br label %return

if.end76:                                         ; preds = %if.end73
  %86 = load ptr, ptr %handshake, align 8
  %premaster77 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %86, i32 0, i32 35
  %arraydecay78 = getelementptr inbounds [1060 x i8], ptr %premaster77, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay78, i64 noundef 1060)
  br label %if.end80

if.else79:                                        ; preds = %if.end32
  %87 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %87, i32 noundef 3, ptr noundef @.str, i32 noundef 764, ptr noundef @.str.11)
  br label %if.end80

if.end80:                                         ; preds = %if.else79, %if.end76
  %arraydecay81 = getelementptr inbounds [64 x i8], ptr %tmp, i64 0, i64 0
  %88 = load ptr, ptr %handshake, align 8
  %randbytes82 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %88, i32 0, i32 34
  %arraydecay83 = getelementptr inbounds [64 x i8], ptr %randbytes82, i64 0, i64 0
  call void @llvm.memcpy.p0.p0.i64(ptr align 16 %arraydecay81, ptr align 8 %arraydecay83, i64 64, i1 false)
  %89 = load ptr, ptr %handshake, align 8
  %randbytes84 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %89, i32 0, i32 34
  %arraydecay85 = getelementptr inbounds [64 x i8], ptr %randbytes84, i64 0, i64 0
  %arraydecay86 = getelementptr inbounds [64 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr = getelementptr inbounds i8, ptr %arraydecay86, i64 32
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay85, ptr align 1 %add.ptr, i64 32, i1 false)
  %90 = load ptr, ptr %handshake, align 8
  %randbytes87 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %90, i32 0, i32 34
  %arraydecay88 = getelementptr inbounds [64 x i8], ptr %randbytes87, i64 0, i64 0
  %add.ptr89 = getelementptr inbounds i8, ptr %arraydecay88, i64 32
  %arraydecay90 = getelementptr inbounds [64 x i8], ptr %tmp, i64 0, i64 0
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr89, ptr align 16 %arraydecay90, i64 32, i1 false)
  %arraydecay91 = getelementptr inbounds [64 x i8], ptr %tmp, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay91, i64 noundef 64)
  %91 = load ptr, ptr %handshake, align 8
  %tls_prf92 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %91, i32 0, i32 32
  %92 = load ptr, ptr %tls_prf92, align 8
  %93 = load ptr, ptr %session, align 8
  %master93 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %93, i32 0, i32 5
  %arraydecay94 = getelementptr inbounds [48 x i8], ptr %master93, i64 0, i64 0
  %94 = load ptr, ptr %handshake, align 8
  %randbytes95 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %94, i32 0, i32 34
  %arraydecay96 = getelementptr inbounds [64 x i8], ptr %randbytes95, i64 0, i64 0
  %arraydecay97 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %call98 = call i32 %92(ptr noundef %arraydecay94, i64 noundef 48, ptr noundef @.str.12, ptr noundef %arraydecay96, i64 noundef 64, ptr noundef %arraydecay97, i64 noundef 256)
  store i32 %call98, ptr %ret, align 4
  %95 = load i32, ptr %ret, align 4
  %cmp99 = icmp ne i32 %95, 0
  br i1 %cmp99, label %if.then100, label %if.end101

if.then100:                                       ; preds = %if.end80
  %96 = load ptr, ptr %ssl.addr, align 8
  %97 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %96, i32 noundef 1, ptr noundef @.str, i32 noundef 790, ptr noundef @.str.9, i32 noundef %97)
  %98 = load i32, ptr %ret, align 4
  store i32 %98, ptr %retval, align 4
  br label %return

if.end101:                                        ; preds = %if.end80
  %99 = load ptr, ptr %ssl.addr, align 8
  %100 = load ptr, ptr %session, align 8
  %ciphersuite = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %100, i32 0, i32 1
  %101 = load i32, ptr %ciphersuite, align 8
  %call102 = call ptr @mbedtls_ssl_get_ciphersuite_name(i32 noundef %101)
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %99, i32 noundef 3, ptr noundef @.str, i32 noundef 795, ptr noundef @.str.13, ptr noundef %call102)
  %102 = load ptr, ptr %ssl.addr, align 8
  %103 = load ptr, ptr %session, align 8
  %master103 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %103, i32 0, i32 5
  %arraydecay104 = getelementptr inbounds [48 x i8], ptr %master103, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %102, i32 noundef 3, ptr noundef @.str, i32 noundef 796, ptr noundef @.str.10, ptr noundef %arraydecay104, i64 noundef 48)
  %104 = load ptr, ptr %ssl.addr, align 8
  %105 = load ptr, ptr %handshake, align 8
  %randbytes105 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %105, i32 0, i32 34
  %arraydecay106 = getelementptr inbounds [64 x i8], ptr %randbytes105, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %104, i32 noundef 4, ptr noundef @.str, i32 noundef 797, ptr noundef @.str.14, ptr noundef %arraydecay106, i64 noundef 64)
  %106 = load ptr, ptr %ssl.addr, align 8
  %arraydecay107 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %106, i32 noundef 4, ptr noundef @.str, i32 noundef 798, ptr noundef @.str.15, ptr noundef %arraydecay107, i64 noundef 256)
  %107 = load ptr, ptr %handshake, align 8
  %randbytes108 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %107, i32 0, i32 34
  %arraydecay109 = getelementptr inbounds [64 x i8], ptr %randbytes108, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay109, i64 noundef 64)
  %108 = load ptr, ptr %cipher_info, align 8
  %key_bitlen = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %108, i32 0, i32 2
  %109 = load i32, ptr %key_bitlen, align 8
  %div = udiv i32 %109, 8
  %110 = load ptr, ptr %transform, align 8
  %keylen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %110, i32 0, i32 1
  store i32 %div, ptr %keylen, align 8
  %111 = load ptr, ptr %cipher_info, align 8
  %mode = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %111, i32 0, i32 1
  %112 = load i32, ptr %mode, align 4
  %cmp110 = icmp eq i32 %112, 6
  br i1 %cmp110, label %if.then116, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end101
  %113 = load ptr, ptr %cipher_info, align 8
  %mode111 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %113, i32 0, i32 1
  %114 = load i32, ptr %mode111, align 4
  %cmp112 = icmp eq i32 %114, 8
  br i1 %cmp112, label %if.then116, label %lor.lhs.false113

lor.lhs.false113:                                 ; preds = %lor.lhs.false
  %115 = load ptr, ptr %cipher_info, align 8
  %mode114 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %115, i32 0, i32 1
  %116 = load i32, ptr %mode114, align 4
  %cmp115 = icmp eq i32 %116, 10
  br i1 %cmp115, label %if.then116, label %if.else127

if.then116:                                       ; preds = %lor.lhs.false113, %lor.lhs.false, %if.end101
  %117 = load ptr, ptr %transform, align 8
  %maclen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %117, i32 0, i32 5
  store i64 0, ptr %maclen, align 8
  store i64 0, ptr %mac_key_len, align 8
  %118 = load ptr, ptr %transform, align 8
  %ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %118, i32 0, i32 3
  store i64 12, ptr %ivlen, align 8
  %119 = load ptr, ptr %cipher_info, align 8
  %mode117 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %119, i32 0, i32 1
  %120 = load i32, ptr %mode117, align 4
  %cmp118 = icmp eq i32 %120, 10
  br i1 %cmp118, label %if.then119, label %if.else120

if.then119:                                       ; preds = %if.then116
  %121 = load ptr, ptr %transform, align 8
  %fixed_ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %121, i32 0, i32 4
  store i64 12, ptr %fixed_ivlen, align 8
  br label %if.end122

if.else120:                                       ; preds = %if.then116
  %122 = load ptr, ptr %transform, align 8
  %fixed_ivlen121 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %122, i32 0, i32 4
  store i64 4, ptr %fixed_ivlen121, align 8
  br label %if.end122

if.end122:                                        ; preds = %if.else120, %if.then119
  %123 = load ptr, ptr %transform, align 8
  %ciphersuite_info123 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %123, i32 0, i32 0
  %124 = load ptr, ptr %ciphersuite_info123, align 8
  %flags = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %124, i32 0, i32 9
  %125 = load i8, ptr %flags, align 4
  %conv = zext i8 %125 to i32
  %and = and i32 %conv, 2
  %tobool = icmp ne i32 %and, 0
  %126 = zext i1 %tobool to i64
  %cond = select i1 %tobool, i32 8, i32 16
  %conv124 = sext i32 %cond to i64
  store i64 %conv124, ptr %taglen, align 8
  %127 = load ptr, ptr %transform, align 8
  %ivlen125 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %127, i32 0, i32 3
  %128 = load i64, ptr %ivlen125, align 8
  %129 = load ptr, ptr %transform, align 8
  %fixed_ivlen126 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %129, i32 0, i32 4
  %130 = load i64, ptr %fixed_ivlen126, align 8
  %sub = sub i64 %128, %130
  store i64 %sub, ptr %explicit_ivlen, align 8
  %131 = load i64, ptr %explicit_ivlen, align 8
  %132 = load i64, ptr %taglen, align 8
  %add = add i64 %131, %132
  %133 = load ptr, ptr %transform, align 8
  %minlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %133, i32 0, i32 2
  store i64 %add, ptr %minlen, align 8
  br label %if.end196

if.else127:                                       ; preds = %lor.lhs.false113
  %134 = load ptr, ptr %transform, align 8
  %md_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %134, i32 0, i32 8
  %135 = load ptr, ptr %md_info, align 8
  %call128 = call i32 @mbedtls_md_setup(ptr noundef %md_ctx_enc, ptr noundef %135, i32 noundef 1)
  store i32 %call128, ptr %ret, align 4
  %cmp129 = icmp ne i32 %call128, 0
  br i1 %cmp129, label %if.then135, label %lor.lhs.false131

lor.lhs.false131:                                 ; preds = %if.else127
  %136 = load ptr, ptr %transform, align 8
  %md_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %136, i32 0, i32 9
  %137 = load ptr, ptr %md_info, align 8
  %call132 = call i32 @mbedtls_md_setup(ptr noundef %md_ctx_dec, ptr noundef %137, i32 noundef 1)
  store i32 %call132, ptr %ret, align 4
  %cmp133 = icmp ne i32 %call132, 0
  br i1 %cmp133, label %if.then135, label %if.end136

if.then135:                                       ; preds = %lor.lhs.false131, %if.else127
  %138 = load ptr, ptr %ssl.addr, align 8
  %139 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %138, i32 noundef 1, ptr noundef @.str, i32 noundef 843, ptr noundef @.str.16, i32 noundef %139)
  %140 = load i32, ptr %ret, align 4
  store i32 %140, ptr %retval, align 4
  br label %return

if.end136:                                        ; preds = %lor.lhs.false131
  %141 = load ptr, ptr %md_info, align 8
  %call137 = call zeroext i8 @mbedtls_md_get_size(ptr noundef %141)
  %conv138 = zext i8 %call137 to i64
  store i64 %conv138, ptr %mac_key_len, align 8
  %142 = load i64, ptr %mac_key_len, align 8
  %143 = load ptr, ptr %transform, align 8
  %maclen139 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %143, i32 0, i32 5
  store i64 %142, ptr %maclen139, align 8
  %144 = load ptr, ptr %session, align 8
  %trunc_hmac = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %144, i32 0, i32 12
  %145 = load i32, ptr %trunc_hmac, align 8
  %cmp140 = icmp eq i32 %145, 1
  br i1 %cmp140, label %if.then142, label %if.end144

if.then142:                                       ; preds = %if.end136
  %146 = load ptr, ptr %transform, align 8
  %maclen143 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %146, i32 0, i32 5
  store i64 10, ptr %maclen143, align 8
  br label %if.end144

if.end144:                                        ; preds = %if.then142, %if.end136
  %147 = load ptr, ptr %cipher_info, align 8
  %iv_size = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %147, i32 0, i32 4
  %148 = load i32, ptr %iv_size, align 8
  %conv145 = zext i32 %148 to i64
  %149 = load ptr, ptr %transform, align 8
  %ivlen146 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %149, i32 0, i32 3
  store i64 %conv145, ptr %ivlen146, align 8
  %150 = load ptr, ptr %cipher_info, align 8
  %mode147 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %150, i32 0, i32 1
  %151 = load i32, ptr %mode147, align 4
  %cmp148 = icmp eq i32 %151, 7
  br i1 %cmp148, label %if.then150, label %if.else153

if.then150:                                       ; preds = %if.end144
  %152 = load ptr, ptr %transform, align 8
  %maclen151 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %152, i32 0, i32 5
  %153 = load i64, ptr %maclen151, align 8
  %154 = load ptr, ptr %transform, align 8
  %minlen152 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %154, i32 0, i32 2
  store i64 %153, ptr %minlen152, align 8
  br label %if.end195

if.else153:                                       ; preds = %if.end144
  %155 = load ptr, ptr %session, align 8
  %encrypt_then_mac = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %155, i32 0, i32 13
  %156 = load i32, ptr %encrypt_then_mac, align 4
  %cmp154 = icmp eq i32 %156, 1
  br i1 %cmp154, label %if.then156, label %if.else161

if.then156:                                       ; preds = %if.else153
  %157 = load ptr, ptr %transform, align 8
  %maclen157 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %157, i32 0, i32 5
  %158 = load i64, ptr %maclen157, align 8
  %159 = load ptr, ptr %cipher_info, align 8
  %block_size = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %159, i32 0, i32 6
  %160 = load i32, ptr %block_size, align 8
  %conv158 = zext i32 %160 to i64
  %add159 = add i64 %158, %conv158
  %161 = load ptr, ptr %transform, align 8
  %minlen160 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %161, i32 0, i32 2
  store i64 %add159, ptr %minlen160, align 8
  br label %if.end171

if.else161:                                       ; preds = %if.else153
  %162 = load ptr, ptr %transform, align 8
  %maclen162 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %162, i32 0, i32 5
  %163 = load i64, ptr %maclen162, align 8
  %164 = load ptr, ptr %cipher_info, align 8
  %block_size163 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %164, i32 0, i32 6
  %165 = load i32, ptr %block_size163, align 8
  %conv164 = zext i32 %165 to i64
  %add165 = add i64 %163, %conv164
  %166 = load ptr, ptr %transform, align 8
  %maclen166 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %166, i32 0, i32 5
  %167 = load i64, ptr %maclen166, align 8
  %168 = load ptr, ptr %cipher_info, align 8
  %block_size167 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %168, i32 0, i32 6
  %169 = load i32, ptr %block_size167, align 8
  %conv168 = zext i32 %169 to i64
  %rem = urem i64 %167, %conv168
  %sub169 = sub i64 %add165, %rem
  %170 = load ptr, ptr %transform, align 8
  %minlen170 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %170, i32 0, i32 2
  store i64 %sub169, ptr %minlen170, align 8
  br label %if.end171

if.end171:                                        ; preds = %if.else161, %if.then156
  %171 = load ptr, ptr %ssl.addr, align 8
  %minor_ver172 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %171, i32 0, i32 5
  %172 = load i32, ptr %minor_ver172, align 8
  %cmp173 = icmp eq i32 %172, 0
  br i1 %cmp173, label %if.then179, label %lor.lhs.false175

lor.lhs.false175:                                 ; preds = %if.end171
  %173 = load ptr, ptr %ssl.addr, align 8
  %minor_ver176 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %173, i32 0, i32 5
  %174 = load i32, ptr %minor_ver176, align 8
  %cmp177 = icmp eq i32 %174, 1
  br i1 %cmp177, label %if.then179, label %if.else180

if.then179:                                       ; preds = %lor.lhs.false175, %if.end171
  br label %if.end194

if.else180:                                       ; preds = %lor.lhs.false175
  %175 = load ptr, ptr %ssl.addr, align 8
  %minor_ver181 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %175, i32 0, i32 5
  %176 = load i32, ptr %minor_ver181, align 8
  %cmp182 = icmp eq i32 %176, 2
  br i1 %cmp182, label %if.then188, label %lor.lhs.false184

lor.lhs.false184:                                 ; preds = %if.else180
  %177 = load ptr, ptr %ssl.addr, align 8
  %minor_ver185 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %177, i32 0, i32 5
  %178 = load i32, ptr %minor_ver185, align 8
  %cmp186 = icmp eq i32 %178, 3
  br i1 %cmp186, label %if.then188, label %if.else192

if.then188:                                       ; preds = %lor.lhs.false184, %if.else180
  %179 = load ptr, ptr %transform, align 8
  %ivlen189 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %179, i32 0, i32 3
  %180 = load i64, ptr %ivlen189, align 8
  %181 = load ptr, ptr %transform, align 8
  %minlen190 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %181, i32 0, i32 2
  %182 = load i64, ptr %minlen190, align 8
  %add191 = add i64 %182, %180
  store i64 %add191, ptr %minlen190, align 8
  br label %if.end193

if.else192:                                       ; preds = %lor.lhs.false184
  %183 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %183, i32 noundef 1, ptr noundef @.str, i32 noundef 913, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end193:                                        ; preds = %if.then188
  br label %if.end194

if.end194:                                        ; preds = %if.end193, %if.then179
  br label %if.end195

if.end195:                                        ; preds = %if.end194, %if.then150
  br label %if.end196

if.end196:                                        ; preds = %if.end195, %if.end122
  %184 = load ptr, ptr %ssl.addr, align 8
  %185 = load ptr, ptr %transform, align 8
  %keylen197 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %185, i32 0, i32 1
  %186 = load i32, ptr %keylen197, align 8
  %187 = load ptr, ptr %transform, align 8
  %minlen198 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %187, i32 0, i32 2
  %188 = load i64, ptr %minlen198, align 8
  %189 = load ptr, ptr %transform, align 8
  %ivlen199 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %189, i32 0, i32 3
  %190 = load i64, ptr %ivlen199, align 8
  %191 = load ptr, ptr %transform, align 8
  %maclen200 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %191, i32 0, i32 5
  %192 = load i64, ptr %maclen200, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %184, i32 noundef 3, ptr noundef @.str, i32 noundef 921, ptr noundef @.str.17, i32 noundef %186, i64 noundef %188, i64 noundef %190, i64 noundef %192)
  %193 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %193, i32 0, i32 0
  %194 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %194, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp201 = icmp eq i32 %bf.clear, 0
  br i1 %cmp201, label %if.then203, label %if.else228

if.then203:                                       ; preds = %if.end196
  %arraydecay204 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %195 = load i64, ptr %mac_key_len, align 8
  %mul = mul i64 %195, 2
  %add.ptr205 = getelementptr inbounds i8, ptr %arraydecay204, i64 %mul
  store ptr %add.ptr205, ptr %key1, align 8
  %arraydecay206 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %196 = load i64, ptr %mac_key_len, align 8
  %mul207 = mul i64 %196, 2
  %add.ptr208 = getelementptr inbounds i8, ptr %arraydecay206, i64 %mul207
  %197 = load ptr, ptr %transform, align 8
  %keylen209 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %197, i32 0, i32 1
  %198 = load i32, ptr %keylen209, align 8
  %idx.ext = zext i32 %198 to i64
  %add.ptr210 = getelementptr inbounds i8, ptr %add.ptr208, i64 %idx.ext
  store ptr %add.ptr210, ptr %key2, align 8
  %arraydecay211 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  store ptr %arraydecay211, ptr %mac_enc, align 8
  %arraydecay212 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %199 = load i64, ptr %mac_key_len, align 8
  %add.ptr213 = getelementptr inbounds i8, ptr %arraydecay212, i64 %199
  store ptr %add.ptr213, ptr %mac_dec, align 8
  %200 = load ptr, ptr %transform, align 8
  %fixed_ivlen214 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %200, i32 0, i32 4
  %201 = load i64, ptr %fixed_ivlen214, align 8
  %tobool215 = icmp ne i64 %201, 0
  br i1 %tobool215, label %cond.true, label %cond.false

cond.true:                                        ; preds = %if.then203
  %202 = load ptr, ptr %transform, align 8
  %fixed_ivlen216 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %202, i32 0, i32 4
  %203 = load i64, ptr %fixed_ivlen216, align 8
  br label %cond.end

cond.false:                                       ; preds = %if.then203
  %204 = load ptr, ptr %transform, align 8
  %ivlen217 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %204, i32 0, i32 3
  %205 = load i64, ptr %ivlen217, align 8
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond218 = phi i64 [ %203, %cond.true ], [ %205, %cond.false ]
  store i64 %cond218, ptr %iv_copy_len, align 8
  %206 = load ptr, ptr %transform, align 8
  %iv_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %206, i32 0, i32 6
  %arraydecay219 = getelementptr inbounds [16 x i8], ptr %iv_enc, i64 0, i64 0
  %207 = load ptr, ptr %key2, align 8
  %208 = load ptr, ptr %transform, align 8
  %keylen220 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %208, i32 0, i32 1
  %209 = load i32, ptr %keylen220, align 8
  %idx.ext221 = zext i32 %209 to i64
  %add.ptr222 = getelementptr inbounds i8, ptr %207, i64 %idx.ext221
  %210 = load i64, ptr %iv_copy_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay219, ptr align 1 %add.ptr222, i64 %210, i1 false)
  %211 = load ptr, ptr %transform, align 8
  %iv_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %211, i32 0, i32 7
  %arraydecay223 = getelementptr inbounds [16 x i8], ptr %iv_dec, i64 0, i64 0
  %212 = load ptr, ptr %key2, align 8
  %213 = load ptr, ptr %transform, align 8
  %keylen224 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %213, i32 0, i32 1
  %214 = load i32, ptr %keylen224, align 8
  %idx.ext225 = zext i32 %214 to i64
  %add.ptr226 = getelementptr inbounds i8, ptr %212, i64 %idx.ext225
  %215 = load i64, ptr %iv_copy_len, align 8
  %add.ptr227 = getelementptr inbounds i8, ptr %add.ptr226, i64 %215
  %216 = load i64, ptr %iv_copy_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay223, ptr align 1 %add.ptr227, i64 %216, i1 false)
  br label %if.end269

if.else228:                                       ; preds = %if.end196
  %217 = load ptr, ptr %ssl.addr, align 8
  %conf229 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %217, i32 0, i32 0
  %218 = load ptr, ptr %conf229, align 8
  %endpoint230 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %218, i32 0, i32 46
  %bf.load231 = load i32, ptr %endpoint230, align 4
  %bf.clear232 = and i32 %bf.load231, 1
  %cmp233 = icmp eq i32 %bf.clear232, 1
  br i1 %cmp233, label %if.then235, label %if.else267

if.then235:                                       ; preds = %if.else228
  %arraydecay236 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %219 = load i64, ptr %mac_key_len, align 8
  %mul237 = mul i64 %219, 2
  %add.ptr238 = getelementptr inbounds i8, ptr %arraydecay236, i64 %mul237
  %220 = load ptr, ptr %transform, align 8
  %keylen239 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %220, i32 0, i32 1
  %221 = load i32, ptr %keylen239, align 8
  %idx.ext240 = zext i32 %221 to i64
  %add.ptr241 = getelementptr inbounds i8, ptr %add.ptr238, i64 %idx.ext240
  store ptr %add.ptr241, ptr %key1, align 8
  %arraydecay242 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %222 = load i64, ptr %mac_key_len, align 8
  %mul243 = mul i64 %222, 2
  %add.ptr244 = getelementptr inbounds i8, ptr %arraydecay242, i64 %mul243
  store ptr %add.ptr244, ptr %key2, align 8
  %arraydecay245 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %223 = load i64, ptr %mac_key_len, align 8
  %add.ptr246 = getelementptr inbounds i8, ptr %arraydecay245, i64 %223
  store ptr %add.ptr246, ptr %mac_enc, align 8
  %arraydecay247 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  store ptr %arraydecay247, ptr %mac_dec, align 8
  %224 = load ptr, ptr %transform, align 8
  %fixed_ivlen248 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %224, i32 0, i32 4
  %225 = load i64, ptr %fixed_ivlen248, align 8
  %tobool249 = icmp ne i64 %225, 0
  br i1 %tobool249, label %cond.true250, label %cond.false252

cond.true250:                                     ; preds = %if.then235
  %226 = load ptr, ptr %transform, align 8
  %fixed_ivlen251 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %226, i32 0, i32 4
  %227 = load i64, ptr %fixed_ivlen251, align 8
  br label %cond.end254

cond.false252:                                    ; preds = %if.then235
  %228 = load ptr, ptr %transform, align 8
  %ivlen253 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %228, i32 0, i32 3
  %229 = load i64, ptr %ivlen253, align 8
  br label %cond.end254

cond.end254:                                      ; preds = %cond.false252, %cond.true250
  %cond255 = phi i64 [ %227, %cond.true250 ], [ %229, %cond.false252 ]
  store i64 %cond255, ptr %iv_copy_len, align 8
  %230 = load ptr, ptr %transform, align 8
  %iv_dec256 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %230, i32 0, i32 7
  %arraydecay257 = getelementptr inbounds [16 x i8], ptr %iv_dec256, i64 0, i64 0
  %231 = load ptr, ptr %key1, align 8
  %232 = load ptr, ptr %transform, align 8
  %keylen258 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %232, i32 0, i32 1
  %233 = load i32, ptr %keylen258, align 8
  %idx.ext259 = zext i32 %233 to i64
  %add.ptr260 = getelementptr inbounds i8, ptr %231, i64 %idx.ext259
  %234 = load i64, ptr %iv_copy_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay257, ptr align 1 %add.ptr260, i64 %234, i1 false)
  %235 = load ptr, ptr %transform, align 8
  %iv_enc261 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %235, i32 0, i32 6
  %arraydecay262 = getelementptr inbounds [16 x i8], ptr %iv_enc261, i64 0, i64 0
  %236 = load ptr, ptr %key1, align 8
  %237 = load ptr, ptr %transform, align 8
  %keylen263 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %237, i32 0, i32 1
  %238 = load i32, ptr %keylen263, align 8
  %idx.ext264 = zext i32 %238 to i64
  %add.ptr265 = getelementptr inbounds i8, ptr %236, i64 %idx.ext264
  %239 = load i64, ptr %iv_copy_len, align 8
  %add.ptr266 = getelementptr inbounds i8, ptr %add.ptr265, i64 %239
  %240 = load i64, ptr %iv_copy_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay262, ptr align 1 %add.ptr266, i64 %240, i1 false)
  br label %if.end268

if.else267:                                       ; preds = %if.else228
  %241 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %241, i32 noundef 1, ptr noundef @.str, i32 noundef 967, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end268:                                        ; preds = %cond.end254
  br label %if.end269

if.end269:                                        ; preds = %if.end268, %cond.end
  %242 = load ptr, ptr %ssl.addr, align 8
  %minor_ver270 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %242, i32 0, i32 5
  %243 = load i32, ptr %minor_ver270, align 8
  %cmp271 = icmp sge i32 %243, 1
  br i1 %cmp271, label %if.then273, label %if.else282

if.then273:                                       ; preds = %if.end269
  %244 = load i64, ptr %mac_key_len, align 8
  %cmp274 = icmp ne i64 %244, 0
  br i1 %cmp274, label %if.then276, label %if.end281

if.then276:                                       ; preds = %if.then273
  %245 = load ptr, ptr %transform, align 8
  %md_ctx_enc277 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %245, i32 0, i32 8
  %246 = load ptr, ptr %mac_enc, align 8
  %247 = load i64, ptr %mac_key_len, align 8
  %call278 = call i32 @mbedtls_md_hmac_starts(ptr noundef %md_ctx_enc277, ptr noundef %246, i64 noundef %247)
  %248 = load ptr, ptr %transform, align 8
  %md_ctx_dec279 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %248, i32 0, i32 9
  %249 = load ptr, ptr %mac_dec, align 8
  %250 = load i64, ptr %mac_key_len, align 8
  %call280 = call i32 @mbedtls_md_hmac_starts(ptr noundef %md_ctx_dec279, ptr noundef %249, i64 noundef %250)
  br label %if.end281

if.end281:                                        ; preds = %if.then276, %if.then273
  br label %if.end283

if.else282:                                       ; preds = %if.end269
  %251 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %251, i32 noundef 1, ptr noundef @.str, i32 noundef 1000, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end283:                                        ; preds = %if.end281
  %252 = load ptr, ptr %ssl.addr, align 8
  %conf284 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %252, i32 0, i32 0
  %253 = load ptr, ptr %conf284, align 8
  %f_export_keys = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %253, i32 0, i32 20
  %254 = load ptr, ptr %f_export_keys, align 8
  %cmp285 = icmp ne ptr %254, null
  br i1 %cmp285, label %if.then287, label %if.end297

if.then287:                                       ; preds = %if.end283
  %255 = load ptr, ptr %ssl.addr, align 8
  %conf288 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %255, i32 0, i32 0
  %256 = load ptr, ptr %conf288, align 8
  %f_export_keys289 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %256, i32 0, i32 20
  %257 = load ptr, ptr %f_export_keys289, align 8
  %258 = load ptr, ptr %ssl.addr, align 8
  %conf290 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %258, i32 0, i32 0
  %259 = load ptr, ptr %conf290, align 8
  %p_export_keys = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %259, i32 0, i32 21
  %260 = load ptr, ptr %p_export_keys, align 8
  %261 = load ptr, ptr %session, align 8
  %master291 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %261, i32 0, i32 5
  %arraydecay292 = getelementptr inbounds [48 x i8], ptr %master291, i64 0, i64 0
  %arraydecay293 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  %262 = load i64, ptr %mac_key_len, align 8
  %263 = load ptr, ptr %transform, align 8
  %keylen294 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %263, i32 0, i32 1
  %264 = load i32, ptr %keylen294, align 8
  %conv295 = zext i32 %264 to i64
  %265 = load i64, ptr %iv_copy_len, align 8
  %call296 = call i32 %257(ptr noundef %260, ptr noundef %arraydecay292, ptr noundef %arraydecay293, i64 noundef %262, i64 noundef %conv295, i64 noundef %265)
  br label %if.end297

if.end297:                                        ; preds = %if.then287, %if.end283
  %266 = load ptr, ptr %transform, align 8
  %cipher_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %266, i32 0, i32 10
  %267 = load ptr, ptr %cipher_info, align 8
  %call298 = call i32 @mbedtls_cipher_setup(ptr noundef %cipher_ctx_enc, ptr noundef %267)
  store i32 %call298, ptr %ret, align 4
  %cmp299 = icmp ne i32 %call298, 0
  br i1 %cmp299, label %if.then301, label %if.end302

if.then301:                                       ; preds = %if.end297
  %268 = load ptr, ptr %ssl.addr, align 8
  %269 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %268, i32 noundef 1, ptr noundef @.str, i32 noundef 1036, ptr noundef @.str.18, i32 noundef %269)
  %270 = load i32, ptr %ret, align 4
  store i32 %270, ptr %retval, align 4
  br label %return

if.end302:                                        ; preds = %if.end297
  %271 = load ptr, ptr %transform, align 8
  %cipher_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %271, i32 0, i32 11
  %272 = load ptr, ptr %cipher_info, align 8
  %call303 = call i32 @mbedtls_cipher_setup(ptr noundef %cipher_ctx_dec, ptr noundef %272)
  store i32 %call303, ptr %ret, align 4
  %cmp304 = icmp ne i32 %call303, 0
  br i1 %cmp304, label %if.then306, label %if.end307

if.then306:                                       ; preds = %if.end302
  %273 = load ptr, ptr %ssl.addr, align 8
  %274 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %273, i32 noundef 1, ptr noundef @.str, i32 noundef 1043, ptr noundef @.str.18, i32 noundef %274)
  %275 = load i32, ptr %ret, align 4
  store i32 %275, ptr %retval, align 4
  br label %return

if.end307:                                        ; preds = %if.end302
  %276 = load ptr, ptr %transform, align 8
  %cipher_ctx_enc308 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %276, i32 0, i32 10
  %277 = load ptr, ptr %key1, align 8
  %278 = load ptr, ptr %cipher_info, align 8
  %key_bitlen309 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %278, i32 0, i32 2
  %279 = load i32, ptr %key_bitlen309, align 8
  %call310 = call i32 @mbedtls_cipher_setkey(ptr noundef %cipher_ctx_enc308, ptr noundef %277, i32 noundef %279, i32 noundef 1)
  store i32 %call310, ptr %ret, align 4
  %cmp311 = icmp ne i32 %call310, 0
  br i1 %cmp311, label %if.then313, label %if.end314

if.then313:                                       ; preds = %if.end307
  %280 = load ptr, ptr %ssl.addr, align 8
  %281 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %280, i32 noundef 1, ptr noundef @.str, i32 noundef 1051, ptr noundef @.str.19, i32 noundef %281)
  %282 = load i32, ptr %ret, align 4
  store i32 %282, ptr %retval, align 4
  br label %return

if.end314:                                        ; preds = %if.end307
  %283 = load ptr, ptr %transform, align 8
  %cipher_ctx_dec315 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %283, i32 0, i32 11
  %284 = load ptr, ptr %key2, align 8
  %285 = load ptr, ptr %cipher_info, align 8
  %key_bitlen316 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %285, i32 0, i32 2
  %286 = load i32, ptr %key_bitlen316, align 8
  %call317 = call i32 @mbedtls_cipher_setkey(ptr noundef %cipher_ctx_dec315, ptr noundef %284, i32 noundef %286, i32 noundef 0)
  store i32 %call317, ptr %ret, align 4
  %cmp318 = icmp ne i32 %call317, 0
  br i1 %cmp318, label %if.then320, label %if.end321

if.then320:                                       ; preds = %if.end314
  %287 = load ptr, ptr %ssl.addr, align 8
  %288 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %287, i32 noundef 1, ptr noundef @.str, i32 noundef 1059, ptr noundef @.str.19, i32 noundef %288)
  %289 = load i32, ptr %ret, align 4
  store i32 %289, ptr %retval, align 4
  br label %return

if.end321:                                        ; preds = %if.end314
  %290 = load ptr, ptr %cipher_info, align 8
  %mode322 = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %290, i32 0, i32 1
  %291 = load i32, ptr %mode322, align 4
  %cmp323 = icmp eq i32 %291, 2
  br i1 %cmp323, label %if.then325, label %if.end338

if.then325:                                       ; preds = %if.end321
  %292 = load ptr, ptr %transform, align 8
  %cipher_ctx_enc326 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %292, i32 0, i32 10
  %call327 = call i32 @mbedtls_cipher_set_padding_mode(ptr noundef %cipher_ctx_enc326, i32 noundef 4)
  store i32 %call327, ptr %ret, align 4
  %cmp328 = icmp ne i32 %call327, 0
  br i1 %cmp328, label %if.then330, label %if.end331

if.then330:                                       ; preds = %if.then325
  %293 = load ptr, ptr %ssl.addr, align 8
  %294 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %293, i32 noundef 1, ptr noundef @.str, i32 noundef 1069, ptr noundef @.str.20, i32 noundef %294)
  %295 = load i32, ptr %ret, align 4
  store i32 %295, ptr %retval, align 4
  br label %return

if.end331:                                        ; preds = %if.then325
  %296 = load ptr, ptr %transform, align 8
  %cipher_ctx_dec332 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %296, i32 0, i32 11
  %call333 = call i32 @mbedtls_cipher_set_padding_mode(ptr noundef %cipher_ctx_dec332, i32 noundef 4)
  store i32 %call333, ptr %ret, align 4
  %cmp334 = icmp ne i32 %call333, 0
  br i1 %cmp334, label %if.then336, label %if.end337

if.then336:                                       ; preds = %if.end331
  %297 = load ptr, ptr %ssl.addr, align 8
  %298 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %297, i32 noundef 1, ptr noundef @.str, i32 noundef 1076, ptr noundef @.str.20, i32 noundef %298)
  %299 = load i32, ptr %ret, align 4
  store i32 %299, ptr %retval, align 4
  br label %return

if.end337:                                        ; preds = %if.end331
  br label %if.end338

if.end338:                                        ; preds = %if.end337, %if.end321
  %arraydecay339 = getelementptr inbounds [256 x i8], ptr %keyblk, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay339, i64 noundef 256)
  %300 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %300, i32 noundef 2, ptr noundef @.str, i32 noundef 1116, ptr noundef @.str.21)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end338, %if.then336, %if.then330, %if.then320, %if.then313, %if.then306, %if.then301, %if.else282, %if.else267, %if.else192, %if.then135, %if.then100, %if.then75, %if.then62, %if.else29, %if.then7, %if.then
  %301 = load i32, ptr %retval, align 4
  ret i32 %301
}

declare void @mbedtls_debug_print_msg(ptr noundef, i32 noundef, ptr noundef, i32 noundef, ptr noundef, ...) #1

declare ptr @mbedtls_cipher_info_from_type(i32 noundef) #1

declare ptr @mbedtls_md_info_from_type(i32 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @tls1_prf(ptr noundef %secret, i64 noundef %slen, ptr noundef %label, ptr noundef %random, i64 noundef %rlen, ptr noundef %dstbuf, i64 noundef %dlen) #0 {
entry:
  %retval = alloca i32, align 4
  %secret.addr = alloca ptr, align 8
  %slen.addr = alloca i64, align 8
  %label.addr = alloca ptr, align 8
  %random.addr = alloca ptr, align 8
  %rlen.addr = alloca i64, align 8
  %dstbuf.addr = alloca ptr, align 8
  %dlen.addr = alloca i64, align 8
  %nb = alloca i64, align 8
  %hs = alloca i64, align 8
  %i = alloca i64, align 8
  %j = alloca i64, align 8
  %k = alloca i64, align 8
  %S1 = alloca ptr, align 8
  %S2 = alloca ptr, align 8
  %tmp = alloca [128 x i8], align 16
  %h_i = alloca [20 x i8], align 16
  %md_info = alloca ptr, align 8
  %md_ctx = alloca %struct.mbedtls_md_context_t, align 8
  %ret = alloca i32, align 4
  store ptr %secret, ptr %secret.addr, align 8
  store i64 %slen, ptr %slen.addr, align 8
  store ptr %label, ptr %label.addr, align 8
  store ptr %random, ptr %random.addr, align 8
  store i64 %rlen, ptr %rlen.addr, align 8
  store ptr %dstbuf, ptr %dstbuf.addr, align 8
  store i64 %dlen, ptr %dlen.addr, align 8
  call void @mbedtls_md_init(ptr noundef %md_ctx)
  %0 = load ptr, ptr %label.addr, align 8
  %call = call i64 @strlen(ptr noundef %0) #7
  %add = add i64 20, %call
  %1 = load i64, ptr %rlen.addr, align 8
  %add1 = add i64 %add, %1
  %cmp = icmp ult i64 128, %add1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %2 = load i64, ptr %slen.addr, align 8
  %add2 = add i64 %2, 1
  %div = udiv i64 %add2, 2
  store i64 %div, ptr %hs, align 8
  %3 = load ptr, ptr %secret.addr, align 8
  store ptr %3, ptr %S1, align 8
  %4 = load ptr, ptr %secret.addr, align 8
  %5 = load i64, ptr %slen.addr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %4, i64 %5
  %6 = load i64, ptr %hs, align 8
  %idx.neg = sub i64 0, %6
  %add.ptr3 = getelementptr inbounds i8, ptr %add.ptr, i64 %idx.neg
  store ptr %add.ptr3, ptr %S2, align 8
  %7 = load ptr, ptr %label.addr, align 8
  %call4 = call i64 @strlen(ptr noundef %7) #7
  store i64 %call4, ptr %nb, align 8
  %arraydecay = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr5 = getelementptr inbounds i8, ptr %arraydecay, i64 20
  %8 = load ptr, ptr %label.addr, align 8
  %9 = load i64, ptr %nb, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr5, ptr align 1 %8, i64 %9, i1 false)
  %arraydecay6 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr7 = getelementptr inbounds i8, ptr %arraydecay6, i64 20
  %10 = load i64, ptr %nb, align 8
  %add.ptr8 = getelementptr inbounds i8, ptr %add.ptr7, i64 %10
  %11 = load ptr, ptr %random.addr, align 8
  %12 = load i64, ptr %rlen.addr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr8, ptr align 1 %11, i64 %12, i1 false)
  %13 = load i64, ptr %rlen.addr, align 8
  %14 = load i64, ptr %nb, align 8
  %add9 = add i64 %14, %13
  store i64 %add9, ptr %nb, align 8
  %call10 = call ptr @mbedtls_md_info_from_type(i32 noundef 3)
  store ptr %call10, ptr %md_info, align 8
  %cmp11 = icmp eq ptr %call10, null
  br i1 %cmp11, label %if.then12, label %if.end13

if.then12:                                        ; preds = %if.end
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %if.end
  %15 = load ptr, ptr %md_info, align 8
  %call14 = call i32 @mbedtls_md_setup(ptr noundef %md_ctx, ptr noundef %15, i32 noundef 1)
  store i32 %call14, ptr %ret, align 4
  %cmp15 = icmp ne i32 %call14, 0
  br i1 %cmp15, label %if.then16, label %if.end17

if.then16:                                        ; preds = %if.end13
  %16 = load i32, ptr %ret, align 4
  store i32 %16, ptr %retval, align 4
  br label %return

if.end17:                                         ; preds = %if.end13
  %17 = load ptr, ptr %S1, align 8
  %18 = load i64, ptr %hs, align 8
  %call18 = call i32 @mbedtls_md_hmac_starts(ptr noundef %md_ctx, ptr noundef %17, i64 noundef %18)
  %arraydecay19 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr20 = getelementptr inbounds i8, ptr %arraydecay19, i64 20
  %19 = load i64, ptr %nb, align 8
  %call21 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %add.ptr20, i64 noundef %19)
  %arraydecay22 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr23 = getelementptr inbounds i8, ptr %arraydecay22, i64 4
  %call24 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %add.ptr23)
  store i64 0, ptr %i, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc47, %if.end17
  %20 = load i64, ptr %i, align 8
  %21 = load i64, ptr %dlen.addr, align 8
  %cmp25 = icmp ult i64 %20, %21
  br i1 %cmp25, label %for.body, label %for.end49

for.body:                                         ; preds = %for.cond
  %call26 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx)
  %arraydecay27 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr28 = getelementptr inbounds i8, ptr %arraydecay27, i64 4
  %22 = load i64, ptr %nb, align 8
  %add29 = add i64 16, %22
  %call30 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %add.ptr28, i64 noundef %add29)
  %arraydecay31 = getelementptr inbounds [20 x i8], ptr %h_i, i64 0, i64 0
  %call32 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %arraydecay31)
  %call33 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx)
  %arraydecay34 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr35 = getelementptr inbounds i8, ptr %arraydecay34, i64 4
  %call36 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %add.ptr35, i64 noundef 16)
  %arraydecay37 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr38 = getelementptr inbounds i8, ptr %arraydecay37, i64 4
  %call39 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %add.ptr38)
  %23 = load i64, ptr %i, align 8
  %add40 = add i64 %23, 16
  %24 = load i64, ptr %dlen.addr, align 8
  %cmp41 = icmp ugt i64 %add40, %24
  br i1 %cmp41, label %cond.true, label %cond.false

cond.true:                                        ; preds = %for.body
  %25 = load i64, ptr %dlen.addr, align 8
  %rem = urem i64 %25, 16
  br label %cond.end

cond.false:                                       ; preds = %for.body
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond = phi i64 [ %rem, %cond.true ], [ 16, %cond.false ]
  store i64 %cond, ptr %k, align 8
  store i64 0, ptr %j, align 8
  br label %for.cond42

for.cond42:                                       ; preds = %for.inc, %cond.end
  %26 = load i64, ptr %j, align 8
  %27 = load i64, ptr %k, align 8
  %cmp43 = icmp ult i64 %26, %27
  br i1 %cmp43, label %for.body44, label %for.end

for.body44:                                       ; preds = %for.cond42
  %28 = load i64, ptr %j, align 8
  %arrayidx = getelementptr inbounds [20 x i8], ptr %h_i, i64 0, i64 %28
  %29 = load i8, ptr %arrayidx, align 1
  %30 = load ptr, ptr %dstbuf.addr, align 8
  %31 = load i64, ptr %i, align 8
  %32 = load i64, ptr %j, align 8
  %add45 = add i64 %31, %32
  %arrayidx46 = getelementptr inbounds i8, ptr %30, i64 %add45
  store i8 %29, ptr %arrayidx46, align 1
  br label %for.inc

for.inc:                                          ; preds = %for.body44
  %33 = load i64, ptr %j, align 8
  %inc = add i64 %33, 1
  store i64 %inc, ptr %j, align 8
  br label %for.cond42, !llvm.loop !5

for.end:                                          ; preds = %for.cond42
  br label %for.inc47

for.inc47:                                        ; preds = %for.end
  %34 = load i64, ptr %i, align 8
  %add48 = add i64 %34, 16
  store i64 %add48, ptr %i, align 8
  br label %for.cond, !llvm.loop !7

for.end49:                                        ; preds = %for.cond
  call void @mbedtls_md_free(ptr noundef %md_ctx)
  %call50 = call ptr @mbedtls_md_info_from_type(i32 noundef 4)
  store ptr %call50, ptr %md_info, align 8
  %cmp51 = icmp eq ptr %call50, null
  br i1 %cmp51, label %if.then52, label %if.end53

if.then52:                                        ; preds = %for.end49
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end53:                                         ; preds = %for.end49
  %35 = load ptr, ptr %md_info, align 8
  %call54 = call i32 @mbedtls_md_setup(ptr noundef %md_ctx, ptr noundef %35, i32 noundef 1)
  store i32 %call54, ptr %ret, align 4
  %cmp55 = icmp ne i32 %call54, 0
  br i1 %cmp55, label %if.then56, label %if.end57

if.then56:                                        ; preds = %if.end53
  %36 = load i32, ptr %ret, align 4
  store i32 %36, ptr %retval, align 4
  br label %return

if.end57:                                         ; preds = %if.end53
  %37 = load ptr, ptr %S2, align 8
  %38 = load i64, ptr %hs, align 8
  %call58 = call i32 @mbedtls_md_hmac_starts(ptr noundef %md_ctx, ptr noundef %37, i64 noundef %38)
  %arraydecay59 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %add.ptr60 = getelementptr inbounds i8, ptr %arraydecay59, i64 20
  %39 = load i64, ptr %nb, align 8
  %call61 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %add.ptr60, i64 noundef %39)
  %arraydecay62 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %call63 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %arraydecay62)
  store i64 0, ptr %i, align 8
  br label %for.cond64

for.cond64:                                       ; preds = %for.inc98, %if.end57
  %40 = load i64, ptr %i, align 8
  %41 = load i64, ptr %dlen.addr, align 8
  %cmp65 = icmp ult i64 %40, %41
  br i1 %cmp65, label %for.body66, label %for.end100

for.body66:                                       ; preds = %for.cond64
  %call67 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx)
  %arraydecay68 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %42 = load i64, ptr %nb, align 8
  %add69 = add i64 20, %42
  %call70 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %arraydecay68, i64 noundef %add69)
  %arraydecay71 = getelementptr inbounds [20 x i8], ptr %h_i, i64 0, i64 0
  %call72 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %arraydecay71)
  %call73 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx)
  %arraydecay74 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %call75 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %arraydecay74, i64 noundef 20)
  %arraydecay76 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %call77 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %arraydecay76)
  %43 = load i64, ptr %i, align 8
  %add78 = add i64 %43, 20
  %44 = load i64, ptr %dlen.addr, align 8
  %cmp79 = icmp ugt i64 %add78, %44
  br i1 %cmp79, label %cond.true80, label %cond.false82

cond.true80:                                      ; preds = %for.body66
  %45 = load i64, ptr %dlen.addr, align 8
  %rem81 = urem i64 %45, 20
  br label %cond.end83

cond.false82:                                     ; preds = %for.body66
  br label %cond.end83

cond.end83:                                       ; preds = %cond.false82, %cond.true80
  %cond84 = phi i64 [ %rem81, %cond.true80 ], [ 20, %cond.false82 ]
  store i64 %cond84, ptr %k, align 8
  store i64 0, ptr %j, align 8
  br label %for.cond85

for.cond85:                                       ; preds = %for.inc95, %cond.end83
  %46 = load i64, ptr %j, align 8
  %47 = load i64, ptr %k, align 8
  %cmp86 = icmp ult i64 %46, %47
  br i1 %cmp86, label %for.body87, label %for.end97

for.body87:                                       ; preds = %for.cond85
  %48 = load ptr, ptr %dstbuf.addr, align 8
  %49 = load i64, ptr %i, align 8
  %50 = load i64, ptr %j, align 8
  %add88 = add i64 %49, %50
  %arrayidx89 = getelementptr inbounds i8, ptr %48, i64 %add88
  %51 = load i8, ptr %arrayidx89, align 1
  %conv = zext i8 %51 to i32
  %52 = load i64, ptr %j, align 8
  %arrayidx90 = getelementptr inbounds [20 x i8], ptr %h_i, i64 0, i64 %52
  %53 = load i8, ptr %arrayidx90, align 1
  %conv91 = zext i8 %53 to i32
  %xor = xor i32 %conv, %conv91
  %conv92 = trunc i32 %xor to i8
  %54 = load ptr, ptr %dstbuf.addr, align 8
  %55 = load i64, ptr %i, align 8
  %56 = load i64, ptr %j, align 8
  %add93 = add i64 %55, %56
  %arrayidx94 = getelementptr inbounds i8, ptr %54, i64 %add93
  store i8 %conv92, ptr %arrayidx94, align 1
  br label %for.inc95

for.inc95:                                        ; preds = %for.body87
  %57 = load i64, ptr %j, align 8
  %inc96 = add i64 %57, 1
  store i64 %inc96, ptr %j, align 8
  br label %for.cond85, !llvm.loop !8

for.end97:                                        ; preds = %for.cond85
  br label %for.inc98

for.inc98:                                        ; preds = %for.end97
  %58 = load i64, ptr %i, align 8
  %add99 = add i64 %58, 20
  store i64 %add99, ptr %i, align 8
  br label %for.cond64, !llvm.loop !9

for.end100:                                       ; preds = %for.cond64
  call void @mbedtls_md_free(ptr noundef %md_ctx)
  %arraydecay101 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay101, i64 noundef 128)
  %arraydecay102 = getelementptr inbounds [20 x i8], ptr %h_i, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay102, i64 noundef 20)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %for.end100, %if.then56, %if.then52, %if.then16, %if.then12, %if.then
  %59 = load i32, ptr %retval, align 4
  ret i32 %59
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_calc_verify_tls(ptr noundef %ssl, ptr noundef %hash) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %hash.addr = alloca ptr, align 8
  %md5 = alloca %struct.mbedtls_md5_context, align 4
  %sha1 = alloca %struct.mbedtls_sha1_context, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %hash, ptr %hash.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 1176, ptr noundef @.str.176)
  call void @mbedtls_md5_init(ptr noundef %md5)
  call void @mbedtls_sha1_init(ptr noundef %sha1)
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %fin_md5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 25
  call void @mbedtls_md5_clone(ptr noundef %md5, ptr noundef %fin_md5)
  %3 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 15
  %4 = load ptr, ptr %handshake1, align 8
  %fin_sha1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 26
  call void @mbedtls_sha1_clone(ptr noundef %sha1, ptr noundef %fin_sha1)
  %5 = load ptr, ptr %hash.addr, align 8
  %call = call i32 @mbedtls_md5_finish_ret(ptr noundef %md5, ptr noundef %5)
  %6 = load ptr, ptr %hash.addr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %6, i64 16
  %call2 = call i32 @mbedtls_sha1_finish_ret(ptr noundef %sha1, ptr noundef %add.ptr)
  %7 = load ptr, ptr %ssl.addr, align 8
  %8 = load ptr, ptr %hash.addr, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %7, i32 noundef 3, ptr noundef @.str, i32 noundef 1187, ptr noundef @.str.177, ptr noundef %8, i64 noundef 36)
  %9 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %9, i32 noundef 2, ptr noundef @.str, i32 noundef 1188, ptr noundef @.str.178)
  call void @mbedtls_md5_free(ptr noundef %md5)
  call void @mbedtls_sha1_free(ptr noundef %sha1)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_calc_finished_tls(ptr noundef %ssl, ptr noundef %buf, i32 noundef %from) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %from.addr = alloca i32, align 4
  %len = alloca i32, align 4
  %sender = alloca ptr, align 8
  %md5 = alloca %struct.mbedtls_md5_context, align 4
  %sha1 = alloca %struct.mbedtls_sha1_context, align 4
  %padbuf = alloca [36 x i8], align 16
  %session = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i32 %from, ptr %from.addr, align 4
  store i32 12, ptr %len, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 14
  %1 = load ptr, ptr %session_negotiate, align 8
  store ptr %1, ptr %session, align 8
  %2 = load ptr, ptr %session, align 8
  %tobool = icmp ne ptr %2, null
  br i1 %tobool, label %if.end, label %if.then

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %session1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 13
  %4 = load ptr, ptr %session1, align 8
  store ptr %4, ptr %session, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 2, ptr noundef @.str, i32 noundef 6162, ptr noundef @.str.287)
  call void @mbedtls_md5_init(ptr noundef %md5)
  call void @mbedtls_sha1_init(ptr noundef %sha1)
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake, align 8
  %fin_md5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 25
  call void @mbedtls_md5_clone(ptr noundef %md5, ptr noundef %fin_md5)
  %8 = load ptr, ptr %ssl.addr, align 8
  %handshake2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 15
  %9 = load ptr, ptr %handshake2, align 8
  %fin_sha1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 26
  call void @mbedtls_sha1_clone(ptr noundef %sha1, ptr noundef %fin_sha1)
  %10 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_md5_context, ptr %md5, i32 0, i32 1
  %arraydecay = getelementptr inbounds [4 x i32], ptr %state, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %10, i32 noundef 4, ptr noundef @.str, i32 noundef 6178, ptr noundef @.str.288, ptr noundef %arraydecay, i64 noundef 16)
  %11 = load ptr, ptr %ssl.addr, align 8
  %state3 = getelementptr inbounds %struct.mbedtls_sha1_context, ptr %sha1, i32 0, i32 1
  %arraydecay4 = getelementptr inbounds [5 x i32], ptr %state3, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %11, i32 noundef 4, ptr noundef @.str, i32 noundef 6183, ptr noundef @.str.289, ptr noundef %arraydecay4, i64 noundef 20)
  %12 = load i32, ptr %from.addr, align 4
  %cmp = icmp eq i32 %12, 0
  %13 = zext i1 %cmp to i64
  %cond = select i1 %cmp, ptr @.str.290, ptr @.str.291
  store ptr %cond, ptr %sender, align 8
  %arraydecay5 = getelementptr inbounds [36 x i8], ptr %padbuf, i64 0, i64 0
  %call = call i32 @mbedtls_md5_finish_ret(ptr noundef %md5, ptr noundef %arraydecay5)
  %arraydecay6 = getelementptr inbounds [36 x i8], ptr %padbuf, i64 0, i64 0
  %add.ptr = getelementptr inbounds i8, ptr %arraydecay6, i64 16
  %call7 = call i32 @mbedtls_sha1_finish_ret(ptr noundef %sha1, ptr noundef %add.ptr)
  %14 = load ptr, ptr %ssl.addr, align 8
  %handshake8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 15
  %15 = load ptr, ptr %handshake8, align 8
  %tls_prf = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %15, i32 0, i32 32
  %16 = load ptr, ptr %tls_prf, align 8
  %17 = load ptr, ptr %session, align 8
  %master = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %17, i32 0, i32 5
  %arraydecay9 = getelementptr inbounds [48 x i8], ptr %master, i64 0, i64 0
  %18 = load ptr, ptr %sender, align 8
  %arraydecay10 = getelementptr inbounds [36 x i8], ptr %padbuf, i64 0, i64 0
  %19 = load ptr, ptr %buf.addr, align 8
  %20 = load i32, ptr %len, align 4
  %conv = sext i32 %20 to i64
  %call11 = call i32 %16(ptr noundef %arraydecay9, i64 noundef 48, ptr noundef %18, ptr noundef %arraydecay10, i64 noundef 36, ptr noundef %19, i64 noundef %conv)
  %21 = load ptr, ptr %ssl.addr, align 8
  %22 = load ptr, ptr %buf.addr, align 8
  %23 = load i32, ptr %len, align 4
  %conv12 = sext i32 %23 to i64
  call void @mbedtls_debug_print_buf(ptr noundef %21, i32 noundef 3, ptr noundef @.str, i32 noundef 6196, ptr noundef @.str.292, ptr noundef %22, i64 noundef %conv12)
  call void @mbedtls_md5_free(ptr noundef %md5)
  call void @mbedtls_sha1_free(ptr noundef %sha1)
  %arraydecay13 = getelementptr inbounds [36 x i8], ptr %padbuf, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay13, i64 noundef 36)
  %24 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %24, i32 noundef 2, ptr noundef @.str, i32 noundef 6203, ptr noundef @.str.293)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @tls_prf_sha384(ptr noundef %secret, i64 noundef %slen, ptr noundef %label, ptr noundef %random, i64 noundef %rlen, ptr noundef %dstbuf, i64 noundef %dlen) #0 {
entry:
  %secret.addr = alloca ptr, align 8
  %slen.addr = alloca i64, align 8
  %label.addr = alloca ptr, align 8
  %random.addr = alloca ptr, align 8
  %rlen.addr = alloca i64, align 8
  %dstbuf.addr = alloca ptr, align 8
  %dlen.addr = alloca i64, align 8
  store ptr %secret, ptr %secret.addr, align 8
  store i64 %slen, ptr %slen.addr, align 8
  store ptr %label, ptr %label.addr, align 8
  store ptr %random, ptr %random.addr, align 8
  store i64 %rlen, ptr %rlen.addr, align 8
  store ptr %dstbuf, ptr %dstbuf.addr, align 8
  store i64 %dlen, ptr %dlen.addr, align 8
  %0 = load ptr, ptr %secret.addr, align 8
  %1 = load i64, ptr %slen.addr, align 8
  %2 = load ptr, ptr %label.addr, align 8
  %3 = load ptr, ptr %random.addr, align 8
  %4 = load i64, ptr %rlen.addr, align 8
  %5 = load ptr, ptr %dstbuf.addr, align 8
  %6 = load i64, ptr %dlen.addr, align 8
  %call = call i32 @tls_prf_generic(i32 noundef 7, ptr noundef %0, i64 noundef %1, ptr noundef %2, ptr noundef %3, i64 noundef %4, ptr noundef %5, i64 noundef %6)
  ret i32 %call
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_calc_verify_tls_sha384(ptr noundef %ssl, ptr noundef %hash) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %hash.addr = alloca ptr, align 8
  %sha512 = alloca %struct.mbedtls_sha512_context, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %hash, ptr %hash.addr, align 8
  call void @mbedtls_sha512_init(ptr noundef %sha512)
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 1226, ptr noundef @.str.180)
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %fin_sha512 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 28
  call void @mbedtls_sha512_clone(ptr noundef %sha512, ptr noundef %fin_sha512)
  %3 = load ptr, ptr %hash.addr, align 8
  %call = call i32 @mbedtls_sha512_finish_ret(ptr noundef %sha512, ptr noundef %3)
  %4 = load ptr, ptr %ssl.addr, align 8
  %5 = load ptr, ptr %hash.addr, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %4, i32 noundef 3, ptr noundef @.str, i32 noundef 1231, ptr noundef @.str.177, ptr noundef %5, i64 noundef 48)
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 2, ptr noundef @.str, i32 noundef 1232, ptr noundef @.str.178)
  call void @mbedtls_sha512_free(ptr noundef %sha512)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_calc_finished_tls_sha384(ptr noundef %ssl, ptr noundef %buf, i32 noundef %from) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %from.addr = alloca i32, align 4
  %len = alloca i32, align 4
  %sender = alloca ptr, align 8
  %sha512 = alloca %struct.mbedtls_sha512_context, align 8
  %padbuf = alloca [48 x i8], align 16
  %session = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i32 %from, ptr %from.addr, align 4
  store i32 12, ptr %len, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 14
  %1 = load ptr, ptr %session_negotiate, align 8
  store ptr %1, ptr %session, align 8
  %2 = load ptr, ptr %session, align 8
  %tobool = icmp ne ptr %2, null
  br i1 %tobool, label %if.end, label %if.then

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %session1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 13
  %4 = load ptr, ptr %session1, align 8
  store ptr %4, ptr %session, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  call void @mbedtls_sha512_init(ptr noundef %sha512)
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 2, ptr noundef @.str, i32 noundef 6272, ptr noundef @.str.296)
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake, align 8
  %fin_sha512 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 28
  call void @mbedtls_sha512_clone(ptr noundef %sha512, ptr noundef %fin_sha512)
  %8 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_sha512_context, ptr %sha512, i32 0, i32 1
  %arraydecay = getelementptr inbounds [8 x i64], ptr %state, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %8, i32 noundef 4, ptr noundef @.str, i32 noundef 6284, ptr noundef @.str.297, ptr noundef %arraydecay, i64 noundef 64)
  %9 = load i32, ptr %from.addr, align 4
  %cmp = icmp eq i32 %9, 0
  %10 = zext i1 %cmp to i64
  %cond = select i1 %cmp, ptr @.str.290, ptr @.str.291
  store ptr %cond, ptr %sender, align 8
  %arraydecay2 = getelementptr inbounds [48 x i8], ptr %padbuf, i64 0, i64 0
  %call = call i32 @mbedtls_sha512_finish_ret(ptr noundef %sha512, ptr noundef %arraydecay2)
  %11 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 15
  %12 = load ptr, ptr %handshake3, align 8
  %tls_prf = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %12, i32 0, i32 32
  %13 = load ptr, ptr %tls_prf, align 8
  %14 = load ptr, ptr %session, align 8
  %master = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %14, i32 0, i32 5
  %arraydecay4 = getelementptr inbounds [48 x i8], ptr %master, i64 0, i64 0
  %15 = load ptr, ptr %sender, align 8
  %arraydecay5 = getelementptr inbounds [48 x i8], ptr %padbuf, i64 0, i64 0
  %16 = load ptr, ptr %buf.addr, align 8
  %17 = load i32, ptr %len, align 4
  %conv = sext i32 %17 to i64
  %call6 = call i32 %13(ptr noundef %arraydecay4, i64 noundef 48, ptr noundef %15, ptr noundef %arraydecay5, i64 noundef 48, ptr noundef %16, i64 noundef %conv)
  %18 = load ptr, ptr %ssl.addr, align 8
  %19 = load ptr, ptr %buf.addr, align 8
  %20 = load i32, ptr %len, align 4
  %conv7 = sext i32 %20 to i64
  call void @mbedtls_debug_print_buf(ptr noundef %18, i32 noundef 3, ptr noundef @.str, i32 noundef 6296, ptr noundef @.str.292, ptr noundef %19, i64 noundef %conv7)
  call void @mbedtls_sha512_free(ptr noundef %sha512)
  %arraydecay8 = getelementptr inbounds [48 x i8], ptr %padbuf, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay8, i64 noundef 48)
  %21 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %21, i32 noundef 2, ptr noundef @.str, i32 noundef 6302, ptr noundef @.str.293)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @tls_prf_sha256(ptr noundef %secret, i64 noundef %slen, ptr noundef %label, ptr noundef %random, i64 noundef %rlen, ptr noundef %dstbuf, i64 noundef %dlen) #0 {
entry:
  %secret.addr = alloca ptr, align 8
  %slen.addr = alloca i64, align 8
  %label.addr = alloca ptr, align 8
  %random.addr = alloca ptr, align 8
  %rlen.addr = alloca i64, align 8
  %dstbuf.addr = alloca ptr, align 8
  %dlen.addr = alloca i64, align 8
  store ptr %secret, ptr %secret.addr, align 8
  store i64 %slen, ptr %slen.addr, align 8
  store ptr %label, ptr %label.addr, align 8
  store ptr %random, ptr %random.addr, align 8
  store i64 %rlen, ptr %rlen.addr, align 8
  store ptr %dstbuf, ptr %dstbuf.addr, align 8
  store i64 %dlen, ptr %dlen.addr, align 8
  %0 = load ptr, ptr %secret.addr, align 8
  %1 = load i64, ptr %slen.addr, align 8
  %2 = load ptr, ptr %label.addr, align 8
  %3 = load ptr, ptr %random.addr, align 8
  %4 = load i64, ptr %rlen.addr, align 8
  %5 = load ptr, ptr %dstbuf.addr, align 8
  %6 = load i64, ptr %dlen.addr, align 8
  %call = call i32 @tls_prf_generic(i32 noundef 6, ptr noundef %0, i64 noundef %1, ptr noundef %2, ptr noundef %3, i64 noundef %4, ptr noundef %5, i64 noundef %6)
  ret i32 %call
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_calc_verify_tls_sha256(ptr noundef %ssl, ptr noundef %hash) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %hash.addr = alloca ptr, align 8
  %sha256 = alloca %struct.mbedtls_sha256_context, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %hash, ptr %hash.addr, align 8
  call void @mbedtls_sha256_init(ptr noundef %sha256)
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 1205, ptr noundef @.str.179)
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %fin_sha256 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 27
  call void @mbedtls_sha256_clone(ptr noundef %sha256, ptr noundef %fin_sha256)
  %3 = load ptr, ptr %hash.addr, align 8
  %call = call i32 @mbedtls_sha256_finish_ret(ptr noundef %sha256, ptr noundef %3)
  %4 = load ptr, ptr %ssl.addr, align 8
  %5 = load ptr, ptr %hash.addr, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %4, i32 noundef 3, ptr noundef @.str, i32 noundef 1210, ptr noundef @.str.177, ptr noundef %5, i64 noundef 32)
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 2, ptr noundef @.str, i32 noundef 1211, ptr noundef @.str.178)
  call void @mbedtls_sha256_free(ptr noundef %sha256)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_calc_finished_tls_sha256(ptr noundef %ssl, ptr noundef %buf, i32 noundef %from) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %from.addr = alloca i32, align 4
  %len = alloca i32, align 4
  %sender = alloca ptr, align 8
  %sha256 = alloca %struct.mbedtls_sha256_context, align 4
  %padbuf = alloca [32 x i8], align 16
  %session = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i32 %from, ptr %from.addr, align 4
  store i32 12, ptr %len, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 14
  %1 = load ptr, ptr %session_negotiate, align 8
  store ptr %1, ptr %session, align 8
  %2 = load ptr, ptr %session, align 8
  %tobool = icmp ne ptr %2, null
  br i1 %tobool, label %if.end, label %if.then

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %session1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 13
  %4 = load ptr, ptr %session1, align 8
  store ptr %4, ptr %session, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  call void @mbedtls_sha256_init(ptr noundef %sha256)
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 2, ptr noundef @.str, i32 noundef 6223, ptr noundef @.str.294)
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake, align 8
  %fin_sha256 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 27
  call void @mbedtls_sha256_clone(ptr noundef %sha256, ptr noundef %fin_sha256)
  %8 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_sha256_context, ptr %sha256, i32 0, i32 1
  %arraydecay = getelementptr inbounds [8 x i32], ptr %state, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %8, i32 noundef 4, ptr noundef @.str, i32 noundef 6235, ptr noundef @.str.295, ptr noundef %arraydecay, i64 noundef 32)
  %9 = load i32, ptr %from.addr, align 4
  %cmp = icmp eq i32 %9, 0
  %10 = zext i1 %cmp to i64
  %cond = select i1 %cmp, ptr @.str.290, ptr @.str.291
  store ptr %cond, ptr %sender, align 8
  %arraydecay2 = getelementptr inbounds [32 x i8], ptr %padbuf, i64 0, i64 0
  %call = call i32 @mbedtls_sha256_finish_ret(ptr noundef %sha256, ptr noundef %arraydecay2)
  %11 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 15
  %12 = load ptr, ptr %handshake3, align 8
  %tls_prf = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %12, i32 0, i32 32
  %13 = load ptr, ptr %tls_prf, align 8
  %14 = load ptr, ptr %session, align 8
  %master = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %14, i32 0, i32 5
  %arraydecay4 = getelementptr inbounds [48 x i8], ptr %master, i64 0, i64 0
  %15 = load ptr, ptr %sender, align 8
  %arraydecay5 = getelementptr inbounds [32 x i8], ptr %padbuf, i64 0, i64 0
  %16 = load ptr, ptr %buf.addr, align 8
  %17 = load i32, ptr %len, align 4
  %conv = sext i32 %17 to i64
  %call6 = call i32 %13(ptr noundef %arraydecay4, i64 noundef 48, ptr noundef %15, ptr noundef %arraydecay5, i64 noundef 32, ptr noundef %16, i64 noundef %conv)
  %18 = load ptr, ptr %ssl.addr, align 8
  %19 = load ptr, ptr %buf.addr, align 8
  %20 = load i32, ptr %len, align 4
  %conv7 = sext i32 %20 to i64
  call void @mbedtls_debug_print_buf(ptr noundef %18, i32 noundef 3, ptr noundef @.str, i32 noundef 6247, ptr noundef @.str.292, ptr noundef %19, i64 noundef %conv7)
  call void @mbedtls_sha256_free(ptr noundef %sha256)
  %arraydecay8 = getelementptr inbounds [32 x i8], ptr %padbuf, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay8, i64 noundef 32)
  %21 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %21, i32 noundef 2, ptr noundef @.str, i32 noundef 6253, ptr noundef @.str.293)
  ret void
}

declare void @mbedtls_debug_print_buf(ptr noundef, i32 noundef, ptr noundef, i32 noundef, ptr noundef, ptr noundef, i64 noundef) #1

declare void @mbedtls_debug_print_ret(ptr noundef, i32 noundef, ptr noundef, i32 noundef, ptr noundef, i32 noundef) #1

declare void @mbedtls_platform_zeroize(ptr noundef, i64 noundef) #1

; Function Attrs: nocallback nofree nounwind willreturn memory(argmem: readwrite)
declare void @llvm.memcpy.p0.p0.i64(ptr noalias nocapture writeonly, ptr noalias nocapture readonly, i64, i1 immarg) #2

declare ptr @mbedtls_ssl_get_ciphersuite_name(i32 noundef) #1

declare i32 @mbedtls_md_setup(ptr noundef, ptr noundef, i32 noundef) #1

declare zeroext i8 @mbedtls_md_get_size(ptr noundef) #1

declare i32 @mbedtls_md_hmac_starts(ptr noundef, ptr noundef, i64 noundef) #1

declare i32 @mbedtls_cipher_setup(ptr noundef, ptr noundef) #1

declare i32 @mbedtls_cipher_setkey(ptr noundef, ptr noundef, i32 noundef, i32 noundef) #1

declare i32 @mbedtls_cipher_set_padding_mode(ptr noundef, i32 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_psk_derive_premaster(ptr noundef %ssl, i32 noundef %key_ex) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %key_ex.addr = alloca i32, align 4
  %p = alloca ptr, align 8
  %end = alloca ptr, align 8
  %psk = alloca ptr, align 8
  %psk_len = alloca i64, align 8
  %ret = alloca i32, align 4
  %len = alloca i64, align 8
  %ret68 = alloca i32, align 4
  %zlen = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %key_ex, ptr %key_ex.addr, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %premaster = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 35
  %arraydecay = getelementptr inbounds [1060 x i8], ptr %premaster, i64 0, i64 0
  store ptr %arraydecay, ptr %p, align 8
  %2 = load ptr, ptr %p, align 8
  %add.ptr = getelementptr inbounds i8, ptr %2, i64 1060
  store ptr %add.ptr, ptr %end, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf, align 8
  %psk1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 30
  %5 = load ptr, ptr %psk1, align 8
  store ptr %5, ptr %psk, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  %conf2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 0
  %7 = load ptr, ptr %conf2, align 8
  %psk_len3 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 31
  %8 = load i64, ptr %psk_len3, align 8
  store i64 %8, ptr %psk_len, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %handshake4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 15
  %10 = load ptr, ptr %handshake4, align 8
  %psk5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %10, i32 0, i32 4
  %11 = load ptr, ptr %psk5, align 8
  %cmp = icmp ne ptr %11, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %12 = load ptr, ptr %ssl.addr, align 8
  %handshake6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 15
  %13 = load ptr, ptr %handshake6, align 8
  %psk7 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %13, i32 0, i32 4
  %14 = load ptr, ptr %psk7, align 8
  store ptr %14, ptr %psk, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %handshake8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 15
  %16 = load ptr, ptr %handshake8, align 8
  %psk_len9 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %16, i32 0, i32 5
  %17 = load i64, ptr %psk_len9, align 8
  store i64 %17, ptr %psk_len, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %18 = load i32, ptr %key_ex.addr, align 4
  %cmp10 = icmp eq i32 %18, 5
  br i1 %cmp10, label %if.then11, label %if.else

if.then11:                                        ; preds = %if.end
  %19 = load ptr, ptr %end, align 8
  %20 = load ptr, ptr %p, align 8
  %sub.ptr.lhs.cast = ptrtoint ptr %19 to i64
  %sub.ptr.rhs.cast = ptrtoint ptr %20 to i64
  %sub.ptr.sub = sub i64 %sub.ptr.lhs.cast, %sub.ptr.rhs.cast
  %cmp12 = icmp slt i64 %sub.ptr.sub, 2
  br i1 %cmp12, label %if.then13, label %if.end14

if.then13:                                        ; preds = %if.then11
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end14:                                         ; preds = %if.then11
  %21 = load i64, ptr %psk_len, align 8
  %shr = lshr i64 %21, 8
  %conv = trunc i64 %shr to i8
  %22 = load ptr, ptr %p, align 8
  %incdec.ptr = getelementptr inbounds i8, ptr %22, i32 1
  store ptr %incdec.ptr, ptr %p, align 8
  store i8 %conv, ptr %22, align 1
  %23 = load i64, ptr %psk_len, align 8
  %conv15 = trunc i64 %23 to i8
  %24 = load ptr, ptr %p, align 8
  %incdec.ptr16 = getelementptr inbounds i8, ptr %24, i32 1
  store ptr %incdec.ptr16, ptr %p, align 8
  store i8 %conv15, ptr %24, align 1
  %25 = load ptr, ptr %end, align 8
  %26 = load ptr, ptr %p, align 8
  %cmp17 = icmp ult ptr %25, %26
  br i1 %cmp17, label %if.then24, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end14
  %27 = load ptr, ptr %end, align 8
  %28 = load ptr, ptr %p, align 8
  %sub.ptr.lhs.cast19 = ptrtoint ptr %27 to i64
  %sub.ptr.rhs.cast20 = ptrtoint ptr %28 to i64
  %sub.ptr.sub21 = sub i64 %sub.ptr.lhs.cast19, %sub.ptr.rhs.cast20
  %29 = load i64, ptr %psk_len, align 8
  %cmp22 = icmp ult i64 %sub.ptr.sub21, %29
  br i1 %cmp22, label %if.then24, label %if.end25

if.then24:                                        ; preds = %lor.lhs.false, %if.end14
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end25:                                         ; preds = %lor.lhs.false
  %30 = load ptr, ptr %p, align 8
  %31 = load i64, ptr %psk_len, align 8
  call void @llvm.memset.p0.i64(ptr align 1 %30, i8 0, i64 %31, i1 false)
  %32 = load i64, ptr %psk_len, align 8
  %33 = load ptr, ptr %p, align 8
  %add.ptr26 = getelementptr inbounds i8, ptr %33, i64 %32
  store ptr %add.ptr26, ptr %p, align 8
  br label %if.end96

if.else:                                          ; preds = %if.end
  %34 = load i32, ptr %key_ex.addr, align 4
  %cmp27 = icmp eq i32 %34, 7
  br i1 %cmp27, label %if.then29, label %if.else40

if.then29:                                        ; preds = %if.else
  %35 = load ptr, ptr %end, align 8
  %36 = load ptr, ptr %p, align 8
  %sub.ptr.lhs.cast30 = ptrtoint ptr %35 to i64
  %sub.ptr.rhs.cast31 = ptrtoint ptr %36 to i64
  %sub.ptr.sub32 = sub i64 %sub.ptr.lhs.cast30, %sub.ptr.rhs.cast31
  %cmp33 = icmp slt i64 %sub.ptr.sub32, 2
  br i1 %cmp33, label %if.then35, label %if.end36

if.then35:                                        ; preds = %if.then29
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end36:                                         ; preds = %if.then29
  %37 = load ptr, ptr %p, align 8
  %incdec.ptr37 = getelementptr inbounds i8, ptr %37, i32 1
  store ptr %incdec.ptr37, ptr %p, align 8
  store i8 0, ptr %37, align 1
  %38 = load ptr, ptr %p, align 8
  %incdec.ptr38 = getelementptr inbounds i8, ptr %38, i32 1
  store ptr %incdec.ptr38, ptr %p, align 8
  store i8 48, ptr %38, align 1
  %39 = load ptr, ptr %p, align 8
  %add.ptr39 = getelementptr inbounds i8, ptr %39, i64 48
  store ptr %add.ptr39, ptr %p, align 8
  br label %if.end95

if.else40:                                        ; preds = %if.else
  %40 = load i32, ptr %key_ex.addr, align 4
  %cmp41 = icmp eq i32 %40, 6
  br i1 %cmp41, label %if.then43, label %if.else64

if.then43:                                        ; preds = %if.else40
  %41 = load ptr, ptr %ssl.addr, align 8
  %handshake44 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 15
  %42 = load ptr, ptr %handshake44, align 8
  %dhm_ctx = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %42, i32 0, i32 1
  %43 = load ptr, ptr %p, align 8
  %add.ptr45 = getelementptr inbounds i8, ptr %43, i64 2
  %44 = load ptr, ptr %end, align 8
  %45 = load ptr, ptr %p, align 8
  %add.ptr46 = getelementptr inbounds i8, ptr %45, i64 2
  %sub.ptr.lhs.cast47 = ptrtoint ptr %44 to i64
  %sub.ptr.rhs.cast48 = ptrtoint ptr %add.ptr46 to i64
  %sub.ptr.sub49 = sub i64 %sub.ptr.lhs.cast47, %sub.ptr.rhs.cast48
  %46 = load ptr, ptr %ssl.addr, align 8
  %conf50 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 0
  %47 = load ptr, ptr %conf50, align 8
  %f_rng = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %47, i32 0, i32 3
  %48 = load ptr, ptr %f_rng, align 8
  %49 = load ptr, ptr %ssl.addr, align 8
  %conf51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 0
  %50 = load ptr, ptr %conf51, align 8
  %p_rng = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %50, i32 0, i32 4
  %51 = load ptr, ptr %p_rng, align 8
  %call = call i32 @mbedtls_dhm_calc_secret(ptr noundef %dhm_ctx, ptr noundef %add.ptr45, i64 noundef %sub.ptr.sub49, ptr noundef %len, ptr noundef %48, ptr noundef %51)
  store i32 %call, ptr %ret, align 4
  %cmp52 = icmp ne i32 %call, 0
  br i1 %cmp52, label %if.then54, label %if.end55

if.then54:                                        ; preds = %if.then43
  %52 = load ptr, ptr %ssl.addr, align 8
  %53 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %52, i32 noundef 1, ptr noundef @.str, i32 noundef 1307, ptr noundef @.str.22, i32 noundef %53)
  %54 = load i32, ptr %ret, align 4
  store i32 %54, ptr %retval, align 4
  br label %return

if.end55:                                         ; preds = %if.then43
  %55 = load i64, ptr %len, align 8
  %shr56 = lshr i64 %55, 8
  %conv57 = trunc i64 %shr56 to i8
  %56 = load ptr, ptr %p, align 8
  %incdec.ptr58 = getelementptr inbounds i8, ptr %56, i32 1
  store ptr %incdec.ptr58, ptr %p, align 8
  store i8 %conv57, ptr %56, align 1
  %57 = load i64, ptr %len, align 8
  %conv59 = trunc i64 %57 to i8
  %58 = load ptr, ptr %p, align 8
  %incdec.ptr60 = getelementptr inbounds i8, ptr %58, i32 1
  store ptr %incdec.ptr60, ptr %p, align 8
  store i8 %conv59, ptr %58, align 1
  %59 = load i64, ptr %len, align 8
  %60 = load ptr, ptr %p, align 8
  %add.ptr61 = getelementptr inbounds i8, ptr %60, i64 %59
  store ptr %add.ptr61, ptr %p, align 8
  %61 = load ptr, ptr %ssl.addr, align 8
  %62 = load ptr, ptr %ssl.addr, align 8
  %handshake62 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %62, i32 0, i32 15
  %63 = load ptr, ptr %handshake62, align 8
  %dhm_ctx63 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %63, i32 0, i32 1
  %K = getelementptr inbounds %struct.mbedtls_dhm_context, ptr %dhm_ctx63, i32 0, i32 6
  call void @mbedtls_debug_print_mpi(ptr noundef %61, i32 noundef 3, ptr noundef @.str, i32 noundef 1314, ptr noundef @.str.23, ptr noundef %K)
  br label %if.end94

if.else64:                                        ; preds = %if.else40
  %64 = load i32, ptr %key_ex.addr, align 4
  %cmp65 = icmp eq i32 %64, 8
  br i1 %cmp65, label %if.then67, label %if.else92

if.then67:                                        ; preds = %if.else64
  %65 = load ptr, ptr %ssl.addr, align 8
  %handshake69 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %65, i32 0, i32 15
  %66 = load ptr, ptr %handshake69, align 8
  %ecdh_ctx = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %66, i32 0, i32 2
  %67 = load ptr, ptr %p, align 8
  %add.ptr70 = getelementptr inbounds i8, ptr %67, i64 2
  %68 = load ptr, ptr %end, align 8
  %69 = load ptr, ptr %p, align 8
  %add.ptr71 = getelementptr inbounds i8, ptr %69, i64 2
  %sub.ptr.lhs.cast72 = ptrtoint ptr %68 to i64
  %sub.ptr.rhs.cast73 = ptrtoint ptr %add.ptr71 to i64
  %sub.ptr.sub74 = sub i64 %sub.ptr.lhs.cast72, %sub.ptr.rhs.cast73
  %70 = load ptr, ptr %ssl.addr, align 8
  %conf75 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %70, i32 0, i32 0
  %71 = load ptr, ptr %conf75, align 8
  %f_rng76 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %71, i32 0, i32 3
  %72 = load ptr, ptr %f_rng76, align 8
  %73 = load ptr, ptr %ssl.addr, align 8
  %conf77 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %73, i32 0, i32 0
  %74 = load ptr, ptr %conf77, align 8
  %p_rng78 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %74, i32 0, i32 4
  %75 = load ptr, ptr %p_rng78, align 8
  %call79 = call i32 @mbedtls_ecdh_calc_secret(ptr noundef %ecdh_ctx, ptr noundef %zlen, ptr noundef %add.ptr70, i64 noundef %sub.ptr.sub74, ptr noundef %72, ptr noundef %75)
  store i32 %call79, ptr %ret68, align 4
  %cmp80 = icmp ne i32 %call79, 0
  br i1 %cmp80, label %if.then82, label %if.end83

if.then82:                                        ; preds = %if.then67
  %76 = load ptr, ptr %ssl.addr, align 8
  %77 = load i32, ptr %ret68, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %76, i32 noundef 1, ptr noundef @.str, i32 noundef 1328, ptr noundef @.str.24, i32 noundef %77)
  %78 = load i32, ptr %ret68, align 4
  store i32 %78, ptr %retval, align 4
  br label %return

if.end83:                                         ; preds = %if.then67
  %79 = load i64, ptr %zlen, align 8
  %shr84 = lshr i64 %79, 8
  %conv85 = trunc i64 %shr84 to i8
  %80 = load ptr, ptr %p, align 8
  %incdec.ptr86 = getelementptr inbounds i8, ptr %80, i32 1
  store ptr %incdec.ptr86, ptr %p, align 8
  store i8 %conv85, ptr %80, align 1
  %81 = load i64, ptr %zlen, align 8
  %conv87 = trunc i64 %81 to i8
  %82 = load ptr, ptr %p, align 8
  %incdec.ptr88 = getelementptr inbounds i8, ptr %82, i32 1
  store ptr %incdec.ptr88, ptr %p, align 8
  store i8 %conv87, ptr %82, align 1
  %83 = load i64, ptr %zlen, align 8
  %84 = load ptr, ptr %p, align 8
  %add.ptr89 = getelementptr inbounds i8, ptr %84, i64 %83
  store ptr %add.ptr89, ptr %p, align 8
  %85 = load ptr, ptr %ssl.addr, align 8
  %86 = load ptr, ptr %ssl.addr, align 8
  %handshake90 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %86, i32 0, i32 15
  %87 = load ptr, ptr %handshake90, align 8
  %ecdh_ctx91 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %87, i32 0, i32 2
  call void @mbedtls_debug_printf_ecdh(ptr noundef %85, i32 noundef 3, ptr noundef @.str, i32 noundef 1337, ptr noundef %ecdh_ctx91, i32 noundef 2)
  br label %if.end93

if.else92:                                        ; preds = %if.else64
  %88 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %88, i32 noundef 1, ptr noundef @.str, i32 noundef 1342, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end93:                                         ; preds = %if.end83
  br label %if.end94

if.end94:                                         ; preds = %if.end93, %if.end55
  br label %if.end95

if.end95:                                         ; preds = %if.end94, %if.end36
  br label %if.end96

if.end96:                                         ; preds = %if.end95, %if.end25
  %89 = load ptr, ptr %end, align 8
  %90 = load ptr, ptr %p, align 8
  %sub.ptr.lhs.cast97 = ptrtoint ptr %89 to i64
  %sub.ptr.rhs.cast98 = ptrtoint ptr %90 to i64
  %sub.ptr.sub99 = sub i64 %sub.ptr.lhs.cast97, %sub.ptr.rhs.cast98
  %cmp100 = icmp slt i64 %sub.ptr.sub99, 2
  br i1 %cmp100, label %if.then102, label %if.end103

if.then102:                                       ; preds = %if.end96
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end103:                                        ; preds = %if.end96
  %91 = load i64, ptr %psk_len, align 8
  %shr104 = lshr i64 %91, 8
  %conv105 = trunc i64 %shr104 to i8
  %92 = load ptr, ptr %p, align 8
  %incdec.ptr106 = getelementptr inbounds i8, ptr %92, i32 1
  store ptr %incdec.ptr106, ptr %p, align 8
  store i8 %conv105, ptr %92, align 1
  %93 = load i64, ptr %psk_len, align 8
  %conv107 = trunc i64 %93 to i8
  %94 = load ptr, ptr %p, align 8
  %incdec.ptr108 = getelementptr inbounds i8, ptr %94, i32 1
  store ptr %incdec.ptr108, ptr %p, align 8
  store i8 %conv107, ptr %94, align 1
  %95 = load ptr, ptr %end, align 8
  %96 = load ptr, ptr %p, align 8
  %cmp109 = icmp ult ptr %95, %96
  br i1 %cmp109, label %if.then117, label %lor.lhs.false111

lor.lhs.false111:                                 ; preds = %if.end103
  %97 = load ptr, ptr %end, align 8
  %98 = load ptr, ptr %p, align 8
  %sub.ptr.lhs.cast112 = ptrtoint ptr %97 to i64
  %sub.ptr.rhs.cast113 = ptrtoint ptr %98 to i64
  %sub.ptr.sub114 = sub i64 %sub.ptr.lhs.cast112, %sub.ptr.rhs.cast113
  %99 = load i64, ptr %psk_len, align 8
  %cmp115 = icmp ult i64 %sub.ptr.sub114, %99
  br i1 %cmp115, label %if.then117, label %if.end118

if.then117:                                       ; preds = %lor.lhs.false111, %if.end103
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end118:                                        ; preds = %lor.lhs.false111
  %100 = load ptr, ptr %p, align 8
  %101 = load ptr, ptr %psk, align 8
  %102 = load i64, ptr %psk_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %100, ptr align 1 %101, i64 %102, i1 false)
  %103 = load i64, ptr %psk_len, align 8
  %104 = load ptr, ptr %p, align 8
  %add.ptr119 = getelementptr inbounds i8, ptr %104, i64 %103
  store ptr %add.ptr119, ptr %p, align 8
  %105 = load ptr, ptr %p, align 8
  %106 = load ptr, ptr %ssl.addr, align 8
  %handshake120 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %106, i32 0, i32 15
  %107 = load ptr, ptr %handshake120, align 8
  %premaster121 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %107, i32 0, i32 35
  %arraydecay122 = getelementptr inbounds [1060 x i8], ptr %premaster121, i64 0, i64 0
  %sub.ptr.lhs.cast123 = ptrtoint ptr %105 to i64
  %sub.ptr.rhs.cast124 = ptrtoint ptr %arraydecay122 to i64
  %sub.ptr.sub125 = sub i64 %sub.ptr.lhs.cast123, %sub.ptr.rhs.cast124
  %108 = load ptr, ptr %ssl.addr, align 8
  %handshake126 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %108, i32 0, i32 15
  %109 = load ptr, ptr %handshake126, align 8
  %pmslen = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %109, i32 0, i32 33
  store i64 %sub.ptr.sub125, ptr %pmslen, align 8
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end118, %if.then117, %if.then102, %if.else92, %if.then82, %if.then54, %if.then35, %if.then24, %if.then13
  %110 = load i32, ptr %retval, align 4
  ret i32 %110
}

; Function Attrs: nocallback nofree nounwind willreturn memory(argmem: write)
declare void @llvm.memset.p0.i64(ptr nocapture writeonly, i8, i64, i1 immarg) #3

declare i32 @mbedtls_dhm_calc_secret(ptr noundef, ptr noundef, i64 noundef, ptr noundef, ptr noundef, ptr noundef) #1

declare void @mbedtls_debug_print_mpi(ptr noundef, i32 noundef, ptr noundef, i32 noundef, ptr noundef, ptr noundef) #1

declare i32 @mbedtls_ecdh_calc_secret(ptr noundef, ptr noundef, ptr noundef, i64 noundef, ptr noundef, ptr noundef) #1

declare void @mbedtls_debug_printf_ecdh(ptr noundef, i32 noundef, ptr noundef, i32 noundef, ptr noundef, i32 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_fetch_input(ptr noundef %ssl, i64 noundef %nb_want) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %nb_want.addr = alloca i64, align 8
  %ret = alloca i32, align 4
  %len = alloca i64, align 8
  %timeout = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i64 %nb_want, ptr %nb_want.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 2536, ptr noundef @.str.25)
  %1 = load ptr, ptr %ssl.addr, align 8
  %f_recv = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 8
  %2 = load ptr, ptr %f_recv, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %land.lhs.true, label %if.end

land.lhs.true:                                    ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %f_recv_timeout = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 9
  %4 = load ptr, ptr %f_recv_timeout, align 8
  %cmp1 = icmp eq ptr %4, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %land.lhs.true
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 1, ptr noundef @.str, i32 noundef 2541, ptr noundef @.str.26)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %land.lhs.true, %entry
  %6 = load i64, ptr %nb_want.addr, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 25
  %8 = load ptr, ptr %in_hdr, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 23
  %10 = load ptr, ptr %in_buf, align 8
  %sub.ptr.lhs.cast = ptrtoint ptr %8 to i64
  %sub.ptr.rhs.cast = ptrtoint ptr %10 to i64
  %sub.ptr.sub = sub i64 %sub.ptr.lhs.cast, %sub.ptr.rhs.cast
  %sub = sub i64 16717, %sub.ptr.sub
  %cmp2 = icmp ugt i64 %6, %sub
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  %11 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %11, i32 noundef 1, ptr noundef @.str, i32 noundef 2547, ptr noundef @.str.27)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  %12 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 0
  %13 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %13, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp5 = icmp eq i32 %bf.clear, 1
  br i1 %cmp5, label %if.then6, label %if.else101

if.then6:                                         ; preds = %if.end4
  %14 = load ptr, ptr %ssl.addr, align 8
  %f_set_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 21
  %15 = load ptr, ptr %f_set_timer, align 8
  %cmp7 = icmp eq ptr %15, null
  br i1 %cmp7, label %if.then9, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.then6
  %16 = load ptr, ptr %ssl.addr, align 8
  %f_get_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 22
  %17 = load ptr, ptr %f_get_timer, align 8
  %cmp8 = icmp eq ptr %17, null
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %lor.lhs.false, %if.then6
  %18 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %18, i32 noundef 1, ptr noundef @.str, i32 noundef 2560, ptr noundef @.str.28)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %lor.lhs.false
  %19 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 34
  %20 = load i64, ptr %next_record_offset, align 8
  %cmp11 = icmp ne i64 %20, 0
  br i1 %cmp11, label %if.then12, label %if.end30

if.then12:                                        ; preds = %if.end10
  %21 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 32
  %22 = load i64, ptr %in_left, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 34
  %24 = load i64, ptr %next_record_offset13, align 8
  %cmp14 = icmp ult i64 %22, %24
  br i1 %cmp14, label %if.then15, label %if.end16

if.then15:                                        ; preds = %if.then12
  %25 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %25, i32 noundef 1, ptr noundef @.str, i32 noundef 2578, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end16:                                         ; preds = %if.then12
  %26 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 34
  %27 = load i64, ptr %next_record_offset17, align 8
  %28 = load ptr, ptr %ssl.addr, align 8
  %in_left18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 32
  %29 = load i64, ptr %in_left18, align 8
  %sub19 = sub i64 %29, %27
  store i64 %sub19, ptr %in_left18, align 8
  %30 = load ptr, ptr %ssl.addr, align 8
  %in_left20 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 32
  %31 = load i64, ptr %in_left20, align 8
  %cmp21 = icmp ne i64 %31, 0
  br i1 %cmp21, label %if.then22, label %if.end28

if.then22:                                        ; preds = %if.end16
  %32 = load ptr, ptr %ssl.addr, align 8
  %33 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 34
  %34 = load i64, ptr %next_record_offset23, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %32, i32 noundef 2, ptr noundef @.str, i32 noundef 2587, ptr noundef @.str.29, i64 noundef %34)
  %35 = load ptr, ptr %ssl.addr, align 8
  %in_hdr24 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 25
  %36 = load ptr, ptr %in_hdr24, align 8
  %37 = load ptr, ptr %ssl.addr, align 8
  %in_hdr25 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %37, i32 0, i32 25
  %38 = load ptr, ptr %in_hdr25, align 8
  %39 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset26 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 34
  %40 = load i64, ptr %next_record_offset26, align 8
  %add.ptr = getelementptr inbounds i8, ptr %38, i64 %40
  %41 = load ptr, ptr %ssl.addr, align 8
  %in_left27 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 32
  %42 = load i64, ptr %in_left27, align 8
  call void @llvm.memmove.p0.p0.i64(ptr align 1 %36, ptr align 1 %add.ptr, i64 %42, i1 false)
  br label %if.end28

if.end28:                                         ; preds = %if.then22, %if.end16
  %43 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset29 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %43, i32 0, i32 34
  store i64 0, ptr %next_record_offset29, align 8
  br label %if.end30

if.end30:                                         ; preds = %if.end28, %if.end10
  %44 = load ptr, ptr %ssl.addr, align 8
  %45 = load ptr, ptr %ssl.addr, align 8
  %in_left31 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %45, i32 0, i32 32
  %46 = load i64, ptr %in_left31, align 8
  %47 = load i64, ptr %nb_want.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %44, i32 noundef 2, ptr noundef @.str, i32 noundef 2597, ptr noundef @.str.30, i64 noundef %46, i64 noundef %47)
  %48 = load i64, ptr %nb_want.addr, align 8
  %49 = load ptr, ptr %ssl.addr, align 8
  %in_left32 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 32
  %50 = load i64, ptr %in_left32, align 8
  %cmp33 = icmp ule i64 %48, %50
  br i1 %cmp33, label %if.then34, label %if.end35

if.then34:                                        ; preds = %if.end30
  %51 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %51, i32 noundef 2, ptr noundef @.str, i32 noundef 2604, ptr noundef @.str.31)
  store i32 0, ptr %retval, align 4
  br label %return

if.end35:                                         ; preds = %if.end30
  %52 = load ptr, ptr %ssl.addr, align 8
  %in_left36 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 32
  %53 = load i64, ptr %in_left36, align 8
  %cmp37 = icmp ne i64 %53, 0
  br i1 %cmp37, label %if.then38, label %if.end39

if.then38:                                        ; preds = %if.end35
  %54 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %54, i32 noundef 1, ptr noundef @.str, i32 noundef 2615, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end39:                                         ; preds = %if.end35
  %55 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_check_timer(ptr noundef %55)
  %cmp40 = icmp ne i32 %call, 0
  br i1 %cmp40, label %if.then41, label %if.else

if.then41:                                        ; preds = %if.end39
  %56 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %56, i32 noundef 2, ptr noundef @.str, i32 noundef 2626, ptr noundef @.str.32)
  store i32 -26624, ptr %ret, align 4
  br label %if.end68

if.else:                                          ; preds = %if.end39
  %57 = load ptr, ptr %ssl.addr, align 8
  %in_hdr42 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %57, i32 0, i32 25
  %58 = load ptr, ptr %in_hdr42, align 8
  %59 = load ptr, ptr %ssl.addr, align 8
  %in_buf43 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %59, i32 0, i32 23
  %60 = load ptr, ptr %in_buf43, align 8
  %sub.ptr.lhs.cast44 = ptrtoint ptr %58 to i64
  %sub.ptr.rhs.cast45 = ptrtoint ptr %60 to i64
  %sub.ptr.sub46 = sub i64 %sub.ptr.lhs.cast44, %sub.ptr.rhs.cast45
  %sub47 = sub nsw i64 16717, %sub.ptr.sub46
  store i64 %sub47, ptr %len, align 8
  %61 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %61, i32 0, i32 1
  %62 = load i32, ptr %state, align 8
  %cmp48 = icmp ne i32 %62, 16
  br i1 %cmp48, label %if.then49, label %if.else50

if.then49:                                        ; preds = %if.else
  %63 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %63, i32 0, i32 15
  %64 = load ptr, ptr %handshake, align 8
  %retransmit_timeout = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %64, i32 0, i32 15
  %65 = load i32, ptr %retransmit_timeout, align 4
  store i32 %65, ptr %timeout, align 4
  br label %if.end52

if.else50:                                        ; preds = %if.else
  %66 = load ptr, ptr %ssl.addr, align 8
  %conf51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %66, i32 0, i32 0
  %67 = load ptr, ptr %conf51, align 8
  %read_timeout = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %67, i32 0, i32 35
  %68 = load i32, ptr %read_timeout, align 8
  store i32 %68, ptr %timeout, align 4
  br label %if.end52

if.end52:                                         ; preds = %if.else50, %if.then49
  %69 = load ptr, ptr %ssl.addr, align 8
  %70 = load i32, ptr %timeout, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %69, i32 noundef 3, ptr noundef @.str, i32 noundef 2638, ptr noundef @.str.33, i32 noundef %70)
  %71 = load ptr, ptr %ssl.addr, align 8
  %f_recv_timeout53 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %71, i32 0, i32 9
  %72 = load ptr, ptr %f_recv_timeout53, align 8
  %cmp54 = icmp ne ptr %72, null
  br i1 %cmp54, label %if.then55, label %if.else59

if.then55:                                        ; preds = %if.end52
  %73 = load ptr, ptr %ssl.addr, align 8
  %f_recv_timeout56 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %73, i32 0, i32 9
  %74 = load ptr, ptr %f_recv_timeout56, align 8
  %75 = load ptr, ptr %ssl.addr, align 8
  %p_bio = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %75, i32 0, i32 10
  %76 = load ptr, ptr %p_bio, align 8
  %77 = load ptr, ptr %ssl.addr, align 8
  %in_hdr57 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %77, i32 0, i32 25
  %78 = load ptr, ptr %in_hdr57, align 8
  %79 = load i64, ptr %len, align 8
  %80 = load i32, ptr %timeout, align 4
  %call58 = call i32 %74(ptr noundef %76, ptr noundef %78, i64 noundef %79, i32 noundef %80)
  store i32 %call58, ptr %ret, align 4
  br label %if.end64

if.else59:                                        ; preds = %if.end52
  %81 = load ptr, ptr %ssl.addr, align 8
  %f_recv60 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %81, i32 0, i32 8
  %82 = load ptr, ptr %f_recv60, align 8
  %83 = load ptr, ptr %ssl.addr, align 8
  %p_bio61 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %83, i32 0, i32 10
  %84 = load ptr, ptr %p_bio61, align 8
  %85 = load ptr, ptr %ssl.addr, align 8
  %in_hdr62 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %85, i32 0, i32 25
  %86 = load ptr, ptr %in_hdr62, align 8
  %87 = load i64, ptr %len, align 8
  %call63 = call i32 %82(ptr noundef %84, ptr noundef %86, i64 noundef %87)
  store i32 %call63, ptr %ret, align 4
  br label %if.end64

if.end64:                                         ; preds = %if.else59, %if.then55
  %88 = load ptr, ptr %ssl.addr, align 8
  %89 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %88, i32 noundef 2, ptr noundef @.str, i32 noundef 2646, ptr noundef @.str.34, i32 noundef %89)
  %90 = load i32, ptr %ret, align 4
  %cmp65 = icmp eq i32 %90, 0
  br i1 %cmp65, label %if.then66, label %if.end67

if.then66:                                        ; preds = %if.end64
  store i32 -29312, ptr %retval, align 4
  br label %return

if.end67:                                         ; preds = %if.end64
  br label %if.end68

if.end68:                                         ; preds = %if.end67, %if.then41
  %91 = load i32, ptr %ret, align 4
  %cmp69 = icmp eq i32 %91, -26624
  br i1 %cmp69, label %if.then70, label %if.end96

if.then70:                                        ; preds = %if.end68
  %92 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %92, i32 noundef 2, ptr noundef @.str, i32 noundef 2654, ptr noundef @.str.35)
  %93 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_set_timer(ptr noundef %93, i32 noundef 0)
  %94 = load ptr, ptr %ssl.addr, align 8
  %state71 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %94, i32 0, i32 1
  %95 = load i32, ptr %state71, align 8
  %cmp72 = icmp ne i32 %95, 16
  br i1 %cmp72, label %if.then73, label %if.else82

if.then73:                                        ; preds = %if.then70
  %96 = load ptr, ptr %ssl.addr, align 8
  %call74 = call i32 @ssl_double_retransmit_timeout(ptr noundef %96)
  %cmp75 = icmp ne i32 %call74, 0
  br i1 %cmp75, label %if.then76, label %if.end77

if.then76:                                        ; preds = %if.then73
  %97 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %97, i32 noundef 1, ptr noundef @.str, i32 noundef 2661, ptr noundef @.str.36)
  store i32 -26624, ptr %retval, align 4
  br label %return

if.end77:                                         ; preds = %if.then73
  %98 = load ptr, ptr %ssl.addr, align 8
  %call78 = call i32 @mbedtls_ssl_resend(ptr noundef %98)
  store i32 %call78, ptr %ret, align 4
  %cmp79 = icmp ne i32 %call78, 0
  br i1 %cmp79, label %if.then80, label %if.end81

if.then80:                                        ; preds = %if.end77
  %99 = load ptr, ptr %ssl.addr, align 8
  %100 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %99, i32 noundef 1, ptr noundef @.str, i32 noundef 2667, ptr noundef @.str.37, i32 noundef %100)
  %101 = load i32, ptr %ret, align 4
  store i32 %101, ptr %retval, align 4
  br label %return

if.end81:                                         ; preds = %if.end77
  store i32 -26880, ptr %retval, align 4
  br label %return

if.else82:                                        ; preds = %if.then70
  %102 = load ptr, ptr %ssl.addr, align 8
  %conf83 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %102, i32 0, i32 0
  %103 = load ptr, ptr %conf83, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %103, i32 0, i32 46
  %bf.load84 = load i32, ptr %endpoint, align 4
  %bf.clear85 = and i32 %bf.load84, 1
  %cmp86 = icmp eq i32 %bf.clear85, 1
  br i1 %cmp86, label %land.lhs.true87, label %if.end94

land.lhs.true87:                                  ; preds = %if.else82
  %104 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %104, i32 0, i32 2
  %105 = load i32, ptr %renego_status, align 4
  %cmp88 = icmp eq i32 %105, 3
  br i1 %cmp88, label %if.then89, label %if.end94

if.then89:                                        ; preds = %land.lhs.true87
  %106 = load ptr, ptr %ssl.addr, align 8
  %call90 = call i32 @ssl_resend_hello_request(ptr noundef %106)
  store i32 %call90, ptr %ret, align 4
  %cmp91 = icmp ne i32 %call90, 0
  br i1 %cmp91, label %if.then92, label %if.end93

if.then92:                                        ; preds = %if.then89
  %107 = load ptr, ptr %ssl.addr, align 8
  %108 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %107, i32 noundef 1, ptr noundef @.str, i32 noundef 2679, ptr noundef @.str.38, i32 noundef %108)
  %109 = load i32, ptr %ret, align 4
  store i32 %109, ptr %retval, align 4
  br label %return

if.end93:                                         ; preds = %if.then89
  store i32 -26880, ptr %retval, align 4
  br label %return

if.end94:                                         ; preds = %land.lhs.true87, %if.else82
  br label %if.end95

if.end95:                                         ; preds = %if.end94
  br label %if.end96

if.end96:                                         ; preds = %if.end95, %if.end68
  %110 = load i32, ptr %ret, align 4
  %cmp97 = icmp slt i32 %110, 0
  br i1 %cmp97, label %if.then98, label %if.end99

if.then98:                                        ; preds = %if.end96
  %111 = load i32, ptr %ret, align 4
  store i32 %111, ptr %retval, align 4
  br label %return

if.end99:                                         ; preds = %if.end96
  %112 = load i32, ptr %ret, align 4
  %conv = sext i32 %112 to i64
  %113 = load ptr, ptr %ssl.addr, align 8
  %in_left100 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %113, i32 0, i32 32
  store i64 %conv, ptr %in_left100, align 8
  br label %if.end150

if.else101:                                       ; preds = %if.end4
  %114 = load ptr, ptr %ssl.addr, align 8
  %115 = load ptr, ptr %ssl.addr, align 8
  %in_left102 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %115, i32 0, i32 32
  %116 = load i64, ptr %in_left102, align 8
  %117 = load i64, ptr %nb_want.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %114, i32 noundef 2, ptr noundef @.str, i32 noundef 2697, ptr noundef @.str.30, i64 noundef %116, i64 noundef %117)
  br label %while.cond

while.cond:                                       ; preds = %if.end147, %if.else101
  %118 = load ptr, ptr %ssl.addr, align 8
  %in_left103 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %118, i32 0, i32 32
  %119 = load i64, ptr %in_left103, align 8
  %120 = load i64, ptr %nb_want.addr, align 8
  %cmp104 = icmp ult i64 %119, %120
  br i1 %cmp104, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %121 = load i64, ptr %nb_want.addr, align 8
  %122 = load ptr, ptr %ssl.addr, align 8
  %in_left106 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %122, i32 0, i32 32
  %123 = load i64, ptr %in_left106, align 8
  %sub107 = sub i64 %121, %123
  store i64 %sub107, ptr %len, align 8
  %124 = load ptr, ptr %ssl.addr, align 8
  %call108 = call i32 @ssl_check_timer(ptr noundef %124)
  %cmp109 = icmp ne i32 %call108, 0
  br i1 %cmp109, label %if.then111, label %if.else112

if.then111:                                       ; preds = %while.body
  store i32 -26624, ptr %ret, align 4
  br label %if.end133

if.else112:                                       ; preds = %while.body
  %125 = load ptr, ptr %ssl.addr, align 8
  %f_recv_timeout113 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %125, i32 0, i32 9
  %126 = load ptr, ptr %f_recv_timeout113, align 8
  %cmp114 = icmp ne ptr %126, null
  br i1 %cmp114, label %if.then116, label %if.else125

if.then116:                                       ; preds = %if.else112
  %127 = load ptr, ptr %ssl.addr, align 8
  %f_recv_timeout117 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %127, i32 0, i32 9
  %128 = load ptr, ptr %f_recv_timeout117, align 8
  %129 = load ptr, ptr %ssl.addr, align 8
  %p_bio118 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %129, i32 0, i32 10
  %130 = load ptr, ptr %p_bio118, align 8
  %131 = load ptr, ptr %ssl.addr, align 8
  %in_hdr119 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %131, i32 0, i32 25
  %132 = load ptr, ptr %in_hdr119, align 8
  %133 = load ptr, ptr %ssl.addr, align 8
  %in_left120 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %133, i32 0, i32 32
  %134 = load i64, ptr %in_left120, align 8
  %add.ptr121 = getelementptr inbounds i8, ptr %132, i64 %134
  %135 = load i64, ptr %len, align 8
  %136 = load ptr, ptr %ssl.addr, align 8
  %conf122 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %136, i32 0, i32 0
  %137 = load ptr, ptr %conf122, align 8
  %read_timeout123 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %137, i32 0, i32 35
  %138 = load i32, ptr %read_timeout123, align 8
  %call124 = call i32 %128(ptr noundef %130, ptr noundef %add.ptr121, i64 noundef %135, i32 noundef %138)
  store i32 %call124, ptr %ret, align 4
  br label %if.end132

if.else125:                                       ; preds = %if.else112
  %139 = load ptr, ptr %ssl.addr, align 8
  %f_recv126 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %139, i32 0, i32 8
  %140 = load ptr, ptr %f_recv126, align 8
  %141 = load ptr, ptr %ssl.addr, align 8
  %p_bio127 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %141, i32 0, i32 10
  %142 = load ptr, ptr %p_bio127, align 8
  %143 = load ptr, ptr %ssl.addr, align 8
  %in_hdr128 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %143, i32 0, i32 25
  %144 = load ptr, ptr %in_hdr128, align 8
  %145 = load ptr, ptr %ssl.addr, align 8
  %in_left129 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %145, i32 0, i32 32
  %146 = load i64, ptr %in_left129, align 8
  %add.ptr130 = getelementptr inbounds i8, ptr %144, i64 %146
  %147 = load i64, ptr %len, align 8
  %call131 = call i32 %140(ptr noundef %142, ptr noundef %add.ptr130, i64 noundef %147)
  store i32 %call131, ptr %ret, align 4
  br label %if.end132

if.end132:                                        ; preds = %if.else125, %if.then116
  br label %if.end133

if.end133:                                        ; preds = %if.end132, %if.then111
  %148 = load ptr, ptr %ssl.addr, align 8
  %149 = load ptr, ptr %ssl.addr, align 8
  %in_left134 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %149, i32 0, i32 32
  %150 = load i64, ptr %in_left134, align 8
  %151 = load i64, ptr %nb_want.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %148, i32 noundef 2, ptr noundef @.str, i32 noundef 2721, ptr noundef @.str.30, i64 noundef %150, i64 noundef %151)
  %152 = load ptr, ptr %ssl.addr, align 8
  %153 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %152, i32 noundef 2, ptr noundef @.str, i32 noundef 2722, ptr noundef @.str.34, i32 noundef %153)
  %154 = load i32, ptr %ret, align 4
  %cmp135 = icmp eq i32 %154, 0
  br i1 %cmp135, label %if.then137, label %if.end138

if.then137:                                       ; preds = %if.end133
  store i32 -29312, ptr %retval, align 4
  br label %return

if.end138:                                        ; preds = %if.end133
  %155 = load i32, ptr %ret, align 4
  %cmp139 = icmp slt i32 %155, 0
  br i1 %cmp139, label %if.then141, label %if.end142

if.then141:                                       ; preds = %if.end138
  %156 = load i32, ptr %ret, align 4
  store i32 %156, ptr %retval, align 4
  br label %return

if.end142:                                        ; preds = %if.end138
  %157 = load i32, ptr %ret, align 4
  %conv143 = sext i32 %157 to i64
  %158 = load i64, ptr %len, align 8
  %cmp144 = icmp ugt i64 %conv143, %158
  br i1 %cmp144, label %if.then146, label %if.end147

if.then146:                                       ; preds = %if.end142
  %159 = load ptr, ptr %ssl.addr, align 8
  %160 = load i32, ptr %ret, align 4
  %161 = load i64, ptr %len, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %159, i32 noundef 1, ptr noundef @.str, i32 noundef 2734, ptr noundef @.str.39, i32 noundef %160, i64 noundef %161)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end147:                                        ; preds = %if.end142
  %162 = load i32, ptr %ret, align 4
  %conv148 = sext i32 %162 to i64
  %163 = load ptr, ptr %ssl.addr, align 8
  %in_left149 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %163, i32 0, i32 32
  %164 = load i64, ptr %in_left149, align 8
  %add = add i64 %164, %conv148
  store i64 %add, ptr %in_left149, align 8
  br label %while.cond, !llvm.loop !10

while.end:                                        ; preds = %while.cond
  br label %if.end150

if.end150:                                        ; preds = %while.end, %if.end99
  %165 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %165, i32 noundef 2, ptr noundef @.str, i32 noundef 2742, ptr noundef @.str.31)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end150, %if.then146, %if.then141, %if.then137, %if.then98, %if.end93, %if.then92, %if.end81, %if.then80, %if.then76, %if.then66, %if.then38, %if.then34, %if.then15, %if.then9, %if.then3, %if.then
  %166 = load i32, ptr %retval, align 4
  ret i32 %166
}

; Function Attrs: nocallback nofree nounwind willreturn memory(argmem: readwrite)
declare void @llvm.memmove.p0.p0.i64(ptr nocapture writeonly, ptr nocapture readonly, i64, i1 immarg) #2

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_check_timer(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %f_get_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 22
  %1 = load ptr, ptr %f_get_timer, align 8
  %cmp = icmp eq ptr %1, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %f_get_timer1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 22
  %3 = load ptr, ptr %f_get_timer1, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %p_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 20
  %5 = load ptr, ptr %p_timer, align 8
  %call = call i32 %3(ptr noundef %5)
  %cmp2 = icmp eq i32 %call, 2
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 3, ptr noundef @.str, i32 noundef 95, ptr noundef @.str.181)
  store i32 -1, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end4, %if.then3, %if.then
  %7 = load i32, ptr %retval, align 4
  ret i32 %7
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_set_timer(ptr noundef %ssl, i32 noundef %millisecs) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %millisecs.addr = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %millisecs, ptr %millisecs.addr, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %f_set_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 21
  %1 = load ptr, ptr %f_set_timer, align 8
  %cmp = icmp eq ptr %1, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %return

if.end:                                           ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %3 = load i32, ptr %millisecs.addr, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %2, i32 noundef 3, ptr noundef @.str, i32 noundef 81, ptr noundef @.str.182, i32 noundef %3)
  %4 = load ptr, ptr %ssl.addr, align 8
  %f_set_timer1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 21
  %5 = load ptr, ptr %f_set_timer1, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  %p_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 20
  %7 = load ptr, ptr %p_timer, align 8
  %8 = load i32, ptr %millisecs.addr, align 4
  %div = udiv i32 %8, 4
  %9 = load i32, ptr %millisecs.addr, align 4
  call void %5(ptr noundef %7, i32 noundef %div, i32 noundef %9)
  br label %return

return:                                           ; preds = %if.end, %if.then
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_double_retransmit_timeout(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %new_timeout = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %retransmit_timeout = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 15
  %2 = load i32, ptr %retransmit_timeout, align 4
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf, align 8
  %hs_timeout_max = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 37
  %5 = load i32, ptr %hs_timeout_max, align 8
  %cmp = icmp uge i32 %2, %5
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake1, align 8
  %retransmit_timeout2 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 15
  %8 = load i32, ptr %retransmit_timeout2, align 4
  %9 = load ptr, ptr %ssl.addr, align 8
  %conf3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 0
  %10 = load ptr, ptr %conf3, align 8
  %hs_timeout_min = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %10, i32 0, i32 36
  %11 = load i32, ptr %hs_timeout_min, align 4
  %cmp4 = icmp ne i32 %8, %11
  br i1 %cmp4, label %if.then5, label %if.end9

if.then5:                                         ; preds = %if.end
  %12 = load ptr, ptr %ssl.addr, align 8
  %handshake6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 15
  %13 = load ptr, ptr %handshake6, align 8
  %mtu = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %13, i32 0, i32 24
  store i16 508, ptr %mtu, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %handshake7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 15
  %16 = load ptr, ptr %handshake7, align 8
  %mtu8 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %16, i32 0, i32 24
  %17 = load i16, ptr %mtu8, align 8
  %conv = zext i16 %17 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %14, i32 noundef 2, ptr noundef @.str, i32 noundef 217, ptr noundef @.str.183, i32 noundef %conv)
  br label %if.end9

if.end9:                                          ; preds = %if.then5, %if.end
  %18 = load ptr, ptr %ssl.addr, align 8
  %handshake10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 15
  %19 = load ptr, ptr %handshake10, align 8
  %retransmit_timeout11 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %19, i32 0, i32 15
  %20 = load i32, ptr %retransmit_timeout11, align 4
  %mul = mul i32 2, %20
  store i32 %mul, ptr %new_timeout, align 4
  %21 = load i32, ptr %new_timeout, align 4
  %22 = load ptr, ptr %ssl.addr, align 8
  %handshake12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 15
  %23 = load ptr, ptr %handshake12, align 8
  %retransmit_timeout13 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %23, i32 0, i32 15
  %24 = load i32, ptr %retransmit_timeout13, align 4
  %cmp14 = icmp ult i32 %21, %24
  br i1 %cmp14, label %if.then20, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end9
  %25 = load i32, ptr %new_timeout, align 4
  %26 = load ptr, ptr %ssl.addr, align 8
  %conf16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 0
  %27 = load ptr, ptr %conf16, align 8
  %hs_timeout_max17 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %27, i32 0, i32 37
  %28 = load i32, ptr %hs_timeout_max17, align 8
  %cmp18 = icmp ugt i32 %25, %28
  br i1 %cmp18, label %if.then20, label %if.end23

if.then20:                                        ; preds = %lor.lhs.false, %if.end9
  %29 = load ptr, ptr %ssl.addr, align 8
  %conf21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 0
  %30 = load ptr, ptr %conf21, align 8
  %hs_timeout_max22 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %30, i32 0, i32 37
  %31 = load i32, ptr %hs_timeout_max22, align 8
  store i32 %31, ptr %new_timeout, align 4
  br label %if.end23

if.end23:                                         ; preds = %if.then20, %lor.lhs.false
  %32 = load i32, ptr %new_timeout, align 4
  %33 = load ptr, ptr %ssl.addr, align 8
  %handshake24 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 15
  %34 = load ptr, ptr %handshake24, align 8
  %retransmit_timeout25 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %34, i32 0, i32 15
  store i32 %32, ptr %retransmit_timeout25, align 4
  %35 = load ptr, ptr %ssl.addr, align 8
  %36 = load ptr, ptr %ssl.addr, align 8
  %handshake26 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 15
  %37 = load ptr, ptr %handshake26, align 8
  %retransmit_timeout27 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %37, i32 0, i32 15
  %38 = load i32, ptr %retransmit_timeout27, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %35, i32 noundef 3, ptr noundef @.str, i32 noundef 231, ptr noundef @.str.184, i32 noundef %38)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end23, %if.then
  %39 = load i32, ptr %retval, align 4
  ret i32 %39
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_resend(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 0, ptr %ret, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 2933, ptr noundef @.str.45)
  %1 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_flight_transmit(ptr noundef %1)
  store i32 %call, ptr %ret, align 4
  %2 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %2, i32 noundef 2, ptr noundef @.str, i32 noundef 2937, ptr noundef @.str.46)
  %3 = load i32, ptr %ret, align 4
  ret i32 %3
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_resend_hello_request(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ratio = alloca i32, align 4
  %doublings = alloca i8, align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %renego_max_records = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 38
  %2 = load i32, ptr %renego_max_records, align 4
  %cmp = icmp slt i32 %2, 0
  br i1 %cmp, label %if.then, label %if.end8

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf1, align 8
  %hs_timeout_max = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 37
  %5 = load i32, ptr %hs_timeout_max, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  %conf2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 0
  %7 = load ptr, ptr %conf2, align 8
  %hs_timeout_min = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 36
  %8 = load i32, ptr %hs_timeout_min, align 4
  %div = udiv i32 %5, %8
  %add = add i32 %div, 1
  store i32 %add, ptr %ratio, align 4
  store i8 1, ptr %doublings, align 1
  br label %while.cond

while.cond:                                       ; preds = %while.body, %if.then
  %9 = load i32, ptr %ratio, align 4
  %cmp3 = icmp ne i32 %9, 0
  br i1 %cmp3, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %10 = load i8, ptr %doublings, align 1
  %inc = add i8 %10, 1
  store i8 %inc, ptr %doublings, align 1
  %11 = load i32, ptr %ratio, align 4
  %shr = lshr i32 %11, 1
  store i32 %shr, ptr %ratio, align 4
  br label %while.cond, !llvm.loop !11

while.end:                                        ; preds = %while.cond
  %12 = load ptr, ptr %ssl.addr, align 8
  %renego_records_seen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 3
  %13 = load i32, ptr %renego_records_seen, align 8
  %inc4 = add nsw i32 %13, 1
  store i32 %inc4, ptr %renego_records_seen, align 8
  %14 = load i8, ptr %doublings, align 1
  %conv = zext i8 %14 to i32
  %cmp5 = icmp sgt i32 %inc4, %conv
  br i1 %cmp5, label %if.then7, label %if.end

if.then7:                                         ; preds = %while.end
  %15 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %15, i32 noundef 2, ptr noundef @.str, i32 noundef 2506, ptr noundef @.str.185)
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %while.end
  br label %if.end8

if.end8:                                          ; preds = %if.end, %entry
  %16 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_write_hello_request(ptr noundef %16)
  store i32 %call, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end8, %if.then7
  %17 = load i32, ptr %retval, align 4
  ret i32 %17
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_flush_output(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %buf = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 2755, ptr noundef @.str.40)
  %1 = load ptr, ptr %ssl.addr, align 8
  %f_send = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 7
  %2 = load ptr, ptr %f_send, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 1, ptr noundef @.str, i32 noundef 2760, ptr noundef @.str.26)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 49
  %5 = load i64, ptr %out_left, align 8
  %cmp1 = icmp eq i64 %5, 0
  br i1 %cmp1, label %if.then2, label %if.end3

if.then2:                                         ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 2, ptr noundef @.str, i32 noundef 2767, ptr noundef @.str.41)
  store i32 0, ptr %retval, align 4
  br label %return

if.end3:                                          ; preds = %if.end
  br label %while.cond

while.cond:                                       ; preds = %if.end19, %if.end3
  %7 = load ptr, ptr %ssl.addr, align 8
  %out_left4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 49
  %8 = load i64, ptr %out_left4, align 8
  %cmp5 = icmp ugt i64 %8, 0
  br i1 %cmp5, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %9 = load ptr, ptr %ssl.addr, align 8
  %10 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_hdr_len(ptr noundef %10)
  %11 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 48
  %12 = load i64, ptr %out_msglen, align 8
  %add = add i64 %call, %12
  %13 = load ptr, ptr %ssl.addr, align 8
  %out_left6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 49
  %14 = load i64, ptr %out_left6, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %9, i32 noundef 2, ptr noundef @.str, i32 noundef 2774, ptr noundef @.str.42, i64 noundef %add, i64 noundef %14)
  %15 = load ptr, ptr %ssl.addr, align 8
  %out_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 43
  %16 = load ptr, ptr %out_hdr, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %out_left7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 49
  %18 = load i64, ptr %out_left7, align 8
  %idx.neg = sub i64 0, %18
  %add.ptr = getelementptr inbounds i8, ptr %16, i64 %idx.neg
  store ptr %add.ptr, ptr %buf, align 8
  %19 = load ptr, ptr %ssl.addr, align 8
  %f_send8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 7
  %20 = load ptr, ptr %f_send8, align 8
  %21 = load ptr, ptr %ssl.addr, align 8
  %p_bio = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 10
  %22 = load ptr, ptr %p_bio, align 8
  %23 = load ptr, ptr %buf, align 8
  %24 = load ptr, ptr %ssl.addr, align 8
  %out_left9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 49
  %25 = load i64, ptr %out_left9, align 8
  %call10 = call i32 %20(ptr noundef %22, ptr noundef %23, i64 noundef %25)
  store i32 %call10, ptr %ret, align 4
  %26 = load ptr, ptr %ssl.addr, align 8
  %27 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %26, i32 noundef 2, ptr noundef @.str, i32 noundef 2779, ptr noundef @.str.43, i32 noundef %27)
  %28 = load i32, ptr %ret, align 4
  %cmp11 = icmp sle i32 %28, 0
  br i1 %cmp11, label %if.then12, label %if.end13

if.then12:                                        ; preds = %while.body
  %29 = load i32, ptr %ret, align 4
  store i32 %29, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %while.body
  %30 = load i32, ptr %ret, align 4
  %conv = sext i32 %30 to i64
  %31 = load ptr, ptr %ssl.addr, align 8
  %out_left14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 49
  %32 = load i64, ptr %out_left14, align 8
  %cmp15 = icmp ugt i64 %conv, %32
  br i1 %cmp15, label %if.then17, label %if.end19

if.then17:                                        ; preds = %if.end13
  %33 = load ptr, ptr %ssl.addr, align 8
  %34 = load i32, ptr %ret, align 4
  %35 = load ptr, ptr %ssl.addr, align 8
  %out_left18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 49
  %36 = load i64, ptr %out_left18, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %33, i32 noundef 1, ptr noundef @.str, i32 noundef 2788, ptr noundef @.str.44, i32 noundef %34, i64 noundef %36)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end19:                                         ; preds = %if.end13
  %37 = load i32, ptr %ret, align 4
  %conv20 = sext i32 %37 to i64
  %38 = load ptr, ptr %ssl.addr, align 8
  %out_left21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 49
  %39 = load i64, ptr %out_left21, align 8
  %sub = sub i64 %39, %conv20
  store i64 %sub, ptr %out_left21, align 8
  br label %while.cond, !llvm.loop !12

while.end:                                        ; preds = %while.cond
  %40 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %40, i32 0, i32 0
  %41 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %41, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp22 = icmp eq i32 %bf.clear, 1
  br i1 %cmp22, label %if.then24, label %if.else

if.then24:                                        ; preds = %while.end
  %42 = load ptr, ptr %ssl.addr, align 8
  %out_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 41
  %43 = load ptr, ptr %out_buf, align 8
  %44 = load ptr, ptr %ssl.addr, align 8
  %out_hdr25 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %44, i32 0, i32 43
  store ptr %43, ptr %out_hdr25, align 8
  br label %if.end29

if.else:                                          ; preds = %while.end
  %45 = load ptr, ptr %ssl.addr, align 8
  %out_buf26 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %45, i32 0, i32 41
  %46 = load ptr, ptr %out_buf26, align 8
  %add.ptr27 = getelementptr inbounds i8, ptr %46, i64 8
  %47 = load ptr, ptr %ssl.addr, align 8
  %out_hdr28 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %47, i32 0, i32 43
  store ptr %add.ptr27, ptr %out_hdr28, align 8
  br label %if.end29

if.end29:                                         ; preds = %if.else, %if.then24
  %48 = load ptr, ptr %ssl.addr, align 8
  %49 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 17
  %50 = load ptr, ptr %transform_out, align 8
  call void @ssl_update_out_pointers(ptr noundef %48, ptr noundef %50)
  %51 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %51, i32 noundef 2, ptr noundef @.str, i32 noundef 2807, ptr noundef @.str.41)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end29, %if.then17, %if.then12, %if.then2, %if.then
  %52 = load i32, ptr %retval, align 4
  ret i32 %52
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i64 @mbedtls_ssl_hdr_len(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i64, align 8
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i64 13, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %entry
  store i64 5, ptr %retval, align 8
  br label %return

return:                                           ; preds = %if.end, %if.then
  %2 = load i64, ptr %retval, align 8
  ret i64 %2
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_update_out_pointers(ptr noundef %ssl, ptr noundef %transform) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %transform.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %transform, ptr %transform.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 43
  %3 = load ptr, ptr %out_hdr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %3, i64 3
  %4 = load ptr, ptr %ssl.addr, align 8
  %out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 42
  store ptr %add.ptr, ptr %out_ctr, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %out_hdr1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 43
  %6 = load ptr, ptr %out_hdr1, align 8
  %add.ptr2 = getelementptr inbounds i8, ptr %6, i64 11
  %7 = load ptr, ptr %ssl.addr, align 8
  %out_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 44
  store ptr %add.ptr2, ptr %out_len, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %out_hdr3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 43
  %9 = load ptr, ptr %out_hdr3, align 8
  %add.ptr4 = getelementptr inbounds i8, ptr %9, i64 13
  %10 = load ptr, ptr %ssl.addr, align 8
  %out_iv = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 45
  store ptr %add.ptr4, ptr %out_iv, align 8
  br label %if.end

if.else:                                          ; preds = %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  %out_hdr5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 43
  %12 = load ptr, ptr %out_hdr5, align 8
  %add.ptr6 = getelementptr inbounds i8, ptr %12, i64 -8
  %13 = load ptr, ptr %ssl.addr, align 8
  %out_ctr7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 42
  store ptr %add.ptr6, ptr %out_ctr7, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %out_hdr8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 43
  %15 = load ptr, ptr %out_hdr8, align 8
  %add.ptr9 = getelementptr inbounds i8, ptr %15, i64 3
  %16 = load ptr, ptr %ssl.addr, align 8
  %out_len10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 44
  store ptr %add.ptr9, ptr %out_len10, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %out_hdr11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 43
  %18 = load ptr, ptr %out_hdr11, align 8
  %add.ptr12 = getelementptr inbounds i8, ptr %18, i64 5
  %19 = load ptr, ptr %ssl.addr, align 8
  %out_iv13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 45
  store ptr %add.ptr12, ptr %out_iv13, align 8
  br label %if.end

if.end:                                           ; preds = %if.else, %if.then
  %20 = load ptr, ptr %transform.addr, align 8
  %cmp14 = icmp ne ptr %20, null
  br i1 %cmp14, label %land.lhs.true, label %if.else20

land.lhs.true:                                    ; preds = %if.end
  %21 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 5
  %22 = load i32, ptr %minor_ver, align 8
  %cmp15 = icmp sge i32 %22, 2
  br i1 %cmp15, label %if.then16, label %if.else20

if.then16:                                        ; preds = %land.lhs.true
  %23 = load ptr, ptr %ssl.addr, align 8
  %out_iv17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 45
  %24 = load ptr, ptr %out_iv17, align 8
  %25 = load ptr, ptr %transform.addr, align 8
  %ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %25, i32 0, i32 3
  %26 = load i64, ptr %ivlen, align 8
  %add.ptr18 = getelementptr inbounds i8, ptr %24, i64 %26
  %27 = load ptr, ptr %transform.addr, align 8
  %fixed_ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %27, i32 0, i32 4
  %28 = load i64, ptr %fixed_ivlen, align 8
  %idx.neg = sub i64 0, %28
  %add.ptr19 = getelementptr inbounds i8, ptr %add.ptr18, i64 %idx.neg
  %29 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 46
  store ptr %add.ptr19, ptr %out_msg, align 8
  br label %if.end23

if.else20:                                        ; preds = %land.lhs.true, %if.end
  %30 = load ptr, ptr %ssl.addr, align 8
  %out_iv21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 45
  %31 = load ptr, ptr %out_iv21, align 8
  %32 = load ptr, ptr %ssl.addr, align 8
  %out_msg22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 46
  store ptr %31, ptr %out_msg22, align 8
  br label %if.end23

if.end23:                                         ; preds = %if.else20, %if.then16
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_flight_transmit(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %max_frag_len = alloca i64, align 8
  %cur = alloca ptr, align 8
  %is_finished = alloca i32, align 4
  %force_flush = alloca i8, align 1
  %p61 = alloca ptr, align 8
  %hs_len = alloca i64, align 8
  %frag_off = alloca i64, align 8
  %rem_len = alloca i64, align 8
  %cur_hs_frag_len = alloca i64, align 8
  %max_hs_frag_len = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 2952, ptr noundef @.str.47)
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %retransmit_state = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 16
  %3 = load i8, ptr %retransmit_state, align 8
  %conv = zext i8 %3 to i32
  %cmp = icmp ne i32 %conv, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %4, i32 noundef 2, ptr noundef @.str, i32 noundef 2956, ptr noundef @.str.48)
  %5 = load ptr, ptr %ssl.addr, align 8
  %handshake2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 15
  %6 = load ptr, ptr %handshake2, align 8
  %flight = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 17
  %7 = load ptr, ptr %flight, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 15
  %9 = load ptr, ptr %handshake3, align 8
  %cur_msg = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 18
  store ptr %7, ptr %cur_msg, align 8
  %10 = load ptr, ptr %ssl.addr, align 8
  %handshake4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 15
  %11 = load ptr, ptr %handshake4, align 8
  %flight5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 17
  %12 = load ptr, ptr %flight5, align 8
  %p = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %12, i32 0, i32 0
  %13 = load ptr, ptr %p, align 8
  %add.ptr = getelementptr inbounds i8, ptr %13, i64 12
  %14 = load ptr, ptr %ssl.addr, align 8
  %handshake6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 15
  %15 = load ptr, ptr %handshake6, align 8
  %cur_msg_p = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %15, i32 0, i32 19
  store ptr %add.ptr, ptr %cur_msg_p, align 8
  %16 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_swap_epochs(ptr noundef %16)
  %17 = load ptr, ptr %ssl.addr, align 8
  %handshake7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 15
  %18 = load ptr, ptr %handshake7, align 8
  %retransmit_state8 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %18, i32 0, i32 16
  store i8 1, ptr %retransmit_state8, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  br label %while.cond

while.cond:                                       ; preds = %if.end167, %if.end83, %if.end51, %if.end
  %19 = load ptr, ptr %ssl.addr, align 8
  %handshake9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 15
  %20 = load ptr, ptr %handshake9, align 8
  %cur_msg10 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %20, i32 0, i32 18
  %21 = load ptr, ptr %cur_msg10, align 8
  %cmp11 = icmp ne ptr %21, null
  br i1 %cmp11, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %22 = load ptr, ptr %ssl.addr, align 8
  %handshake13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 15
  %23 = load ptr, ptr %handshake13, align 8
  %cur_msg14 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %23, i32 0, i32 18
  %24 = load ptr, ptr %cur_msg14, align 8
  store ptr %24, ptr %cur, align 8
  %25 = load ptr, ptr %cur, align 8
  %type = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %25, i32 0, i32 2
  %26 = load i8, ptr %type, align 8
  %conv15 = zext i8 %26 to i32
  %cmp16 = icmp eq i32 %conv15, 22
  br i1 %cmp16, label %land.rhs, label %land.end

land.rhs:                                         ; preds = %while.body
  %27 = load ptr, ptr %cur, align 8
  %p18 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %27, i32 0, i32 0
  %28 = load ptr, ptr %p18, align 8
  %arrayidx = getelementptr inbounds i8, ptr %28, i64 0
  %29 = load i8, ptr %arrayidx, align 1
  %conv19 = zext i8 %29 to i32
  %cmp20 = icmp eq i32 %conv19, 20
  br label %land.end

land.end:                                         ; preds = %land.rhs, %while.body
  %30 = phi i1 [ false, %while.body ], [ %cmp20, %land.rhs ]
  %land.ext = zext i1 %30 to i32
  store i32 %land.ext, ptr %is_finished, align 4
  %31 = load ptr, ptr %ssl.addr, align 8
  %disable_datagram_packing = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 40
  %32 = load i8, ptr %disable_datagram_packing, align 8
  %conv22 = zext i8 %32 to i32
  %cmp23 = icmp eq i32 %conv22, 1
  %33 = zext i1 %cmp23 to i64
  %cond = select i1 %cmp23, i32 1, i32 0
  %conv25 = trunc i32 %cond to i8
  store i8 %conv25, ptr %force_flush, align 1
  %34 = load i32, ptr %is_finished, align 4
  %tobool = icmp ne i32 %34, 0
  br i1 %tobool, label %land.lhs.true, label %if.end33

land.lhs.true:                                    ; preds = %land.end
  %35 = load ptr, ptr %ssl.addr, align 8
  %handshake26 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 15
  %36 = load ptr, ptr %handshake26, align 8
  %cur_msg_p27 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %36, i32 0, i32 19
  %37 = load ptr, ptr %cur_msg_p27, align 8
  %38 = load ptr, ptr %cur, align 8
  %p28 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %38, i32 0, i32 0
  %39 = load ptr, ptr %p28, align 8
  %add.ptr29 = getelementptr inbounds i8, ptr %39, i64 12
  %cmp30 = icmp eq ptr %37, %add.ptr29
  br i1 %cmp30, label %if.then32, label %if.end33

if.then32:                                        ; preds = %land.lhs.true
  %40 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %40, i32 noundef 2, ptr noundef @.str, i32 noundef 2982, ptr noundef @.str.49)
  %41 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_swap_epochs(ptr noundef %41)
  br label %if.end33

if.end33:                                         ; preds = %if.then32, %land.lhs.true, %land.end
  %42 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_get_remaining_payload_in_datagram(ptr noundef %42)
  store i32 %call, ptr %ret, align 4
  %43 = load i32, ptr %ret, align 4
  %cmp34 = icmp slt i32 %43, 0
  br i1 %cmp34, label %if.then36, label %if.end37

if.then36:                                        ; preds = %if.end33
  %44 = load i32, ptr %ret, align 4
  store i32 %44, ptr %retval, align 4
  br label %return

if.end37:                                         ; preds = %if.end33
  %45 = load i32, ptr %ret, align 4
  %conv38 = sext i32 %45 to i64
  store i64 %conv38, ptr %max_frag_len, align 8
  %46 = load ptr, ptr %cur, align 8
  %type39 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %46, i32 0, i32 2
  %47 = load i8, ptr %type39, align 8
  %conv40 = zext i8 %47 to i32
  %cmp41 = icmp eq i32 %conv40, 20
  br i1 %cmp41, label %if.then43, label %if.else

if.then43:                                        ; preds = %if.end37
  %48 = load i64, ptr %max_frag_len, align 8
  %cmp44 = icmp eq i64 %48, 0
  br i1 %cmp44, label %if.then46, label %if.end52

if.then46:                                        ; preds = %if.then43
  %49 = load ptr, ptr %ssl.addr, align 8
  %call47 = call i32 @mbedtls_ssl_flush_output(ptr noundef %49)
  store i32 %call47, ptr %ret, align 4
  %cmp48 = icmp ne i32 %call47, 0
  br i1 %cmp48, label %if.then50, label %if.end51

if.then50:                                        ; preds = %if.then46
  %50 = load i32, ptr %ret, align 4
  store i32 %50, ptr %retval, align 4
  br label %return

if.end51:                                         ; preds = %if.then46
  br label %while.cond, !llvm.loop !13

if.end52:                                         ; preds = %if.then43
  %51 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %51, i32 0, i32 46
  %52 = load ptr, ptr %out_msg, align 8
  %53 = load ptr, ptr %cur, align 8
  %p53 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %53, i32 0, i32 0
  %54 = load ptr, ptr %p53, align 8
  %55 = load ptr, ptr %cur, align 8
  %len = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %55, i32 0, i32 1
  %56 = load i64, ptr %len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %52, ptr align 1 %54, i64 %56, i1 false)
  %57 = load ptr, ptr %cur, align 8
  %len54 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %57, i32 0, i32 1
  %58 = load i64, ptr %len54, align 8
  %59 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %59, i32 0, i32 48
  store i64 %58, ptr %out_msglen, align 8
  %60 = load ptr, ptr %cur, align 8
  %type55 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %60, i32 0, i32 2
  %61 = load i8, ptr %type55, align 8
  %conv56 = zext i8 %61 to i32
  %62 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %62, i32 0, i32 47
  store i32 %conv56, ptr %out_msgtype, align 8
  %63 = load ptr, ptr %cur, align 8
  %len57 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %63, i32 0, i32 1
  %64 = load i64, ptr %len57, align 8
  %65 = load ptr, ptr %ssl.addr, align 8
  %handshake58 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %65, i32 0, i32 15
  %66 = load ptr, ptr %handshake58, align 8
  %cur_msg_p59 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %66, i32 0, i32 19
  %67 = load ptr, ptr %cur_msg_p59, align 8
  %add.ptr60 = getelementptr inbounds i8, ptr %67, i64 %64
  store ptr %add.ptr60, ptr %cur_msg_p59, align 8
  br label %if.end136

if.else:                                          ; preds = %if.end37
  %68 = load ptr, ptr %ssl.addr, align 8
  %handshake62 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %68, i32 0, i32 15
  %69 = load ptr, ptr %handshake62, align 8
  %cur_msg_p63 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %69, i32 0, i32 19
  %70 = load ptr, ptr %cur_msg_p63, align 8
  store ptr %70, ptr %p61, align 8
  %71 = load ptr, ptr %cur, align 8
  %len64 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %71, i32 0, i32 1
  %72 = load i64, ptr %len64, align 8
  %sub = sub i64 %72, 12
  store i64 %sub, ptr %hs_len, align 8
  %73 = load ptr, ptr %p61, align 8
  %74 = load ptr, ptr %cur, align 8
  %p65 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %74, i32 0, i32 0
  %75 = load ptr, ptr %p65, align 8
  %add.ptr66 = getelementptr inbounds i8, ptr %75, i64 12
  %sub.ptr.lhs.cast = ptrtoint ptr %73 to i64
  %sub.ptr.rhs.cast = ptrtoint ptr %add.ptr66 to i64
  %sub.ptr.sub = sub i64 %sub.ptr.lhs.cast, %sub.ptr.rhs.cast
  store i64 %sub.ptr.sub, ptr %frag_off, align 8
  %76 = load i64, ptr %hs_len, align 8
  %77 = load i64, ptr %frag_off, align 8
  %sub67 = sub i64 %76, %77
  store i64 %sub67, ptr %rem_len, align 8
  %78 = load i64, ptr %max_frag_len, align 8
  %cmp68 = icmp ult i64 %78, 12
  br i1 %cmp68, label %if.then75, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.else
  %79 = load i64, ptr %max_frag_len, align 8
  %cmp70 = icmp eq i64 %79, 12
  br i1 %cmp70, label %land.lhs.true72, label %if.end84

land.lhs.true72:                                  ; preds = %lor.lhs.false
  %80 = load i64, ptr %hs_len, align 8
  %cmp73 = icmp ne i64 %80, 0
  br i1 %cmp73, label %if.then75, label %if.end84

if.then75:                                        ; preds = %land.lhs.true72, %if.else
  %81 = load i32, ptr %is_finished, align 4
  %tobool76 = icmp ne i32 %81, 0
  br i1 %tobool76, label %if.then77, label %if.end78

if.then77:                                        ; preds = %if.then75
  %82 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_swap_epochs(ptr noundef %82)
  br label %if.end78

if.end78:                                         ; preds = %if.then77, %if.then75
  %83 = load ptr, ptr %ssl.addr, align 8
  %call79 = call i32 @mbedtls_ssl_flush_output(ptr noundef %83)
  store i32 %call79, ptr %ret, align 4
  %cmp80 = icmp ne i32 %call79, 0
  br i1 %cmp80, label %if.then82, label %if.end83

if.then82:                                        ; preds = %if.end78
  %84 = load i32, ptr %ret, align 4
  store i32 %84, ptr %retval, align 4
  br label %return

if.end83:                                         ; preds = %if.end78
  br label %while.cond, !llvm.loop !13

if.end84:                                         ; preds = %land.lhs.true72, %lor.lhs.false
  %85 = load i64, ptr %max_frag_len, align 8
  %sub85 = sub i64 %85, 12
  store i64 %sub85, ptr %max_hs_frag_len, align 8
  %86 = load i64, ptr %rem_len, align 8
  %87 = load i64, ptr %max_hs_frag_len, align 8
  %cmp86 = icmp ugt i64 %86, %87
  br i1 %cmp86, label %cond.true, label %cond.false

cond.true:                                        ; preds = %if.end84
  %88 = load i64, ptr %max_hs_frag_len, align 8
  br label %cond.end

cond.false:                                       ; preds = %if.end84
  %89 = load i64, ptr %rem_len, align 8
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond88 = phi i64 [ %88, %cond.true ], [ %89, %cond.false ]
  store i64 %cond88, ptr %cur_hs_frag_len, align 8
  %90 = load i64, ptr %frag_off, align 8
  %cmp89 = icmp eq i64 %90, 0
  br i1 %cmp89, label %land.lhs.true91, label %if.end97

land.lhs.true91:                                  ; preds = %cond.end
  %91 = load i64, ptr %cur_hs_frag_len, align 8
  %92 = load i64, ptr %hs_len, align 8
  %cmp92 = icmp ne i64 %91, %92
  br i1 %cmp92, label %if.then94, label %if.end97

if.then94:                                        ; preds = %land.lhs.true91
  %93 = load ptr, ptr %ssl.addr, align 8
  %94 = load i64, ptr %cur_hs_frag_len, align 8
  %conv95 = trunc i64 %94 to i32
  %95 = load i64, ptr %max_hs_frag_len, align 8
  %conv96 = trunc i64 %95 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %93, i32 noundef 2, ptr noundef @.str, i32 noundef 3036, ptr noundef @.str.50, i32 noundef %conv95, i32 noundef %conv96)
  br label %if.end97

if.end97:                                         ; preds = %if.then94, %land.lhs.true91, %cond.end
  %96 = load ptr, ptr %ssl.addr, align 8
  %out_msg98 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %96, i32 0, i32 46
  %97 = load ptr, ptr %out_msg98, align 8
  %98 = load ptr, ptr %cur, align 8
  %p99 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %98, i32 0, i32 0
  %99 = load ptr, ptr %p99, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %97, ptr align 1 %99, i64 6, i1 false)
  %100 = load i64, ptr %frag_off, align 8
  %shr = lshr i64 %100, 16
  %and = and i64 %shr, 255
  %conv100 = trunc i64 %and to i8
  %101 = load ptr, ptr %ssl.addr, align 8
  %out_msg101 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %101, i32 0, i32 46
  %102 = load ptr, ptr %out_msg101, align 8
  %arrayidx102 = getelementptr inbounds i8, ptr %102, i64 6
  store i8 %conv100, ptr %arrayidx102, align 1
  %103 = load i64, ptr %frag_off, align 8
  %shr103 = lshr i64 %103, 8
  %and104 = and i64 %shr103, 255
  %conv105 = trunc i64 %and104 to i8
  %104 = load ptr, ptr %ssl.addr, align 8
  %out_msg106 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %104, i32 0, i32 46
  %105 = load ptr, ptr %out_msg106, align 8
  %arrayidx107 = getelementptr inbounds i8, ptr %105, i64 7
  store i8 %conv105, ptr %arrayidx107, align 1
  %106 = load i64, ptr %frag_off, align 8
  %and108 = and i64 %106, 255
  %conv109 = trunc i64 %and108 to i8
  %107 = load ptr, ptr %ssl.addr, align 8
  %out_msg110 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %107, i32 0, i32 46
  %108 = load ptr, ptr %out_msg110, align 8
  %arrayidx111 = getelementptr inbounds i8, ptr %108, i64 8
  store i8 %conv109, ptr %arrayidx111, align 1
  %109 = load i64, ptr %cur_hs_frag_len, align 8
  %shr112 = lshr i64 %109, 16
  %and113 = and i64 %shr112, 255
  %conv114 = trunc i64 %and113 to i8
  %110 = load ptr, ptr %ssl.addr, align 8
  %out_msg115 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %110, i32 0, i32 46
  %111 = load ptr, ptr %out_msg115, align 8
  %arrayidx116 = getelementptr inbounds i8, ptr %111, i64 9
  store i8 %conv114, ptr %arrayidx116, align 1
  %112 = load i64, ptr %cur_hs_frag_len, align 8
  %shr117 = lshr i64 %112, 8
  %and118 = and i64 %shr117, 255
  %conv119 = trunc i64 %and118 to i8
  %113 = load ptr, ptr %ssl.addr, align 8
  %out_msg120 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %113, i32 0, i32 46
  %114 = load ptr, ptr %out_msg120, align 8
  %arrayidx121 = getelementptr inbounds i8, ptr %114, i64 10
  store i8 %conv119, ptr %arrayidx121, align 1
  %115 = load i64, ptr %cur_hs_frag_len, align 8
  %and122 = and i64 %115, 255
  %conv123 = trunc i64 %and122 to i8
  %116 = load ptr, ptr %ssl.addr, align 8
  %out_msg124 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %116, i32 0, i32 46
  %117 = load ptr, ptr %out_msg124, align 8
  %arrayidx125 = getelementptr inbounds i8, ptr %117, i64 11
  store i8 %conv123, ptr %arrayidx125, align 1
  %118 = load ptr, ptr %ssl.addr, align 8
  %119 = load ptr, ptr %ssl.addr, align 8
  %out_msg126 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %119, i32 0, i32 46
  %120 = load ptr, ptr %out_msg126, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %118, i32 noundef 3, ptr noundef @.str, i32 noundef 3052, ptr noundef @.str.51, ptr noundef %120, i64 noundef 12)
  %121 = load ptr, ptr %ssl.addr, align 8
  %out_msg127 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %121, i32 0, i32 46
  %122 = load ptr, ptr %out_msg127, align 8
  %add.ptr128 = getelementptr inbounds i8, ptr %122, i64 12
  %123 = load ptr, ptr %p61, align 8
  %124 = load i64, ptr %cur_hs_frag_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr128, ptr align 1 %123, i64 %124, i1 false)
  %125 = load i64, ptr %cur_hs_frag_len, align 8
  %add = add i64 %125, 12
  %126 = load ptr, ptr %ssl.addr, align 8
  %out_msglen129 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %126, i32 0, i32 48
  store i64 %add, ptr %out_msglen129, align 8
  %127 = load ptr, ptr %cur, align 8
  %type130 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %127, i32 0, i32 2
  %128 = load i8, ptr %type130, align 8
  %conv131 = zext i8 %128 to i32
  %129 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype132 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %129, i32 0, i32 47
  store i32 %conv131, ptr %out_msgtype132, align 8
  %130 = load i64, ptr %cur_hs_frag_len, align 8
  %131 = load ptr, ptr %ssl.addr, align 8
  %handshake133 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %131, i32 0, i32 15
  %132 = load ptr, ptr %handshake133, align 8
  %cur_msg_p134 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %132, i32 0, i32 19
  %133 = load ptr, ptr %cur_msg_p134, align 8
  %add.ptr135 = getelementptr inbounds i8, ptr %133, i64 %130
  store ptr %add.ptr135, ptr %cur_msg_p134, align 8
  br label %if.end136

if.end136:                                        ; preds = %if.end97, %if.end52
  %134 = load ptr, ptr %ssl.addr, align 8
  %handshake137 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %134, i32 0, i32 15
  %135 = load ptr, ptr %handshake137, align 8
  %cur_msg_p138 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %135, i32 0, i32 19
  %136 = load ptr, ptr %cur_msg_p138, align 8
  %137 = load ptr, ptr %cur, align 8
  %p139 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %137, i32 0, i32 0
  %138 = load ptr, ptr %p139, align 8
  %139 = load ptr, ptr %cur, align 8
  %len140 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %139, i32 0, i32 1
  %140 = load i64, ptr %len140, align 8
  %add.ptr141 = getelementptr inbounds i8, ptr %138, i64 %140
  %cmp142 = icmp uge ptr %136, %add.ptr141
  br i1 %cmp142, label %if.then144, label %if.end162

if.then144:                                       ; preds = %if.end136
  %141 = load ptr, ptr %cur, align 8
  %next = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %141, i32 0, i32 3
  %142 = load ptr, ptr %next, align 8
  %cmp145 = icmp ne ptr %142, null
  br i1 %cmp145, label %if.then147, label %if.else156

if.then147:                                       ; preds = %if.then144
  %143 = load ptr, ptr %cur, align 8
  %next148 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %143, i32 0, i32 3
  %144 = load ptr, ptr %next148, align 8
  %145 = load ptr, ptr %ssl.addr, align 8
  %handshake149 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %145, i32 0, i32 15
  %146 = load ptr, ptr %handshake149, align 8
  %cur_msg150 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %146, i32 0, i32 18
  store ptr %144, ptr %cur_msg150, align 8
  %147 = load ptr, ptr %cur, align 8
  %next151 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %147, i32 0, i32 3
  %148 = load ptr, ptr %next151, align 8
  %p152 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %148, i32 0, i32 0
  %149 = load ptr, ptr %p152, align 8
  %add.ptr153 = getelementptr inbounds i8, ptr %149, i64 12
  %150 = load ptr, ptr %ssl.addr, align 8
  %handshake154 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %150, i32 0, i32 15
  %151 = load ptr, ptr %handshake154, align 8
  %cur_msg_p155 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %151, i32 0, i32 19
  store ptr %add.ptr153, ptr %cur_msg_p155, align 8
  br label %if.end161

if.else156:                                       ; preds = %if.then144
  %152 = load ptr, ptr %ssl.addr, align 8
  %handshake157 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %152, i32 0, i32 15
  %153 = load ptr, ptr %handshake157, align 8
  %cur_msg158 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %153, i32 0, i32 18
  store ptr null, ptr %cur_msg158, align 8
  %154 = load ptr, ptr %ssl.addr, align 8
  %handshake159 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %154, i32 0, i32 15
  %155 = load ptr, ptr %handshake159, align 8
  %cur_msg_p160 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %155, i32 0, i32 19
  store ptr null, ptr %cur_msg_p160, align 8
  br label %if.end161

if.end161:                                        ; preds = %if.else156, %if.then147
  br label %if.end162

if.end162:                                        ; preds = %if.end161, %if.end136
  %156 = load ptr, ptr %ssl.addr, align 8
  %157 = load i8, ptr %force_flush, align 1
  %call163 = call i32 @mbedtls_ssl_write_record(ptr noundef %156, i8 noundef zeroext %157)
  store i32 %call163, ptr %ret, align 4
  %cmp164 = icmp ne i32 %call163, 0
  br i1 %cmp164, label %if.then166, label %if.end167

if.then166:                                       ; preds = %if.end162
  %158 = load ptr, ptr %ssl.addr, align 8
  %159 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %158, i32 noundef 1, ptr noundef @.str, i32 noundef 3081, ptr noundef @.str.52, i32 noundef %159)
  %160 = load i32, ptr %ret, align 4
  store i32 %160, ptr %retval, align 4
  br label %return

if.end167:                                        ; preds = %if.end162
  br label %while.cond, !llvm.loop !13

while.end:                                        ; preds = %while.cond
  %161 = load ptr, ptr %ssl.addr, align 8
  %call168 = call i32 @mbedtls_ssl_flush_output(ptr noundef %161)
  store i32 %call168, ptr %ret, align 4
  %cmp169 = icmp ne i32 %call168, 0
  br i1 %cmp169, label %if.then171, label %if.end172

if.then171:                                       ; preds = %while.end
  %162 = load i32, ptr %ret, align 4
  store i32 %162, ptr %retval, align 4
  br label %return

if.end172:                                        ; preds = %while.end
  %163 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %163, i32 0, i32 1
  %164 = load i32, ptr %state, align 8
  %cmp173 = icmp eq i32 %164, 16
  br i1 %cmp173, label %if.then175, label %if.else178

if.then175:                                       ; preds = %if.end172
  %165 = load ptr, ptr %ssl.addr, align 8
  %handshake176 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %165, i32 0, i32 15
  %166 = load ptr, ptr %handshake176, align 8
  %retransmit_state177 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %166, i32 0, i32 16
  store i8 3, ptr %retransmit_state177, align 8
  br label %if.end182

if.else178:                                       ; preds = %if.end172
  %167 = load ptr, ptr %ssl.addr, align 8
  %handshake179 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %167, i32 0, i32 15
  %168 = load ptr, ptr %handshake179, align 8
  %retransmit_state180 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %168, i32 0, i32 16
  store i8 2, ptr %retransmit_state180, align 8
  %169 = load ptr, ptr %ssl.addr, align 8
  %170 = load ptr, ptr %ssl.addr, align 8
  %handshake181 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %170, i32 0, i32 15
  %171 = load ptr, ptr %handshake181, align 8
  %retransmit_timeout = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %171, i32 0, i32 15
  %172 = load i32, ptr %retransmit_timeout, align 4
  call void @ssl_set_timer(ptr noundef %169, i32 noundef %172)
  br label %if.end182

if.end182:                                        ; preds = %if.else178, %if.then175
  %173 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %173, i32 noundef 2, ptr noundef @.str, i32 noundef 3098, ptr noundef @.str.53)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end182, %if.then171, %if.then166, %if.then82, %if.then50, %if.then36
  %174 = load i32, ptr %retval, align 4
  ret i32 %174
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_swap_epochs(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %tmp_transform = alloca ptr, align 8
  %tmp_out_ctr = alloca [8 x i8], align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 17
  %1 = load ptr, ptr %transform_out, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 15
  %3 = load ptr, ptr %handshake, align 8
  %alt_transform_out = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 21
  %4 = load ptr, ptr %alt_transform_out, align 8
  %cmp = icmp eq ptr %1, %4
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 3, ptr noundef @.str, i32 noundef 2895, ptr noundef @.str.186)
  br label %return

if.end:                                           ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 3, ptr noundef @.str, i32 noundef 2899, ptr noundef @.str.187)
  %7 = load ptr, ptr %ssl.addr, align 8
  %transform_out1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 17
  %8 = load ptr, ptr %transform_out1, align 8
  store ptr %8, ptr %tmp_transform, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %handshake2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 15
  %10 = load ptr, ptr %handshake2, align 8
  %alt_transform_out3 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %10, i32 0, i32 21
  %11 = load ptr, ptr %alt_transform_out3, align 8
  %12 = load ptr, ptr %ssl.addr, align 8
  %transform_out4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 17
  store ptr %11, ptr %transform_out4, align 8
  %13 = load ptr, ptr %tmp_transform, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %handshake5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 15
  %15 = load ptr, ptr %handshake5, align 8
  %alt_transform_out6 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %15, i32 0, i32 21
  store ptr %13, ptr %alt_transform_out6, align 8
  %arraydecay = getelementptr inbounds [8 x i8], ptr %tmp_out_ctr, i64 0, i64 0
  %16 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 50
  %arraydecay7 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr, i64 0, i64 0
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %arraydecay, ptr align 8 %arraydecay7, i64 8, i1 false)
  %17 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 50
  %arraydecay9 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr8, i64 0, i64 0
  %18 = load ptr, ptr %ssl.addr, align 8
  %handshake10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 15
  %19 = load ptr, ptr %handshake10, align 8
  %alt_out_ctr = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %19, i32 0, i32 22
  %arraydecay11 = getelementptr inbounds [8 x i8], ptr %alt_out_ctr, i64 0, i64 0
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay9, ptr align 8 %arraydecay11, i64 8, i1 false)
  %20 = load ptr, ptr %ssl.addr, align 8
  %handshake12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 15
  %21 = load ptr, ptr %handshake12, align 8
  %alt_out_ctr13 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %21, i32 0, i32 22
  %arraydecay14 = getelementptr inbounds [8 x i8], ptr %alt_out_ctr13, i64 0, i64 0
  %arraydecay15 = getelementptr inbounds [8 x i8], ptr %tmp_out_ctr, i64 0, i64 0
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay14, ptr align 1 %arraydecay15, i64 8, i1 false)
  %22 = load ptr, ptr %ssl.addr, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %transform_out16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 17
  %24 = load ptr, ptr %transform_out16, align 8
  call void @ssl_update_out_pointers(ptr noundef %22, ptr noundef %24)
  br label %return

return:                                           ; preds = %if.end, %if.then
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_get_remaining_payload_in_datagram(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %remaining = alloca i64, align 8
  %expansion = alloca i64, align 8
  %max_len = alloca i64, align 8
  %mfl = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i64 16384, ptr %max_len, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_get_max_frag_len(ptr noundef %0)
  store i64 %call, ptr %mfl, align 8
  %1 = load i64, ptr %max_len, align 8
  %2 = load i64, ptr %mfl, align 8
  %cmp = icmp ugt i64 %1, %2
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %3 = load i64, ptr %mfl, align 8
  store i64 %3, ptr %max_len, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %4 = load i64, ptr %max_len, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 49
  %6 = load i64, ptr %out_left, align 8
  %cmp1 = icmp ule i64 %4, %6
  br i1 %cmp1, label %if.then2, label %if.end3

if.then2:                                         ; preds = %if.end
  store i32 0, ptr %retval, align 4
  br label %return

if.end3:                                          ; preds = %if.end
  %7 = load ptr, ptr %ssl.addr, align 8
  %out_left4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 49
  %8 = load i64, ptr %out_left4, align 8
  %9 = load i64, ptr %max_len, align 8
  %sub = sub i64 %9, %8
  store i64 %sub, ptr %max_len, align 8
  %10 = load ptr, ptr %ssl.addr, align 8
  %call5 = call i32 @ssl_get_remaining_space_in_datagram(ptr noundef %10)
  store i32 %call5, ptr %ret, align 4
  %11 = load i32, ptr %ret, align 4
  %cmp6 = icmp slt i32 %11, 0
  br i1 %cmp6, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end3
  %12 = load i32, ptr %ret, align 4
  store i32 %12, ptr %retval, align 4
  br label %return

if.end8:                                          ; preds = %if.end3
  %13 = load i32, ptr %ret, align 4
  %conv = sext i32 %13 to i64
  store i64 %conv, ptr %remaining, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %call9 = call i32 @mbedtls_ssl_get_record_expansion(ptr noundef %14)
  store i32 %call9, ptr %ret, align 4
  %15 = load i32, ptr %ret, align 4
  %cmp10 = icmp slt i32 %15, 0
  br i1 %cmp10, label %if.then12, label %if.end13

if.then12:                                        ; preds = %if.end8
  %16 = load i32, ptr %ret, align 4
  store i32 %16, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %if.end8
  %17 = load i32, ptr %ret, align 4
  %conv14 = sext i32 %17 to i64
  store i64 %conv14, ptr %expansion, align 8
  %18 = load i64, ptr %remaining, align 8
  %19 = load i64, ptr %expansion, align 8
  %cmp15 = icmp ule i64 %18, %19
  br i1 %cmp15, label %if.then17, label %if.end18

if.then17:                                        ; preds = %if.end13
  store i32 0, ptr %retval, align 4
  br label %return

if.end18:                                         ; preds = %if.end13
  %20 = load i64, ptr %expansion, align 8
  %21 = load i64, ptr %remaining, align 8
  %sub19 = sub i64 %21, %20
  store i64 %sub19, ptr %remaining, align 8
  %22 = load i64, ptr %remaining, align 8
  %23 = load i64, ptr %max_len, align 8
  %cmp20 = icmp uge i64 %22, %23
  br i1 %cmp20, label %if.then22, label %if.end23

if.then22:                                        ; preds = %if.end18
  %24 = load i64, ptr %max_len, align 8
  store i64 %24, ptr %remaining, align 8
  br label %if.end23

if.end23:                                         ; preds = %if.then22, %if.end18
  %25 = load i64, ptr %remaining, align 8
  %conv24 = trunc i64 %25 to i32
  store i32 %conv24, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end23, %if.then17, %if.then12, %if.then7, %if.then2
  %26 = load i32, ptr %retval, align 4
  ret i32 %26
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_write_record(ptr noundef %ssl, i8 noundef zeroext %force_flush) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %force_flush.addr = alloca i8, align 1
  %ret = alloca i32, align 4
  %done = alloca i32, align 4
  %len = alloca i64, align 8
  %flush = alloca i8, align 1
  %i = alloca i32, align 4
  %protected_record_size = alloca i64, align 8
  %remaining = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i8 %force_flush, ptr %force_flush.addr, align 1
  store i32 0, ptr %done, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 48
  %1 = load i64, ptr %out_msglen, align 8
  store i64 %1, ptr %len, align 8
  %2 = load i8, ptr %force_flush.addr, align 1
  store i8 %2, ptr %flush, align 1
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 3343, ptr noundef @.str.60)
  %4 = load i32, ptr %done, align 4
  %tobool = icmp ne i32 %4, 0
  br i1 %tobool, label %if.end72, label %if.then

if.then:                                          ; preds = %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 47
  %6 = load i32, ptr %out_msgtype, align 8
  %conv = trunc i32 %6 to i8
  %7 = load ptr, ptr %ssl.addr, align 8
  %out_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 43
  %8 = load ptr, ptr %out_hdr, align 8
  %arrayidx = getelementptr inbounds i8, ptr %8, i64 0
  store i8 %conv, ptr %arrayidx, align 1
  %9 = load ptr, ptr %ssl.addr, align 8
  %major_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 4
  %10 = load i32, ptr %major_ver, align 4
  %11 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 5
  %12 = load i32, ptr %minor_ver, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 0
  %14 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %14, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %15 = load ptr, ptr %ssl.addr, align 8
  %out_hdr1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 43
  %16 = load ptr, ptr %out_hdr1, align 8
  %add.ptr = getelementptr inbounds i8, ptr %16, i64 1
  call void @mbedtls_ssl_write_version(i32 noundef %10, i32 noundef %12, i32 noundef %bf.clear, ptr noundef %add.ptr)
  %17 = load ptr, ptr %ssl.addr, align 8
  %out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 42
  %18 = load ptr, ptr %out_ctr, align 8
  %19 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 50
  %arraydecay = getelementptr inbounds [8 x i8], ptr %cur_out_ctr, i64 0, i64 0
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %18, ptr align 8 %arraydecay, i64 8, i1 false)
  %20 = load i64, ptr %len, align 8
  %shr = lshr i64 %20, 8
  %conv2 = trunc i64 %shr to i8
  %21 = load ptr, ptr %ssl.addr, align 8
  %out_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 44
  %22 = load ptr, ptr %out_len, align 8
  %arrayidx3 = getelementptr inbounds i8, ptr %22, i64 0
  store i8 %conv2, ptr %arrayidx3, align 1
  %23 = load i64, ptr %len, align 8
  %conv4 = trunc i64 %23 to i8
  %24 = load ptr, ptr %ssl.addr, align 8
  %out_len5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 44
  %25 = load ptr, ptr %out_len5, align 8
  %arrayidx6 = getelementptr inbounds i8, ptr %25, i64 1
  store i8 %conv4, ptr %arrayidx6, align 1
  %26 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 17
  %27 = load ptr, ptr %transform_out, align 8
  %cmp = icmp ne ptr %27, null
  br i1 %cmp, label %if.then8, label %if.end20

if.then8:                                         ; preds = %if.then
  %28 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_encrypt_buf(ptr noundef %28)
  store i32 %call, ptr %ret, align 4
  %cmp9 = icmp ne i32 %call, 0
  br i1 %cmp9, label %if.then11, label %if.end

if.then11:                                        ; preds = %if.then8
  %29 = load ptr, ptr %ssl.addr, align 8
  %30 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %29, i32 noundef 1, ptr noundef @.str, i32 noundef 3392, ptr noundef @.str.61, i32 noundef %30)
  %31 = load i32, ptr %ret, align 4
  store i32 %31, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %if.then8
  %32 = load ptr, ptr %ssl.addr, align 8
  %out_msglen12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 48
  %33 = load i64, ptr %out_msglen12, align 8
  store i64 %33, ptr %len, align 8
  %34 = load i64, ptr %len, align 8
  %shr13 = lshr i64 %34, 8
  %conv14 = trunc i64 %shr13 to i8
  %35 = load ptr, ptr %ssl.addr, align 8
  %out_len15 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 44
  %36 = load ptr, ptr %out_len15, align 8
  %arrayidx16 = getelementptr inbounds i8, ptr %36, i64 0
  store i8 %conv14, ptr %arrayidx16, align 1
  %37 = load i64, ptr %len, align 8
  %conv17 = trunc i64 %37 to i8
  %38 = load ptr, ptr %ssl.addr, align 8
  %out_len18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 44
  %39 = load ptr, ptr %out_len18, align 8
  %arrayidx19 = getelementptr inbounds i8, ptr %39, i64 1
  store i8 %conv17, ptr %arrayidx19, align 1
  br label %if.end20

if.end20:                                         ; preds = %if.end, %if.then
  %40 = load i64, ptr %len, align 8
  %41 = load ptr, ptr %ssl.addr, align 8
  %call21 = call i64 @mbedtls_ssl_hdr_len(ptr noundef %41)
  %add = add i64 %40, %call21
  store i64 %add, ptr %protected_record_size, align 8
  %42 = load ptr, ptr %ssl.addr, align 8
  %conf22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 0
  %43 = load ptr, ptr %conf22, align 8
  %transport23 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %43, i32 0, i32 46
  %bf.load24 = load i32, ptr %transport23, align 4
  %bf.lshr25 = lshr i32 %bf.load24, 1
  %bf.clear26 = and i32 %bf.lshr25, 1
  %cmp27 = icmp eq i32 %bf.clear26, 1
  br i1 %cmp27, label %if.then29, label %if.end40

if.then29:                                        ; preds = %if.end20
  %44 = load ptr, ptr %ssl.addr, align 8
  %call30 = call i32 @ssl_get_remaining_space_in_datagram(ptr noundef %44)
  store i32 %call30, ptr %ret, align 4
  %45 = load i32, ptr %ret, align 4
  %cmp31 = icmp slt i32 %45, 0
  br i1 %cmp31, label %if.then33, label %if.end34

if.then33:                                        ; preds = %if.then29
  %46 = load i32, ptr %ret, align 4
  store i32 %46, ptr %retval, align 4
  br label %return

if.end34:                                         ; preds = %if.then29
  %47 = load i64, ptr %protected_record_size, align 8
  %48 = load i32, ptr %ret, align 4
  %conv35 = sext i32 %48 to i64
  %cmp36 = icmp ugt i64 %47, %conv35
  br i1 %cmp36, label %if.then38, label %if.end39

if.then38:                                        ; preds = %if.end34
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end39:                                         ; preds = %if.end34
  br label %if.end40

if.end40:                                         ; preds = %if.end39, %if.end20
  %49 = load ptr, ptr %ssl.addr, align 8
  %50 = load ptr, ptr %ssl.addr, align 8
  %out_hdr41 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %50, i32 0, i32 43
  %51 = load ptr, ptr %out_hdr41, align 8
  %arrayidx42 = getelementptr inbounds i8, ptr %51, i64 0
  %52 = load i8, ptr %arrayidx42, align 1
  %conv43 = zext i8 %52 to i32
  %53 = load ptr, ptr %ssl.addr, align 8
  %out_hdr44 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %53, i32 0, i32 43
  %54 = load ptr, ptr %out_hdr44, align 8
  %arrayidx45 = getelementptr inbounds i8, ptr %54, i64 1
  %55 = load i8, ptr %arrayidx45, align 1
  %conv46 = zext i8 %55 to i32
  %56 = load ptr, ptr %ssl.addr, align 8
  %out_hdr47 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %56, i32 0, i32 43
  %57 = load ptr, ptr %out_hdr47, align 8
  %arrayidx48 = getelementptr inbounds i8, ptr %57, i64 2
  %58 = load i8, ptr %arrayidx48, align 1
  %conv49 = zext i8 %58 to i32
  %59 = load i64, ptr %len, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %49, i32 noundef 3, ptr noundef @.str, i32 noundef 3423, ptr noundef @.str.62, i32 noundef %conv43, i32 noundef %conv46, i32 noundef %conv49, i64 noundef %59)
  %60 = load ptr, ptr %ssl.addr, align 8
  %61 = load ptr, ptr %ssl.addr, align 8
  %out_hdr50 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %61, i32 0, i32 43
  %62 = load ptr, ptr %out_hdr50, align 8
  %63 = load i64, ptr %protected_record_size, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %60, i32 noundef 4, ptr noundef @.str, i32 noundef 3426, ptr noundef @.str.63, ptr noundef %62, i64 noundef %63)
  %64 = load i64, ptr %protected_record_size, align 8
  %65 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %65, i32 0, i32 49
  %66 = load i64, ptr %out_left, align 8
  %add51 = add i64 %66, %64
  store i64 %add51, ptr %out_left, align 8
  %67 = load i64, ptr %protected_record_size, align 8
  %68 = load ptr, ptr %ssl.addr, align 8
  %out_hdr52 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %68, i32 0, i32 43
  %69 = load ptr, ptr %out_hdr52, align 8
  %add.ptr53 = getelementptr inbounds i8, ptr %69, i64 %67
  store ptr %add.ptr53, ptr %out_hdr52, align 8
  %70 = load ptr, ptr %ssl.addr, align 8
  %71 = load ptr, ptr %ssl.addr, align 8
  %transform_out54 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %71, i32 0, i32 17
  %72 = load ptr, ptr %transform_out54, align 8
  call void @ssl_update_out_pointers(ptr noundef %70, ptr noundef %72)
  store i32 8, ptr %i, align 4
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.end40
  %73 = load i32, ptr %i, align 4
  %conv55 = zext i32 %73 to i64
  %74 = load ptr, ptr %ssl.addr, align 8
  %call56 = call i64 @ssl_ep_len(ptr noundef %74)
  %cmp57 = icmp ugt i64 %conv55, %call56
  br i1 %cmp57, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %75 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr59 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %75, i32 0, i32 50
  %76 = load i32, ptr %i, align 4
  %sub = sub i32 %76, 1
  %idxprom = zext i32 %sub to i64
  %arrayidx60 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr59, i64 0, i64 %idxprom
  %77 = load i8, ptr %arrayidx60, align 1
  %inc = add i8 %77, 1
  store i8 %inc, ptr %arrayidx60, align 1
  %conv61 = zext i8 %inc to i32
  %cmp62 = icmp ne i32 %conv61, 0
  br i1 %cmp62, label %if.then64, label %if.end65

if.then64:                                        ; preds = %for.body
  br label %for.end

if.end65:                                         ; preds = %for.body
  br label %for.inc

for.inc:                                          ; preds = %if.end65
  %78 = load i32, ptr %i, align 4
  %dec = add i32 %78, -1
  store i32 %dec, ptr %i, align 4
  br label %for.cond, !llvm.loop !14

for.end:                                          ; preds = %if.then64, %for.cond
  %79 = load i32, ptr %i, align 4
  %conv66 = zext i32 %79 to i64
  %80 = load ptr, ptr %ssl.addr, align 8
  %call67 = call i64 @ssl_ep_len(ptr noundef %80)
  %cmp68 = icmp eq i64 %conv66, %call67
  br i1 %cmp68, label %if.then70, label %if.end71

if.then70:                                        ; preds = %for.end
  %81 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %81, i32 noundef 1, ptr noundef @.str, i32 noundef 3439, ptr noundef @.str.64)
  store i32 -27520, ptr %retval, align 4
  br label %return

if.end71:                                         ; preds = %for.end
  br label %if.end72

if.end72:                                         ; preds = %if.end71, %entry
  %82 = load ptr, ptr %ssl.addr, align 8
  %conf73 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %82, i32 0, i32 0
  %83 = load ptr, ptr %conf73, align 8
  %transport74 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %83, i32 0, i32 46
  %bf.load75 = load i32, ptr %transport74, align 4
  %bf.lshr76 = lshr i32 %bf.load75, 1
  %bf.clear77 = and i32 %bf.lshr76, 1
  %cmp78 = icmp eq i32 %bf.clear77, 1
  br i1 %cmp78, label %land.lhs.true, label %if.end95

land.lhs.true:                                    ; preds = %if.end72
  %84 = load i8, ptr %flush, align 1
  %conv80 = zext i8 %84 to i32
  %cmp81 = icmp eq i32 %conv80, 0
  br i1 %cmp81, label %if.then83, label %if.end95

if.then83:                                        ; preds = %land.lhs.true
  %85 = load ptr, ptr %ssl.addr, align 8
  %call84 = call i32 @ssl_get_remaining_payload_in_datagram(ptr noundef %85)
  store i32 %call84, ptr %ret, align 4
  %86 = load i32, ptr %ret, align 4
  %cmp85 = icmp slt i32 %86, 0
  br i1 %cmp85, label %if.then87, label %if.end88

if.then87:                                        ; preds = %if.then83
  %87 = load ptr, ptr %ssl.addr, align 8
  %88 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %87, i32 noundef 1, ptr noundef @.str, i32 noundef 3453, ptr noundef @.str.65, i32 noundef %88)
  %89 = load i32, ptr %ret, align 4
  store i32 %89, ptr %retval, align 4
  br label %return

if.end88:                                         ; preds = %if.then83
  %90 = load i32, ptr %ret, align 4
  %conv89 = sext i32 %90 to i64
  store i64 %conv89, ptr %remaining, align 8
  %91 = load i64, ptr %remaining, align 8
  %cmp90 = icmp eq i64 %91, 0
  br i1 %cmp90, label %if.then92, label %if.else

if.then92:                                        ; preds = %if.end88
  store i8 1, ptr %flush, align 1
  br label %if.end94

if.else:                                          ; preds = %if.end88
  %92 = load ptr, ptr %ssl.addr, align 8
  %93 = load i64, ptr %remaining, align 8
  %conv93 = trunc i64 %93 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %92, i32 noundef 2, ptr noundef @.str, i32 noundef 3464, ptr noundef @.str.66, i32 noundef %conv93)
  br label %if.end94

if.end94:                                         ; preds = %if.else, %if.then92
  br label %if.end95

if.end95:                                         ; preds = %if.end94, %land.lhs.true, %if.end72
  %94 = load i8, ptr %flush, align 1
  %conv96 = zext i8 %94 to i32
  %cmp97 = icmp eq i32 %conv96, 1
  br i1 %cmp97, label %land.lhs.true99, label %if.end104

land.lhs.true99:                                  ; preds = %if.end95
  %95 = load ptr, ptr %ssl.addr, align 8
  %call100 = call i32 @mbedtls_ssl_flush_output(ptr noundef %95)
  store i32 %call100, ptr %ret, align 4
  %cmp101 = icmp ne i32 %call100, 0
  br i1 %cmp101, label %if.then103, label %if.end104

if.then103:                                       ; preds = %land.lhs.true99
  %96 = load ptr, ptr %ssl.addr, align 8
  %97 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %96, i32 noundef 1, ptr noundef @.str, i32 noundef 3472, ptr noundef @.str.67, i32 noundef %97)
  %98 = load i32, ptr %ret, align 4
  store i32 %98, ptr %retval, align 4
  br label %return

if.end104:                                        ; preds = %land.lhs.true99, %if.end95
  %99 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %99, i32 noundef 2, ptr noundef @.str, i32 noundef 3476, ptr noundef @.str.68)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end104, %if.then103, %if.then87, %if.then70, %if.then38, %if.then33, %if.then11
  %100 = load i32, ptr %retval, align 4
  ret i32 %100
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_recv_flight_completed(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %flight = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 17
  %2 = load ptr, ptr %flight, align 8
  call void @ssl_flight_free(ptr noundef %2)
  %3 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 15
  %4 = load ptr, ptr %handshake1, align 8
  %flight2 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 17
  store ptr null, ptr %flight2, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 15
  %6 = load ptr, ptr %handshake3, align 8
  %cur_msg = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 18
  store ptr null, ptr %cur_msg, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %handshake4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 15
  %8 = load ptr, ptr %handshake4, align 8
  %in_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 12
  %9 = load i32, ptr %in_msg_seq, align 4
  %10 = load ptr, ptr %ssl.addr, align 8
  %handshake5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 15
  %11 = load ptr, ptr %handshake5, align 8
  %in_flight_start_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 20
  store i32 %9, ptr %in_flight_start_seq, align 8
  %12 = load ptr, ptr %ssl.addr, align 8
  %handshake6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 15
  %13 = load ptr, ptr %handshake6, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %13, i32 0, i32 23
  %seen_ccs = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 1
  store i8 0, ptr %seen_ccs, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_buffering_free(ptr noundef %14)
  %15 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_set_timer(ptr noundef %15, i32 noundef 0)
  %16 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 30
  %17 = load i32, ptr %in_msgtype, align 8
  %cmp = icmp eq i32 %17, 22
  br i1 %cmp, label %land.lhs.true, label %if.else

land.lhs.true:                                    ; preds = %entry
  %18 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 28
  %19 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %19, i64 0
  %20 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %20 to i32
  %cmp7 = icmp eq i32 %conv, 20
  br i1 %cmp7, label %if.then, label %if.else

if.then:                                          ; preds = %land.lhs.true
  %21 = load ptr, ptr %ssl.addr, align 8
  %handshake9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 15
  %22 = load ptr, ptr %handshake9, align 8
  %retransmit_state = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %22, i32 0, i32 16
  store i8 3, ptr %retransmit_state, align 8
  br label %if.end

if.else:                                          ; preds = %land.lhs.true, %entry
  %23 = load ptr, ptr %ssl.addr, align 8
  %handshake10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 15
  %24 = load ptr, ptr %handshake10, align 8
  %retransmit_state11 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %24, i32 0, i32 16
  store i8 0, ptr %retransmit_state11, align 8
  br label %if.end

if.end:                                           ; preds = %if.else, %if.then
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_flight_free(ptr noundef %flight) #0 {
entry:
  %flight.addr = alloca ptr, align 8
  %cur = alloca ptr, align 8
  %next = alloca ptr, align 8
  store ptr %flight, ptr %flight.addr, align 8
  %0 = load ptr, ptr %flight.addr, align 8
  store ptr %0, ptr %cur, align 8
  br label %while.cond

while.cond:                                       ; preds = %while.body, %entry
  %1 = load ptr, ptr %cur, align 8
  %cmp = icmp ne ptr %1, null
  br i1 %cmp, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %2 = load ptr, ptr %cur, align 8
  %next1 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %2, i32 0, i32 3
  %3 = load ptr, ptr %next1, align 8
  store ptr %3, ptr %next, align 8
  %4 = load ptr, ptr %cur, align 8
  %p = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %4, i32 0, i32 0
  %5 = load ptr, ptr %p, align 8
  call void @free(ptr noundef %5) #8
  %6 = load ptr, ptr %cur, align 8
  call void @free(ptr noundef %6) #8
  %7 = load ptr, ptr %next, align 8
  store ptr %7, ptr %cur, align 8
  br label %while.cond, !llvm.loop !15

while.end:                                        ; preds = %while.cond
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_buffering_free(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %offset = alloca i32, align 4
  %hs = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  %2 = load ptr, ptr %hs, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %for.end

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_free_buffered_record(ptr noundef %3)
  store i32 0, ptr %offset, align 4
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.end
  %4 = load i32, ptr %offset, align 4
  %cmp1 = icmp ult i32 %4, 4
  br i1 %cmp1, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %5 = load ptr, ptr %ssl.addr, align 8
  %6 = load i32, ptr %offset, align 4
  %conv = trunc i32 %6 to i8
  call void @ssl_buffering_free_slot(ptr noundef %5, i8 noundef zeroext %conv)
  br label %for.inc

for.inc:                                          ; preds = %for.body
  %7 = load i32, ptr %offset, align 4
  %inc = add i32 %7, 1
  store i32 %inc, ptr %offset, align 4
  br label %for.cond, !llvm.loop !16

for.end:                                          ; preds = %if.then, %for.cond
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_send_flight_completed(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_reset_retransmit_timeout(ptr noundef %0)
  %1 = load ptr, ptr %ssl.addr, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 15
  %3 = load ptr, ptr %handshake, align 8
  %retransmit_timeout = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 15
  %4 = load i32, ptr %retransmit_timeout, align 4
  call void @ssl_set_timer(ptr noundef %1, i32 noundef %4)
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 30
  %6 = load i32, ptr %in_msgtype, align 8
  %cmp = icmp eq i32 %6, 22
  br i1 %cmp, label %land.lhs.true, label %if.else

land.lhs.true:                                    ; preds = %entry
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 28
  %8 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %8, i64 0
  %9 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %9 to i32
  %cmp1 = icmp eq i32 %conv, 20
  br i1 %cmp1, label %if.then, label %if.else

if.then:                                          ; preds = %land.lhs.true
  %10 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 15
  %11 = load ptr, ptr %handshake3, align 8
  %retransmit_state = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 16
  store i8 3, ptr %retransmit_state, align 8
  br label %if.end

if.else:                                          ; preds = %land.lhs.true, %entry
  %12 = load ptr, ptr %ssl.addr, align 8
  %handshake4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 15
  %13 = load ptr, ptr %handshake4, align 8
  %retransmit_state5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %13, i32 0, i32 16
  store i8 2, ptr %retransmit_state5, align 8
  br label %if.end

if.end:                                           ; preds = %if.else, %if.then
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_reset_retransmit_timeout(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %hs_timeout_min = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 36
  %2 = load i32, ptr %hs_timeout_min, align 4
  %3 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 15
  %4 = load ptr, ptr %handshake, align 8
  %retransmit_timeout = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 15
  store i32 %2, ptr %retransmit_timeout, align 4
  %5 = load ptr, ptr %ssl.addr, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake1, align 8
  %retransmit_timeout2 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 15
  %8 = load i32, ptr %retransmit_timeout2, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 3, ptr noundef @.str, i32 noundef 240, ptr noundef @.str.184, i32 noundef %8)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_write_handshake_msg(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %hs_len = alloca i64, align 8
  %hs_type = alloca i8, align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 48
  %1 = load i64, ptr %out_msglen, align 8
  %sub = sub i64 %1, 4
  store i64 %sub, ptr %hs_len, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 46
  %3 = load ptr, ptr %out_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %3, i64 0
  %4 = load i8, ptr %arrayidx, align 1
  store i8 %4, ptr %hs_type, align 1
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 2, ptr noundef @.str, i32 noundef 3184, ptr noundef @.str.54)
  %6 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 47
  %7 = load i32, ptr %out_msgtype, align 8
  %cmp = icmp ne i32 %7, 22
  br i1 %cmp, label %land.lhs.true, label %if.end

land.lhs.true:                                    ; preds = %entry
  %8 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 47
  %9 = load i32, ptr %out_msgtype1, align 8
  %cmp2 = icmp ne i32 %9, 20
  br i1 %cmp2, label %if.then, label %if.end

if.then:                                          ; preds = %land.lhs.true
  %10 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %10, i32 noundef 1, ptr noundef @.str, i32 noundef 3199, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %land.lhs.true, %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 47
  %12 = load i32, ptr %out_msgtype3, align 8
  %cmp4 = icmp eq i32 %12, 22
  br i1 %cmp4, label %land.lhs.true5, label %land.lhs.true8

land.lhs.true5:                                   ; preds = %if.end
  %13 = load i8, ptr %hs_type, align 1
  %conv = zext i8 %13 to i32
  %cmp6 = icmp eq i32 %conv, 0
  br i1 %cmp6, label %if.end12, label %land.lhs.true8

land.lhs.true8:                                   ; preds = %land.lhs.true5, %if.end
  %14 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 15
  %15 = load ptr, ptr %handshake, align 8
  %cmp9 = icmp eq ptr %15, null
  br i1 %cmp9, label %if.then11, label %if.end12

if.then11:                                        ; preds = %land.lhs.true8
  %16 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %16, i32 noundef 1, ptr noundef @.str, i32 noundef 3210, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end12:                                         ; preds = %land.lhs.true8, %land.lhs.true5
  %17 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 0
  %18 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %18, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp13 = icmp eq i32 %bf.clear, 1
  br i1 %cmp13, label %land.lhs.true15, label %if.end25

land.lhs.true15:                                  ; preds = %if.end12
  %19 = load ptr, ptr %ssl.addr, align 8
  %handshake16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 15
  %20 = load ptr, ptr %handshake16, align 8
  %cmp17 = icmp ne ptr %20, null
  br i1 %cmp17, label %land.lhs.true19, label %if.end25

land.lhs.true19:                                  ; preds = %land.lhs.true15
  %21 = load ptr, ptr %ssl.addr, align 8
  %handshake20 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 15
  %22 = load ptr, ptr %handshake20, align 8
  %retransmit_state = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %22, i32 0, i32 16
  %23 = load i8, ptr %retransmit_state, align 8
  %conv21 = zext i8 %23 to i32
  %cmp22 = icmp eq i32 %conv21, 1
  br i1 %cmp22, label %if.then24, label %if.end25

if.then24:                                        ; preds = %land.lhs.true19
  %24 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %24, i32 noundef 1, ptr noundef @.str, i32 noundef 3219, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end25:                                         ; preds = %land.lhs.true19, %land.lhs.true15, %if.end12
  %25 = load ptr, ptr %ssl.addr, align 8
  %out_msglen26 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 48
  %26 = load i64, ptr %out_msglen26, align 8
  %cmp27 = icmp ugt i64 %26, 16384
  br i1 %cmp27, label %if.then29, label %if.end32

if.then29:                                        ; preds = %if.end25
  %27 = load ptr, ptr %ssl.addr, align 8
  %28 = load ptr, ptr %ssl.addr, align 8
  %out_msglen30 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 48
  %29 = load i64, ptr %out_msglen30, align 8
  %conv31 = trunc i64 %29 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %27, i32 noundef 1, ptr noundef @.str, i32 noundef 3237, ptr noundef @.str.55, i32 noundef %conv31, i32 noundef 16384)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end32:                                         ; preds = %if.end25
  %30 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype33 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 47
  %31 = load i32, ptr %out_msgtype33, align 8
  %cmp34 = icmp eq i32 %31, 22
  br i1 %cmp34, label %if.then36, label %if.end103

if.then36:                                        ; preds = %if.end32
  %32 = load i64, ptr %hs_len, align 8
  %shr = lshr i64 %32, 16
  %conv37 = trunc i64 %shr to i8
  %33 = load ptr, ptr %ssl.addr, align 8
  %out_msg38 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 46
  %34 = load ptr, ptr %out_msg38, align 8
  %arrayidx39 = getelementptr inbounds i8, ptr %34, i64 1
  store i8 %conv37, ptr %arrayidx39, align 1
  %35 = load i64, ptr %hs_len, align 8
  %shr40 = lshr i64 %35, 8
  %conv41 = trunc i64 %shr40 to i8
  %36 = load ptr, ptr %ssl.addr, align 8
  %out_msg42 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 46
  %37 = load ptr, ptr %out_msg42, align 8
  %arrayidx43 = getelementptr inbounds i8, ptr %37, i64 2
  store i8 %conv41, ptr %arrayidx43, align 1
  %38 = load i64, ptr %hs_len, align 8
  %conv44 = trunc i64 %38 to i8
  %39 = load ptr, ptr %ssl.addr, align 8
  %out_msg45 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 46
  %40 = load ptr, ptr %out_msg45, align 8
  %arrayidx46 = getelementptr inbounds i8, ptr %40, i64 3
  store i8 %conv44, ptr %arrayidx46, align 1
  %41 = load ptr, ptr %ssl.addr, align 8
  %conf47 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 0
  %42 = load ptr, ptr %conf47, align 8
  %transport48 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %42, i32 0, i32 46
  %bf.load49 = load i32, ptr %transport48, align 4
  %bf.lshr50 = lshr i32 %bf.load49, 1
  %bf.clear51 = and i32 %bf.lshr50, 1
  %cmp52 = icmp eq i32 %bf.clear51, 1
  br i1 %cmp52, label %if.then54, label %if.end94

if.then54:                                        ; preds = %if.then36
  %43 = load ptr, ptr %ssl.addr, align 8
  %out_msglen55 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %43, i32 0, i32 48
  %44 = load i64, ptr %out_msglen55, align 8
  %sub56 = sub i64 16384, %44
  %cmp57 = icmp ult i64 %sub56, 8
  br i1 %cmp57, label %if.then59, label %if.end61

if.then59:                                        ; preds = %if.then54
  %45 = load ptr, ptr %ssl.addr, align 8
  %46 = load i64, ptr %hs_len, align 8
  %conv60 = trunc i64 %46 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %45, i32 noundef 1, ptr noundef @.str, i32 noundef 3266, ptr noundef @.str.56, i32 noundef %conv60, i32 noundef 16372)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end61:                                         ; preds = %if.then54
  %47 = load ptr, ptr %ssl.addr, align 8
  %out_msg62 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %47, i32 0, i32 46
  %48 = load ptr, ptr %out_msg62, align 8
  %add.ptr = getelementptr inbounds i8, ptr %48, i64 12
  %49 = load ptr, ptr %ssl.addr, align 8
  %out_msg63 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 46
  %50 = load ptr, ptr %out_msg63, align 8
  %add.ptr64 = getelementptr inbounds i8, ptr %50, i64 4
  %51 = load i64, ptr %hs_len, align 8
  call void @llvm.memmove.p0.p0.i64(ptr align 1 %add.ptr, ptr align 1 %add.ptr64, i64 %51, i1 false)
  %52 = load ptr, ptr %ssl.addr, align 8
  %out_msglen65 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 48
  %53 = load i64, ptr %out_msglen65, align 8
  %add = add i64 %53, 8
  store i64 %add, ptr %out_msglen65, align 8
  %54 = load i8, ptr %hs_type, align 1
  %conv66 = zext i8 %54 to i32
  %cmp67 = icmp ne i32 %conv66, 0
  br i1 %cmp67, label %if.then69, label %if.else

if.then69:                                        ; preds = %if.end61
  %55 = load ptr, ptr %ssl.addr, align 8
  %handshake70 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %55, i32 0, i32 15
  %56 = load ptr, ptr %handshake70, align 8
  %out_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %56, i32 0, i32 11
  %57 = load i32, ptr %out_msg_seq, align 8
  %shr71 = lshr i32 %57, 8
  %and = and i32 %shr71, 255
  %conv72 = trunc i32 %and to i8
  %58 = load ptr, ptr %ssl.addr, align 8
  %out_msg73 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 46
  %59 = load ptr, ptr %out_msg73, align 8
  %arrayidx74 = getelementptr inbounds i8, ptr %59, i64 4
  store i8 %conv72, ptr %arrayidx74, align 1
  %60 = load ptr, ptr %ssl.addr, align 8
  %handshake75 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %60, i32 0, i32 15
  %61 = load ptr, ptr %handshake75, align 8
  %out_msg_seq76 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %61, i32 0, i32 11
  %62 = load i32, ptr %out_msg_seq76, align 8
  %and77 = and i32 %62, 255
  %conv78 = trunc i32 %and77 to i8
  %63 = load ptr, ptr %ssl.addr, align 8
  %out_msg79 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %63, i32 0, i32 46
  %64 = load ptr, ptr %out_msg79, align 8
  %arrayidx80 = getelementptr inbounds i8, ptr %64, i64 5
  store i8 %conv78, ptr %arrayidx80, align 1
  %65 = load ptr, ptr %ssl.addr, align 8
  %handshake81 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %65, i32 0, i32 15
  %66 = load ptr, ptr %handshake81, align 8
  %out_msg_seq82 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %66, i32 0, i32 11
  %67 = load i32, ptr %out_msg_seq82, align 8
  %inc = add i32 %67, 1
  store i32 %inc, ptr %out_msg_seq82, align 8
  br label %if.end87

if.else:                                          ; preds = %if.end61
  %68 = load ptr, ptr %ssl.addr, align 8
  %out_msg83 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %68, i32 0, i32 46
  %69 = load ptr, ptr %out_msg83, align 8
  %arrayidx84 = getelementptr inbounds i8, ptr %69, i64 4
  store i8 0, ptr %arrayidx84, align 1
  %70 = load ptr, ptr %ssl.addr, align 8
  %out_msg85 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %70, i32 0, i32 46
  %71 = load ptr, ptr %out_msg85, align 8
  %arrayidx86 = getelementptr inbounds i8, ptr %71, i64 5
  store i8 0, ptr %arrayidx86, align 1
  br label %if.end87

if.end87:                                         ; preds = %if.else, %if.then69
  %72 = load ptr, ptr %ssl.addr, align 8
  %out_msg88 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %72, i32 0, i32 46
  %73 = load ptr, ptr %out_msg88, align 8
  %add.ptr89 = getelementptr inbounds i8, ptr %73, i64 6
  call void @llvm.memset.p0.i64(ptr align 1 %add.ptr89, i8 0, i64 3, i1 false)
  %74 = load ptr, ptr %ssl.addr, align 8
  %out_msg90 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %74, i32 0, i32 46
  %75 = load ptr, ptr %out_msg90, align 8
  %add.ptr91 = getelementptr inbounds i8, ptr %75, i64 9
  %76 = load ptr, ptr %ssl.addr, align 8
  %out_msg92 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %76, i32 0, i32 46
  %77 = load ptr, ptr %out_msg92, align 8
  %add.ptr93 = getelementptr inbounds i8, ptr %77, i64 1
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr91, ptr align 1 %add.ptr93, i64 3, i1 false)
  br label %if.end94

if.end94:                                         ; preds = %if.end87, %if.then36
  %78 = load i8, ptr %hs_type, align 1
  %conv95 = zext i8 %78 to i32
  %cmp96 = icmp ne i32 %conv95, 0
  br i1 %cmp96, label %if.then98, label %if.end102

if.then98:                                        ; preds = %if.end94
  %79 = load ptr, ptr %ssl.addr, align 8
  %handshake99 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %79, i32 0, i32 15
  %80 = load ptr, ptr %handshake99, align 8
  %update_checksum = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %80, i32 0, i32 29
  %81 = load ptr, ptr %update_checksum, align 8
  %82 = load ptr, ptr %ssl.addr, align 8
  %83 = load ptr, ptr %ssl.addr, align 8
  %out_msg100 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %83, i32 0, i32 46
  %84 = load ptr, ptr %out_msg100, align 8
  %85 = load ptr, ptr %ssl.addr, align 8
  %out_msglen101 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %85, i32 0, i32 48
  %86 = load i64, ptr %out_msglen101, align 8
  call void %81(ptr noundef %82, ptr noundef %84, i64 noundef %86)
  br label %if.end102

if.end102:                                        ; preds = %if.then98, %if.end94
  br label %if.end103

if.end103:                                        ; preds = %if.end102, %if.end32
  %87 = load ptr, ptr %ssl.addr, align 8
  %conf104 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %87, i32 0, i32 0
  %88 = load ptr, ptr %conf104, align 8
  %transport105 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %88, i32 0, i32 46
  %bf.load106 = load i32, ptr %transport105, align 4
  %bf.lshr107 = lshr i32 %bf.load106, 1
  %bf.clear108 = and i32 %bf.lshr107, 1
  %cmp109 = icmp eq i32 %bf.clear108, 1
  br i1 %cmp109, label %land.lhs.true111, label %if.else124

land.lhs.true111:                                 ; preds = %if.end103
  %89 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype112 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %89, i32 0, i32 47
  %90 = load i32, ptr %out_msgtype112, align 8
  %cmp113 = icmp eq i32 %90, 22
  br i1 %cmp113, label %land.lhs.true115, label %if.then119

land.lhs.true115:                                 ; preds = %land.lhs.true111
  %91 = load i8, ptr %hs_type, align 1
  %conv116 = zext i8 %91 to i32
  %cmp117 = icmp eq i32 %conv116, 0
  br i1 %cmp117, label %if.else124, label %if.then119

if.then119:                                       ; preds = %land.lhs.true115, %land.lhs.true111
  %92 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_flight_append(ptr noundef %92)
  store i32 %call, ptr %ret, align 4
  %cmp120 = icmp ne i32 %call, 0
  br i1 %cmp120, label %if.then122, label %if.end123

if.then122:                                       ; preds = %if.then119
  %93 = load ptr, ptr %ssl.addr, align 8
  %94 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %93, i32 noundef 1, ptr noundef @.str, i32 noundef 3306, ptr noundef @.str.57, i32 noundef %94)
  %95 = load i32, ptr %ret, align 4
  store i32 %95, ptr %retval, align 4
  br label %return

if.end123:                                        ; preds = %if.then119
  br label %if.end130

if.else124:                                       ; preds = %land.lhs.true115, %if.end103
  %96 = load ptr, ptr %ssl.addr, align 8
  %call125 = call i32 @mbedtls_ssl_write_record(ptr noundef %96, i8 noundef zeroext 1)
  store i32 %call125, ptr %ret, align 4
  %cmp126 = icmp ne i32 %call125, 0
  br i1 %cmp126, label %if.then128, label %if.end129

if.then128:                                       ; preds = %if.else124
  %97 = load ptr, ptr %ssl.addr, align 8
  %98 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %97, i32 noundef 1, ptr noundef @.str, i32 noundef 3315, ptr noundef @.str.58, i32 noundef %98)
  %99 = load i32, ptr %ret, align 4
  store i32 %99, ptr %retval, align 4
  br label %return

if.end129:                                        ; preds = %if.else124
  br label %if.end130

if.end130:                                        ; preds = %if.end129, %if.end123
  %100 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %100, i32 noundef 2, ptr noundef @.str, i32 noundef 3320, ptr noundef @.str.59)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end130, %if.then128, %if.then122, %if.then59, %if.then29, %if.then24, %if.then11, %if.then
  %101 = load i32, ptr %retval, align 4
  ret i32 %101
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_flight_append(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %msg = alloca ptr, align 8
  %cur = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 2822, ptr noundef @.str.188)
  %1 = load ptr, ptr %ssl.addr, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 46
  %3 = load ptr, ptr %out_msg, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 48
  %5 = load i64, ptr %out_msglen, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %1, i32 noundef 4, ptr noundef @.str, i32 noundef 2824, ptr noundef @.str.189, ptr noundef %3, i64 noundef %5)
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef 32) #9
  store ptr %call, ptr %msg, align 8
  %cmp = icmp eq ptr %call, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 1, ptr noundef @.str, i32 noundef 2830, ptr noundef @.str.190, i64 noundef 32)
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %7 = load ptr, ptr %ssl.addr, align 8
  %out_msglen1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 48
  %8 = load i64, ptr %out_msglen1, align 8
  %call2 = call noalias ptr @calloc(i64 noundef 1, i64 noundef %8) #9
  %9 = load ptr, ptr %msg, align 8
  %p = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %9, i32 0, i32 0
  store ptr %call2, ptr %p, align 8
  %cmp3 = icmp eq ptr %call2, null
  br i1 %cmp3, label %if.then4, label %if.end6

if.then4:                                         ; preds = %if.end
  %10 = load ptr, ptr %ssl.addr, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %out_msglen5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 48
  %12 = load i64, ptr %out_msglen5, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %10, i32 noundef 1, ptr noundef @.str, i32 noundef 2836, ptr noundef @.str.190, i64 noundef %12)
  %13 = load ptr, ptr %msg, align 8
  call void @free(ptr noundef %13) #8
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end6:                                          ; preds = %if.end
  %14 = load ptr, ptr %msg, align 8
  %p7 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %14, i32 0, i32 0
  %15 = load ptr, ptr %p7, align 8
  %16 = load ptr, ptr %ssl.addr, align 8
  %out_msg8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 46
  %17 = load ptr, ptr %out_msg8, align 8
  %18 = load ptr, ptr %ssl.addr, align 8
  %out_msglen9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 48
  %19 = load i64, ptr %out_msglen9, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %15, ptr align 1 %17, i64 %19, i1 false)
  %20 = load ptr, ptr %ssl.addr, align 8
  %out_msglen10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 48
  %21 = load i64, ptr %out_msglen10, align 8
  %22 = load ptr, ptr %msg, align 8
  %len = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %22, i32 0, i32 1
  store i64 %21, ptr %len, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 47
  %24 = load i32, ptr %out_msgtype, align 8
  %conv = trunc i32 %24 to i8
  %25 = load ptr, ptr %msg, align 8
  %type = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %25, i32 0, i32 2
  store i8 %conv, ptr %type, align 8
  %26 = load ptr, ptr %msg, align 8
  %next = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %26, i32 0, i32 3
  store ptr null, ptr %next, align 8
  %27 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 15
  %28 = load ptr, ptr %handshake, align 8
  %flight = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %28, i32 0, i32 17
  %29 = load ptr, ptr %flight, align 8
  %cmp11 = icmp eq ptr %29, null
  br i1 %cmp11, label %if.then13, label %if.else

if.then13:                                        ; preds = %if.end6
  %30 = load ptr, ptr %msg, align 8
  %31 = load ptr, ptr %ssl.addr, align 8
  %handshake14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 15
  %32 = load ptr, ptr %handshake14, align 8
  %flight15 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %32, i32 0, i32 17
  store ptr %30, ptr %flight15, align 8
  br label %if.end23

if.else:                                          ; preds = %if.end6
  %33 = load ptr, ptr %ssl.addr, align 8
  %handshake16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 15
  %34 = load ptr, ptr %handshake16, align 8
  %flight17 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %34, i32 0, i32 17
  %35 = load ptr, ptr %flight17, align 8
  store ptr %35, ptr %cur, align 8
  br label %while.cond

while.cond:                                       ; preds = %while.body, %if.else
  %36 = load ptr, ptr %cur, align 8
  %next18 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %36, i32 0, i32 3
  %37 = load ptr, ptr %next18, align 8
  %cmp19 = icmp ne ptr %37, null
  br i1 %cmp19, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %38 = load ptr, ptr %cur, align 8
  %next21 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %38, i32 0, i32 3
  %39 = load ptr, ptr %next21, align 8
  store ptr %39, ptr %cur, align 8
  br label %while.cond, !llvm.loop !17

while.end:                                        ; preds = %while.cond
  %40 = load ptr, ptr %msg, align 8
  %41 = load ptr, ptr %cur, align 8
  %next22 = getelementptr inbounds %struct.mbedtls_ssl_flight_item, ptr %41, i32 0, i32 3
  store ptr %40, ptr %next22, align 8
  br label %if.end23

if.end23:                                         ; preds = %while.end, %if.then13
  %42 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %42, i32 noundef 2, ptr noundef @.str, i32 noundef 2858, ptr noundef @.str.191)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end23, %if.then4, %if.then
  %43 = load i32, ptr %retval, align 4
  ret i32 %43
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_write_version(i32 noundef %major, i32 noundef %minor, i32 noundef %transport, ptr noundef %ver) #0 {
entry:
  %major.addr = alloca i32, align 4
  %minor.addr = alloca i32, align 4
  %transport.addr = alloca i32, align 4
  %ver.addr = alloca ptr, align 8
  store i32 %major, ptr %major.addr, align 4
  store i32 %minor, ptr %minor.addr, align 4
  store i32 %transport, ptr %transport.addr, align 4
  store ptr %ver, ptr %ver.addr, align 8
  %0 = load i32, ptr %transport.addr, align 4
  %cmp = icmp eq i32 %0, 1
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %1 = load i32, ptr %minor.addr, align 4
  %cmp1 = icmp eq i32 %1, 2
  br i1 %cmp1, label %if.then2, label %if.end

if.then2:                                         ; preds = %if.then
  %2 = load i32, ptr %minor.addr, align 4
  %dec = add nsw i32 %2, -1
  store i32 %dec, ptr %minor.addr, align 4
  br label %if.end

if.end:                                           ; preds = %if.then2, %if.then
  %3 = load i32, ptr %major.addr, align 4
  %sub = sub nsw i32 %3, 2
  %sub3 = sub nsw i32 255, %sub
  %conv = trunc i32 %sub3 to i8
  %4 = load ptr, ptr %ver.addr, align 8
  %arrayidx = getelementptr inbounds i8, ptr %4, i64 0
  store i8 %conv, ptr %arrayidx, align 1
  %5 = load i32, ptr %minor.addr, align 4
  %sub4 = sub nsw i32 %5, 1
  %sub5 = sub nsw i32 255, %sub4
  %conv6 = trunc i32 %sub5 to i8
  %6 = load ptr, ptr %ver.addr, align 8
  %arrayidx7 = getelementptr inbounds i8, ptr %6, i64 1
  store i8 %conv6, ptr %arrayidx7, align 1
  br label %if.end12

if.else:                                          ; preds = %entry
  %7 = load i32, ptr %major.addr, align 4
  %conv8 = trunc i32 %7 to i8
  %8 = load ptr, ptr %ver.addr, align 8
  %arrayidx9 = getelementptr inbounds i8, ptr %8, i64 0
  store i8 %conv8, ptr %arrayidx9, align 1
  %9 = load i32, ptr %minor.addr, align 4
  %conv10 = trunc i32 %9 to i8
  %10 = load ptr, ptr %ver.addr, align 8
  %arrayidx11 = getelementptr inbounds i8, ptr %10, i64 1
  store i8 %conv10, ptr %arrayidx11, align 1
  br label %if.end12

if.end12:                                         ; preds = %if.else, %if.end
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_encrypt_buf(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %mode = alloca i32, align 4
  %auth_done = alloca i32, align 4
  %mac = alloca [48 x i8], align 16
  %ret = alloca i32, align 4
  %olen = alloca i64, align 8
  %ret70 = alloca i32, align 4
  %enc_msglen = alloca i64, align 8
  %olen71 = alloca i64, align 8
  %enc_msg = alloca ptr, align 8
  %add_data = alloca [13 x i8], align 1
  %iv = alloca [12 x i8], align 1
  %transform = alloca ptr, align 8
  %taglen = alloca i8, align 1
  %explicit_ivlen = alloca i64, align 8
  %i = alloca i8, align 1
  %ret169 = alloca i32, align 4
  %enc_msg170 = alloca ptr, align 8
  %enc_msglen171 = alloca i64, align 8
  %padlen = alloca i64, align 8
  %olen172 = alloca i64, align 8
  %i173 = alloca i64, align 8
  %mac270 = alloca [48 x i8], align 16
  %pseudo_hdr = alloca [13 x i8], align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 0, ptr %auth_done, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 1445, ptr noundef @.str.192)
  %1 = load ptr, ptr %ssl.addr, align 8
  %session_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 12
  %2 = load ptr, ptr %session_out, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 17
  %4 = load ptr, ptr %transform_out, align 8
  %cmp1 = icmp eq ptr %4, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 1, ptr noundef @.str, i32 noundef 1449, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %6 = load ptr, ptr %ssl.addr, align 8
  %transform_out2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 17
  %7 = load ptr, ptr %transform_out2, align 8
  %cipher_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %7, i32 0, i32 10
  %call = call i32 @mbedtls_cipher_get_cipher_mode(ptr noundef %cipher_ctx_enc)
  store i32 %call, ptr %mode, align 4
  %8 = load ptr, ptr %ssl.addr, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 46
  %10 = load ptr, ptr %out_msg, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 48
  %12 = load i64, ptr %out_msglen, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %8, i32 noundef 4, ptr noundef @.str, i32 noundef 1456, ptr noundef @.str.193, ptr noundef %10, i64 noundef %12)
  %13 = load i32, ptr %mode, align 4
  %cmp3 = icmp eq i32 %13, 7
  br i1 %cmp3, label %if.then8, label %lor.lhs.false4

lor.lhs.false4:                                   ; preds = %if.end
  %14 = load i32, ptr %mode, align 4
  %cmp5 = icmp eq i32 %14, 2
  br i1 %cmp5, label %land.lhs.true, label %if.end43

land.lhs.true:                                    ; preds = %lor.lhs.false4
  %15 = load ptr, ptr %ssl.addr, align 8
  %session_out6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 12
  %16 = load ptr, ptr %session_out6, align 8
  %encrypt_then_mac = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %16, i32 0, i32 13
  %17 = load i32, ptr %encrypt_then_mac, align 4
  %cmp7 = icmp eq i32 %17, 0
  br i1 %cmp7, label %if.then8, label %if.end43

if.then8:                                         ; preds = %land.lhs.true, %if.end
  %18 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 5
  %19 = load i32, ptr %minor_ver, align 8
  %cmp9 = icmp sge i32 %19, 1
  br i1 %cmp9, label %if.then10, label %if.else

if.then10:                                        ; preds = %if.then8
  %20 = load ptr, ptr %ssl.addr, align 8
  %transform_out11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 17
  %21 = load ptr, ptr %transform_out11, align 8
  %md_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %21, i32 0, i32 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 42
  %23 = load ptr, ptr %out_ctr, align 8
  %call12 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_enc, ptr noundef %23, i64 noundef 8)
  %24 = load ptr, ptr %ssl.addr, align 8
  %transform_out13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 17
  %25 = load ptr, ptr %transform_out13, align 8
  %md_ctx_enc14 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %25, i32 0, i32 8
  %26 = load ptr, ptr %ssl.addr, align 8
  %out_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 43
  %27 = load ptr, ptr %out_hdr, align 8
  %call15 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_enc14, ptr noundef %27, i64 noundef 3)
  %28 = load ptr, ptr %ssl.addr, align 8
  %transform_out16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 17
  %29 = load ptr, ptr %transform_out16, align 8
  %md_ctx_enc17 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %29, i32 0, i32 8
  %30 = load ptr, ptr %ssl.addr, align 8
  %out_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 44
  %31 = load ptr, ptr %out_len, align 8
  %call18 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_enc17, ptr noundef %31, i64 noundef 2)
  %32 = load ptr, ptr %ssl.addr, align 8
  %transform_out19 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 17
  %33 = load ptr, ptr %transform_out19, align 8
  %md_ctx_enc20 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %33, i32 0, i32 8
  %34 = load ptr, ptr %ssl.addr, align 8
  %out_msg21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %34, i32 0, i32 46
  %35 = load ptr, ptr %out_msg21, align 8
  %36 = load ptr, ptr %ssl.addr, align 8
  %out_msglen22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 48
  %37 = load i64, ptr %out_msglen22, align 8
  %call23 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_enc20, ptr noundef %35, i64 noundef %37)
  %38 = load ptr, ptr %ssl.addr, align 8
  %transform_out24 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 17
  %39 = load ptr, ptr %transform_out24, align 8
  %md_ctx_enc25 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %39, i32 0, i32 8
  %arraydecay = getelementptr inbounds [48 x i8], ptr %mac, i64 0, i64 0
  %call26 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx_enc25, ptr noundef %arraydecay)
  %40 = load ptr, ptr %ssl.addr, align 8
  %transform_out27 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %40, i32 0, i32 17
  %41 = load ptr, ptr %transform_out27, align 8
  %md_ctx_enc28 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %41, i32 0, i32 8
  %call29 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx_enc28)
  %42 = load ptr, ptr %ssl.addr, align 8
  %out_msg30 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 46
  %43 = load ptr, ptr %out_msg30, align 8
  %44 = load ptr, ptr %ssl.addr, align 8
  %out_msglen31 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %44, i32 0, i32 48
  %45 = load i64, ptr %out_msglen31, align 8
  %add.ptr = getelementptr inbounds i8, ptr %43, i64 %45
  %arraydecay32 = getelementptr inbounds [48 x i8], ptr %mac, i64 0, i64 0
  %46 = load ptr, ptr %ssl.addr, align 8
  %transform_out33 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 17
  %47 = load ptr, ptr %transform_out33, align 8
  %maclen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %47, i32 0, i32 5
  %48 = load i64, ptr %maclen, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr, ptr align 16 %arraydecay32, i64 %48, i1 false)
  br label %if.end34

if.else:                                          ; preds = %if.then8
  %49 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %49, i32 noundef 1, ptr noundef @.str, i32 noundef 1503, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end34:                                         ; preds = %if.then10
  %50 = load ptr, ptr %ssl.addr, align 8
  %51 = load ptr, ptr %ssl.addr, align 8
  %out_msg35 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %51, i32 0, i32 46
  %52 = load ptr, ptr %out_msg35, align 8
  %53 = load ptr, ptr %ssl.addr, align 8
  %out_msglen36 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %53, i32 0, i32 48
  %54 = load i64, ptr %out_msglen36, align 8
  %add.ptr37 = getelementptr inbounds i8, ptr %52, i64 %54
  %55 = load ptr, ptr %ssl.addr, align 8
  %transform_out38 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %55, i32 0, i32 17
  %56 = load ptr, ptr %transform_out38, align 8
  %maclen39 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %56, i32 0, i32 5
  %57 = load i64, ptr %maclen39, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %50, i32 noundef 4, ptr noundef @.str, i32 noundef 1509, ptr noundef @.str.194, ptr noundef %add.ptr37, i64 noundef %57)
  %58 = load ptr, ptr %ssl.addr, align 8
  %transform_out40 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 17
  %59 = load ptr, ptr %transform_out40, align 8
  %maclen41 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %59, i32 0, i32 5
  %60 = load i64, ptr %maclen41, align 8
  %61 = load ptr, ptr %ssl.addr, align 8
  %out_msglen42 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %61, i32 0, i32 48
  %62 = load i64, ptr %out_msglen42, align 8
  %add = add i64 %62, %60
  store i64 %add, ptr %out_msglen42, align 8
  %63 = load i32, ptr %auth_done, align 4
  %inc = add nsw i32 %63, 1
  store i32 %inc, ptr %auth_done, align 4
  br label %if.end43

if.end43:                                         ; preds = %if.end34, %land.lhs.true, %lor.lhs.false4
  %64 = load i32, ptr %mode, align 4
  %cmp44 = icmp eq i32 %64, 7
  br i1 %cmp44, label %if.then45, label %if.else63

if.then45:                                        ; preds = %if.end43
  store i64 0, ptr %olen, align 8
  %65 = load ptr, ptr %ssl.addr, align 8
  %66 = load ptr, ptr %ssl.addr, align 8
  %out_msglen46 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %66, i32 0, i32 48
  %67 = load i64, ptr %out_msglen46, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %65, i32 noundef 3, ptr noundef @.str, i32 noundef 1527, ptr noundef @.str.195, i64 noundef %67, i32 noundef 0)
  %68 = load ptr, ptr %ssl.addr, align 8
  %transform_out47 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %68, i32 0, i32 17
  %69 = load ptr, ptr %transform_out47, align 8
  %cipher_ctx_enc48 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %69, i32 0, i32 10
  %70 = load ptr, ptr %ssl.addr, align 8
  %transform_out49 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %70, i32 0, i32 17
  %71 = load ptr, ptr %transform_out49, align 8
  %iv_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %71, i32 0, i32 6
  %arraydecay50 = getelementptr inbounds [16 x i8], ptr %iv_enc, i64 0, i64 0
  %72 = load ptr, ptr %ssl.addr, align 8
  %transform_out51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %72, i32 0, i32 17
  %73 = load ptr, ptr %transform_out51, align 8
  %ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %73, i32 0, i32 3
  %74 = load i64, ptr %ivlen, align 8
  %75 = load ptr, ptr %ssl.addr, align 8
  %out_msg52 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %75, i32 0, i32 46
  %76 = load ptr, ptr %out_msg52, align 8
  %77 = load ptr, ptr %ssl.addr, align 8
  %out_msglen53 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %77, i32 0, i32 48
  %78 = load i64, ptr %out_msglen53, align 8
  %79 = load ptr, ptr %ssl.addr, align 8
  %out_msg54 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %79, i32 0, i32 46
  %80 = load ptr, ptr %out_msg54, align 8
  %call55 = call i32 @mbedtls_cipher_crypt(ptr noundef %cipher_ctx_enc48, ptr noundef %arraydecay50, i64 noundef %74, ptr noundef %76, i64 noundef %78, ptr noundef %80, ptr noundef %olen)
  store i32 %call55, ptr %ret, align 4
  %cmp56 = icmp ne i32 %call55, 0
  br i1 %cmp56, label %if.then57, label %if.end58

if.then57:                                        ; preds = %if.then45
  %81 = load ptr, ptr %ssl.addr, align 8
  %82 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %81, i32 noundef 1, ptr noundef @.str, i32 noundef 1535, ptr noundef @.str.196, i32 noundef %82)
  %83 = load i32, ptr %ret, align 4
  store i32 %83, ptr %retval, align 4
  br label %return

if.end58:                                         ; preds = %if.then45
  %84 = load ptr, ptr %ssl.addr, align 8
  %out_msglen59 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %84, i32 0, i32 48
  %85 = load i64, ptr %out_msglen59, align 8
  %86 = load i64, ptr %olen, align 8
  %cmp60 = icmp ne i64 %85, %86
  br i1 %cmp60, label %if.then61, label %if.end62

if.then61:                                        ; preds = %if.end58
  %87 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %87, i32 noundef 1, ptr noundef @.str, i32 noundef 1541, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end62:                                         ; preds = %if.end58
  br label %if.end318

if.else63:                                        ; preds = %if.end43
  %88 = load i32, ptr %mode, align 4
  %cmp64 = icmp eq i32 %88, 6
  br i1 %cmp64, label %if.then69, label %lor.lhs.false65

lor.lhs.false65:                                  ; preds = %if.else63
  %89 = load i32, ptr %mode, align 4
  %cmp66 = icmp eq i32 %89, 8
  br i1 %cmp66, label %if.then69, label %lor.lhs.false67

lor.lhs.false67:                                  ; preds = %lor.lhs.false65
  %90 = load i32, ptr %mode, align 4
  %cmp68 = icmp eq i32 %90, 10
  br i1 %cmp68, label %if.then69, label %if.else165

if.then69:                                        ; preds = %lor.lhs.false67, %lor.lhs.false65, %if.else63
  %91 = load ptr, ptr %ssl.addr, align 8
  %transform_out72 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %91, i32 0, i32 17
  %92 = load ptr, ptr %transform_out72, align 8
  store ptr %92, ptr %transform, align 8
  %93 = load ptr, ptr %transform, align 8
  %ciphersuite_info = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %93, i32 0, i32 0
  %94 = load ptr, ptr %ciphersuite_info, align 8
  %flags = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %94, i32 0, i32 9
  %95 = load i8, ptr %flags, align 4
  %conv = zext i8 %95 to i32
  %and = and i32 %conv, 2
  %tobool = icmp ne i32 %and, 0
  %96 = zext i1 %tobool to i64
  %cond = select i1 %tobool, i32 8, i32 16
  %conv73 = trunc i32 %cond to i8
  store i8 %conv73, ptr %taglen, align 1
  %97 = load ptr, ptr %transform, align 8
  %ivlen74 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %97, i32 0, i32 3
  %98 = load i64, ptr %ivlen74, align 8
  %99 = load ptr, ptr %transform, align 8
  %fixed_ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %99, i32 0, i32 4
  %100 = load i64, ptr %fixed_ivlen, align 8
  %sub = sub i64 %98, %100
  store i64 %sub, ptr %explicit_ivlen, align 8
  %arraydecay75 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  %101 = load ptr, ptr %ssl.addr, align 8
  %out_ctr76 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %101, i32 0, i32 42
  %102 = load ptr, ptr %out_ctr76, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %arraydecay75, ptr align 1 %102, i64 8, i1 false)
  %103 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %103, i32 0, i32 47
  %104 = load i32, ptr %out_msgtype, align 8
  %conv77 = trunc i32 %104 to i8
  %arrayidx = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 8
  store i8 %conv77, ptr %arrayidx, align 1
  %105 = load ptr, ptr %ssl.addr, align 8
  %major_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %105, i32 0, i32 4
  %106 = load i32, ptr %major_ver, align 4
  %107 = load ptr, ptr %ssl.addr, align 8
  %minor_ver78 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %107, i32 0, i32 5
  %108 = load i32, ptr %minor_ver78, align 8
  %109 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %109, i32 0, i32 0
  %110 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %110, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %arraydecay79 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  %add.ptr80 = getelementptr inbounds i8, ptr %arraydecay79, i64 9
  call void @mbedtls_ssl_write_version(i32 noundef %106, i32 noundef %108, i32 noundef %bf.clear, ptr noundef %add.ptr80)
  %111 = load ptr, ptr %ssl.addr, align 8
  %out_msglen81 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %111, i32 0, i32 48
  %112 = load i64, ptr %out_msglen81, align 8
  %shr = lshr i64 %112, 8
  %and82 = and i64 %shr, 255
  %conv83 = trunc i64 %and82 to i8
  %arrayidx84 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 11
  store i8 %conv83, ptr %arrayidx84, align 1
  %113 = load ptr, ptr %ssl.addr, align 8
  %out_msglen85 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %113, i32 0, i32 48
  %114 = load i64, ptr %out_msglen85, align 8
  %and86 = and i64 %114, 255
  %conv87 = trunc i64 %and86 to i8
  %arrayidx88 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 12
  store i8 %conv87, ptr %arrayidx88, align 1
  %115 = load ptr, ptr %ssl.addr, align 8
  %arraydecay89 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %115, i32 noundef 4, ptr noundef @.str, i32 noundef 1574, ptr noundef @.str.197, ptr noundef %arraydecay89, i64 noundef 13)
  %116 = load ptr, ptr %transform, align 8
  %ivlen90 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %116, i32 0, i32 3
  %117 = load i64, ptr %ivlen90, align 8
  %cmp91 = icmp eq i64 %117, 12
  br i1 %cmp91, label %land.lhs.true93, label %if.else107

land.lhs.true93:                                  ; preds = %if.then69
  %118 = load ptr, ptr %transform, align 8
  %fixed_ivlen94 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %118, i32 0, i32 4
  %119 = load i64, ptr %fixed_ivlen94, align 8
  %cmp95 = icmp eq i64 %119, 4
  br i1 %cmp95, label %if.then97, label %if.else107

if.then97:                                        ; preds = %land.lhs.true93
  %arraydecay98 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %120 = load ptr, ptr %transform, align 8
  %iv_enc99 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %120, i32 0, i32 6
  %arraydecay100 = getelementptr inbounds [16 x i8], ptr %iv_enc99, i64 0, i64 0
  %121 = load ptr, ptr %transform, align 8
  %fixed_ivlen101 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %121, i32 0, i32 4
  %122 = load i64, ptr %fixed_ivlen101, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %arraydecay98, ptr align 8 %arraydecay100, i64 %122, i1 false)
  %arraydecay102 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %123 = load ptr, ptr %transform, align 8
  %fixed_ivlen103 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %123, i32 0, i32 4
  %124 = load i64, ptr %fixed_ivlen103, align 8
  %add.ptr104 = getelementptr inbounds i8, ptr %arraydecay102, i64 %124
  %125 = load ptr, ptr %ssl.addr, align 8
  %out_ctr105 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %125, i32 0, i32 42
  %126 = load ptr, ptr %out_ctr105, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr104, ptr align 1 %126, i64 8, i1 false)
  %127 = load ptr, ptr %ssl.addr, align 8
  %out_iv = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %127, i32 0, i32 45
  %128 = load ptr, ptr %out_iv, align 8
  %129 = load ptr, ptr %ssl.addr, align 8
  %out_ctr106 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %129, i32 0, i32 42
  %130 = load ptr, ptr %out_ctr106, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %128, ptr align 1 %130, i64 8, i1 false)
  br label %if.end135

if.else107:                                       ; preds = %land.lhs.true93, %if.then69
  %131 = load ptr, ptr %transform, align 8
  %ivlen108 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %131, i32 0, i32 3
  %132 = load i64, ptr %ivlen108, align 8
  %cmp109 = icmp eq i64 %132, 12
  br i1 %cmp109, label %land.lhs.true111, label %if.else133

land.lhs.true111:                                 ; preds = %if.else107
  %133 = load ptr, ptr %transform, align 8
  %fixed_ivlen112 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %133, i32 0, i32 4
  %134 = load i64, ptr %fixed_ivlen112, align 8
  %cmp113 = icmp eq i64 %134, 12
  br i1 %cmp113, label %if.then115, label %if.else133

if.then115:                                       ; preds = %land.lhs.true111
  %arraydecay116 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %135 = load ptr, ptr %transform, align 8
  %iv_enc117 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %135, i32 0, i32 6
  %arraydecay118 = getelementptr inbounds [16 x i8], ptr %iv_enc117, i64 0, i64 0
  %136 = load ptr, ptr %transform, align 8
  %fixed_ivlen119 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %136, i32 0, i32 4
  %137 = load i64, ptr %fixed_ivlen119, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %arraydecay116, ptr align 8 %arraydecay118, i64 %137, i1 false)
  store i8 0, ptr %i, align 1
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.then115
  %138 = load i8, ptr %i, align 1
  %conv120 = zext i8 %138 to i32
  %cmp121 = icmp slt i32 %conv120, 8
  br i1 %cmp121, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %139 = load ptr, ptr %ssl.addr, align 8
  %out_ctr123 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %139, i32 0, i32 42
  %140 = load ptr, ptr %out_ctr123, align 8
  %141 = load i8, ptr %i, align 1
  %idxprom = zext i8 %141 to i64
  %arrayidx124 = getelementptr inbounds i8, ptr %140, i64 %idxprom
  %142 = load i8, ptr %arrayidx124, align 1
  %conv125 = zext i8 %142 to i32
  %143 = load i8, ptr %i, align 1
  %conv126 = zext i8 %143 to i32
  %add127 = add nsw i32 %conv126, 4
  %idxprom128 = sext i32 %add127 to i64
  %arrayidx129 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 %idxprom128
  %144 = load i8, ptr %arrayidx129, align 1
  %conv130 = zext i8 %144 to i32
  %xor = xor i32 %conv130, %conv125
  %conv131 = trunc i32 %xor to i8
  store i8 %conv131, ptr %arrayidx129, align 1
  br label %for.inc

for.inc:                                          ; preds = %for.body
  %145 = load i8, ptr %i, align 1
  %inc132 = add i8 %145, 1
  store i8 %inc132, ptr %i, align 1
  br label %for.cond, !llvm.loop !18

for.end:                                          ; preds = %for.cond
  br label %if.end134

if.else133:                                       ; preds = %land.lhs.true111, %if.else107
  %146 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %146, i32 noundef 1, ptr noundef @.str, i32 noundef 1600, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end134:                                        ; preds = %for.end
  br label %if.end135

if.end135:                                        ; preds = %if.end134, %if.then97
  %147 = load ptr, ptr %ssl.addr, align 8
  %arraydecay136 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %148 = load ptr, ptr %transform, align 8
  %ivlen137 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %148, i32 0, i32 3
  %149 = load i64, ptr %ivlen137, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %147, i32 noundef 4, ptr noundef @.str, i32 noundef 1605, ptr noundef @.str.198, ptr noundef %arraydecay136, i64 noundef %149)
  %150 = load ptr, ptr %ssl.addr, align 8
  %151 = load ptr, ptr %ssl.addr, align 8
  %out_iv138 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %151, i32 0, i32 45
  %152 = load ptr, ptr %out_iv138, align 8
  %153 = load i64, ptr %explicit_ivlen, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %150, i32 noundef 4, ptr noundef @.str, i32 noundef 1607, ptr noundef @.str.199, ptr noundef %152, i64 noundef %153)
  %154 = load ptr, ptr %ssl.addr, align 8
  %out_msg139 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %154, i32 0, i32 46
  %155 = load ptr, ptr %out_msg139, align 8
  store ptr %155, ptr %enc_msg, align 8
  %156 = load ptr, ptr %ssl.addr, align 8
  %out_msglen140 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %156, i32 0, i32 48
  %157 = load i64, ptr %out_msglen140, align 8
  store i64 %157, ptr %enc_msglen, align 8
  %158 = load i64, ptr %explicit_ivlen, align 8
  %159 = load ptr, ptr %ssl.addr, align 8
  %out_msglen141 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %159, i32 0, i32 48
  %160 = load i64, ptr %out_msglen141, align 8
  %add142 = add i64 %160, %158
  store i64 %add142, ptr %out_msglen141, align 8
  %161 = load ptr, ptr %ssl.addr, align 8
  %162 = load ptr, ptr %ssl.addr, align 8
  %out_msglen143 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %162, i32 0, i32 48
  %163 = load i64, ptr %out_msglen143, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %161, i32 noundef 3, ptr noundef @.str, i32 noundef 1618, ptr noundef @.str.200, i64 noundef %163)
  %164 = load ptr, ptr %transform, align 8
  %cipher_ctx_enc144 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %164, i32 0, i32 10
  %arraydecay145 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %165 = load ptr, ptr %transform, align 8
  %ivlen146 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %165, i32 0, i32 3
  %166 = load i64, ptr %ivlen146, align 8
  %arraydecay147 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  %167 = load ptr, ptr %enc_msg, align 8
  %168 = load i64, ptr %enc_msglen, align 8
  %169 = load ptr, ptr %enc_msg, align 8
  %170 = load ptr, ptr %enc_msg, align 8
  %171 = load i64, ptr %enc_msglen, align 8
  %add.ptr148 = getelementptr inbounds i8, ptr %170, i64 %171
  %172 = load i8, ptr %taglen, align 1
  %conv149 = zext i8 %172 to i64
  %call150 = call i32 @mbedtls_cipher_auth_encrypt(ptr noundef %cipher_ctx_enc144, ptr noundef %arraydecay145, i64 noundef %166, ptr noundef %arraydecay147, i64 noundef 13, ptr noundef %167, i64 noundef %168, ptr noundef %169, ptr noundef %olen71, ptr noundef %add.ptr148, i64 noundef %conv149)
  store i32 %call150, ptr %ret70, align 4
  %cmp151 = icmp ne i32 %call150, 0
  br i1 %cmp151, label %if.then153, label %if.end154

if.then153:                                       ; preds = %if.end135
  %173 = load ptr, ptr %ssl.addr, align 8
  %174 = load i32, ptr %ret70, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %173, i32 noundef 1, ptr noundef @.str, i32 noundef 1630, ptr noundef @.str.201, i32 noundef %174)
  %175 = load i32, ptr %ret70, align 4
  store i32 %175, ptr %retval, align 4
  br label %return

if.end154:                                        ; preds = %if.end135
  %176 = load i64, ptr %olen71, align 8
  %177 = load i64, ptr %enc_msglen, align 8
  %cmp155 = icmp ne i64 %176, %177
  br i1 %cmp155, label %if.then157, label %if.end158

if.then157:                                       ; preds = %if.end154
  %178 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %178, i32 noundef 1, ptr noundef @.str, i32 noundef 1636, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end158:                                        ; preds = %if.end154
  %179 = load i8, ptr %taglen, align 1
  %conv159 = zext i8 %179 to i64
  %180 = load ptr, ptr %ssl.addr, align 8
  %out_msglen160 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %180, i32 0, i32 48
  %181 = load i64, ptr %out_msglen160, align 8
  %add161 = add i64 %181, %conv159
  store i64 %add161, ptr %out_msglen160, align 8
  %182 = load i32, ptr %auth_done, align 4
  %inc162 = add nsw i32 %182, 1
  store i32 %inc162, ptr %auth_done, align 4
  %183 = load ptr, ptr %ssl.addr, align 8
  %184 = load ptr, ptr %enc_msg, align 8
  %185 = load i64, ptr %enc_msglen, align 8
  %add.ptr163 = getelementptr inbounds i8, ptr %184, i64 %185
  %186 = load i8, ptr %taglen, align 1
  %conv164 = zext i8 %186 to i64
  call void @mbedtls_debug_print_buf(ptr noundef %183, i32 noundef 4, ptr noundef @.str, i32 noundef 1643, ptr noundef @.str.202, ptr noundef %add.ptr163, i64 noundef %conv164)
  br label %if.end317

if.else165:                                       ; preds = %lor.lhs.false67
  %187 = load i32, ptr %mode, align 4
  %cmp166 = icmp eq i32 %187, 2
  br i1 %cmp166, label %if.then168, label %if.else315

if.then168:                                       ; preds = %if.else165
  store i64 0, ptr %olen172, align 8
  %188 = load ptr, ptr %ssl.addr, align 8
  %transform_out174 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %188, i32 0, i32 17
  %189 = load ptr, ptr %transform_out174, align 8
  %ivlen175 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %189, i32 0, i32 3
  %190 = load i64, ptr %ivlen175, align 8
  %191 = load ptr, ptr %ssl.addr, align 8
  %out_msglen176 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %191, i32 0, i32 48
  %192 = load i64, ptr %out_msglen176, align 8
  %add177 = add i64 %192, 1
  %193 = load ptr, ptr %ssl.addr, align 8
  %transform_out178 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %193, i32 0, i32 17
  %194 = load ptr, ptr %transform_out178, align 8
  %ivlen179 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %194, i32 0, i32 3
  %195 = load i64, ptr %ivlen179, align 8
  %rem = urem i64 %add177, %195
  %sub180 = sub i64 %190, %rem
  store i64 %sub180, ptr %padlen, align 8
  %196 = load i64, ptr %padlen, align 8
  %197 = load ptr, ptr %ssl.addr, align 8
  %transform_out181 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %197, i32 0, i32 17
  %198 = load ptr, ptr %transform_out181, align 8
  %ivlen182 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %198, i32 0, i32 3
  %199 = load i64, ptr %ivlen182, align 8
  %cmp183 = icmp eq i64 %196, %199
  br i1 %cmp183, label %if.then185, label %if.end186

if.then185:                                       ; preds = %if.then168
  store i64 0, ptr %padlen, align 8
  br label %if.end186

if.end186:                                        ; preds = %if.then185, %if.then168
  store i64 0, ptr %i173, align 8
  br label %for.cond187

for.cond187:                                      ; preds = %for.inc196, %if.end186
  %200 = load i64, ptr %i173, align 8
  %201 = load i64, ptr %padlen, align 8
  %cmp188 = icmp ule i64 %200, %201
  br i1 %cmp188, label %for.body190, label %for.end198

for.body190:                                      ; preds = %for.cond187
  %202 = load i64, ptr %padlen, align 8
  %conv191 = trunc i64 %202 to i8
  %203 = load ptr, ptr %ssl.addr, align 8
  %out_msg192 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %203, i32 0, i32 46
  %204 = load ptr, ptr %out_msg192, align 8
  %205 = load ptr, ptr %ssl.addr, align 8
  %out_msglen193 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %205, i32 0, i32 48
  %206 = load i64, ptr %out_msglen193, align 8
  %207 = load i64, ptr %i173, align 8
  %add194 = add i64 %206, %207
  %arrayidx195 = getelementptr inbounds i8, ptr %204, i64 %add194
  store i8 %conv191, ptr %arrayidx195, align 1
  br label %for.inc196

for.inc196:                                       ; preds = %for.body190
  %208 = load i64, ptr %i173, align 8
  %inc197 = add i64 %208, 1
  store i64 %inc197, ptr %i173, align 8
  br label %for.cond187, !llvm.loop !19

for.end198:                                       ; preds = %for.cond187
  %209 = load i64, ptr %padlen, align 8
  %add199 = add i64 %209, 1
  %210 = load ptr, ptr %ssl.addr, align 8
  %out_msglen200 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %210, i32 0, i32 48
  %211 = load i64, ptr %out_msglen200, align 8
  %add201 = add i64 %211, %add199
  store i64 %add201, ptr %out_msglen200, align 8
  %212 = load ptr, ptr %ssl.addr, align 8
  %out_msglen202 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %212, i32 0, i32 48
  %213 = load i64, ptr %out_msglen202, align 8
  store i64 %213, ptr %enc_msglen171, align 8
  %214 = load ptr, ptr %ssl.addr, align 8
  %out_msg203 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %214, i32 0, i32 46
  %215 = load ptr, ptr %out_msg203, align 8
  store ptr %215, ptr %enc_msg170, align 8
  %216 = load ptr, ptr %ssl.addr, align 8
  %minor_ver204 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %216, i32 0, i32 5
  %217 = load i32, ptr %minor_ver204, align 8
  %cmp205 = icmp sge i32 %217, 2
  br i1 %cmp205, label %if.then207, label %if.end232

if.then207:                                       ; preds = %for.end198
  %218 = load ptr, ptr %ssl.addr, align 8
  %conf208 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %218, i32 0, i32 0
  %219 = load ptr, ptr %conf208, align 8
  %f_rng = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %219, i32 0, i32 3
  %220 = load ptr, ptr %f_rng, align 8
  %221 = load ptr, ptr %ssl.addr, align 8
  %conf209 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %221, i32 0, i32 0
  %222 = load ptr, ptr %conf209, align 8
  %p_rng = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %222, i32 0, i32 4
  %223 = load ptr, ptr %p_rng, align 8
  %224 = load ptr, ptr %ssl.addr, align 8
  %transform_out210 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %224, i32 0, i32 17
  %225 = load ptr, ptr %transform_out210, align 8
  %iv_enc211 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %225, i32 0, i32 6
  %arraydecay212 = getelementptr inbounds [16 x i8], ptr %iv_enc211, i64 0, i64 0
  %226 = load ptr, ptr %ssl.addr, align 8
  %transform_out213 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %226, i32 0, i32 17
  %227 = load ptr, ptr %transform_out213, align 8
  %ivlen214 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %227, i32 0, i32 3
  %228 = load i64, ptr %ivlen214, align 8
  %call215 = call i32 %220(ptr noundef %223, ptr noundef %arraydecay212, i64 noundef %228)
  store i32 %call215, ptr %ret169, align 4
  %229 = load i32, ptr %ret169, align 4
  %cmp216 = icmp ne i32 %229, 0
  br i1 %cmp216, label %if.then218, label %if.end219

if.then218:                                       ; preds = %if.then207
  %230 = load i32, ptr %ret169, align 4
  store i32 %230, ptr %retval, align 4
  br label %return

if.end219:                                        ; preds = %if.then207
  %231 = load ptr, ptr %ssl.addr, align 8
  %out_iv220 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %231, i32 0, i32 45
  %232 = load ptr, ptr %out_iv220, align 8
  %233 = load ptr, ptr %ssl.addr, align 8
  %transform_out221 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %233, i32 0, i32 17
  %234 = load ptr, ptr %transform_out221, align 8
  %iv_enc222 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %234, i32 0, i32 6
  %arraydecay223 = getelementptr inbounds [16 x i8], ptr %iv_enc222, i64 0, i64 0
  %235 = load ptr, ptr %ssl.addr, align 8
  %transform_out224 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %235, i32 0, i32 17
  %236 = load ptr, ptr %transform_out224, align 8
  %ivlen225 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %236, i32 0, i32 3
  %237 = load i64, ptr %ivlen225, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %232, ptr align 8 %arraydecay223, i64 %237, i1 false)
  %238 = load ptr, ptr %ssl.addr, align 8
  %out_msg226 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %238, i32 0, i32 46
  %239 = load ptr, ptr %out_msg226, align 8
  store ptr %239, ptr %enc_msg170, align 8
  %240 = load ptr, ptr %ssl.addr, align 8
  %out_msglen227 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %240, i32 0, i32 48
  %241 = load i64, ptr %out_msglen227, align 8
  store i64 %241, ptr %enc_msglen171, align 8
  %242 = load ptr, ptr %ssl.addr, align 8
  %transform_out228 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %242, i32 0, i32 17
  %243 = load ptr, ptr %transform_out228, align 8
  %ivlen229 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %243, i32 0, i32 3
  %244 = load i64, ptr %ivlen229, align 8
  %245 = load ptr, ptr %ssl.addr, align 8
  %out_msglen230 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %245, i32 0, i32 48
  %246 = load i64, ptr %out_msglen230, align 8
  %add231 = add i64 %246, %244
  store i64 %add231, ptr %out_msglen230, align 8
  br label %if.end232

if.end232:                                        ; preds = %if.end219, %for.end198
  %247 = load ptr, ptr %ssl.addr, align 8
  %248 = load ptr, ptr %ssl.addr, align 8
  %out_msglen233 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %248, i32 0, i32 48
  %249 = load i64, ptr %out_msglen233, align 8
  %250 = load ptr, ptr %ssl.addr, align 8
  %transform_out234 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %250, i32 0, i32 17
  %251 = load ptr, ptr %transform_out234, align 8
  %ivlen235 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %251, i32 0, i32 3
  %252 = load i64, ptr %ivlen235, align 8
  %253 = load i64, ptr %padlen, align 8
  %add236 = add i64 %253, 1
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %247, i32 noundef 3, ptr noundef @.str, i32 noundef 1698, ptr noundef @.str.203, i64 noundef %249, i64 noundef %252, i64 noundef %add236)
  %254 = load ptr, ptr %ssl.addr, align 8
  %transform_out237 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %254, i32 0, i32 17
  %255 = load ptr, ptr %transform_out237, align 8
  %cipher_ctx_enc238 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %255, i32 0, i32 10
  %256 = load ptr, ptr %ssl.addr, align 8
  %transform_out239 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %256, i32 0, i32 17
  %257 = load ptr, ptr %transform_out239, align 8
  %iv_enc240 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %257, i32 0, i32 6
  %arraydecay241 = getelementptr inbounds [16 x i8], ptr %iv_enc240, i64 0, i64 0
  %258 = load ptr, ptr %ssl.addr, align 8
  %transform_out242 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %258, i32 0, i32 17
  %259 = load ptr, ptr %transform_out242, align 8
  %ivlen243 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %259, i32 0, i32 3
  %260 = load i64, ptr %ivlen243, align 8
  %261 = load ptr, ptr %enc_msg170, align 8
  %262 = load i64, ptr %enc_msglen171, align 8
  %263 = load ptr, ptr %enc_msg170, align 8
  %call244 = call i32 @mbedtls_cipher_crypt(ptr noundef %cipher_ctx_enc238, ptr noundef %arraydecay241, i64 noundef %260, ptr noundef %261, i64 noundef %262, ptr noundef %263, ptr noundef %olen172)
  store i32 %call244, ptr %ret169, align 4
  %cmp245 = icmp ne i32 %call244, 0
  br i1 %cmp245, label %if.then247, label %if.end248

if.then247:                                       ; preds = %if.end232
  %264 = load ptr, ptr %ssl.addr, align 8
  %265 = load i32, ptr %ret169, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %264, i32 noundef 1, ptr noundef @.str, i32 noundef 1706, ptr noundef @.str.196, i32 noundef %265)
  %266 = load i32, ptr %ret169, align 4
  store i32 %266, ptr %retval, align 4
  br label %return

if.end248:                                        ; preds = %if.end232
  %267 = load i64, ptr %enc_msglen171, align 8
  %268 = load i64, ptr %olen172, align 8
  %cmp249 = icmp ne i64 %267, %268
  br i1 %cmp249, label %if.then251, label %if.end252

if.then251:                                       ; preds = %if.end248
  %269 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %269, i32 noundef 1, ptr noundef @.str, i32 noundef 1712, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end252:                                        ; preds = %if.end248
  %270 = load ptr, ptr %ssl.addr, align 8
  %minor_ver253 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %270, i32 0, i32 5
  %271 = load i32, ptr %minor_ver253, align 8
  %cmp254 = icmp slt i32 %271, 2
  br i1 %cmp254, label %if.then256, label %if.end266

if.then256:                                       ; preds = %if.end252
  %272 = load ptr, ptr %ssl.addr, align 8
  %transform_out257 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %272, i32 0, i32 17
  %273 = load ptr, ptr %transform_out257, align 8
  %iv_enc258 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %273, i32 0, i32 6
  %arraydecay259 = getelementptr inbounds [16 x i8], ptr %iv_enc258, i64 0, i64 0
  %274 = load ptr, ptr %ssl.addr, align 8
  %transform_out260 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %274, i32 0, i32 17
  %275 = load ptr, ptr %transform_out260, align 8
  %cipher_ctx_enc261 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %275, i32 0, i32 10
  %iv262 = getelementptr inbounds %struct.mbedtls_cipher_context_t, ptr %cipher_ctx_enc261, i32 0, i32 7
  %arraydecay263 = getelementptr inbounds [16 x i8], ptr %iv262, i64 0, i64 0
  %276 = load ptr, ptr %ssl.addr, align 8
  %transform_out264 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %276, i32 0, i32 17
  %277 = load ptr, ptr %transform_out264, align 8
  %ivlen265 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %277, i32 0, i32 3
  %278 = load i64, ptr %ivlen265, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay259, ptr align 8 %arraydecay263, i64 %278, i1 false)
  br label %if.end266

if.end266:                                        ; preds = %if.then256, %if.end252
  %279 = load i32, ptr %auth_done, align 4
  %cmp267 = icmp eq i32 %279, 0
  br i1 %cmp267, label %if.then269, label %if.end314

if.then269:                                       ; preds = %if.end266
  %280 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %280, i32 noundef 3, ptr noundef @.str, i32 noundef 1743, ptr noundef @.str.204)
  %arraydecay271 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  %add.ptr272 = getelementptr inbounds i8, ptr %arraydecay271, i64 0
  %281 = load ptr, ptr %ssl.addr, align 8
  %out_ctr273 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %281, i32 0, i32 42
  %282 = load ptr, ptr %out_ctr273, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr272, ptr align 1 %282, i64 8, i1 false)
  %arraydecay274 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  %add.ptr275 = getelementptr inbounds i8, ptr %arraydecay274, i64 8
  %283 = load ptr, ptr %ssl.addr, align 8
  %out_hdr276 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %283, i32 0, i32 43
  %284 = load ptr, ptr %out_hdr276, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr275, ptr align 1 %284, i64 3, i1 false)
  %285 = load ptr, ptr %ssl.addr, align 8
  %out_msglen277 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %285, i32 0, i32 48
  %286 = load i64, ptr %out_msglen277, align 8
  %shr278 = lshr i64 %286, 8
  %and279 = and i64 %shr278, 255
  %conv280 = trunc i64 %and279 to i8
  %arrayidx281 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 11
  store i8 %conv280, ptr %arrayidx281, align 1
  %287 = load ptr, ptr %ssl.addr, align 8
  %out_msglen282 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %287, i32 0, i32 48
  %288 = load i64, ptr %out_msglen282, align 8
  %and283 = and i64 %288, 255
  %conv284 = trunc i64 %and283 to i8
  %arrayidx285 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 12
  store i8 %conv284, ptr %arrayidx285, align 1
  %289 = load ptr, ptr %ssl.addr, align 8
  %arraydecay286 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %289, i32 noundef 4, ptr noundef @.str, i32 noundef 1750, ptr noundef @.str.205, ptr noundef %arraydecay286, i64 noundef 13)
  %290 = load ptr, ptr %ssl.addr, align 8
  %transform_out287 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %290, i32 0, i32 17
  %291 = load ptr, ptr %transform_out287, align 8
  %md_ctx_enc288 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %291, i32 0, i32 8
  %arraydecay289 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  %call290 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_enc288, ptr noundef %arraydecay289, i64 noundef 13)
  %292 = load ptr, ptr %ssl.addr, align 8
  %transform_out291 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %292, i32 0, i32 17
  %293 = load ptr, ptr %transform_out291, align 8
  %md_ctx_enc292 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %293, i32 0, i32 8
  %294 = load ptr, ptr %ssl.addr, align 8
  %out_iv293 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %294, i32 0, i32 45
  %295 = load ptr, ptr %out_iv293, align 8
  %296 = load ptr, ptr %ssl.addr, align 8
  %out_msglen294 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %296, i32 0, i32 48
  %297 = load i64, ptr %out_msglen294, align 8
  %call295 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_enc292, ptr noundef %295, i64 noundef %297)
  %298 = load ptr, ptr %ssl.addr, align 8
  %transform_out296 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %298, i32 0, i32 17
  %299 = load ptr, ptr %transform_out296, align 8
  %md_ctx_enc297 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %299, i32 0, i32 8
  %arraydecay298 = getelementptr inbounds [48 x i8], ptr %mac270, i64 0, i64 0
  %call299 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx_enc297, ptr noundef %arraydecay298)
  %300 = load ptr, ptr %ssl.addr, align 8
  %transform_out300 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %300, i32 0, i32 17
  %301 = load ptr, ptr %transform_out300, align 8
  %md_ctx_enc301 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %301, i32 0, i32 8
  %call302 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx_enc301)
  %302 = load ptr, ptr %ssl.addr, align 8
  %out_iv303 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %302, i32 0, i32 45
  %303 = load ptr, ptr %out_iv303, align 8
  %304 = load ptr, ptr %ssl.addr, align 8
  %out_msglen304 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %304, i32 0, i32 48
  %305 = load i64, ptr %out_msglen304, align 8
  %add.ptr305 = getelementptr inbounds i8, ptr %303, i64 %305
  %arraydecay306 = getelementptr inbounds [48 x i8], ptr %mac270, i64 0, i64 0
  %306 = load ptr, ptr %ssl.addr, align 8
  %transform_out307 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %306, i32 0, i32 17
  %307 = load ptr, ptr %transform_out307, align 8
  %maclen308 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %307, i32 0, i32 5
  %308 = load i64, ptr %maclen308, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr305, ptr align 16 %arraydecay306, i64 %308, i1 false)
  %309 = load ptr, ptr %ssl.addr, align 8
  %transform_out309 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %309, i32 0, i32 17
  %310 = load ptr, ptr %transform_out309, align 8
  %maclen310 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %310, i32 0, i32 5
  %311 = load i64, ptr %maclen310, align 8
  %312 = load ptr, ptr %ssl.addr, align 8
  %out_msglen311 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %312, i32 0, i32 48
  %313 = load i64, ptr %out_msglen311, align 8
  %add312 = add i64 %313, %311
  store i64 %add312, ptr %out_msglen311, align 8
  %314 = load i32, ptr %auth_done, align 4
  %inc313 = add nsw i32 %314, 1
  store i32 %inc313, ptr %auth_done, align 4
  br label %if.end314

if.end314:                                        ; preds = %if.then269, %if.end266
  br label %if.end316

if.else315:                                       ; preds = %if.else165
  %315 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %315, i32 noundef 1, ptr noundef @.str, i32 noundef 1770, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end316:                                        ; preds = %if.end314
  br label %if.end317

if.end317:                                        ; preds = %if.end316, %if.end158
  br label %if.end318

if.end318:                                        ; preds = %if.end317, %if.end62
  %316 = load i32, ptr %auth_done, align 4
  %cmp319 = icmp ne i32 %316, 1
  br i1 %cmp319, label %if.then321, label %if.end322

if.then321:                                       ; preds = %if.end318
  %317 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %317, i32 noundef 1, ptr noundef @.str, i32 noundef 1777, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end322:                                        ; preds = %if.end318
  %318 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %318, i32 noundef 2, ptr noundef @.str, i32 noundef 1781, ptr noundef @.str.206)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end322, %if.then321, %if.else315, %if.then251, %if.then247, %if.then218, %if.then157, %if.then153, %if.else133, %if.then61, %if.then57, %if.else, %if.then
  %319 = load i32, ptr %retval, align 4
  ret i32 %319
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_get_remaining_space_in_datagram(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %bytes_written = alloca i64, align 8
  %mtu = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 49
  %1 = load i64, ptr %out_left, align 8
  store i64 %1, ptr %bytes_written, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @ssl_get_maximum_datagram_size(ptr noundef %2)
  store i64 %call, ptr %mtu, align 8
  %3 = load i64, ptr %bytes_written, align 8
  %4 = load i64, ptr %mtu, align 8
  %cmp = icmp ugt i64 %3, %4
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %5 = load i64, ptr %mtu, align 8
  %6 = load i64, ptr %bytes_written, align 8
  %sub = sub i64 %5, %6
  %conv = trunc i64 %sub to i32
  store i32 %conv, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %7 = load i32, ptr %retval, align 4
  ret i32 %7
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i64 @ssl_ep_len(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i64, align 8
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i64 2, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %entry
  store i64 0, ptr %retval, align 8
  br label %return

return:                                           ; preds = %if.end, %if.then
  %2 = load i64, ptr %retval, align 8
  ret i64 %2
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_prepare_handshake_record(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %recv_msg_seq = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 31
  %1 = load i64, ptr %in_msglen, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %2)
  %cmp = icmp ult i64 %1, %call
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_msglen1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 31
  %5 = load i64, ptr %in_msglen1, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 1, ptr noundef @.str, i32 noundef 3618, ptr noundef @.str.69, i64 noundef %5)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  %call2 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %6)
  %7 = load ptr, ptr %ssl.addr, align 8
  %call3 = call i32 @ssl_get_hs_total_len(ptr noundef %7)
  %conv = zext i32 %call3 to i64
  %add = add i64 %call2, %conv
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 37
  store i64 %add, ptr %in_hslen, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %10 = load ptr, ptr %ssl.addr, align 8
  %in_msglen4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 31
  %11 = load i64, ptr %in_msglen4, align 8
  %12 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 28
  %13 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %13, i64 0
  %14 = load i8, ptr %arrayidx, align 1
  %conv5 = zext i8 %14 to i32
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_hslen6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 37
  %16 = load i64, ptr %in_hslen6, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %9, i32 noundef 3, ptr noundef @.str, i32 noundef 3626, ptr noundef @.str.70, i64 noundef %11, i32 noundef %conv5, i64 noundef %16)
  %17 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 0
  %18 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %18, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp7 = icmp eq i32 %bf.clear, 1
  br i1 %cmp7, label %if.then9, label %if.else73

if.then9:                                         ; preds = %if.end
  %19 = load ptr, ptr %ssl.addr, align 8
  %in_msg10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 28
  %20 = load ptr, ptr %in_msg10, align 8
  %arrayidx11 = getelementptr inbounds i8, ptr %20, i64 4
  %21 = load i8, ptr %arrayidx11, align 1
  %conv12 = zext i8 %21 to i32
  %shl = shl i32 %conv12, 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %in_msg13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 28
  %23 = load ptr, ptr %in_msg13, align 8
  %arrayidx14 = getelementptr inbounds i8, ptr %23, i64 5
  %24 = load i8, ptr %arrayidx14, align 1
  %conv15 = zext i8 %24 to i32
  %or = or i32 %shl, %conv15
  store i32 %or, ptr %recv_msg_seq, align 4
  %25 = load ptr, ptr %ssl.addr, align 8
  %call16 = call i32 @ssl_check_hs_header(ptr noundef %25)
  %cmp17 = icmp ne i32 %call16, 0
  br i1 %cmp17, label %if.then19, label %if.end20

if.then19:                                        ; preds = %if.then9
  %26 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %26, i32 noundef 1, ptr noundef @.str, i32 noundef 3636, ptr noundef @.str.71)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end20:                                         ; preds = %if.then9
  %27 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 15
  %28 = load ptr, ptr %handshake, align 8
  %cmp21 = icmp ne ptr %28, null
  br i1 %cmp21, label %land.lhs.true, label %if.end67

land.lhs.true:                                    ; preds = %if.end20
  %29 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 1
  %30 = load i32, ptr %state, align 8
  %cmp23 = icmp ne i32 %30, 16
  br i1 %cmp23, label %land.lhs.true25, label %lor.lhs.false

land.lhs.true25:                                  ; preds = %land.lhs.true
  %31 = load i32, ptr %recv_msg_seq, align 4
  %32 = load ptr, ptr %ssl.addr, align 8
  %handshake26 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 15
  %33 = load ptr, ptr %handshake26, align 8
  %in_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %33, i32 0, i32 12
  %34 = load i32, ptr %in_msg_seq, align 4
  %cmp27 = icmp ne i32 %31, %34
  br i1 %cmp27, label %if.then38, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %land.lhs.true25, %land.lhs.true
  %35 = load ptr, ptr %ssl.addr, align 8
  %state29 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 1
  %36 = load i32, ptr %state29, align 8
  %cmp30 = icmp eq i32 %36, 16
  br i1 %cmp30, label %land.lhs.true32, label %if.end67

land.lhs.true32:                                  ; preds = %lor.lhs.false
  %37 = load ptr, ptr %ssl.addr, align 8
  %in_msg33 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %37, i32 0, i32 28
  %38 = load ptr, ptr %in_msg33, align 8
  %arrayidx34 = getelementptr inbounds i8, ptr %38, i64 0
  %39 = load i8, ptr %arrayidx34, align 1
  %conv35 = zext i8 %39 to i32
  %cmp36 = icmp ne i32 %conv35, 1
  br i1 %cmp36, label %if.then38, label %if.end67

if.then38:                                        ; preds = %land.lhs.true32, %land.lhs.true25
  %40 = load i32, ptr %recv_msg_seq, align 4
  %41 = load ptr, ptr %ssl.addr, align 8
  %handshake39 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 15
  %42 = load ptr, ptr %handshake39, align 8
  %in_msg_seq40 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %42, i32 0, i32 12
  %43 = load i32, ptr %in_msg_seq40, align 4
  %cmp41 = icmp ugt i32 %40, %43
  br i1 %cmp41, label %if.then43, label %if.end46

if.then43:                                        ; preds = %if.then38
  %44 = load ptr, ptr %ssl.addr, align 8
  %45 = load i32, ptr %recv_msg_seq, align 4
  %46 = load ptr, ptr %ssl.addr, align 8
  %handshake44 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 15
  %47 = load ptr, ptr %handshake44, align 8
  %in_msg_seq45 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %47, i32 0, i32 12
  %48 = load i32, ptr %in_msg_seq45, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %44, i32 noundef 2, ptr noundef @.str, i32 noundef 3650, ptr noundef @.str.72, i32 noundef %45, i32 noundef %48)
  store i32 -25728, ptr %retval, align 4
  br label %return

if.end46:                                         ; preds = %if.then38
  %49 = load i32, ptr %recv_msg_seq, align 4
  %50 = load ptr, ptr %ssl.addr, align 8
  %handshake47 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %50, i32 0, i32 15
  %51 = load ptr, ptr %handshake47, align 8
  %in_flight_start_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %51, i32 0, i32 20
  %52 = load i32, ptr %in_flight_start_seq, align 8
  %sub = sub i32 %52, 1
  %cmp48 = icmp eq i32 %49, %sub
  br i1 %cmp48, label %land.lhs.true50, label %if.else

land.lhs.true50:                                  ; preds = %if.end46
  %53 = load ptr, ptr %ssl.addr, align 8
  %in_msg51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %53, i32 0, i32 28
  %54 = load ptr, ptr %in_msg51, align 8
  %arrayidx52 = getelementptr inbounds i8, ptr %54, i64 0
  %55 = load i8, ptr %arrayidx52, align 1
  %conv53 = zext i8 %55 to i32
  %cmp54 = icmp ne i32 %conv53, 3
  br i1 %cmp54, label %if.then56, label %if.else

if.then56:                                        ; preds = %land.lhs.true50
  %56 = load ptr, ptr %ssl.addr, align 8
  %57 = load i32, ptr %recv_msg_seq, align 4
  %58 = load ptr, ptr %ssl.addr, align 8
  %handshake57 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 15
  %59 = load ptr, ptr %handshake57, align 8
  %in_flight_start_seq58 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %59, i32 0, i32 20
  %60 = load i32, ptr %in_flight_start_seq58, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %56, i32 noundef 2, ptr noundef @.str, i32 noundef 3663, ptr noundef @.str.73, i32 noundef %57, i32 noundef %60)
  %61 = load ptr, ptr %ssl.addr, align 8
  %call59 = call i32 @mbedtls_ssl_resend(ptr noundef %61)
  store i32 %call59, ptr %ret, align 4
  %cmp60 = icmp ne i32 %call59, 0
  br i1 %cmp60, label %if.then62, label %if.end63

if.then62:                                        ; preds = %if.then56
  %62 = load ptr, ptr %ssl.addr, align 8
  %63 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %62, i32 noundef 1, ptr noundef @.str, i32 noundef 3667, ptr noundef @.str.37, i32 noundef %63)
  %64 = load i32, ptr %ret, align 4
  store i32 %64, ptr %retval, align 4
  br label %return

if.end63:                                         ; preds = %if.then56
  br label %if.end66

if.else:                                          ; preds = %land.lhs.true50, %if.end46
  %65 = load ptr, ptr %ssl.addr, align 8
  %66 = load i32, ptr %recv_msg_seq, align 4
  %67 = load ptr, ptr %ssl.addr, align 8
  %handshake64 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %67, i32 0, i32 15
  %68 = load ptr, ptr %handshake64, align 8
  %in_msg_seq65 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %68, i32 0, i32 12
  %69 = load i32, ptr %in_msg_seq65, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %65, i32 noundef 2, ptr noundef @.str, i32 noundef 3676, ptr noundef @.str.74, i32 noundef %66, i32 noundef %69)
  br label %if.end66

if.end66:                                         ; preds = %if.else, %if.end63
  store i32 -25984, ptr %retval, align 4
  br label %return

if.end67:                                         ; preds = %land.lhs.true32, %lor.lhs.false, %if.end20
  %70 = load ptr, ptr %ssl.addr, align 8
  %call68 = call i32 @ssl_hs_is_proper_fragment(ptr noundef %70)
  %cmp69 = icmp eq i32 %call68, 1
  br i1 %cmp69, label %if.then71, label %if.end72

if.then71:                                        ; preds = %if.end67
  %71 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %71, i32 noundef 2, ptr noundef @.str, i32 noundef 3689, ptr noundef @.str.75)
  store i32 -25728, ptr %retval, align 4
  br label %return

if.end72:                                         ; preds = %if.end67
  br label %if.end80

if.else73:                                        ; preds = %if.end
  %72 = load ptr, ptr %ssl.addr, align 8
  %in_msglen74 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %72, i32 0, i32 31
  %73 = load i64, ptr %in_msglen74, align 8
  %74 = load ptr, ptr %ssl.addr, align 8
  %in_hslen75 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %74, i32 0, i32 37
  %75 = load i64, ptr %in_hslen75, align 8
  %cmp76 = icmp ult i64 %73, %75
  br i1 %cmp76, label %if.then78, label %if.end79

if.then78:                                        ; preds = %if.else73
  %76 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %76, i32 noundef 1, ptr noundef @.str, i32 noundef 3698, ptr noundef @.str.76)
  store i32 -28800, ptr %retval, align 4
  br label %return

if.end79:                                         ; preds = %if.else73
  br label %if.end80

if.end80:                                         ; preds = %if.end79, %if.end72
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end80, %if.then78, %if.then71, %if.end66, %if.then62, %if.then43, %if.then19, %if.then
  %77 = load i32, ptr %retval, align 4
  ret i32 %77
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i64, align 8
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i64 12, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %entry
  store i64 4, ptr %retval, align 8
  br label %return

return:                                           ; preds = %if.end, %if.then
  %2 = load i64, ptr %retval, align 8
  ret i64 %2
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_get_hs_total_len(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 28
  %1 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %1, i64 1
  %2 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %2 to i32
  %shl = shl i32 %conv, 16
  %3 = load ptr, ptr %ssl.addr, align 8
  %in_msg1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 28
  %4 = load ptr, ptr %in_msg1, align 8
  %arrayidx2 = getelementptr inbounds i8, ptr %4, i64 2
  %5 = load i8, ptr %arrayidx2, align 1
  %conv3 = zext i8 %5 to i32
  %shl4 = shl i32 %conv3, 8
  %or = or i32 %shl, %shl4
  %6 = load ptr, ptr %ssl.addr, align 8
  %in_msg5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 28
  %7 = load ptr, ptr %in_msg5, align 8
  %arrayidx6 = getelementptr inbounds i8, ptr %7, i64 3
  %8 = load i8, ptr %arrayidx6, align 1
  %conv7 = zext i8 %8 to i32
  %or8 = or i32 %or, %conv7
  ret i32 %or8
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_check_hs_header(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %msg_len = alloca i32, align 4
  %frag_off = alloca i32, align 4
  %frag_len = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_get_hs_total_len(ptr noundef %0)
  store i32 %call, ptr %msg_len, align 4
  %1 = load ptr, ptr %ssl.addr, align 8
  %call1 = call i32 @ssl_get_hs_frag_off(ptr noundef %1)
  store i32 %call1, ptr %frag_off, align 4
  %2 = load ptr, ptr %ssl.addr, align 8
  %call2 = call i32 @ssl_get_hs_frag_len(ptr noundef %2)
  store i32 %call2, ptr %frag_len, align 4
  %3 = load i32, ptr %frag_off, align 4
  %4 = load i32, ptr %msg_len, align 4
  %cmp = icmp ugt i32 %3, %4
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %5 = load i32, ptr %frag_len, align 4
  %6 = load i32, ptr %msg_len, align 4
  %7 = load i32, ptr %frag_off, align 4
  %sub = sub i32 %6, %7
  %cmp3 = icmp ugt i32 %5, %sub
  br i1 %cmp3, label %if.then4, label %if.end5

if.then4:                                         ; preds = %if.end
  store i32 -1, ptr %retval, align 4
  br label %return

if.end5:                                          ; preds = %if.end
  %8 = load i32, ptr %frag_len, align 4
  %add = add i32 %8, 12
  %conv = zext i32 %add to i64
  %9 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 31
  %10 = load i64, ptr %in_msglen, align 8
  %cmp6 = icmp ugt i64 %conv, %10
  br i1 %cmp6, label %if.then8, label %if.end9

if.then8:                                         ; preds = %if.end5
  store i32 -1, ptr %retval, align 4
  br label %return

if.end9:                                          ; preds = %if.end5
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end9, %if.then8, %if.then4, %if.then
  %11 = load i32, ptr %retval, align 4
  ret i32 %11
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_hs_is_proper_fragment(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 31
  %1 = load i64, ptr %in_msglen, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 37
  %3 = load i64, ptr %in_hslen, align 8
  %cmp = icmp ult i64 %1, %3
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 28
  %5 = load ptr, ptr %in_msg, align 8
  %add.ptr = getelementptr inbounds i8, ptr %5, i64 6
  %call = call i32 @memcmp(ptr noundef %add.ptr, ptr noundef @.str.207, i64 noundef 3) #7
  %cmp1 = icmp ne i32 %call, 0
  br i1 %cmp1, label %if.then, label %lor.lhs.false2

lor.lhs.false2:                                   ; preds = %lor.lhs.false
  %6 = load ptr, ptr %ssl.addr, align 8
  %in_msg3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 28
  %7 = load ptr, ptr %in_msg3, align 8
  %add.ptr4 = getelementptr inbounds i8, ptr %7, i64 9
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_msg5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 28
  %9 = load ptr, ptr %in_msg5, align 8
  %add.ptr6 = getelementptr inbounds i8, ptr %9, i64 1
  %call7 = call i32 @memcmp(ptr noundef %add.ptr4, ptr noundef %add.ptr6, i64 noundef 3) #7
  %cmp8 = icmp ne i32 %call7, 0
  br i1 %cmp8, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false2, %lor.lhs.false, %entry
  store i32 1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false2
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %10 = load i32, ptr %retval, align 4
  ret i32 %10
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_update_handshake_status(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %hs = alloca ptr, align 8
  %offset = alloca i32, align 4
  %hs_buf = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 1
  %3 = load i32, ptr %state, align 8
  %cmp = icmp ne i32 %3, 16
  br i1 %cmp, label %land.lhs.true, label %if.end

land.lhs.true:                                    ; preds = %entry
  %4 = load ptr, ptr %hs, align 8
  %cmp1 = icmp ne ptr %4, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %land.lhs.true
  %5 = load ptr, ptr %ssl.addr, align 8
  %handshake2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 15
  %6 = load ptr, ptr %handshake2, align 8
  %update_checksum = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 29
  %7 = load ptr, ptr %update_checksum, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 28
  %10 = load ptr, ptr %in_msg, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 37
  %12 = load i64, ptr %in_hslen, align 8
  call void %7(ptr noundef %8, ptr noundef %10, i64 noundef %12)
  br label %if.end

if.end:                                           ; preds = %if.then, %land.lhs.true, %entry
  %13 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 0
  %14 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %14, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp3 = icmp eq i32 %bf.clear, 1
  br i1 %cmp3, label %land.lhs.true4, label %if.end11

land.lhs.true4:                                   ; preds = %if.end
  %15 = load ptr, ptr %ssl.addr, align 8
  %handshake5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 15
  %16 = load ptr, ptr %handshake5, align 8
  %cmp6 = icmp ne ptr %16, null
  br i1 %cmp6, label %if.then7, label %if.end11

if.then7:                                         ; preds = %land.lhs.true4
  %17 = load ptr, ptr %hs, align 8
  %in_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %17, i32 0, i32 12
  %18 = load i32, ptr %in_msg_seq, align 4
  %inc = add i32 %18, 1
  store i32 %inc, ptr %in_msg_seq, align 4
  %19 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_buffering_free_slot(ptr noundef %19, i8 noundef zeroext 0)
  store i32 0, ptr %offset, align 4
  %20 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %20, i32 0, i32 23
  %hs8 = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 2
  %arrayidx = getelementptr inbounds [4 x %struct.mbedtls_ssl_hs_buffer], ptr %hs8, i64 0, i64 0
  store ptr %arrayidx, ptr %hs_buf, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.then7
  %21 = load i32, ptr %offset, align 4
  %add = add i32 %21, 1
  %cmp9 = icmp ult i32 %add, 4
  br i1 %cmp9, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %22 = load ptr, ptr %hs_buf, align 8
  %23 = load ptr, ptr %hs_buf, align 8
  %add.ptr = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %23, i64 1
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %22, ptr align 8 %add.ptr, i64 24, i1 false)
  br label %for.inc

for.inc:                                          ; preds = %for.body
  %24 = load i32, ptr %offset, align 4
  %inc10 = add i32 %24, 1
  store i32 %inc10, ptr %offset, align 4
  %25 = load ptr, ptr %hs_buf, align 8
  %incdec.ptr = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %25, i32 1
  store ptr %incdec.ptr, ptr %hs_buf, align 8
  br label %for.cond, !llvm.loop !20

for.end:                                          ; preds = %for.cond
  %26 = load ptr, ptr %hs_buf, align 8
  call void @llvm.memset.p0.i64(ptr align 8 %26, i8 0, i64 24, i1 false)
  br label %if.end11

if.end11:                                         ; preds = %for.end, %land.lhs.true4, %if.end
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_buffering_free_slot(ptr noundef %ssl, i8 noundef zeroext %slot) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %slot.addr = alloca i8, align 1
  %hs = alloca ptr, align 8
  %hs_buf = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i8 %slot, ptr %slot.addr, align 1
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  %2 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 23
  %hs1 = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 2
  %3 = load i8, ptr %slot.addr, align 1
  %idxprom = zext i8 %3 to i64
  %arrayidx = getelementptr inbounds [4 x %struct.mbedtls_ssl_hs_buffer], ptr %hs1, i64 0, i64 %idxprom
  store ptr %arrayidx, ptr %hs_buf, align 8
  %4 = load i8, ptr %slot.addr, align 1
  %conv = zext i8 %4 to i32
  %cmp = icmp sge i32 %conv, 4
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %if.end9

if.end:                                           ; preds = %entry
  %5 = load ptr, ptr %hs_buf, align 8
  %bf.load = load i8, ptr %5, align 8
  %bf.clear = and i8 %bf.load, 1
  %bf.cast = zext i8 %bf.clear to i32
  %cmp3 = icmp eq i32 %bf.cast, 1
  br i1 %cmp3, label %if.then5, label %if.end9

if.then5:                                         ; preds = %if.end
  %6 = load ptr, ptr %hs_buf, align 8
  %data_len = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %6, i32 0, i32 2
  %7 = load i64, ptr %data_len, align 8
  %8 = load ptr, ptr %hs, align 8
  %buffering6 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 23
  %total_bytes_buffered = getelementptr inbounds %struct.anon, ptr %buffering6, i32 0, i32 0
  %9 = load i64, ptr %total_bytes_buffered, align 8
  %sub = sub i64 %9, %7
  store i64 %sub, ptr %total_bytes_buffered, align 8
  %10 = load ptr, ptr %hs_buf, align 8
  %data = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %10, i32 0, i32 1
  %11 = load ptr, ptr %data, align 8
  %12 = load ptr, ptr %hs_buf, align 8
  %data_len7 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %12, i32 0, i32 2
  %13 = load i64, ptr %data_len7, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %11, i64 noundef %13)
  %14 = load ptr, ptr %hs_buf, align 8
  %data8 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %14, i32 0, i32 1
  %15 = load ptr, ptr %data8, align 8
  call void @free(ptr noundef %15) #8
  %16 = load ptr, ptr %hs_buf, align 8
  call void @llvm.memset.p0.i64(ptr align 8 %16, i8 0, i64 24, i1 false)
  br label %if.end9

if.end9:                                          ; preds = %if.then, %if.then5, %if.end
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_dtls_replay_check(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %rec_seqnum = alloca i64, align 8
  %bit = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 24
  %1 = load ptr, ptr %in_ctr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %1, i64 2
  %call = call i64 @ssl_load_six_bytes(ptr noundef %add.ptr)
  store i64 %call, ptr %rec_seqnum, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 0
  %3 = load ptr, ptr %conf, align 8
  %anti_replay = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 46
  %bf.load = load i32, ptr %anti_replay, align 4
  %bf.lshr = lshr i32 %bf.load, 12
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %4 = load i64, ptr %rec_seqnum, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_window_top = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 35
  %6 = load i64, ptr %in_window_top, align 8
  %cmp1 = icmp ugt i64 %4, %6
  br i1 %cmp1, label %if.then2, label %if.end3

if.then2:                                         ; preds = %if.end
  store i32 0, ptr %retval, align 4
  br label %return

if.end3:                                          ; preds = %if.end
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_window_top4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 35
  %8 = load i64, ptr %in_window_top4, align 8
  %9 = load i64, ptr %rec_seqnum, align 8
  %sub = sub i64 %8, %9
  store i64 %sub, ptr %bit, align 8
  %10 = load i64, ptr %bit, align 8
  %cmp5 = icmp uge i64 %10, 64
  br i1 %cmp5, label %if.then6, label %if.end7

if.then6:                                         ; preds = %if.end3
  store i32 -1, ptr %retval, align 4
  br label %return

if.end7:                                          ; preds = %if.end3
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_window = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 36
  %12 = load i64, ptr %in_window, align 8
  %13 = load i64, ptr %bit, align 8
  %shl = shl i64 1, %13
  %and = and i64 %12, %shl
  %cmp8 = icmp ne i64 %and, 0
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %if.end7
  store i32 -1, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.end7
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end10, %if.then9, %if.then6, %if.then2, %if.then
  %14 = load i32, ptr %retval, align 4
  ret i32 %14
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i64 @ssl_load_six_bytes(ptr noundef %buf) #0 {
entry:
  %buf.addr = alloca ptr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  %0 = load ptr, ptr %buf.addr, align 8
  %arrayidx = getelementptr inbounds i8, ptr %0, i64 0
  %1 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %1 to i64
  %shl = shl i64 %conv, 40
  %2 = load ptr, ptr %buf.addr, align 8
  %arrayidx1 = getelementptr inbounds i8, ptr %2, i64 1
  %3 = load i8, ptr %arrayidx1, align 1
  %conv2 = zext i8 %3 to i64
  %shl3 = shl i64 %conv2, 32
  %or = or i64 %shl, %shl3
  %4 = load ptr, ptr %buf.addr, align 8
  %arrayidx4 = getelementptr inbounds i8, ptr %4, i64 2
  %5 = load i8, ptr %arrayidx4, align 1
  %conv5 = zext i8 %5 to i64
  %shl6 = shl i64 %conv5, 24
  %or7 = or i64 %or, %shl6
  %6 = load ptr, ptr %buf.addr, align 8
  %arrayidx8 = getelementptr inbounds i8, ptr %6, i64 3
  %7 = load i8, ptr %arrayidx8, align 1
  %conv9 = zext i8 %7 to i64
  %shl10 = shl i64 %conv9, 16
  %or11 = or i64 %or7, %shl10
  %8 = load ptr, ptr %buf.addr, align 8
  %arrayidx12 = getelementptr inbounds i8, ptr %8, i64 4
  %9 = load i8, ptr %arrayidx12, align 1
  %conv13 = zext i8 %9 to i64
  %shl14 = shl i64 %conv13, 8
  %or15 = or i64 %or11, %shl14
  %10 = load ptr, ptr %buf.addr, align 8
  %arrayidx16 = getelementptr inbounds i8, ptr %10, i64 5
  %11 = load i8, ptr %arrayidx16, align 1
  %conv17 = zext i8 %11 to i64
  %or18 = or i64 %or15, %conv17
  ret i64 %or18
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_dtls_replay_update(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %rec_seqnum = alloca i64, align 8
  %shift = alloca i64, align 8
  %bit = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 24
  %1 = load ptr, ptr %in_ctr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %1, i64 2
  %call = call i64 @ssl_load_six_bytes(ptr noundef %add.ptr)
  store i64 %call, ptr %rec_seqnum, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 0
  %3 = load ptr, ptr %conf, align 8
  %anti_replay = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 46
  %bf.load = load i32, ptr %anti_replay, align 4
  %bf.lshr = lshr i32 %bf.load, 12
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %if.end19

if.end:                                           ; preds = %entry
  %4 = load i64, ptr %rec_seqnum, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_window_top = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 35
  %6 = load i64, ptr %in_window_top, align 8
  %cmp1 = icmp ugt i64 %4, %6
  br i1 %cmp1, label %if.then2, label %if.else10

if.then2:                                         ; preds = %if.end
  %7 = load i64, ptr %rec_seqnum, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_window_top3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 35
  %9 = load i64, ptr %in_window_top3, align 8
  %sub = sub i64 %7, %9
  store i64 %sub, ptr %shift, align 8
  %10 = load i64, ptr %shift, align 8
  %cmp4 = icmp uge i64 %10, 64
  br i1 %cmp4, label %if.then5, label %if.else

if.then5:                                         ; preds = %if.then2
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_window = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 36
  store i64 1, ptr %in_window, align 8
  br label %if.end8

if.else:                                          ; preds = %if.then2
  %12 = load i64, ptr %shift, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_window6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 36
  %14 = load i64, ptr %in_window6, align 8
  %shl = shl i64 %14, %12
  store i64 %shl, ptr %in_window6, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_window7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 36
  %16 = load i64, ptr %in_window7, align 8
  %or = or i64 %16, 1
  store i64 %or, ptr %in_window7, align 8
  br label %if.end8

if.end8:                                          ; preds = %if.else, %if.then5
  %17 = load i64, ptr %rec_seqnum, align 8
  %18 = load ptr, ptr %ssl.addr, align 8
  %in_window_top9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 35
  store i64 %17, ptr %in_window_top9, align 8
  br label %if.end19

if.else10:                                        ; preds = %if.end
  %19 = load ptr, ptr %ssl.addr, align 8
  %in_window_top11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 35
  %20 = load i64, ptr %in_window_top11, align 8
  %21 = load i64, ptr %rec_seqnum, align 8
  %sub12 = sub i64 %20, %21
  store i64 %sub12, ptr %bit, align 8
  %22 = load i64, ptr %bit, align 8
  %cmp13 = icmp ult i64 %22, 64
  br i1 %cmp13, label %if.then14, label %if.end18

if.then14:                                        ; preds = %if.else10
  %23 = load i64, ptr %bit, align 8
  %shl15 = shl i64 1, %23
  %24 = load ptr, ptr %ssl.addr, align 8
  %in_window16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 36
  %25 = load i64, ptr %in_window16, align 8
  %or17 = or i64 %25, %shl15
  store i64 %or17, ptr %in_window16, align 8
  br label %if.end18

if.end18:                                         ; preds = %if.then14, %if.else10
  br label %if.end19

if.end19:                                         ; preds = %if.then, %if.end18, %if.end8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_read_record(ptr noundef %ssl, i32 noundef %update_hs_digest) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %update_hs_digest.addr = alloca i32, align 4
  %ret = alloca i32, align 4
  %have_buffered = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %update_hs_digest, ptr %update_hs_digest.addr, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 4311, ptr noundef @.str.77)
  %1 = load ptr, ptr %ssl.addr, align 8
  %keep_current_message = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 39
  %2 = load i32, ptr %keep_current_message, align 4
  %cmp = icmp eq i32 %2, 0
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  br label %do.body

do.body:                                          ; preds = %lor.end, %if.then
  %3 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_consume_current_message(ptr noundef %3)
  store i32 %call, ptr %ret, align 4
  %4 = load i32, ptr %ret, align 4
  %cmp1 = icmp ne i32 %4, 0
  br i1 %cmp1, label %if.then2, label %if.end

if.then2:                                         ; preds = %do.body
  %5 = load i32, ptr %ret, align 4
  store i32 %5, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %do.body
  %6 = load ptr, ptr %ssl.addr, align 8
  %call3 = call i32 @ssl_record_is_in_progress(ptr noundef %6)
  %cmp4 = icmp eq i32 %call3, 0
  br i1 %cmp4, label %if.then5, label %if.end25

if.then5:                                         ; preds = %if.end
  store i32 0, ptr %have_buffered, align 4
  %7 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 0
  %8 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %8, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp6 = icmp eq i32 %bf.clear, 1
  br i1 %cmp6, label %land.lhs.true, label %if.end14

land.lhs.true:                                    ; preds = %if.then5
  %9 = load ptr, ptr %ssl.addr, align 8
  %call7 = call i32 @ssl_next_record_is_in_datagram(ptr noundef %9)
  %cmp8 = icmp eq i32 %call7, 0
  br i1 %cmp8, label %if.then9, label %if.end14

if.then9:                                         ; preds = %land.lhs.true
  %10 = load ptr, ptr %ssl.addr, align 8
  %call10 = call i32 @ssl_load_buffered_message(ptr noundef %10)
  %cmp11 = icmp eq i32 %call10, 0
  br i1 %cmp11, label %if.then12, label %if.end13

if.then12:                                        ; preds = %if.then9
  store i32 1, ptr %have_buffered, align 4
  br label %if.end13

if.end13:                                         ; preds = %if.then12, %if.then9
  br label %if.end14

if.end14:                                         ; preds = %if.end13, %land.lhs.true, %if.then5
  %11 = load i32, ptr %have_buffered, align 4
  %cmp15 = icmp eq i32 %11, 0
  br i1 %cmp15, label %if.then16, label %if.end24

if.then16:                                        ; preds = %if.end14
  %12 = load ptr, ptr %ssl.addr, align 8
  %call17 = call i32 @ssl_get_next_record(ptr noundef %12)
  store i32 %call17, ptr %ret, align 4
  %13 = load i32, ptr %ret, align 4
  %cmp18 = icmp eq i32 %13, -25984
  br i1 %cmp18, label %if.then19, label %if.end20

if.then19:                                        ; preds = %if.then16
  br label %do.cond

if.end20:                                         ; preds = %if.then16
  %14 = load i32, ptr %ret, align 4
  %cmp21 = icmp ne i32 %14, 0
  br i1 %cmp21, label %if.then22, label %if.end23

if.then22:                                        ; preds = %if.end20
  %15 = load ptr, ptr %ssl.addr, align 8
  %16 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %15, i32 noundef 1, ptr noundef @.str, i32 noundef 4344, ptr noundef @.str.78, i32 noundef %16)
  %17 = load i32, ptr %ret, align 4
  store i32 %17, ptr %retval, align 4
  br label %return

if.end23:                                         ; preds = %if.end20
  br label %if.end24

if.end24:                                         ; preds = %if.end23, %if.end14
  br label %if.end25

if.end25:                                         ; preds = %if.end24, %if.end
  %18 = load ptr, ptr %ssl.addr, align 8
  %call26 = call i32 @mbedtls_ssl_handle_message_type(ptr noundef %18)
  store i32 %call26, ptr %ret, align 4
  %19 = load i32, ptr %ret, align 4
  %cmp27 = icmp eq i32 %19, -25728
  br i1 %cmp27, label %if.then28, label %if.end33

if.then28:                                        ; preds = %if.end25
  %20 = load ptr, ptr %ssl.addr, align 8
  %call29 = call i32 @ssl_buffer_message(ptr noundef %20)
  store i32 %call29, ptr %ret, align 4
  %21 = load i32, ptr %ret, align 4
  %cmp30 = icmp ne i32 %21, 0
  br i1 %cmp30, label %if.then31, label %if.end32

if.then31:                                        ; preds = %if.then28
  %22 = load i32, ptr %ret, align 4
  store i32 %22, ptr %retval, align 4
  br label %return

if.end32:                                         ; preds = %if.then28
  store i32 -25984, ptr %ret, align 4
  br label %if.end33

if.end33:                                         ; preds = %if.end32, %if.end25
  br label %do.cond

do.cond:                                          ; preds = %if.end33, %if.then19
  %23 = load i32, ptr %ret, align 4
  %cmp34 = icmp eq i32 -26240, %23
  br i1 %cmp34, label %lor.end, label %lor.rhs

lor.rhs:                                          ; preds = %do.cond
  %24 = load i32, ptr %ret, align 4
  %cmp35 = icmp eq i32 -25984, %24
  br label %lor.end

lor.end:                                          ; preds = %lor.rhs, %do.cond
  %25 = phi i1 [ true, %do.cond ], [ %cmp35, %lor.rhs ]
  br i1 %25, label %do.body, label %do.end, !llvm.loop !21

do.end:                                           ; preds = %lor.end
  %26 = load i32, ptr %ret, align 4
  %cmp36 = icmp ne i32 0, %26
  br i1 %cmp36, label %if.then37, label %if.end38

if.then37:                                        ; preds = %do.end
  %27 = load ptr, ptr %ssl.addr, align 8
  %28 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %27, i32 noundef 1, ptr noundef @.str, i32 noundef 4369, ptr noundef @.str.79, i32 noundef %28)
  %29 = load i32, ptr %ret, align 4
  store i32 %29, ptr %retval, align 4
  br label %return

if.end38:                                         ; preds = %do.end
  %30 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 30
  %31 = load i32, ptr %in_msgtype, align 8
  %cmp39 = icmp eq i32 %31, 22
  br i1 %cmp39, label %land.lhs.true40, label %if.end43

land.lhs.true40:                                  ; preds = %if.end38
  %32 = load i32, ptr %update_hs_digest.addr, align 4
  %cmp41 = icmp eq i32 %32, 1
  br i1 %cmp41, label %if.then42, label %if.end43

if.then42:                                        ; preds = %land.lhs.true40
  %33 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_ssl_update_handshake_status(ptr noundef %33)
  br label %if.end43

if.end43:                                         ; preds = %if.then42, %land.lhs.true40, %if.end38
  br label %if.end45

if.else:                                          ; preds = %entry
  %34 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %34, i32 noundef 2, ptr noundef @.str, i32 noundef 4381, ptr noundef @.str.80)
  %35 = load ptr, ptr %ssl.addr, align 8
  %keep_current_message44 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 39
  store i32 0, ptr %keep_current_message44, align 4
  br label %if.end45

if.end45:                                         ; preds = %if.else, %if.end43
  %36 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %36, i32 noundef 2, ptr noundef @.str, i32 noundef 4385, ptr noundef @.str.81)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end45, %if.then37, %if.then31, %if.then22, %if.then2
  %37 = load i32, ptr %retval, align 4
  ret i32 %37
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_consume_current_message(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 37
  %1 = load i64, ptr %in_hslen, align 8
  %cmp = icmp ne i64 %1, 0
  br i1 %cmp, label %if.then, label %if.else16

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %in_offt = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 29
  %3 = load ptr, ptr %in_offt, align 8
  %cmp1 = icmp ne ptr %3, null
  br i1 %cmp1, label %if.then2, label %if.end

if.then2:                                         ; preds = %if.then
  %4 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %4, i32 noundef 1, ptr noundef @.str, i32 noundef 4763, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %if.then
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_hslen3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 37
  %6 = load i64, ptr %in_hslen3, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 31
  %8 = load i64, ptr %in_msglen, align 8
  %cmp4 = icmp ult i64 %6, %8
  br i1 %cmp4, label %if.then5, label %if.else

if.then5:                                         ; preds = %if.end
  %9 = load ptr, ptr %ssl.addr, align 8
  %in_hslen6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 37
  %10 = load i64, ptr %in_hslen6, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_msglen7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 31
  %12 = load i64, ptr %in_msglen7, align 8
  %sub = sub i64 %12, %10
  store i64 %sub, ptr %in_msglen7, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 28
  %14 = load ptr, ptr %in_msg, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_msg8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 28
  %16 = load ptr, ptr %in_msg8, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %in_hslen9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 37
  %18 = load i64, ptr %in_hslen9, align 8
  %add.ptr = getelementptr inbounds i8, ptr %16, i64 %18
  %19 = load ptr, ptr %ssl.addr, align 8
  %in_msglen10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 31
  %20 = load i64, ptr %in_msglen10, align 8
  call void @llvm.memmove.p0.p0.i64(ptr align 1 %14, ptr align 1 %add.ptr, i64 %20, i1 false)
  %21 = load ptr, ptr %ssl.addr, align 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %in_msg11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 28
  %23 = load ptr, ptr %in_msg11, align 8
  %24 = load ptr, ptr %ssl.addr, align 8
  %in_msglen12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 31
  %25 = load i64, ptr %in_msglen12, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %21, i32 noundef 4, ptr noundef @.str, i32 noundef 4795, ptr noundef @.str.236, ptr noundef %23, i64 noundef %25)
  br label %if.end14

if.else:                                          ; preds = %if.end
  %26 = load ptr, ptr %ssl.addr, align 8
  %in_msglen13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 31
  store i64 0, ptr %in_msglen13, align 8
  br label %if.end14

if.end14:                                         ; preds = %if.else, %if.then5
  %27 = load ptr, ptr %ssl.addr, align 8
  %in_hslen15 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 37
  store i64 0, ptr %in_hslen15, align 8
  br label %if.end23

if.else16:                                        ; preds = %entry
  %28 = load ptr, ptr %ssl.addr, align 8
  %in_offt17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 29
  %29 = load ptr, ptr %in_offt17, align 8
  %cmp18 = icmp ne ptr %29, null
  br i1 %cmp18, label %if.then19, label %if.else20

if.then19:                                        ; preds = %if.else16
  store i32 0, ptr %retval, align 4
  br label %return

if.else20:                                        ; preds = %if.else16
  %30 = load ptr, ptr %ssl.addr, align 8
  %in_msglen21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 31
  store i64 0, ptr %in_msglen21, align 8
  br label %if.end22

if.end22:                                         ; preds = %if.else20
  br label %if.end23

if.end23:                                         ; preds = %if.end22, %if.end14
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end23, %if.then19, %if.then2
  %31 = load i32, ptr %retval, align 4
  ret i32 %31
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_record_is_in_progress(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 31
  %1 = load i64, ptr %in_msglen, align 8
  %cmp = icmp ugt i64 %1, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %2 = load i32, ptr %retval, align 4
  ret i32 %2
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_next_record_is_in_datagram(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 32
  %1 = load i64, ptr %in_left, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 34
  %3 = load i64, ptr %next_record_offset, align 8
  %cmp = icmp ugt i64 %1, %3
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %4 = load i32, ptr %retval, align 4
  ret i32 %4
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_load_buffered_message(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %hs = alloca ptr, align 8
  %hs_buf = alloca ptr, align 8
  %ret = alloca i32, align 4
  %offset = alloca i32, align 4
  %msg_len = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  store i32 0, ptr %ret, align 4
  %2 = load ptr, ptr %hs, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 4408, ptr noundef @.str.208)
  %4 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 1
  %5 = load i32, ptr %state, align 8
  %cmp1 = icmp eq i32 %5, 10
  br i1 %cmp1, label %if.then4, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  %state2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 1
  %7 = load i32, ptr %state2, align 8
  %cmp3 = icmp eq i32 %7, 12
  br i1 %cmp3, label %if.then4, label %if.end9

if.then4:                                         ; preds = %lor.lhs.false, %if.end
  %8 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 23
  %seen_ccs = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 1
  %9 = load i8, ptr %seen_ccs, align 8
  %tobool = icmp ne i8 %9, 0
  br i1 %tobool, label %if.end6, label %if.then5

if.then5:                                         ; preds = %if.then4
  %10 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %10, i32 noundef 2, ptr noundef @.str, i32 noundef 4417, ptr noundef @.str.209)
  store i32 -1, ptr %ret, align 4
  br label %exit

if.end6:                                          ; preds = %if.then4
  %11 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %11, i32 noundef 2, ptr noundef @.str, i32 noundef 4422, ptr noundef @.str.210)
  %12 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 30
  store i32 20, ptr %in_msgtype, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 31
  store i64 1, ptr %in_msglen, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 28
  %15 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %15, i64 0
  store i8 1, ptr %arrayidx, align 1
  %16 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 32
  store i64 0, ptr %in_left, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 34
  store i64 0, ptr %next_record_offset, align 8
  %18 = load ptr, ptr %hs, align 8
  %buffering7 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %18, i32 0, i32 23
  %seen_ccs8 = getelementptr inbounds %struct.anon, ptr %buffering7, i32 0, i32 1
  store i8 0, ptr %seen_ccs8, align 8
  br label %exit

if.end9:                                          ; preds = %lor.lhs.false
  store i32 1, ptr %offset, align 4
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.end9
  %19 = load i32, ptr %offset, align 4
  %cmp10 = icmp ult i32 %19, 4
  br i1 %cmp10, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %20 = load ptr, ptr %hs, align 8
  %buffering11 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %20, i32 0, i32 23
  %hs12 = getelementptr inbounds %struct.anon, ptr %buffering11, i32 0, i32 2
  %21 = load i32, ptr %offset, align 4
  %idxprom = zext i32 %21 to i64
  %arrayidx13 = getelementptr inbounds [4 x %struct.mbedtls_ssl_hs_buffer], ptr %hs12, i64 0, i64 %idxprom
  store ptr %arrayidx13, ptr %hs_buf, align 8
  %22 = load ptr, ptr %hs_buf, align 8
  %bf.load = load i8, ptr %22, align 8
  %bf.clear = and i8 %bf.load, 1
  %bf.cast = zext i8 %bf.clear to i32
  %cmp14 = icmp eq i32 %bf.cast, 1
  br i1 %cmp14, label %if.then15, label %if.end20

if.then15:                                        ; preds = %for.body
  %23 = load ptr, ptr %ssl.addr, align 8
  %24 = load ptr, ptr %hs, align 8
  %in_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %24, i32 0, i32 12
  %25 = load i32, ptr %in_msg_seq, align 4
  %26 = load i32, ptr %offset, align 4
  %add = add i32 %25, %26
  %27 = load ptr, ptr %hs_buf, align 8
  %bf.load16 = load i8, ptr %27, align 8
  %bf.lshr = lshr i8 %bf.load16, 2
  %bf.clear17 = and i8 %bf.lshr, 1
  %bf.cast18 = zext i8 %bf.clear17 to i32
  %tobool19 = icmp ne i32 %bf.cast18, 0
  %28 = zext i1 %tobool19 to i64
  %cond = select i1 %tobool19, ptr @.str.212, ptr @.str.213
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %23, i32 noundef 2, ptr noundef @.str, i32 noundef 4446, ptr noundef @.str.211, i32 noundef %add, ptr noundef %cond)
  br label %if.end20

if.end20:                                         ; preds = %if.then15, %for.body
  br label %for.inc

for.inc:                                          ; preds = %if.end20
  %29 = load i32, ptr %offset, align 4
  %inc = add i32 %29, 1
  store i32 %inc, ptr %offset, align 4
  br label %for.cond, !llvm.loop !22

for.end:                                          ; preds = %for.cond
  %30 = load ptr, ptr %hs, align 8
  %buffering21 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %30, i32 0, i32 23
  %hs22 = getelementptr inbounds %struct.anon, ptr %buffering21, i32 0, i32 2
  %arrayidx23 = getelementptr inbounds [4 x %struct.mbedtls_ssl_hs_buffer], ptr %hs22, i64 0, i64 0
  store ptr %arrayidx23, ptr %hs_buf, align 8
  %31 = load ptr, ptr %hs_buf, align 8
  %bf.load24 = load i8, ptr %31, align 8
  %bf.clear25 = and i8 %bf.load24, 1
  %bf.cast26 = zext i8 %bf.clear25 to i32
  %cmp27 = icmp eq i32 %bf.cast26, 1
  br i1 %cmp27, label %land.lhs.true, label %if.else

land.lhs.true:                                    ; preds = %for.end
  %32 = load ptr, ptr %hs_buf, align 8
  %bf.load28 = load i8, ptr %32, align 8
  %bf.lshr29 = lshr i8 %bf.load28, 2
  %bf.clear30 = and i8 %bf.lshr29, 1
  %bf.cast31 = zext i8 %bf.clear30 to i32
  %cmp32 = icmp eq i32 %bf.cast31, 1
  br i1 %cmp32, label %if.then33, label %if.else

if.then33:                                        ; preds = %land.lhs.true
  %33 = load ptr, ptr %hs_buf, align 8
  %data = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %33, i32 0, i32 1
  %34 = load ptr, ptr %data, align 8
  %arrayidx34 = getelementptr inbounds i8, ptr %34, i64 1
  %35 = load i8, ptr %arrayidx34, align 1
  %conv = zext i8 %35 to i32
  %shl = shl i32 %conv, 16
  %36 = load ptr, ptr %hs_buf, align 8
  %data35 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %36, i32 0, i32 1
  %37 = load ptr, ptr %data35, align 8
  %arrayidx36 = getelementptr inbounds i8, ptr %37, i64 2
  %38 = load i8, ptr %arrayidx36, align 1
  %conv37 = zext i8 %38 to i32
  %shl38 = shl i32 %conv37, 8
  %or = or i32 %shl, %shl38
  %39 = load ptr, ptr %hs_buf, align 8
  %data39 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %39, i32 0, i32 1
  %40 = load ptr, ptr %data39, align 8
  %arrayidx40 = getelementptr inbounds i8, ptr %40, i64 3
  %41 = load i8, ptr %arrayidx40, align 1
  %conv41 = zext i8 %41 to i32
  %or42 = or i32 %or, %conv41
  %conv43 = sext i32 %or42 to i64
  store i64 %conv43, ptr %msg_len, align 8
  %42 = load i64, ptr %msg_len, align 8
  %add44 = add i64 %42, 12
  %cmp45 = icmp ugt i64 %add44, 16384
  br i1 %cmp45, label %if.then47, label %if.end48

if.then47:                                        ; preds = %if.then33
  %43 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %43, i32 noundef 1, ptr noundef @.str, i32 noundef 4466, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end48:                                         ; preds = %if.then33
  %44 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %44, i32 noundef 2, ptr noundef @.str, i32 noundef 4470, ptr noundef @.str.214)
  %45 = load ptr, ptr %ssl.addr, align 8
  %46 = load ptr, ptr %hs_buf, align 8
  %data49 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %46, i32 0, i32 1
  %47 = load ptr, ptr %data49, align 8
  %48 = load i64, ptr %msg_len, align 8
  %add50 = add i64 %48, 12
  call void @mbedtls_debug_print_buf(ptr noundef %45, i32 noundef 3, ptr noundef @.str, i32 noundef 4472, ptr noundef @.str.215, ptr noundef %47, i64 noundef %add50)
  %49 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 30
  store i32 22, ptr %in_msgtype51, align 8
  %50 = load i64, ptr %msg_len, align 8
  %add52 = add i64 %50, 12
  %51 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %51, i32 0, i32 37
  store i64 %add52, ptr %in_hslen, align 8
  %52 = load i64, ptr %msg_len, align 8
  %add53 = add i64 %52, 12
  %53 = load ptr, ptr %ssl.addr, align 8
  %in_msglen54 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %53, i32 0, i32 31
  store i64 %add53, ptr %in_msglen54, align 8
  %54 = load ptr, ptr %ssl.addr, align 8
  %in_msg55 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %54, i32 0, i32 28
  %55 = load ptr, ptr %in_msg55, align 8
  %56 = load ptr, ptr %hs_buf, align 8
  %data56 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %56, i32 0, i32 1
  %57 = load ptr, ptr %data56, align 8
  %58 = load ptr, ptr %ssl.addr, align 8
  %in_hslen57 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 37
  %59 = load i64, ptr %in_hslen57, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %55, ptr align 1 %57, i64 %59, i1 false)
  store i32 0, ptr %ret, align 4
  br label %exit

if.else:                                          ; preds = %land.lhs.true, %for.end
  %60 = load ptr, ptr %ssl.addr, align 8
  %61 = load ptr, ptr %hs, align 8
  %in_msg_seq58 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %61, i32 0, i32 12
  %62 = load i32, ptr %in_msg_seq58, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %60, i32 noundef 2, ptr noundef @.str, i32 noundef 4485, ptr noundef @.str.216, i32 noundef %62)
  br label %if.end59

if.end59:                                         ; preds = %if.else
  store i32 -1, ptr %ret, align 4
  br label %exit

exit:                                             ; preds = %if.end59, %if.end48, %if.end6, %if.then5
  %63 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %63, i32 noundef 2, ptr noundef @.str, i32 noundef 4492, ptr noundef @.str.217)
  %64 = load i32, ptr %ret, align 4
  store i32 %64, ptr %retval, align 4
  br label %return

return:                                           ; preds = %exit, %if.then47, %if.then
  %65 = load i32, ptr %retval, align 4
  ret i32 %65
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_get_next_record(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_load_buffered_record(ptr noundef %0)
  store i32 %call, ptr %ret, align 4
  %1 = load i32, ptr %ret, align 4
  %cmp = icmp ne i32 %1, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %2 = load i32, ptr %ret, align 4
  store i32 %2, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %call1 = call i64 @mbedtls_ssl_hdr_len(ptr noundef %4)
  %call2 = call i32 @mbedtls_ssl_fetch_input(ptr noundef %3, i64 noundef %call1)
  store i32 %call2, ptr %ret, align 4
  %cmp3 = icmp ne i32 %call2, 0
  br i1 %cmp3, label %if.then4, label %if.end5

if.then4:                                         ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %6 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %5, i32 noundef 1, ptr noundef @.str, i32 noundef 4973, ptr noundef @.str.237, i32 noundef %6)
  %7 = load i32, ptr %ret, align 4
  store i32 %7, ptr %retval, align 4
  br label %return

if.end5:                                          ; preds = %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %call6 = call i32 @ssl_parse_record_header(ptr noundef %8)
  store i32 %call6, ptr %ret, align 4
  %cmp7 = icmp ne i32 %call6, 0
  br i1 %cmp7, label %if.then8, label %if.end25

if.then8:                                         ; preds = %if.end5
  %9 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 0
  %10 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %10, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp9 = icmp eq i32 %bf.clear, 1
  br i1 %cmp9, label %land.lhs.true, label %if.end24

land.lhs.true:                                    ; preds = %if.then8
  %11 = load i32, ptr %ret, align 4
  %cmp10 = icmp ne i32 %11, -26496
  br i1 %cmp10, label %if.then11, label %if.end24

if.then11:                                        ; preds = %land.lhs.true
  %12 = load i32, ptr %ret, align 4
  %cmp12 = icmp eq i32 %12, -25728
  br i1 %cmp12, label %if.then13, label %if.end18

if.then13:                                        ; preds = %if.then11
  %13 = load ptr, ptr %ssl.addr, align 8
  %call14 = call i32 @ssl_buffer_future_record(ptr noundef %13)
  store i32 %call14, ptr %ret, align 4
  %14 = load i32, ptr %ret, align 4
  %cmp15 = icmp ne i32 %14, 0
  br i1 %cmp15, label %if.then16, label %if.end17

if.then16:                                        ; preds = %if.then13
  %15 = load i32, ptr %ret, align 4
  store i32 %15, ptr %retval, align 4
  br label %return

if.end17:                                         ; preds = %if.then13
  store i32 -26368, ptr %ret, align 4
  br label %if.end18

if.end18:                                         ; preds = %if.end17, %if.then11
  %16 = load i32, ptr %ret, align 4
  %cmp19 = icmp eq i32 %16, -26368
  br i1 %cmp19, label %if.then20, label %if.else

if.then20:                                        ; preds = %if.end18
  %17 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 31
  %18 = load i64, ptr %in_msglen, align 8
  %19 = load ptr, ptr %ssl.addr, align 8
  %call21 = call i64 @mbedtls_ssl_hdr_len(ptr noundef %19)
  %add = add i64 %18, %call21
  %20 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 34
  store i64 %add, ptr %next_record_offset, align 8
  %21 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %21, i32 noundef 1, ptr noundef @.str, i32 noundef 5000, ptr noundef @.str.238)
  br label %if.end23

if.else:                                          ; preds = %if.end18
  %22 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 34
  store i64 0, ptr %next_record_offset22, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 32
  store i64 0, ptr %in_left, align 8
  %24 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %24, i32 noundef 1, ptr noundef @.str, i32 noundef 5009, ptr noundef @.str.239)
  br label %if.end23

if.end23:                                         ; preds = %if.else, %if.then20
  store i32 -25984, ptr %retval, align 4
  br label %return

if.end24:                                         ; preds = %land.lhs.true, %if.then8
  %25 = load i32, ptr %ret, align 4
  store i32 %25, ptr %retval, align 4
  br label %return

if.end25:                                         ; preds = %if.end5
  %26 = load ptr, ptr %ssl.addr, align 8
  %27 = load ptr, ptr %ssl.addr, align 8
  %call26 = call i64 @mbedtls_ssl_hdr_len(ptr noundef %27)
  %28 = load ptr, ptr %ssl.addr, align 8
  %in_msglen27 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 31
  %29 = load i64, ptr %in_msglen27, align 8
  %add28 = add i64 %call26, %29
  %call29 = call i32 @mbedtls_ssl_fetch_input(ptr noundef %26, i64 noundef %add28)
  store i32 %call29, ptr %ret, align 4
  %cmp30 = icmp ne i32 %call29, 0
  br i1 %cmp30, label %if.then31, label %if.end32

if.then31:                                        ; preds = %if.end25
  %30 = load ptr, ptr %ssl.addr, align 8
  %31 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %30, i32 noundef 1, ptr noundef @.str, i32 noundef 5025, ptr noundef @.str.237, i32 noundef %31)
  %32 = load i32, ptr %ret, align 4
  store i32 %32, ptr %retval, align 4
  br label %return

if.end32:                                         ; preds = %if.end25
  %33 = load ptr, ptr %ssl.addr, align 8
  %conf33 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 0
  %34 = load ptr, ptr %conf33, align 8
  %transport34 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %34, i32 0, i32 46
  %bf.load35 = load i32, ptr %transport34, align 4
  %bf.lshr36 = lshr i32 %bf.load35, 1
  %bf.clear37 = and i32 %bf.lshr36, 1
  %cmp38 = icmp eq i32 %bf.clear37, 1
  br i1 %cmp38, label %if.then39, label %if.else49

if.then39:                                        ; preds = %if.end32
  %35 = load ptr, ptr %ssl.addr, align 8
  %in_msglen40 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 31
  %36 = load i64, ptr %in_msglen40, align 8
  %37 = load ptr, ptr %ssl.addr, align 8
  %call41 = call i64 @mbedtls_ssl_hdr_len(ptr noundef %37)
  %add42 = add i64 %36, %call41
  %38 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset43 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 34
  store i64 %add42, ptr %next_record_offset43, align 8
  %39 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset44 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 34
  %40 = load i64, ptr %next_record_offset44, align 8
  %41 = load ptr, ptr %ssl.addr, align 8
  %in_left45 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 32
  %42 = load i64, ptr %in_left45, align 8
  %cmp46 = icmp ult i64 %40, %42
  br i1 %cmp46, label %if.then47, label %if.end48

if.then47:                                        ; preds = %if.then39
  %43 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %43, i32 noundef 3, ptr noundef @.str, i32 noundef 5036, ptr noundef @.str.240)
  br label %if.end48

if.end48:                                         ; preds = %if.then47, %if.then39
  br label %if.end51

if.else49:                                        ; preds = %if.end32
  %44 = load ptr, ptr %ssl.addr, align 8
  %in_left50 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %44, i32 0, i32 32
  store i64 0, ptr %in_left50, align 8
  br label %if.end51

if.end51:                                         ; preds = %if.else49, %if.end48
  %45 = load ptr, ptr %ssl.addr, align 8
  %call52 = call i32 @ssl_prepare_record_content(ptr noundef %45)
  store i32 %call52, ptr %ret, align 4
  %cmp53 = icmp ne i32 %call52, 0
  br i1 %cmp53, label %if.then54, label %if.end91

if.then54:                                        ; preds = %if.end51
  %46 = load ptr, ptr %ssl.addr, align 8
  %conf55 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 0
  %47 = load ptr, ptr %conf55, align 8
  %transport56 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %47, i32 0, i32 46
  %bf.load57 = load i32, ptr %transport56, align 4
  %bf.lshr58 = lshr i32 %bf.load57, 1
  %bf.clear59 = and i32 %bf.lshr58, 1
  %cmp60 = icmp eq i32 %bf.clear59, 1
  br i1 %cmp60, label %if.then61, label %if.else86

if.then61:                                        ; preds = %if.then54
  %48 = load i32, ptr %ret, align 4
  %cmp62 = icmp eq i32 %48, -29184
  br i1 %cmp62, label %if.then64, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.then61
  %49 = load i32, ptr %ret, align 4
  %cmp63 = icmp eq i32 %49, -29056
  br i1 %cmp63, label %if.then64, label %if.end85

if.then64:                                        ; preds = %lor.lhs.false, %if.then61
  %50 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %50, i32 0, i32 1
  %51 = load i32, ptr %state, align 8
  %cmp65 = icmp eq i32 %51, 11
  br i1 %cmp65, label %if.then69, label %lor.lhs.false66

lor.lhs.false66:                                  ; preds = %if.then64
  %52 = load ptr, ptr %ssl.addr, align 8
  %state67 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 1
  %53 = load i32, ptr %state67, align 8
  %cmp68 = icmp eq i32 %53, 13
  br i1 %cmp68, label %if.then69, label %if.end74

if.then69:                                        ; preds = %lor.lhs.false66, %if.then64
  %54 = load i32, ptr %ret, align 4
  %cmp70 = icmp eq i32 %54, -29056
  br i1 %cmp70, label %if.then71, label %if.end73

if.then71:                                        ; preds = %if.then69
  %55 = load ptr, ptr %ssl.addr, align 8
  %call72 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %55, i8 noundef zeroext 2, i8 noundef zeroext 20)
  br label %if.end73

if.end73:                                         ; preds = %if.then71, %if.then69
  %56 = load i32, ptr %ret, align 4
  store i32 %56, ptr %retval, align 4
  br label %return

if.end74:                                         ; preds = %lor.lhs.false66
  %57 = load ptr, ptr %ssl.addr, align 8
  %conf75 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %57, i32 0, i32 0
  %58 = load ptr, ptr %conf75, align 8
  %badmac_limit = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %58, i32 0, i32 40
  %59 = load i32, ptr %badmac_limit, align 8
  %cmp76 = icmp ne i32 %59, 0
  br i1 %cmp76, label %land.lhs.true77, label %if.end82

land.lhs.true77:                                  ; preds = %if.end74
  %60 = load ptr, ptr %ssl.addr, align 8
  %badmac_seen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %60, i32 0, i32 6
  %61 = load i32, ptr %badmac_seen, align 4
  %inc = add i32 %61, 1
  store i32 %inc, ptr %badmac_seen, align 4
  %62 = load ptr, ptr %ssl.addr, align 8
  %conf78 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %62, i32 0, i32 0
  %63 = load ptr, ptr %conf78, align 8
  %badmac_limit79 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %63, i32 0, i32 40
  %64 = load i32, ptr %badmac_limit79, align 8
  %cmp80 = icmp uge i32 %inc, %64
  br i1 %cmp80, label %if.then81, label %if.end82

if.then81:                                        ; preds = %land.lhs.true77
  %65 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %65, i32 noundef 1, ptr noundef @.str, i32 noundef 5073, ptr noundef @.str.241)
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end82:                                         ; preds = %land.lhs.true77, %if.end74
  %66 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset83 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %66, i32 0, i32 34
  store i64 0, ptr %next_record_offset83, align 8
  %67 = load ptr, ptr %ssl.addr, align 8
  %in_left84 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %67, i32 0, i32 32
  store i64 0, ptr %in_left84, align 8
  %68 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %68, i32 noundef 1, ptr noundef @.str, i32 noundef 5084, ptr noundef @.str.242)
  store i32 -25984, ptr %retval, align 4
  br label %return

if.end85:                                         ; preds = %lor.lhs.false
  %69 = load i32, ptr %ret, align 4
  store i32 %69, ptr %retval, align 4
  br label %return

if.else86:                                        ; preds = %if.then54
  %70 = load i32, ptr %ret, align 4
  %cmp87 = icmp eq i32 %70, -29056
  br i1 %cmp87, label %if.then88, label %if.end90

if.then88:                                        ; preds = %if.else86
  %71 = load ptr, ptr %ssl.addr, align 8
  %call89 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %71, i8 noundef zeroext 2, i8 noundef zeroext 20)
  br label %if.end90

if.end90:                                         ; preds = %if.then88, %if.else86
  %72 = load i32, ptr %ret, align 4
  store i32 %72, ptr %retval, align 4
  br label %return

if.end91:                                         ; preds = %if.end51
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end91, %if.end90, %if.end85, %if.end82, %if.then81, %if.end73, %if.then31, %if.end24, %if.end23, %if.then16, %if.then4, %if.then
  %73 = load i32, ptr %retval, align 4
  ret i32 %73
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_handle_message_type(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 30
  %1 = load i32, ptr %in_msgtype, align 8
  %cmp = icmp eq i32 %1, 22
  br i1 %cmp, label %if.then, label %if.end3

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_prepare_handshake_record(ptr noundef %2)
  store i32 %call, ptr %ret, align 4
  %cmp1 = icmp ne i32 %call, 0
  br i1 %cmp1, label %if.then2, label %if.end

if.then2:                                         ; preds = %if.then
  %3 = load i32, ptr %ret, align 4
  store i32 %3, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %if.then
  br label %if.end3

if.end3:                                          ; preds = %if.end, %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 30
  %5 = load i32, ptr %in_msgtype4, align 8
  %cmp5 = icmp eq i32 %5, 20
  br i1 %cmp5, label %if.then6, label %if.end32

if.then6:                                         ; preds = %if.end3
  %6 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 31
  %7 = load i64, ptr %in_msglen, align 8
  %cmp7 = icmp ne i64 %7, 1
  br i1 %cmp7, label %if.then8, label %if.end10

if.then8:                                         ; preds = %if.then6
  %8 = load ptr, ptr %ssl.addr, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %in_msglen9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 31
  %10 = load i64, ptr %in_msglen9, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %8, i32 noundef 1, ptr noundef @.str, i32 noundef 5129, ptr noundef @.str.82, i64 noundef %10)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.then6
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 28
  %12 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %12, i64 0
  %13 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %13 to i32
  %cmp11 = icmp ne i32 %conv, 1
  br i1 %cmp11, label %if.then13, label %if.end17

if.then13:                                        ; preds = %if.end10
  %14 = load ptr, ptr %ssl.addr, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_msg14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 28
  %16 = load ptr, ptr %in_msg14, align 8
  %arrayidx15 = getelementptr inbounds i8, ptr %16, i64 0
  %17 = load i8, ptr %arrayidx15, align 1
  %conv16 = zext i8 %17 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %14, i32 noundef 1, ptr noundef @.str, i32 noundef 5136, ptr noundef @.str.83, i32 noundef %conv16)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end17:                                         ; preds = %if.end10
  %18 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 0
  %19 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %19, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp18 = icmp eq i32 %bf.clear, 1
  br i1 %cmp18, label %land.lhs.true, label %if.end31

land.lhs.true:                                    ; preds = %if.end17
  %20 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 1
  %21 = load i32, ptr %state, align 8
  %cmp20 = icmp ne i32 %21, 10
  br i1 %cmp20, label %land.lhs.true22, label %if.end31

land.lhs.true22:                                  ; preds = %land.lhs.true
  %22 = load ptr, ptr %ssl.addr, align 8
  %state23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 1
  %23 = load i32, ptr %state23, align 8
  %cmp24 = icmp ne i32 %23, 12
  br i1 %cmp24, label %if.then26, label %if.end31

if.then26:                                        ; preds = %land.lhs.true22
  %24 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 15
  %25 = load ptr, ptr %handshake, align 8
  %cmp27 = icmp eq ptr %25, null
  br i1 %cmp27, label %if.then29, label %if.end30

if.then29:                                        ; preds = %if.then26
  %26 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %26, i32 noundef 1, ptr noundef @.str, i32 noundef 5147, ptr noundef @.str.84)
  store i32 -26368, ptr %retval, align 4
  br label %return

if.end30:                                         ; preds = %if.then26
  %27 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %27, i32 noundef 1, ptr noundef @.str, i32 noundef 5151, ptr noundef @.str.85)
  store i32 -25728, ptr %retval, align 4
  br label %return

if.end31:                                         ; preds = %land.lhs.true22, %land.lhs.true, %if.end17
  br label %if.end32

if.end32:                                         ; preds = %if.end31, %if.end3
  %28 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype33 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 30
  %29 = load i32, ptr %in_msgtype33, align 8
  %cmp34 = icmp eq i32 %29, 21
  br i1 %cmp34, label %if.then36, label %if.end85

if.then36:                                        ; preds = %if.end32
  %30 = load ptr, ptr %ssl.addr, align 8
  %in_msglen37 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 31
  %31 = load i64, ptr %in_msglen37, align 8
  %cmp38 = icmp ne i64 %31, 2
  br i1 %cmp38, label %if.then40, label %if.end42

if.then40:                                        ; preds = %if.then36
  %32 = load ptr, ptr %ssl.addr, align 8
  %33 = load ptr, ptr %ssl.addr, align 8
  %in_msglen41 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 31
  %34 = load i64, ptr %in_msglen41, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %32, i32 noundef 1, ptr noundef @.str, i32 noundef 5165, ptr noundef @.str.86, i64 noundef %34)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end42:                                         ; preds = %if.then36
  %35 = load ptr, ptr %ssl.addr, align 8
  %36 = load ptr, ptr %ssl.addr, align 8
  %in_msg43 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 28
  %37 = load ptr, ptr %in_msg43, align 8
  %arrayidx44 = getelementptr inbounds i8, ptr %37, i64 0
  %38 = load i8, ptr %arrayidx44, align 1
  %conv45 = zext i8 %38 to i32
  %39 = load ptr, ptr %ssl.addr, align 8
  %in_msg46 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 28
  %40 = load ptr, ptr %in_msg46, align 8
  %arrayidx47 = getelementptr inbounds i8, ptr %40, i64 1
  %41 = load i8, ptr %arrayidx47, align 1
  %conv48 = zext i8 %41 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %35, i32 noundef 2, ptr noundef @.str, i32 noundef 5170, ptr noundef @.str.87, i32 noundef %conv45, i32 noundef %conv48)
  %42 = load ptr, ptr %ssl.addr, align 8
  %in_msg49 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 28
  %43 = load ptr, ptr %in_msg49, align 8
  %arrayidx50 = getelementptr inbounds i8, ptr %43, i64 0
  %44 = load i8, ptr %arrayidx50, align 1
  %conv51 = zext i8 %44 to i32
  %cmp52 = icmp eq i32 %conv51, 2
  br i1 %cmp52, label %if.then54, label %if.end58

if.then54:                                        ; preds = %if.end42
  %45 = load ptr, ptr %ssl.addr, align 8
  %46 = load ptr, ptr %ssl.addr, align 8
  %in_msg55 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 28
  %47 = load ptr, ptr %in_msg55, align 8
  %arrayidx56 = getelementptr inbounds i8, ptr %47, i64 1
  %48 = load i8, ptr %arrayidx56, align 1
  %conv57 = zext i8 %48 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %45, i32 noundef 1, ptr noundef @.str, i32 noundef 5178, ptr noundef @.str.88, i32 noundef %conv57)
  store i32 -30592, ptr %retval, align 4
  br label %return

if.end58:                                         ; preds = %if.end42
  %49 = load ptr, ptr %ssl.addr, align 8
  %in_msg59 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 28
  %50 = load ptr, ptr %in_msg59, align 8
  %arrayidx60 = getelementptr inbounds i8, ptr %50, i64 0
  %51 = load i8, ptr %arrayidx60, align 1
  %conv61 = zext i8 %51 to i32
  %cmp62 = icmp eq i32 %conv61, 1
  br i1 %cmp62, label %land.lhs.true64, label %if.end71

land.lhs.true64:                                  ; preds = %if.end58
  %52 = load ptr, ptr %ssl.addr, align 8
  %in_msg65 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 28
  %53 = load ptr, ptr %in_msg65, align 8
  %arrayidx66 = getelementptr inbounds i8, ptr %53, i64 1
  %54 = load i8, ptr %arrayidx66, align 1
  %conv67 = zext i8 %54 to i32
  %cmp68 = icmp eq i32 %conv67, 0
  br i1 %cmp68, label %if.then70, label %if.end71

if.then70:                                        ; preds = %land.lhs.true64
  %55 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %55, i32 noundef 2, ptr noundef @.str, i32 noundef 5185, ptr noundef @.str.89)
  store i32 -30848, ptr %retval, align 4
  br label %return

if.end71:                                         ; preds = %land.lhs.true64, %if.end58
  %56 = load ptr, ptr %ssl.addr, align 8
  %in_msg72 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %56, i32 0, i32 28
  %57 = load ptr, ptr %in_msg72, align 8
  %arrayidx73 = getelementptr inbounds i8, ptr %57, i64 0
  %58 = load i8, ptr %arrayidx73, align 1
  %conv74 = zext i8 %58 to i32
  %cmp75 = icmp eq i32 %conv74, 1
  br i1 %cmp75, label %land.lhs.true77, label %if.end84

land.lhs.true77:                                  ; preds = %if.end71
  %59 = load ptr, ptr %ssl.addr, align 8
  %in_msg78 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %59, i32 0, i32 28
  %60 = load ptr, ptr %in_msg78, align 8
  %arrayidx79 = getelementptr inbounds i8, ptr %60, i64 1
  %61 = load i8, ptr %arrayidx79, align 1
  %conv80 = zext i8 %61 to i32
  %cmp81 = icmp eq i32 %conv80, 100
  br i1 %cmp81, label %if.then83, label %if.end84

if.then83:                                        ; preds = %land.lhs.true77
  %62 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %62, i32 noundef 2, ptr noundef @.str, i32 noundef 5193, ptr noundef @.str.90)
  store i32 0, ptr %retval, align 4
  br label %return

if.end84:                                         ; preds = %land.lhs.true77, %if.end71
  store i32 -26240, ptr %retval, align 4
  br label %return

if.end85:                                         ; preds = %if.end32
  %63 = load ptr, ptr %ssl.addr, align 8
  %conf86 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %63, i32 0, i32 0
  %64 = load ptr, ptr %conf86, align 8
  %transport87 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %64, i32 0, i32 46
  %bf.load88 = load i32, ptr %transport87, align 4
  %bf.lshr89 = lshr i32 %bf.load88, 1
  %bf.clear90 = and i32 %bf.lshr89, 1
  %cmp91 = icmp eq i32 %bf.clear90, 1
  br i1 %cmp91, label %land.lhs.true93, label %if.end102

land.lhs.true93:                                  ; preds = %if.end85
  %65 = load ptr, ptr %ssl.addr, align 8
  %handshake94 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %65, i32 0, i32 15
  %66 = load ptr, ptr %handshake94, align 8
  %cmp95 = icmp ne ptr %66, null
  br i1 %cmp95, label %land.lhs.true97, label %if.end102

land.lhs.true97:                                  ; preds = %land.lhs.true93
  %67 = load ptr, ptr %ssl.addr, align 8
  %state98 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %67, i32 0, i32 1
  %68 = load i32, ptr %state98, align 8
  %cmp99 = icmp eq i32 %68, 16
  br i1 %cmp99, label %if.then101, label %if.end102

if.then101:                                       ; preds = %land.lhs.true97
  %69 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_handshake_wrapup_free_hs_transform(ptr noundef %69)
  br label %if.end102

if.end102:                                        ; preds = %if.then101, %land.lhs.true97, %land.lhs.true93, %if.end85
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end102, %if.end84, %if.then83, %if.then70, %if.then54, %if.then40, %if.end30, %if.then29, %if.then13, %if.then8, %if.then2
  %70 = load i32, ptr %retval, align 4
  ret i32 %70
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_buffer_message(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %hs = alloca ptr, align 8
  %recv_msg_seq_offset = alloca i32, align 4
  %recv_msg_seq = alloca i32, align 4
  %hs_buf = alloca ptr, align 8
  %msg_len = alloca i64, align 8
  %reassembly_buf_sz = alloca i64, align 8
  %frag_len = alloca i64, align 8
  %frag_off = alloca i64, align 8
  %msg = alloca ptr, align 8
  %bitmask = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 0, ptr %ret, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  %2 = load ptr, ptr %hs, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 4546, ptr noundef @.str.218)
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 30
  %5 = load i32, ptr %in_msgtype, align 8
  switch i32 %5, label %sw.default [
    i32 20, label %sw.bb
    i32 22, label %sw.bb1
  ]

sw.bb:                                            ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 2, ptr noundef @.str, i32 noundef 4551, ptr noundef @.str.219)
  %7 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 23
  %seen_ccs = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 1
  store i8 1, ptr %seen_ccs, align 8
  br label %sw.epilog

sw.bb1:                                           ; preds = %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 28
  %9 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %9, i64 4
  %10 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %10 to i32
  %shl = shl i32 %conv, 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_msg2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 28
  %12 = load ptr, ptr %in_msg2, align 8
  %arrayidx3 = getelementptr inbounds i8, ptr %12, i64 5
  %13 = load i8, ptr %arrayidx3, align 1
  %conv4 = zext i8 %13 to i32
  %or = or i32 %shl, %conv4
  store i32 %or, ptr %recv_msg_seq, align 4
  %14 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 37
  %15 = load i64, ptr %in_hslen, align 8
  %sub = sub i64 %15, 12
  store i64 %sub, ptr %msg_len, align 8
  %16 = load i32, ptr %recv_msg_seq, align 4
  %17 = load ptr, ptr %ssl.addr, align 8
  %handshake5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 15
  %18 = load ptr, ptr %handshake5, align 8
  %in_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %18, i32 0, i32 12
  %19 = load i32, ptr %in_msg_seq, align 4
  %cmp6 = icmp ult i32 %16, %19
  br i1 %cmp6, label %if.then8, label %if.end9

if.then8:                                         ; preds = %sw.bb1
  %20 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %20, i32 noundef 1, ptr noundef @.str, i32 noundef 4567, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end9:                                          ; preds = %sw.bb1
  %21 = load i32, ptr %recv_msg_seq, align 4
  %22 = load ptr, ptr %ssl.addr, align 8
  %handshake10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 15
  %23 = load ptr, ptr %handshake10, align 8
  %in_msg_seq11 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %23, i32 0, i32 12
  %24 = load i32, ptr %in_msg_seq11, align 4
  %sub12 = sub i32 %21, %24
  store i32 %sub12, ptr %recv_msg_seq_offset, align 4
  %25 = load i32, ptr %recv_msg_seq_offset, align 4
  %cmp13 = icmp uge i32 %25, 4
  br i1 %cmp13, label %if.then15, label %if.end21

if.then15:                                        ; preds = %if.end9
  %26 = load ptr, ptr %ssl.addr, align 8
  %27 = load i32, ptr %recv_msg_seq, align 4
  %28 = load ptr, ptr %ssl.addr, align 8
  %handshake16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 15
  %29 = load ptr, ptr %handshake16, align 8
  %in_msg_seq17 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %29, i32 0, i32 12
  %30 = load i32, ptr %in_msg_seq17, align 4
  %31 = load ptr, ptr %ssl.addr, align 8
  %handshake18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 15
  %32 = load ptr, ptr %handshake18, align 8
  %in_msg_seq19 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %32, i32 0, i32 12
  %33 = load i32, ptr %in_msg_seq19, align 4
  %add = add i32 %33, 4
  %sub20 = sub i32 %add, 1
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %26, i32 noundef 2, ptr noundef @.str, i32 noundef 4579, ptr noundef @.str.220, i32 noundef %27, i32 noundef %30, i32 noundef %sub20)
  br label %exit

if.end21:                                         ; preds = %if.end9
  %34 = load ptr, ptr %ssl.addr, align 8
  %35 = load i32, ptr %recv_msg_seq, align 4
  %36 = load i32, ptr %recv_msg_seq_offset, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %34, i32 noundef 2, ptr noundef @.str, i32 noundef 4585, ptr noundef @.str.221, i32 noundef %35, i32 noundef %36)
  %37 = load ptr, ptr %hs, align 8
  %buffering22 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %37, i32 0, i32 23
  %hs23 = getelementptr inbounds %struct.anon, ptr %buffering22, i32 0, i32 2
  %38 = load i32, ptr %recv_msg_seq_offset, align 4
  %idxprom = zext i32 %38 to i64
  %arrayidx24 = getelementptr inbounds [4 x %struct.mbedtls_ssl_hs_buffer], ptr %hs23, i64 0, i64 %idxprom
  store ptr %arrayidx24, ptr %hs_buf, align 8
  %39 = load ptr, ptr %hs_buf, align 8
  %bf.load = load i8, ptr %39, align 8
  %bf.clear = and i8 %bf.load, 1
  %bf.cast = zext i8 %bf.clear to i32
  %tobool = icmp ne i32 %bf.cast, 0
  br i1 %tobool, label %if.else92, label %if.then25

if.then25:                                        ; preds = %if.end21
  %40 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_hs_is_proper_fragment(ptr noundef %40)
  %cmp26 = icmp eq i32 %call, 1
  %conv27 = zext i1 %cmp26 to i32
  %41 = load ptr, ptr %hs_buf, align 8
  %42 = trunc i32 %conv27 to i8
  %bf.load28 = load i8, ptr %41, align 8
  %bf.value = and i8 %42, 1
  %bf.shl = shl i8 %bf.value, 1
  %bf.clear29 = and i8 %bf.load28, -3
  %bf.set = or i8 %bf.clear29, %bf.shl
  store i8 %bf.set, ptr %41, align 8
  %bf.result.cast = zext i8 %bf.value to i32
  %43 = load i64, ptr %msg_len, align 8
  %add30 = add i64 %43, 12
  %cmp31 = icmp ugt i64 %add30, 16384
  br i1 %cmp31, label %if.then33, label %if.end34

if.then33:                                        ; preds = %if.then25
  br label %exit

if.end34:                                         ; preds = %if.then25
  %44 = load ptr, ptr %hs, align 8
  %buffering35 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %44, i32 0, i32 23
  %total_bytes_buffered = getelementptr inbounds %struct.anon, ptr %buffering35, i32 0, i32 0
  %45 = load i64, ptr %total_bytes_buffered, align 8
  %cmp36 = icmp ugt i64 %45, 32768
  br i1 %cmp36, label %if.then38, label %if.end39

if.then38:                                        ; preds = %if.end34
  %46 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %46, i32 noundef 1, ptr noundef @.str, i32 noundef 4612, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end39:                                         ; preds = %if.end34
  %47 = load i64, ptr %msg_len, align 8
  %48 = load ptr, ptr %hs_buf, align 8
  %bf.load40 = load i8, ptr %48, align 8
  %bf.lshr = lshr i8 %bf.load40, 1
  %bf.clear41 = and i8 %bf.lshr, 1
  %bf.cast42 = zext i8 %bf.clear41 to i32
  %call43 = call i64 @ssl_get_reassembly_buffer_size(i64 noundef %47, i32 noundef %bf.cast42)
  store i64 %call43, ptr %reassembly_buf_sz, align 8
  %49 = load i64, ptr %reassembly_buf_sz, align 8
  %50 = load ptr, ptr %hs, align 8
  %buffering44 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %50, i32 0, i32 23
  %total_bytes_buffered45 = getelementptr inbounds %struct.anon, ptr %buffering44, i32 0, i32 0
  %51 = load i64, ptr %total_bytes_buffered45, align 8
  %sub46 = sub i64 32768, %51
  %cmp47 = icmp ugt i64 %49, %sub46
  br i1 %cmp47, label %if.then49, label %if.end72

if.then49:                                        ; preds = %if.end39
  %52 = load i32, ptr %recv_msg_seq_offset, align 4
  %cmp50 = icmp ugt i32 %52, 0
  br i1 %cmp50, label %if.then52, label %if.else

if.then52:                                        ; preds = %if.then49
  %53 = load ptr, ptr %ssl.addr, align 8
  %54 = load i64, ptr %msg_len, align 8
  %conv53 = trunc i64 %54 to i32
  %55 = load ptr, ptr %hs, align 8
  %buffering54 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %55, i32 0, i32 23
  %total_bytes_buffered55 = getelementptr inbounds %struct.anon, ptr %buffering54, i32 0, i32 0
  %56 = load i64, ptr %total_bytes_buffered55, align 8
  %conv56 = trunc i64 %56 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %53, i32 noundef 2, ptr noundef @.str, i32 noundef 4628, ptr noundef @.str.222, i32 noundef %conv53, i32 noundef 32768, i32 noundef %conv56)
  br label %exit

if.else:                                          ; preds = %if.then49
  %57 = load ptr, ptr %ssl.addr, align 8
  %58 = load i64, ptr %msg_len, align 8
  %conv57 = trunc i64 %58 to i32
  %59 = load ptr, ptr %hs, align 8
  %buffering58 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %59, i32 0, i32 23
  %total_bytes_buffered59 = getelementptr inbounds %struct.anon, ptr %buffering58, i32 0, i32 0
  %60 = load i64, ptr %total_bytes_buffered59, align 8
  %conv60 = trunc i64 %60 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %57, i32 noundef 2, ptr noundef @.str, i32 noundef 4635, ptr noundef @.str.223, i32 noundef %conv57, i32 noundef 32768, i32 noundef %conv60)
  br label %if.end61

if.end61:                                         ; preds = %if.else
  %61 = load ptr, ptr %ssl.addr, align 8
  %62 = load i64, ptr %reassembly_buf_sz, align 8
  %call62 = call i32 @ssl_buffer_make_space(ptr noundef %61, i64 noundef %62)
  %cmp63 = icmp ne i32 %call62, 0
  br i1 %cmp63, label %if.then65, label %if.end71

if.then65:                                        ; preds = %if.end61
  %63 = load ptr, ptr %ssl.addr, align 8
  %64 = load i64, ptr %msg_len, align 8
  %conv66 = trunc i64 %64 to i32
  %65 = load i64, ptr %reassembly_buf_sz, align 8
  %conv67 = trunc i64 %65 to i32
  %66 = load ptr, ptr %hs, align 8
  %buffering68 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %66, i32 0, i32 23
  %total_bytes_buffered69 = getelementptr inbounds %struct.anon, ptr %buffering68, i32 0, i32 0
  %67 = load i64, ptr %total_bytes_buffered69, align 8
  %conv70 = trunc i64 %67 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %63, i32 noundef 2, ptr noundef @.str, i32 noundef 4644, ptr noundef @.str.224, i32 noundef %conv66, i32 noundef %conv67, i32 noundef 32768, i32 noundef %conv70)
  store i32 -27136, ptr %ret, align 4
  br label %exit

if.end71:                                         ; preds = %if.end61
  br label %if.end72

if.end72:                                         ; preds = %if.end71, %if.end39
  %68 = load ptr, ptr %ssl.addr, align 8
  %69 = load i64, ptr %msg_len, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %68, i32 noundef 2, ptr noundef @.str, i32 noundef 4651, ptr noundef @.str.225, i64 noundef %69)
  %70 = load i64, ptr %reassembly_buf_sz, align 8
  %call73 = call noalias ptr @calloc(i64 noundef 1, i64 noundef %70) #9
  %71 = load ptr, ptr %hs_buf, align 8
  %data = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %71, i32 0, i32 1
  store ptr %call73, ptr %data, align 8
  %72 = load ptr, ptr %hs_buf, align 8
  %data74 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %72, i32 0, i32 1
  %73 = load ptr, ptr %data74, align 8
  %cmp75 = icmp eq ptr %73, null
  br i1 %cmp75, label %if.then77, label %if.end78

if.then77:                                        ; preds = %if.end72
  store i32 -32512, ptr %ret, align 4
  br label %exit

if.end78:                                         ; preds = %if.end72
  %74 = load i64, ptr %reassembly_buf_sz, align 8
  %75 = load ptr, ptr %hs_buf, align 8
  %data_len = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %75, i32 0, i32 2
  store i64 %74, ptr %data_len, align 8
  %76 = load ptr, ptr %hs_buf, align 8
  %data79 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %76, i32 0, i32 1
  %77 = load ptr, ptr %data79, align 8
  %78 = load ptr, ptr %ssl.addr, align 8
  %in_msg80 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %78, i32 0, i32 28
  %79 = load ptr, ptr %in_msg80, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %77, ptr align 1 %79, i64 6, i1 false)
  %80 = load ptr, ptr %hs_buf, align 8
  %data81 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %80, i32 0, i32 1
  %81 = load ptr, ptr %data81, align 8
  %add.ptr = getelementptr inbounds i8, ptr %81, i64 6
  call void @llvm.memset.p0.i64(ptr align 1 %add.ptr, i8 0, i64 3, i1 false)
  %82 = load ptr, ptr %hs_buf, align 8
  %data82 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %82, i32 0, i32 1
  %83 = load ptr, ptr %data82, align 8
  %add.ptr83 = getelementptr inbounds i8, ptr %83, i64 9
  %84 = load ptr, ptr %hs_buf, align 8
  %data84 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %84, i32 0, i32 1
  %85 = load ptr, ptr %data84, align 8
  %add.ptr85 = getelementptr inbounds i8, ptr %85, i64 1
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr83, ptr align 1 %add.ptr85, i64 3, i1 false)
  %86 = load ptr, ptr %hs_buf, align 8
  %bf.load86 = load i8, ptr %86, align 8
  %bf.clear87 = and i8 %bf.load86, -2
  %bf.set88 = or i8 %bf.clear87, 1
  store i8 %bf.set88, ptr %86, align 8
  %87 = load i64, ptr %reassembly_buf_sz, align 8
  %88 = load ptr, ptr %hs, align 8
  %buffering89 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %88, i32 0, i32 23
  %total_bytes_buffered90 = getelementptr inbounds %struct.anon, ptr %buffering89, i32 0, i32 0
  %89 = load i64, ptr %total_bytes_buffered90, align 8
  %add91 = add i64 %89, %87
  store i64 %add91, ptr %total_bytes_buffered90, align 8
  br label %if.end100

if.else92:                                        ; preds = %if.end21
  %90 = load ptr, ptr %hs_buf, align 8
  %data93 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %90, i32 0, i32 1
  %91 = load ptr, ptr %data93, align 8
  %92 = load ptr, ptr %ssl.addr, align 8
  %in_msg94 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %92, i32 0, i32 28
  %93 = load ptr, ptr %in_msg94, align 8
  %call95 = call i32 @memcmp(ptr noundef %91, ptr noundef %93, i64 noundef 4) #7
  %cmp96 = icmp ne i32 %call95, 0
  br i1 %cmp96, label %if.then98, label %if.end99

if.then98:                                        ; preds = %if.else92
  %94 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %94, i32 noundef 1, ptr noundef @.str, i32 noundef 4676, ptr noundef @.str.226)
  br label %exit

if.end99:                                         ; preds = %if.else92
  br label %if.end100

if.end100:                                        ; preds = %if.end99, %if.end78
  %95 = load ptr, ptr %hs_buf, align 8
  %bf.load101 = load i8, ptr %95, align 8
  %bf.lshr102 = lshr i8 %bf.load101, 2
  %bf.clear103 = and i8 %bf.lshr102, 1
  %bf.cast104 = zext i8 %bf.clear103 to i32
  %tobool105 = icmp ne i32 %bf.cast104, 0
  br i1 %tobool105, label %if.end142, label %if.then106

if.then106:                                       ; preds = %if.end100
  %96 = load ptr, ptr %hs_buf, align 8
  %data107 = getelementptr inbounds %struct.mbedtls_ssl_hs_buffer, ptr %96, i32 0, i32 1
  %97 = load ptr, ptr %data107, align 8
  %add.ptr108 = getelementptr inbounds i8, ptr %97, i64 12
  store ptr %add.ptr108, ptr %msg, align 8
  %98 = load ptr, ptr %ssl.addr, align 8
  %call109 = call i32 @ssl_get_hs_frag_off(ptr noundef %98)
  %conv110 = zext i32 %call109 to i64
  store i64 %conv110, ptr %frag_off, align 8
  %99 = load ptr, ptr %ssl.addr, align 8
  %call111 = call i32 @ssl_get_hs_frag_len(ptr noundef %99)
  %conv112 = zext i32 %call111 to i64
  store i64 %conv112, ptr %frag_len, align 8
  %100 = load ptr, ptr %ssl.addr, align 8
  %101 = load i64, ptr %frag_off, align 8
  %102 = load i64, ptr %frag_len, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %100, i32 noundef 2, ptr noundef @.str, i32 noundef 4697, ptr noundef @.str.227, i64 noundef %101, i64 noundef %102)
  %103 = load ptr, ptr %msg, align 8
  %104 = load i64, ptr %frag_off, align 8
  %add.ptr113 = getelementptr inbounds i8, ptr %103, i64 %104
  %105 = load ptr, ptr %ssl.addr, align 8
  %in_msg114 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %105, i32 0, i32 28
  %106 = load ptr, ptr %in_msg114, align 8
  %add.ptr115 = getelementptr inbounds i8, ptr %106, i64 12
  %107 = load i64, ptr %frag_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr113, ptr align 1 %add.ptr115, i64 %107, i1 false)
  %108 = load ptr, ptr %hs_buf, align 8
  %bf.load116 = load i8, ptr %108, align 8
  %bf.lshr117 = lshr i8 %bf.load116, 1
  %bf.clear118 = and i8 %bf.lshr117, 1
  %bf.cast119 = zext i8 %bf.clear118 to i32
  %tobool120 = icmp ne i32 %bf.cast119, 0
  br i1 %tobool120, label %if.then121, label %if.else132

if.then121:                                       ; preds = %if.then106
  %109 = load ptr, ptr %msg, align 8
  %110 = load i64, ptr %msg_len, align 8
  %add.ptr122 = getelementptr inbounds i8, ptr %109, i64 %110
  store ptr %add.ptr122, ptr %bitmask, align 8
  %111 = load ptr, ptr %bitmask, align 8
  %112 = load i64, ptr %frag_off, align 8
  %113 = load i64, ptr %frag_len, align 8
  call void @ssl_bitmask_set(ptr noundef %111, i64 noundef %112, i64 noundef %113)
  %114 = load ptr, ptr %bitmask, align 8
  %115 = load i64, ptr %msg_len, align 8
  %call123 = call i32 @ssl_bitmask_check(ptr noundef %114, i64 noundef %115)
  %cmp124 = icmp eq i32 %call123, 0
  %conv125 = zext i1 %cmp124 to i32
  %116 = load ptr, ptr %hs_buf, align 8
  %117 = trunc i32 %conv125 to i8
  %bf.load126 = load i8, ptr %116, align 8
  %bf.value127 = and i8 %117, 1
  %bf.shl128 = shl i8 %bf.value127, 2
  %bf.clear129 = and i8 %bf.load126, -5
  %bf.set130 = or i8 %bf.clear129, %bf.shl128
  store i8 %bf.set130, ptr %116, align 8
  %bf.result.cast131 = zext i8 %bf.value127 to i32
  br label %if.end136

if.else132:                                       ; preds = %if.then106
  %118 = load ptr, ptr %hs_buf, align 8
  %bf.load133 = load i8, ptr %118, align 8
  %bf.clear134 = and i8 %bf.load133, -5
  %bf.set135 = or i8 %bf.clear134, 4
  store i8 %bf.set135, ptr %118, align 8
  br label %if.end136

if.end136:                                        ; preds = %if.else132, %if.then121
  %119 = load ptr, ptr %ssl.addr, align 8
  %120 = load ptr, ptr %hs_buf, align 8
  %bf.load137 = load i8, ptr %120, align 8
  %bf.lshr138 = lshr i8 %bf.load137, 2
  %bf.clear139 = and i8 %bf.lshr138, 1
  %bf.cast140 = zext i8 %bf.clear139 to i32
  %tobool141 = icmp ne i32 %bf.cast140, 0
  %121 = zext i1 %tobool141 to i64
  %cond = select i1 %tobool141, ptr @.str.229, ptr @.str.230
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %119, i32 noundef 2, ptr noundef @.str, i32 noundef 4713, ptr noundef @.str.228, ptr noundef %cond)
  br label %if.end142

if.end142:                                        ; preds = %if.end136, %if.end100
  br label %sw.epilog

sw.default:                                       ; preds = %if.end
  br label %sw.epilog

sw.epilog:                                        ; preds = %sw.default, %if.end142, %sw.bb
  br label %exit

exit:                                             ; preds = %sw.epilog, %if.then98, %if.then77, %if.then65, %if.then52, %if.then33, %if.then15
  %122 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %122, i32 noundef 2, ptr noundef @.str, i32 noundef 4726, ptr noundef @.str.231)
  %123 = load i32, ptr %ret, align 4
  store i32 %123, ptr %retval, align 4
  br label %return

return:                                           ; preds = %exit, %if.then38, %if.then8, %if.then
  %124 = load i32, ptr %retval, align 4
  ret i32 %124
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_handshake_wrapup_free_hs_transform(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 3, ptr noundef @.str, i32 noundef 6309, ptr noundef @.str.298)
  %1 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_ssl_handshake_free(ptr noundef %1)
  %2 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 15
  %3 = load ptr, ptr %handshake, align 8
  call void @free(ptr noundef %3) #8
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  store ptr null, ptr %handshake1, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %transform = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 18
  %6 = load ptr, ptr %transform, align 8
  %tobool = icmp ne ptr %6, null
  br i1 %tobool, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %7 = load ptr, ptr %ssl.addr, align 8
  %transform2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 18
  %8 = load ptr, ptr %transform2, align 8
  call void @mbedtls_ssl_transform_free(ptr noundef %8)
  %9 = load ptr, ptr %ssl.addr, align 8
  %transform3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 18
  %10 = load ptr, ptr %transform3, align 8
  call void @free(ptr noundef %10) #8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 19
  %12 = load ptr, ptr %transform_negotiate, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %transform4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 18
  store ptr %12, ptr %transform4, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 19
  store ptr null, ptr %transform_negotiate5, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %15, i32 noundef 3, ptr noundef @.str, i32 noundef 6329, ptr noundef @.str.299)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_send_fatal_handshake_failure(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %0, i8 noundef zeroext 2, i8 noundef zeroext 40)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %1 = load i32, ptr %ret, align 4
  store i32 %1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %2 = load i32, ptr %retval, align 4
  ret i32 %2
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_send_alert_message(ptr noundef %ssl, i8 noundef zeroext %level, i8 noundef zeroext %message) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %level.addr = alloca i8, align 1
  %message.addr = alloca i8, align 1
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i8 %level, ptr %level.addr, align 1
  store i8 %message, ptr %message.addr, align 1
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %conf, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 5250, ptr noundef @.str.91)
  %4 = load ptr, ptr %ssl.addr, align 8
  %5 = load i8, ptr %level.addr, align 1
  %conv = zext i8 %5 to i32
  %6 = load i8, ptr %message.addr, align 1
  %conv2 = zext i8 %6 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %4, i32 noundef 3, ptr noundef @.str, i32 noundef 5251, ptr noundef @.str.92, i32 noundef %conv, i32 noundef %conv2)
  %7 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 47
  store i32 21, ptr %out_msgtype, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 48
  store i64 2, ptr %out_msglen, align 8
  %9 = load i8, ptr %level.addr, align 1
  %10 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 46
  %11 = load ptr, ptr %out_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %11, i64 0
  store i8 %9, ptr %arrayidx, align 1
  %12 = load i8, ptr %message.addr, align 1
  %13 = load ptr, ptr %ssl.addr, align 8
  %out_msg3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 46
  %14 = load ptr, ptr %out_msg3, align 8
  %arrayidx4 = getelementptr inbounds i8, ptr %14, i64 1
  store i8 %12, ptr %arrayidx4, align 1
  %15 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_write_record(ptr noundef %15, i8 noundef zeroext 1)
  store i32 %call, ptr %ret, align 4
  %cmp5 = icmp ne i32 %call, 0
  br i1 %cmp5, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end
  %16 = load ptr, ptr %ssl.addr, align 8
  %17 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %16, i32 noundef 1, ptr noundef @.str, i32 noundef 5260, ptr noundef @.str.52, i32 noundef %17)
  %18 = load i32, ptr %ret, align 4
  store i32 %18, ptr %retval, align 4
  br label %return

if.end8:                                          ; preds = %if.end
  %19 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %19, i32 noundef 2, ptr noundef @.str, i32 noundef 5263, ptr noundef @.str.93)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end8, %if.then7, %if.then
  %20 = load i32, ptr %retval, align 4
  ret i32 %20
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_write_certificate(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %i = alloca i64, align 8
  %n = alloca i64, align 8
  %crt = alloca ptr, align 8
  %ciphersuite_info = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 -28800, ptr %ret, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 19
  %1 = load ptr, ptr %transform_negotiate, align 8
  %ciphersuite_info1 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %ciphersuite_info1, align 8
  store ptr %2, ptr %ciphersuite_info, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 5329, ptr noundef @.str.94)
  %4 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %4, i32 0, i32 4
  %5 = load i32, ptr %key_exchange, align 8
  %cmp = icmp eq i32 %5, 5
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %6 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange2 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %6, i32 0, i32 4
  %7 = load i32, ptr %key_exchange2, align 8
  %cmp3 = icmp eq i32 %7, 6
  br i1 %cmp3, label %if.then, label %lor.lhs.false4

lor.lhs.false4:                                   ; preds = %lor.lhs.false
  %8 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange5 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %8, i32 0, i32 4
  %9 = load i32, ptr %key_exchange5, align 8
  %cmp6 = icmp eq i32 %9, 8
  br i1 %cmp6, label %if.then, label %lor.lhs.false7

lor.lhs.false7:                                   ; preds = %lor.lhs.false4
  %10 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange8 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %10, i32 0, i32 4
  %11 = load i32, ptr %key_exchange8, align 8
  %cmp9 = icmp eq i32 %11, 11
  br i1 %cmp9, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false7, %lor.lhs.false4, %lor.lhs.false, %entry
  %12 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %12, i32 noundef 2, ptr noundef @.str, i32 noundef 5336, ptr noundef @.str.95)
  %13 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 1
  %14 = load i32, ptr %state, align 8
  %inc = add nsw i32 %14, 1
  store i32 %inc, ptr %state, align 8
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false7
  %15 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 0
  %16 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %16, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp10 = icmp eq i32 %bf.clear, 0
  br i1 %cmp10, label %if.then11, label %if.end17

if.then11:                                        ; preds = %if.end
  %17 = load ptr, ptr %ssl.addr, align 8
  %client_auth = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 53
  %18 = load i32, ptr %client_auth, align 4
  %cmp12 = icmp eq i32 %18, 0
  br i1 %cmp12, label %if.then13, label %if.end16

if.then13:                                        ; preds = %if.then11
  %19 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %19, i32 noundef 2, ptr noundef @.str, i32 noundef 5346, ptr noundef @.str.95)
  %20 = load ptr, ptr %ssl.addr, align 8
  %state14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 1
  %21 = load i32, ptr %state14, align 8
  %inc15 = add nsw i32 %21, 1
  store i32 %inc15, ptr %state14, align 8
  store i32 0, ptr %retval, align 4
  br label %return

if.end16:                                         ; preds = %if.then11
  br label %if.end17

if.end17:                                         ; preds = %if.end16, %if.end
  %22 = load ptr, ptr %ssl.addr, align 8
  %conf18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 0
  %23 = load ptr, ptr %conf18, align 8
  %endpoint19 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %23, i32 0, i32 46
  %bf.load20 = load i32, ptr %endpoint19, align 4
  %bf.clear21 = and i32 %bf.load20, 1
  %cmp22 = icmp eq i32 %bf.clear21, 1
  br i1 %cmp22, label %if.then23, label %if.end27

if.then23:                                        ; preds = %if.end17
  %24 = load ptr, ptr %ssl.addr, align 8
  %call = call ptr @mbedtls_ssl_own_cert(ptr noundef %24)
  %cmp24 = icmp eq ptr %call, null
  br i1 %cmp24, label %if.then25, label %if.end26

if.then25:                                        ; preds = %if.then23
  %25 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %25, i32 noundef 1, ptr noundef @.str, i32 noundef 5375, ptr noundef @.str.96)
  store i32 -30080, ptr %retval, align 4
  br label %return

if.end26:                                         ; preds = %if.then23
  br label %if.end27

if.end27:                                         ; preds = %if.end26, %if.end17
  %26 = load ptr, ptr %ssl.addr, align 8
  %27 = load ptr, ptr %ssl.addr, align 8
  %call28 = call ptr @mbedtls_ssl_own_cert(ptr noundef %27)
  call void @mbedtls_debug_print_crt(ptr noundef %26, i32 noundef 3, ptr noundef @.str, i32 noundef 5381, ptr noundef @.str.97, ptr noundef %call28)
  store i64 7, ptr %i, align 8
  %28 = load ptr, ptr %ssl.addr, align 8
  %call29 = call ptr @mbedtls_ssl_own_cert(ptr noundef %28)
  store ptr %call29, ptr %crt, align 8
  br label %while.cond

while.cond:                                       ; preds = %if.end34, %if.end27
  %29 = load ptr, ptr %crt, align 8
  %cmp30 = icmp ne ptr %29, null
  br i1 %cmp30, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %30 = load ptr, ptr %crt, align 8
  %raw = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %30, i32 0, i32 0
  %len = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw, i32 0, i32 1
  %31 = load i64, ptr %len, align 8
  store i64 %31, ptr %n, align 8
  %32 = load i64, ptr %n, align 8
  %33 = load i64, ptr %i, align 8
  %sub = sub i64 16381, %33
  %cmp31 = icmp ugt i64 %32, %sub
  br i1 %cmp31, label %if.then32, label %if.end34

if.then32:                                        ; preds = %while.body
  %34 = load ptr, ptr %ssl.addr, align 8
  %35 = load i64, ptr %i, align 8
  %add = add i64 %35, 3
  %36 = load i64, ptr %n, align 8
  %add33 = add i64 %add, %36
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %34, i32 noundef 1, ptr noundef @.str, i32 noundef 5401, ptr noundef @.str.98, i64 noundef %add33, i32 noundef 16384)
  store i32 -29952, ptr %retval, align 4
  br label %return

if.end34:                                         ; preds = %while.body
  %37 = load i64, ptr %n, align 8
  %shr = lshr i64 %37, 16
  %conv = trunc i64 %shr to i8
  %38 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 46
  %39 = load ptr, ptr %out_msg, align 8
  %40 = load i64, ptr %i, align 8
  %arrayidx = getelementptr inbounds i8, ptr %39, i64 %40
  store i8 %conv, ptr %arrayidx, align 1
  %41 = load i64, ptr %n, align 8
  %shr35 = lshr i64 %41, 8
  %conv36 = trunc i64 %shr35 to i8
  %42 = load ptr, ptr %ssl.addr, align 8
  %out_msg37 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 46
  %43 = load ptr, ptr %out_msg37, align 8
  %44 = load i64, ptr %i, align 8
  %add38 = add i64 %44, 1
  %arrayidx39 = getelementptr inbounds i8, ptr %43, i64 %add38
  store i8 %conv36, ptr %arrayidx39, align 1
  %45 = load i64, ptr %n, align 8
  %conv40 = trunc i64 %45 to i8
  %46 = load ptr, ptr %ssl.addr, align 8
  %out_msg41 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 46
  %47 = load ptr, ptr %out_msg41, align 8
  %48 = load i64, ptr %i, align 8
  %add42 = add i64 %48, 2
  %arrayidx43 = getelementptr inbounds i8, ptr %47, i64 %add42
  store i8 %conv40, ptr %arrayidx43, align 1
  %49 = load i64, ptr %i, align 8
  %add44 = add i64 %49, 3
  store i64 %add44, ptr %i, align 8
  %50 = load ptr, ptr %ssl.addr, align 8
  %out_msg45 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %50, i32 0, i32 46
  %51 = load ptr, ptr %out_msg45, align 8
  %52 = load i64, ptr %i, align 8
  %add.ptr = getelementptr inbounds i8, ptr %51, i64 %52
  %53 = load ptr, ptr %crt, align 8
  %raw46 = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %53, i32 0, i32 0
  %p = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw46, i32 0, i32 2
  %54 = load ptr, ptr %p, align 8
  %55 = load i64, ptr %n, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr, ptr align 1 %54, i64 %55, i1 false)
  %56 = load i64, ptr %n, align 8
  %57 = load i64, ptr %i, align 8
  %add47 = add i64 %57, %56
  store i64 %add47, ptr %i, align 8
  %58 = load ptr, ptr %crt, align 8
  %next = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %58, i32 0, i32 26
  %59 = load ptr, ptr %next, align 8
  store ptr %59, ptr %crt, align 8
  br label %while.cond, !llvm.loop !23

while.end:                                        ; preds = %while.cond
  %60 = load i64, ptr %i, align 8
  %sub48 = sub i64 %60, 7
  %shr49 = lshr i64 %sub48, 16
  %conv50 = trunc i64 %shr49 to i8
  %61 = load ptr, ptr %ssl.addr, align 8
  %out_msg51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %61, i32 0, i32 46
  %62 = load ptr, ptr %out_msg51, align 8
  %arrayidx52 = getelementptr inbounds i8, ptr %62, i64 4
  store i8 %conv50, ptr %arrayidx52, align 1
  %63 = load i64, ptr %i, align 8
  %sub53 = sub i64 %63, 7
  %shr54 = lshr i64 %sub53, 8
  %conv55 = trunc i64 %shr54 to i8
  %64 = load ptr, ptr %ssl.addr, align 8
  %out_msg56 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %64, i32 0, i32 46
  %65 = load ptr, ptr %out_msg56, align 8
  %arrayidx57 = getelementptr inbounds i8, ptr %65, i64 5
  store i8 %conv55, ptr %arrayidx57, align 1
  %66 = load i64, ptr %i, align 8
  %sub58 = sub i64 %66, 7
  %conv59 = trunc i64 %sub58 to i8
  %67 = load ptr, ptr %ssl.addr, align 8
  %out_msg60 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %67, i32 0, i32 46
  %68 = load ptr, ptr %out_msg60, align 8
  %arrayidx61 = getelementptr inbounds i8, ptr %68, i64 6
  store i8 %conv59, ptr %arrayidx61, align 1
  %69 = load i64, ptr %i, align 8
  %70 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %70, i32 0, i32 48
  store i64 %69, ptr %out_msglen, align 8
  %71 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %71, i32 0, i32 47
  store i32 22, ptr %out_msgtype, align 8
  %72 = load ptr, ptr %ssl.addr, align 8
  %out_msg62 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %72, i32 0, i32 46
  %73 = load ptr, ptr %out_msg62, align 8
  %arrayidx63 = getelementptr inbounds i8, ptr %73, i64 0
  store i8 11, ptr %arrayidx63, align 1
  %74 = load ptr, ptr %ssl.addr, align 8
  %state64 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %74, i32 0, i32 1
  %75 = load i32, ptr %state64, align 8
  %inc65 = add nsw i32 %75, 1
  store i32 %inc65, ptr %state64, align 8
  %76 = load ptr, ptr %ssl.addr, align 8
  %call66 = call i32 @mbedtls_ssl_write_handshake_msg(ptr noundef %76)
  store i32 %call66, ptr %ret, align 4
  %cmp67 = icmp ne i32 %call66, 0
  br i1 %cmp67, label %if.then69, label %if.end70

if.then69:                                        ; preds = %while.end
  %77 = load ptr, ptr %ssl.addr, align 8
  %78 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %77, i32 noundef 1, ptr noundef @.str, i32 noundef 5429, ptr noundef @.str.99, i32 noundef %78)
  %79 = load i32, ptr %ret, align 4
  store i32 %79, ptr %retval, align 4
  br label %return

if.end70:                                         ; preds = %while.end
  %80 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %80, i32 noundef 2, ptr noundef @.str, i32 noundef 5433, ptr noundef @.str.100)
  %81 = load i32, ptr %ret, align 4
  store i32 %81, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end70, %if.then69, %if.then32, %if.then25, %if.then13, %if.then
  %82 = load i32, ptr %retval, align 4
  ret i32 %82
}

; Function Attrs: noinline nounwind optnone uwtable
define internal ptr @mbedtls_ssl_own_cert(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %key_cert = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %cmp = icmp ne ptr %1, null
  br i1 %cmp, label %land.lhs.true, label %if.else

land.lhs.true:                                    ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 15
  %3 = load ptr, ptr %handshake1, align 8
  %key_cert2 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 6
  %4 = load ptr, ptr %key_cert2, align 8
  %cmp3 = icmp ne ptr %4, null
  br i1 %cmp3, label %if.then, label %if.else

if.then:                                          ; preds = %land.lhs.true
  %5 = load ptr, ptr %ssl.addr, align 8
  %handshake4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 15
  %6 = load ptr, ptr %handshake4, align 8
  %key_cert5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 6
  %7 = load ptr, ptr %key_cert5, align 8
  store ptr %7, ptr %key_cert, align 8
  br label %if.end

if.else:                                          ; preds = %land.lhs.true, %entry
  %8 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 0
  %9 = load ptr, ptr %conf, align 8
  %key_cert6 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %9, i32 0, i32 23
  %10 = load ptr, ptr %key_cert6, align 8
  store ptr %10, ptr %key_cert, align 8
  br label %if.end

if.end:                                           ; preds = %if.else, %if.then
  %11 = load ptr, ptr %key_cert, align 8
  %cmp7 = icmp eq ptr %11, null
  br i1 %cmp7, label %cond.true, label %cond.false

cond.true:                                        ; preds = %if.end
  br label %cond.end

cond.false:                                       ; preds = %if.end
  %12 = load ptr, ptr %key_cert, align 8
  %cert = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %12, i32 0, i32 0
  %13 = load ptr, ptr %cert, align 8
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond = phi ptr [ null, %cond.true ], [ %13, %cond.false ]
  ret ptr %cond
}

declare void @mbedtls_debug_print_crt(ptr noundef, i32 noundef, ptr noundef, i32 noundef, ptr noundef, ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_parse_certificate(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %ciphersuite_info = alloca ptr, align 8
  %authmode = alloca i32, align 4
  %rs_ctx = alloca ptr, align 8
  %ca_chain = alloca ptr, align 8
  %ca_crl = alloca ptr, align 8
  %pk = alloca ptr, align 8
  %alert = alloca i8, align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 19
  %1 = load ptr, ptr %transform_negotiate, align 8
  %ciphersuite_info1 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %ciphersuite_info1, align 8
  store ptr %2, ptr %ciphersuite_info, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 15
  %4 = load ptr, ptr %handshake, align 8
  %sni_authmode = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 7
  %5 = load i32, ptr %sni_authmode, align 8
  %cmp = icmp ne i32 %5, 3
  br i1 %cmp, label %cond.true, label %cond.false

cond.true:                                        ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake2, align 8
  %sni_authmode3 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 7
  %8 = load i32, ptr %sni_authmode3, align 8
  br label %cond.end

cond.false:                                       ; preds = %entry
  %9 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 0
  %10 = load ptr, ptr %conf, align 8
  %authmode4 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %10, i32 0, i32 46
  %bf.load = load i32, ptr %authmode4, align 4
  %bf.lshr = lshr i32 %bf.load, 2
  %bf.clear = and i32 %bf.lshr, 3
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond = phi i32 [ %8, %cond.true ], [ %bf.clear, %cond.false ]
  store i32 %cond, ptr %authmode, align 4
  store ptr null, ptr %rs_ctx, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %11, i32 noundef 2, ptr noundef @.str, i32 noundef 5655, ptr noundef @.str.101)
  %12 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %12, i32 0, i32 4
  %13 = load i32, ptr %key_exchange, align 8
  %cmp5 = icmp eq i32 %13, 5
  br i1 %cmp5, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %cond.end
  %14 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange6 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %14, i32 0, i32 4
  %15 = load i32, ptr %key_exchange6, align 8
  %cmp7 = icmp eq i32 %15, 6
  br i1 %cmp7, label %if.then, label %lor.lhs.false8

lor.lhs.false8:                                   ; preds = %lor.lhs.false
  %16 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange9 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %16, i32 0, i32 4
  %17 = load i32, ptr %key_exchange9, align 8
  %cmp10 = icmp eq i32 %17, 8
  br i1 %cmp10, label %if.then, label %lor.lhs.false11

lor.lhs.false11:                                  ; preds = %lor.lhs.false8
  %18 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange12 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %18, i32 0, i32 4
  %19 = load i32, ptr %key_exchange12, align 8
  %cmp13 = icmp eq i32 %19, 11
  br i1 %cmp13, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false11, %lor.lhs.false8, %lor.lhs.false, %cond.end
  %20 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %20, i32 noundef 2, ptr noundef @.str, i32 noundef 5662, ptr noundef @.str.102)
  %21 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 1
  %22 = load i32, ptr %state, align 8
  %inc = add nsw i32 %22, 1
  store i32 %inc, ptr %state, align 8
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false11
  %23 = load ptr, ptr %ssl.addr, align 8
  %conf14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 0
  %24 = load ptr, ptr %conf14, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %24, i32 0, i32 46
  %bf.load15 = load i32, ptr %endpoint, align 4
  %bf.clear16 = and i32 %bf.load15, 1
  %cmp17 = icmp eq i32 %bf.clear16, 1
  br i1 %cmp17, label %land.lhs.true, label %if.end23

land.lhs.true:                                    ; preds = %if.end
  %25 = load ptr, ptr %ciphersuite_info, align 8
  %key_exchange18 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %25, i32 0, i32 4
  %26 = load i32, ptr %key_exchange18, align 8
  %cmp19 = icmp eq i32 %26, 7
  br i1 %cmp19, label %if.then20, label %if.end23

if.then20:                                        ; preds = %land.lhs.true
  %27 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %27, i32 noundef 2, ptr noundef @.str, i32 noundef 5671, ptr noundef @.str.102)
  %28 = load ptr, ptr %ssl.addr, align 8
  %state21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 1
  %29 = load i32, ptr %state21, align 8
  %inc22 = add nsw i32 %29, 1
  store i32 %inc22, ptr %state21, align 8
  store i32 0, ptr %retval, align 4
  br label %return

if.end23:                                         ; preds = %land.lhs.true, %if.end
  %30 = load ptr, ptr %ssl.addr, align 8
  %conf24 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 0
  %31 = load ptr, ptr %conf24, align 8
  %endpoint25 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %31, i32 0, i32 46
  %bf.load26 = load i32, ptr %endpoint25, align 4
  %bf.clear27 = and i32 %bf.load26, 1
  %cmp28 = icmp eq i32 %bf.clear27, 1
  br i1 %cmp28, label %land.lhs.true29, label %if.end34

land.lhs.true29:                                  ; preds = %if.end23
  %32 = load i32, ptr %authmode, align 4
  %cmp30 = icmp eq i32 %32, 0
  br i1 %cmp30, label %if.then31, label %if.end34

if.then31:                                        ; preds = %land.lhs.true29
  %33 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 14
  %34 = load ptr, ptr %session_negotiate, align 8
  %verify_result = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %34, i32 0, i32 7
  store i32 128, ptr %verify_result, align 8
  %35 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %35, i32 noundef 2, ptr noundef @.str, i32 noundef 5680, ptr noundef @.str.102)
  %36 = load ptr, ptr %ssl.addr, align 8
  %state32 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 1
  %37 = load i32, ptr %state32, align 8
  %inc33 = add nsw i32 %37, 1
  store i32 %inc33, ptr %state32, align 8
  store i32 0, ptr %retval, align 4
  br label %return

if.end34:                                         ; preds = %land.lhs.true29, %if.end23
  %38 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_read_record(ptr noundef %38, i32 noundef 1)
  store i32 %call, ptr %ret, align 4
  %cmp35 = icmp ne i32 %call, 0
  br i1 %cmp35, label %if.then36, label %if.end37

if.then36:                                        ; preds = %if.end34
  %39 = load ptr, ptr %ssl.addr, align 8
  %40 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %39, i32 noundef 1, ptr noundef @.str, i32 noundef 5699, ptr noundef @.str.103, i32 noundef %40)
  %41 = load i32, ptr %ret, align 4
  store i32 %41, ptr %retval, align 4
  br label %return

if.end37:                                         ; preds = %if.end34
  %42 = load ptr, ptr %ssl.addr, align 8
  %call38 = call i32 @ssl_parse_certificate_chain(ptr noundef %42)
  store i32 %call38, ptr %ret, align 4
  %cmp39 = icmp ne i32 %call38, 0
  br i1 %cmp39, label %if.then40, label %if.end48

if.then40:                                        ; preds = %if.end37
  %43 = load i32, ptr %ret, align 4
  %cmp41 = icmp eq i32 %43, -29824
  br i1 %cmp41, label %land.lhs.true42, label %if.end45

land.lhs.true42:                                  ; preds = %if.then40
  %44 = load i32, ptr %authmode, align 4
  %cmp43 = icmp eq i32 %44, 1
  br i1 %cmp43, label %if.then44, label %if.end45

if.then44:                                        ; preds = %land.lhs.true42
  store i32 0, ptr %ret, align 4
  br label %if.end45

if.end45:                                         ; preds = %if.then44, %land.lhs.true42, %if.then40
  %45 = load ptr, ptr %ssl.addr, align 8
  %state46 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %45, i32 0, i32 1
  %46 = load i32, ptr %state46, align 8
  %inc47 = add nsw i32 %46, 1
  store i32 %inc47, ptr %state46, align 8
  %47 = load i32, ptr %ret, align 4
  store i32 %47, ptr %retval, align 4
  br label %return

if.end48:                                         ; preds = %if.end37
  %48 = load i32, ptr %authmode, align 4
  %cmp49 = icmp ne i32 %48, 0
  br i1 %cmp49, label %if.then50, label %if.end196

if.then50:                                        ; preds = %if.end48
  %49 = load ptr, ptr %ssl.addr, align 8
  %handshake51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 15
  %50 = load ptr, ptr %handshake51, align 8
  %sni_ca_chain = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %50, i32 0, i32 9
  %51 = load ptr, ptr %sni_ca_chain, align 8
  %cmp52 = icmp ne ptr %51, null
  br i1 %cmp52, label %if.then53, label %if.else

if.then53:                                        ; preds = %if.then50
  %52 = load ptr, ptr %ssl.addr, align 8
  %handshake54 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 15
  %53 = load ptr, ptr %handshake54, align 8
  %sni_ca_chain55 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %53, i32 0, i32 9
  %54 = load ptr, ptr %sni_ca_chain55, align 8
  store ptr %54, ptr %ca_chain, align 8
  %55 = load ptr, ptr %ssl.addr, align 8
  %handshake56 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %55, i32 0, i32 15
  %56 = load ptr, ptr %handshake56, align 8
  %sni_ca_crl = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %56, i32 0, i32 10
  %57 = load ptr, ptr %sni_ca_crl, align 8
  store ptr %57, ptr %ca_crl, align 8
  br label %if.end61

if.else:                                          ; preds = %if.then50
  %58 = load ptr, ptr %ssl.addr, align 8
  %conf57 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 0
  %59 = load ptr, ptr %conf57, align 8
  %ca_chain58 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %59, i32 0, i32 24
  %60 = load ptr, ptr %ca_chain58, align 8
  store ptr %60, ptr %ca_chain, align 8
  %61 = load ptr, ptr %ssl.addr, align 8
  %conf59 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %61, i32 0, i32 0
  %62 = load ptr, ptr %conf59, align 8
  %ca_crl60 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %62, i32 0, i32 25
  %63 = load ptr, ptr %ca_crl60, align 8
  store ptr %63, ptr %ca_crl, align 8
  br label %if.end61

if.end61:                                         ; preds = %if.else, %if.then53
  %64 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate62 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %64, i32 0, i32 14
  %65 = load ptr, ptr %session_negotiate62, align 8
  %peer_cert = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %65, i32 0, i32 6
  %66 = load ptr, ptr %peer_cert, align 8
  %67 = load ptr, ptr %ca_chain, align 8
  %68 = load ptr, ptr %ca_crl, align 8
  %69 = load ptr, ptr %ssl.addr, align 8
  %conf63 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %69, i32 0, i32 0
  %70 = load ptr, ptr %conf63, align 8
  %cert_profile = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %70, i32 0, i32 22
  %71 = load ptr, ptr %cert_profile, align 8
  %72 = load ptr, ptr %ssl.addr, align 8
  %hostname = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %72, i32 0, i32 54
  %73 = load ptr, ptr %hostname, align 8
  %74 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate64 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %74, i32 0, i32 14
  %75 = load ptr, ptr %session_negotiate64, align 8
  %verify_result65 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %75, i32 0, i32 7
  %76 = load ptr, ptr %ssl.addr, align 8
  %conf66 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %76, i32 0, i32 0
  %77 = load ptr, ptr %conf66, align 8
  %f_vrfy = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %77, i32 0, i32 10
  %78 = load ptr, ptr %f_vrfy, align 8
  %79 = load ptr, ptr %ssl.addr, align 8
  %conf67 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %79, i32 0, i32 0
  %80 = load ptr, ptr %conf67, align 8
  %p_vrfy = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %80, i32 0, i32 11
  %81 = load ptr, ptr %p_vrfy, align 8
  %82 = load ptr, ptr %rs_ctx, align 8
  %call68 = call i32 @mbedtls_x509_crt_verify_restartable(ptr noundef %66, ptr noundef %67, ptr noundef %68, ptr noundef %71, ptr noundef %73, ptr noundef %verify_result65, ptr noundef %78, ptr noundef %81, ptr noundef %82)
  store i32 %call68, ptr %ret, align 4
  %83 = load i32, ptr %ret, align 4
  %cmp69 = icmp ne i32 %83, 0
  br i1 %cmp69, label %if.then70, label %if.end71

if.then70:                                        ; preds = %if.end61
  %84 = load ptr, ptr %ssl.addr, align 8
  %85 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %84, i32 noundef 1, ptr noundef @.str, i32 noundef 5757, ptr noundef @.str.104, i32 noundef %85)
  br label %if.end71

if.end71:                                         ; preds = %if.then70, %if.end61
  %86 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate72 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %86, i32 0, i32 14
  %87 = load ptr, ptr %session_negotiate72, align 8
  %peer_cert73 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %87, i32 0, i32 6
  %88 = load ptr, ptr %peer_cert73, align 8
  %pk74 = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %88, i32 0, i32 11
  store ptr %pk74, ptr %pk, align 8
  %89 = load ptr, ptr %pk, align 8
  %call75 = call i32 @mbedtls_pk_can_do(ptr noundef %89, i32 noundef 2)
  %tobool = icmp ne i32 %call75, 0
  br i1 %tobool, label %land.lhs.true76, label %if.end86

land.lhs.true76:                                  ; preds = %if.end71
  %90 = load ptr, ptr %ssl.addr, align 8
  %91 = load ptr, ptr %pk, align 8
  %92 = getelementptr inbounds { ptr, ptr }, ptr %91, i32 0, i32 0
  %93 = load ptr, ptr %92, align 8
  %94 = getelementptr inbounds { ptr, ptr }, ptr %91, i32 0, i32 1
  %95 = load ptr, ptr %94, align 8
  %call77 = call ptr @mbedtls_pk_ec(ptr %93, ptr %95)
  %grp = getelementptr inbounds %struct.mbedtls_ecp_keypair, ptr %call77, i32 0, i32 0
  %id = getelementptr inbounds %struct.mbedtls_ecp_group, ptr %grp, i32 0, i32 0
  %96 = load i32, ptr %id, align 8
  %call78 = call i32 @mbedtls_ssl_check_curve(ptr noundef %90, i32 noundef %96)
  %cmp79 = icmp ne i32 %call78, 0
  br i1 %cmp79, label %if.then80, label %if.end86

if.then80:                                        ; preds = %land.lhs.true76
  %97 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate81 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %97, i32 0, i32 14
  %98 = load ptr, ptr %session_negotiate81, align 8
  %verify_result82 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %98, i32 0, i32 7
  %99 = load i32, ptr %verify_result82, align 8
  %or = or i32 %99, 65536
  store i32 %or, ptr %verify_result82, align 8
  %100 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %100, i32 noundef 1, ptr noundef @.str, i32 noundef 5779, ptr noundef @.str.105)
  %101 = load i32, ptr %ret, align 4
  %cmp83 = icmp eq i32 %101, 0
  br i1 %cmp83, label %if.then84, label %if.end85

if.then84:                                        ; preds = %if.then80
  store i32 -31232, ptr %ret, align 4
  br label %if.end85

if.end85:                                         ; preds = %if.then84, %if.then80
  br label %if.end86

if.end86:                                         ; preds = %if.end85, %land.lhs.true76, %if.end71
  %102 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate87 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %102, i32 0, i32 14
  %103 = load ptr, ptr %session_negotiate87, align 8
  %peer_cert88 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %103, i32 0, i32 6
  %104 = load ptr, ptr %peer_cert88, align 8
  %105 = load ptr, ptr %ciphersuite_info, align 8
  %106 = load ptr, ptr %ssl.addr, align 8
  %conf89 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %106, i32 0, i32 0
  %107 = load ptr, ptr %conf89, align 8
  %endpoint90 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %107, i32 0, i32 46
  %bf.load91 = load i32, ptr %endpoint90, align 4
  %bf.clear92 = and i32 %bf.load91, 1
  %tobool93 = icmp ne i32 %bf.clear92, 0
  %lnot = xor i1 %tobool93, true
  %lnot.ext = zext i1 %lnot to i32
  %108 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate94 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %108, i32 0, i32 14
  %109 = load ptr, ptr %session_negotiate94, align 8
  %verify_result95 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %109, i32 0, i32 7
  %call96 = call i32 @mbedtls_ssl_check_cert_usage(ptr noundef %104, ptr noundef %105, i32 noundef %lnot.ext, ptr noundef %verify_result95)
  %cmp97 = icmp ne i32 %call96, 0
  br i1 %cmp97, label %if.then98, label %if.end102

if.then98:                                        ; preds = %if.end86
  %110 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %110, i32 noundef 1, ptr noundef @.str, i32 noundef 5791, ptr noundef @.str.106)
  %111 = load i32, ptr %ret, align 4
  %cmp99 = icmp eq i32 %111, 0
  br i1 %cmp99, label %if.then100, label %if.end101

if.then100:                                       ; preds = %if.then98
  store i32 -31232, ptr %ret, align 4
  br label %if.end101

if.end101:                                        ; preds = %if.then100, %if.then98
  br label %if.end102

if.end102:                                        ; preds = %if.end101, %if.end86
  %112 = load i32, ptr %authmode, align 4
  %cmp103 = icmp eq i32 %112, 1
  br i1 %cmp103, label %land.lhs.true104, label %if.end109

land.lhs.true104:                                 ; preds = %if.end102
  %113 = load i32, ptr %ret, align 4
  %cmp105 = icmp eq i32 %113, -9984
  br i1 %cmp105, label %if.then108, label %lor.lhs.false106

lor.lhs.false106:                                 ; preds = %land.lhs.true104
  %114 = load i32, ptr %ret, align 4
  %cmp107 = icmp eq i32 %114, -31232
  br i1 %cmp107, label %if.then108, label %if.end109

if.then108:                                       ; preds = %lor.lhs.false106, %land.lhs.true104
  store i32 0, ptr %ret, align 4
  br label %if.end109

if.end109:                                        ; preds = %if.then108, %lor.lhs.false106, %if.end102
  %115 = load ptr, ptr %ca_chain, align 8
  %cmp110 = icmp eq ptr %115, null
  br i1 %cmp110, label %land.lhs.true111, label %if.end114

land.lhs.true111:                                 ; preds = %if.end109
  %116 = load i32, ptr %authmode, align 4
  %cmp112 = icmp eq i32 %116, 2
  br i1 %cmp112, label %if.then113, label %if.end114

if.then113:                                       ; preds = %land.lhs.true111
  %117 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %117, i32 noundef 1, ptr noundef @.str, i32 noundef 5811, ptr noundef @.str.107)
  store i32 -30336, ptr %ret, align 4
  br label %if.end114

if.end114:                                        ; preds = %if.then113, %land.lhs.true111, %if.end109
  %118 = load i32, ptr %ret, align 4
  %cmp115 = icmp ne i32 %118, 0
  br i1 %cmp115, label %if.then116, label %if.end187

if.then116:                                       ; preds = %if.end114
  %119 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate117 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %119, i32 0, i32 14
  %120 = load ptr, ptr %session_negotiate117, align 8
  %verify_result118 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %120, i32 0, i32 7
  %121 = load i32, ptr %verify_result118, align 8
  %and = and i32 %121, 256
  %tobool119 = icmp ne i32 %and, 0
  br i1 %tobool119, label %if.then120, label %if.else121

if.then120:                                       ; preds = %if.then116
  store i8 49, ptr %alert, align 1
  br label %if.end185

if.else121:                                       ; preds = %if.then116
  %122 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate122 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %122, i32 0, i32 14
  %123 = load ptr, ptr %session_negotiate122, align 8
  %verify_result123 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %123, i32 0, i32 7
  %124 = load i32, ptr %verify_result123, align 8
  %and124 = and i32 %124, 4
  %tobool125 = icmp ne i32 %and124, 0
  br i1 %tobool125, label %if.then126, label %if.else127

if.then126:                                       ; preds = %if.else121
  store i8 42, ptr %alert, align 1
  br label %if.end184

if.else127:                                       ; preds = %if.else121
  %125 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate128 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %125, i32 0, i32 14
  %126 = load ptr, ptr %session_negotiate128, align 8
  %verify_result129 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %126, i32 0, i32 7
  %127 = load i32, ptr %verify_result129, align 8
  %and130 = and i32 %127, 2048
  %tobool131 = icmp ne i32 %and130, 0
  br i1 %tobool131, label %if.then132, label %if.else133

if.then132:                                       ; preds = %if.else127
  store i8 43, ptr %alert, align 1
  br label %if.end183

if.else133:                                       ; preds = %if.else127
  %128 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate134 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %128, i32 0, i32 14
  %129 = load ptr, ptr %session_negotiate134, align 8
  %verify_result135 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %129, i32 0, i32 7
  %130 = load i32, ptr %verify_result135, align 8
  %and136 = and i32 %130, 4096
  %tobool137 = icmp ne i32 %and136, 0
  br i1 %tobool137, label %if.then138, label %if.else139

if.then138:                                       ; preds = %if.else133
  store i8 43, ptr %alert, align 1
  br label %if.end182

if.else139:                                       ; preds = %if.else133
  %131 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate140 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %131, i32 0, i32 14
  %132 = load ptr, ptr %session_negotiate140, align 8
  %verify_result141 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %132, i32 0, i32 7
  %133 = load i32, ptr %verify_result141, align 8
  %and142 = and i32 %133, 8192
  %tobool143 = icmp ne i32 %and142, 0
  br i1 %tobool143, label %if.then144, label %if.else145

if.then144:                                       ; preds = %if.else139
  store i8 43, ptr %alert, align 1
  br label %if.end181

if.else145:                                       ; preds = %if.else139
  %134 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate146 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %134, i32 0, i32 14
  %135 = load ptr, ptr %session_negotiate146, align 8
  %verify_result147 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %135, i32 0, i32 7
  %136 = load i32, ptr %verify_result147, align 8
  %and148 = and i32 %136, 32768
  %tobool149 = icmp ne i32 %and148, 0
  br i1 %tobool149, label %if.then150, label %if.else151

if.then150:                                       ; preds = %if.else145
  store i8 43, ptr %alert, align 1
  br label %if.end180

if.else151:                                       ; preds = %if.else145
  %137 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate152 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %137, i32 0, i32 14
  %138 = load ptr, ptr %session_negotiate152, align 8
  %verify_result153 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %138, i32 0, i32 7
  %139 = load i32, ptr %verify_result153, align 8
  %and154 = and i32 %139, 65536
  %tobool155 = icmp ne i32 %and154, 0
  br i1 %tobool155, label %if.then156, label %if.else157

if.then156:                                       ; preds = %if.else151
  store i8 43, ptr %alert, align 1
  br label %if.end179

if.else157:                                       ; preds = %if.else151
  %140 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate158 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %140, i32 0, i32 14
  %141 = load ptr, ptr %session_negotiate158, align 8
  %verify_result159 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %141, i32 0, i32 7
  %142 = load i32, ptr %verify_result159, align 8
  %and160 = and i32 %142, 1
  %tobool161 = icmp ne i32 %and160, 0
  br i1 %tobool161, label %if.then162, label %if.else163

if.then162:                                       ; preds = %if.else157
  store i8 45, ptr %alert, align 1
  br label %if.end178

if.else163:                                       ; preds = %if.else157
  %143 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate164 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %143, i32 0, i32 14
  %144 = load ptr, ptr %session_negotiate164, align 8
  %verify_result165 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %144, i32 0, i32 7
  %145 = load i32, ptr %verify_result165, align 8
  %and166 = and i32 %145, 2
  %tobool167 = icmp ne i32 %and166, 0
  br i1 %tobool167, label %if.then168, label %if.else169

if.then168:                                       ; preds = %if.else163
  store i8 44, ptr %alert, align 1
  br label %if.end177

if.else169:                                       ; preds = %if.else163
  %146 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate170 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %146, i32 0, i32 14
  %147 = load ptr, ptr %session_negotiate170, align 8
  %verify_result171 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %147, i32 0, i32 7
  %148 = load i32, ptr %verify_result171, align 8
  %and172 = and i32 %148, 8
  %tobool173 = icmp ne i32 %and172, 0
  br i1 %tobool173, label %if.then174, label %if.else175

if.then174:                                       ; preds = %if.else169
  store i8 48, ptr %alert, align 1
  br label %if.end176

if.else175:                                       ; preds = %if.else169
  store i8 46, ptr %alert, align 1
  br label %if.end176

if.end176:                                        ; preds = %if.else175, %if.then174
  br label %if.end177

if.end177:                                        ; preds = %if.end176, %if.then168
  br label %if.end178

if.end178:                                        ; preds = %if.end177, %if.then162
  br label %if.end179

if.end179:                                        ; preds = %if.end178, %if.then156
  br label %if.end180

if.end180:                                        ; preds = %if.end179, %if.then150
  br label %if.end181

if.end181:                                        ; preds = %if.end180, %if.then144
  br label %if.end182

if.end182:                                        ; preds = %if.end181, %if.then138
  br label %if.end183

if.end183:                                        ; preds = %if.end182, %if.then132
  br label %if.end184

if.end184:                                        ; preds = %if.end183, %if.then126
  br label %if.end185

if.end185:                                        ; preds = %if.end184, %if.then120
  %149 = load ptr, ptr %ssl.addr, align 8
  %150 = load i8, ptr %alert, align 1
  %call186 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %149, i8 noundef zeroext 2, i8 noundef zeroext %150)
  br label %if.end187

if.end187:                                        ; preds = %if.end185, %if.end114
  %151 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate188 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %151, i32 0, i32 14
  %152 = load ptr, ptr %session_negotiate188, align 8
  %verify_result189 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %152, i32 0, i32 7
  %153 = load i32, ptr %verify_result189, align 8
  %cmp190 = icmp ne i32 %153, 0
  br i1 %cmp190, label %if.then191, label %if.else194

if.then191:                                       ; preds = %if.end187
  %154 = load ptr, ptr %ssl.addr, align 8
  %155 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate192 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %155, i32 0, i32 14
  %156 = load ptr, ptr %session_negotiate192, align 8
  %verify_result193 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %156, i32 0, i32 7
  %157 = load i32, ptr %verify_result193, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %154, i32 noundef 3, ptr noundef @.str, i32 noundef 5852, ptr noundef @.str.108, i32 noundef %157)
  br label %if.end195

if.else194:                                       ; preds = %if.end187
  %158 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %158, i32 noundef 3, ptr noundef @.str, i32 noundef 5856, ptr noundef @.str.109)
  br label %if.end195

if.end195:                                        ; preds = %if.else194, %if.then191
  br label %if.end196

if.end196:                                        ; preds = %if.end195, %if.end48
  %159 = load ptr, ptr %ssl.addr, align 8
  %state197 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %159, i32 0, i32 1
  %160 = load i32, ptr %state197, align 8
  %inc198 = add nsw i32 %160, 1
  store i32 %inc198, ptr %state197, align 8
  %161 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %161, i32 noundef 2, ptr noundef @.str, i32 noundef 5863, ptr noundef @.str.110)
  %162 = load i32, ptr %ret, align 4
  store i32 %162, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end196, %if.end45, %if.then36, %if.then31, %if.then20, %if.then
  %163 = load i32, ptr %retval, align 4
  ret i32 %163
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_parse_certificate_chain(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %i = alloca i64, align 8
  %n = alloca i64, align 8
  %alert = alloca i8, align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %land.lhs.true, label %if.end15

land.lhs.true:                                    ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 5
  %3 = load i32, ptr %minor_ver, align 8
  %cmp1 = icmp ne i32 %3, 0
  br i1 %cmp1, label %if.then, label %if.end15

if.then:                                          ; preds = %land.lhs.true
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 37
  %5 = load i64, ptr %in_hslen, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %6)
  %add = add i64 3, %call
  %cmp2 = icmp eq i64 %5, %add
  br i1 %cmp2, label %land.lhs.true3, label %if.end

land.lhs.true3:                                   ; preds = %if.then
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 30
  %8 = load i32, ptr %in_msgtype, align 8
  %cmp4 = icmp eq i32 %8, 22
  br i1 %cmp4, label %land.lhs.true5, label %if.end

land.lhs.true5:                                   ; preds = %land.lhs.true3
  %9 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 28
  %10 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %10, i64 0
  %11 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %11 to i32
  %cmp6 = icmp eq i32 %conv, 11
  br i1 %cmp6, label %land.lhs.true8, label %if.end

land.lhs.true8:                                   ; preds = %land.lhs.true5
  %12 = load ptr, ptr %ssl.addr, align 8
  %in_msg9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 28
  %13 = load ptr, ptr %in_msg9, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %call10 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %14)
  %add.ptr = getelementptr inbounds i8, ptr %13, i64 %call10
  %call11 = call i32 @memcmp(ptr noundef %add.ptr, ptr noundef @.str.207, i64 noundef 3) #7
  %cmp12 = icmp eq i32 %call11, 0
  br i1 %cmp12, label %if.then14, label %if.end

if.then14:                                        ; preds = %land.lhs.true8
  %15 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %15, i32 noundef 1, ptr noundef @.str, i32 noundef 5482, ptr noundef @.str.281)
  %16 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 14
  %17 = load ptr, ptr %session_negotiate, align 8
  %verify_result = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %17, i32 0, i32 7
  store i32 64, ptr %verify_result, align 8
  store i32 -29824, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %land.lhs.true8, %land.lhs.true5, %land.lhs.true3, %if.then
  br label %if.end15

if.end15:                                         ; preds = %if.end, %land.lhs.true, %entry
  %18 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 30
  %19 = load i32, ptr %in_msgtype16, align 8
  %cmp17 = icmp ne i32 %19, 22
  br i1 %cmp17, label %if.then19, label %if.end21

if.then19:                                        ; preds = %if.end15
  %20 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %20, i32 noundef 1, ptr noundef @.str, i32 noundef 5497, ptr noundef @.str.282)
  %21 = load ptr, ptr %ssl.addr, align 8
  %call20 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %21, i8 noundef zeroext 2, i8 noundef zeroext 10)
  store i32 -30464, ptr %retval, align 4
  br label %return

if.end21:                                         ; preds = %if.end15
  %22 = load ptr, ptr %ssl.addr, align 8
  %in_msg22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 28
  %23 = load ptr, ptr %in_msg22, align 8
  %arrayidx23 = getelementptr inbounds i8, ptr %23, i64 0
  %24 = load i8, ptr %arrayidx23, align 1
  %conv24 = zext i8 %24 to i32
  %cmp25 = icmp ne i32 %conv24, 11
  br i1 %cmp25, label %if.then33, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end21
  %25 = load ptr, ptr %ssl.addr, align 8
  %in_hslen27 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 37
  %26 = load i64, ptr %in_hslen27, align 8
  %27 = load ptr, ptr %ssl.addr, align 8
  %call28 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %27)
  %add29 = add i64 %call28, 3
  %add30 = add i64 %add29, 3
  %cmp31 = icmp ult i64 %26, %add30
  br i1 %cmp31, label %if.then33, label %if.end35

if.then33:                                        ; preds = %lor.lhs.false, %if.end21
  %28 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %28, i32 noundef 1, ptr noundef @.str, i32 noundef 5506, ptr noundef @.str.282)
  %29 = load ptr, ptr %ssl.addr, align 8
  %call34 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %29, i8 noundef zeroext 2, i8 noundef zeroext 50)
  store i32 -31232, ptr %retval, align 4
  br label %return

if.end35:                                         ; preds = %lor.lhs.false
  %30 = load ptr, ptr %ssl.addr, align 8
  %call36 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %30)
  store i64 %call36, ptr %i, align 8
  %31 = load ptr, ptr %ssl.addr, align 8
  %in_msg37 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 28
  %32 = load ptr, ptr %in_msg37, align 8
  %33 = load i64, ptr %i, align 8
  %add38 = add i64 %33, 1
  %arrayidx39 = getelementptr inbounds i8, ptr %32, i64 %add38
  %34 = load i8, ptr %arrayidx39, align 1
  %conv40 = zext i8 %34 to i32
  %shl = shl i32 %conv40, 8
  %35 = load ptr, ptr %ssl.addr, align 8
  %in_msg41 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 28
  %36 = load ptr, ptr %in_msg41, align 8
  %37 = load i64, ptr %i, align 8
  %add42 = add i64 %37, 2
  %arrayidx43 = getelementptr inbounds i8, ptr %36, i64 %add42
  %38 = load i8, ptr %arrayidx43, align 1
  %conv44 = zext i8 %38 to i32
  %or = or i32 %shl, %conv44
  %conv45 = sext i32 %or to i64
  store i64 %conv45, ptr %n, align 8
  %39 = load ptr, ptr %ssl.addr, align 8
  %in_msg46 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 28
  %40 = load ptr, ptr %in_msg46, align 8
  %41 = load i64, ptr %i, align 8
  %arrayidx47 = getelementptr inbounds i8, ptr %40, i64 %41
  %42 = load i8, ptr %arrayidx47, align 1
  %conv48 = zext i8 %42 to i32
  %cmp49 = icmp ne i32 %conv48, 0
  br i1 %cmp49, label %if.then58, label %lor.lhs.false51

lor.lhs.false51:                                  ; preds = %if.end35
  %43 = load ptr, ptr %ssl.addr, align 8
  %in_hslen52 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %43, i32 0, i32 37
  %44 = load i64, ptr %in_hslen52, align 8
  %45 = load i64, ptr %n, align 8
  %add53 = add i64 %45, 3
  %46 = load ptr, ptr %ssl.addr, align 8
  %call54 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %46)
  %add55 = add i64 %add53, %call54
  %cmp56 = icmp ne i64 %44, %add55
  br i1 %cmp56, label %if.then58, label %if.end60

if.then58:                                        ; preds = %lor.lhs.false51, %if.end35
  %47 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %47, i32 noundef 1, ptr noundef @.str, i32 noundef 5522, ptr noundef @.str.282)
  %48 = load ptr, ptr %ssl.addr, align 8
  %call59 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %48, i8 noundef zeroext 2, i8 noundef zeroext 50)
  store i32 -31232, ptr %retval, align 4
  br label %return

if.end60:                                         ; preds = %lor.lhs.false51
  %49 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate61 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 14
  %50 = load ptr, ptr %session_negotiate61, align 8
  %peer_cert = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %50, i32 0, i32 6
  %51 = load ptr, ptr %peer_cert, align 8
  %cmp62 = icmp ne ptr %51, null
  br i1 %cmp62, label %if.then64, label %if.end69

if.then64:                                        ; preds = %if.end60
  %52 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate65 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 14
  %53 = load ptr, ptr %session_negotiate65, align 8
  %peer_cert66 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %53, i32 0, i32 6
  %54 = load ptr, ptr %peer_cert66, align 8
  call void @mbedtls_x509_crt_free(ptr noundef %54)
  %55 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate67 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %55, i32 0, i32 14
  %56 = load ptr, ptr %session_negotiate67, align 8
  %peer_cert68 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %56, i32 0, i32 6
  %57 = load ptr, ptr %peer_cert68, align 8
  call void @free(ptr noundef %57) #8
  br label %if.end69

if.end69:                                         ; preds = %if.then64, %if.end60
  %call70 = call noalias ptr @calloc(i64 noundef 1, i64 noundef 552) #9
  %58 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate71 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 14
  %59 = load ptr, ptr %session_negotiate71, align 8
  %peer_cert72 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %59, i32 0, i32 6
  store ptr %call70, ptr %peer_cert72, align 8
  %cmp73 = icmp eq ptr %call70, null
  br i1 %cmp73, label %if.then75, label %if.end77

if.then75:                                        ; preds = %if.end69
  %60 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %60, i32 noundef 1, ptr noundef @.str, i32 noundef 5539, ptr noundef @.str.129, i64 noundef 552)
  %61 = load ptr, ptr %ssl.addr, align 8
  %call76 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %61, i8 noundef zeroext 2, i8 noundef zeroext 80)
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end77:                                         ; preds = %if.end69
  %62 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate78 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %62, i32 0, i32 14
  %63 = load ptr, ptr %session_negotiate78, align 8
  %peer_cert79 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %63, i32 0, i32 6
  %64 = load ptr, ptr %peer_cert79, align 8
  call void @mbedtls_x509_crt_init(ptr noundef %64)
  %65 = load i64, ptr %i, align 8
  %add80 = add i64 %65, 3
  store i64 %add80, ptr %i, align 8
  br label %while.cond

while.cond:                                       ; preds = %sw.epilog, %if.end77
  %66 = load i64, ptr %i, align 8
  %67 = load ptr, ptr %ssl.addr, align 8
  %in_hslen81 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %67, i32 0, i32 37
  %68 = load i64, ptr %in_hslen81, align 8
  %cmp82 = icmp ult i64 %66, %68
  br i1 %cmp82, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %69 = load i64, ptr %i, align 8
  %add84 = add i64 %69, 3
  %70 = load ptr, ptr %ssl.addr, align 8
  %in_hslen85 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %70, i32 0, i32 37
  %71 = load i64, ptr %in_hslen85, align 8
  %cmp86 = icmp ugt i64 %add84, %71
  br i1 %cmp86, label %if.then88, label %if.end90

if.then88:                                        ; preds = %while.body
  %72 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %72, i32 noundef 1, ptr noundef @.str, i32 noundef 5552, ptr noundef @.str.282)
  %73 = load ptr, ptr %ssl.addr, align 8
  %call89 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %73, i8 noundef zeroext 2, i8 noundef zeroext 50)
  store i32 -31232, ptr %retval, align 4
  br label %return

if.end90:                                         ; preds = %while.body
  %74 = load ptr, ptr %ssl.addr, align 8
  %in_msg91 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %74, i32 0, i32 28
  %75 = load ptr, ptr %in_msg91, align 8
  %76 = load i64, ptr %i, align 8
  %arrayidx92 = getelementptr inbounds i8, ptr %75, i64 %76
  %77 = load i8, ptr %arrayidx92, align 1
  %conv93 = zext i8 %77 to i32
  %cmp94 = icmp ne i32 %conv93, 0
  br i1 %cmp94, label %if.then96, label %if.end98

if.then96:                                        ; preds = %if.end90
  %78 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %78, i32 noundef 1, ptr noundef @.str, i32 noundef 5559, ptr noundef @.str.282)
  %79 = load ptr, ptr %ssl.addr, align 8
  %call97 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %79, i8 noundef zeroext 2, i8 noundef zeroext 50)
  store i32 -31232, ptr %retval, align 4
  br label %return

if.end98:                                         ; preds = %if.end90
  %80 = load ptr, ptr %ssl.addr, align 8
  %in_msg99 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %80, i32 0, i32 28
  %81 = load ptr, ptr %in_msg99, align 8
  %82 = load i64, ptr %i, align 8
  %add100 = add i64 %82, 1
  %arrayidx101 = getelementptr inbounds i8, ptr %81, i64 %add100
  %83 = load i8, ptr %arrayidx101, align 1
  %conv102 = zext i8 %83 to i32
  %shl103 = shl i32 %conv102, 8
  %84 = load ptr, ptr %ssl.addr, align 8
  %in_msg104 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %84, i32 0, i32 28
  %85 = load ptr, ptr %in_msg104, align 8
  %86 = load i64, ptr %i, align 8
  %add105 = add i64 %86, 2
  %arrayidx106 = getelementptr inbounds i8, ptr %85, i64 %add105
  %87 = load i8, ptr %arrayidx106, align 1
  %conv107 = zext i8 %87 to i32
  %or108 = or i32 %shl103, %conv107
  %conv109 = zext i32 %or108 to i64
  store i64 %conv109, ptr %n, align 8
  %88 = load i64, ptr %i, align 8
  %add110 = add i64 %88, 3
  store i64 %add110, ptr %i, align 8
  %89 = load i64, ptr %n, align 8
  %cmp111 = icmp ult i64 %89, 128
  br i1 %cmp111, label %if.then118, label %lor.lhs.false113

lor.lhs.false113:                                 ; preds = %if.end98
  %90 = load i64, ptr %i, align 8
  %91 = load i64, ptr %n, align 8
  %add114 = add i64 %90, %91
  %92 = load ptr, ptr %ssl.addr, align 8
  %in_hslen115 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %92, i32 0, i32 37
  %93 = load i64, ptr %in_hslen115, align 8
  %cmp116 = icmp ugt i64 %add114, %93
  br i1 %cmp116, label %if.then118, label %if.end120

if.then118:                                       ; preds = %lor.lhs.false113, %if.end98
  %94 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %94, i32 noundef 1, ptr noundef @.str, i32 noundef 5571, ptr noundef @.str.282)
  %95 = load ptr, ptr %ssl.addr, align 8
  %call119 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %95, i8 noundef zeroext 2, i8 noundef zeroext 50)
  store i32 -31232, ptr %retval, align 4
  br label %return

if.end120:                                        ; preds = %lor.lhs.false113
  %96 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate121 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %96, i32 0, i32 14
  %97 = load ptr, ptr %session_negotiate121, align 8
  %peer_cert122 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %97, i32 0, i32 6
  %98 = load ptr, ptr %peer_cert122, align 8
  %99 = load ptr, ptr %ssl.addr, align 8
  %in_msg123 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %99, i32 0, i32 28
  %100 = load ptr, ptr %in_msg123, align 8
  %101 = load i64, ptr %i, align 8
  %add.ptr124 = getelementptr inbounds i8, ptr %100, i64 %101
  %102 = load i64, ptr %n, align 8
  %call125 = call i32 @mbedtls_x509_crt_parse_der(ptr noundef %98, ptr noundef %add.ptr124, i64 noundef %102)
  store i32 %call125, ptr %ret, align 4
  %103 = load i32, ptr %ret, align 4
  switch i32 %103, label %sw.default [
    i32 0, label %sw.bb
    i32 -9774, label %sw.bb
    i32 -10368, label %sw.bb126
    i32 -9600, label %sw.bb127
  ]

sw.bb:                                            ; preds = %if.end120, %if.end120
  br label %sw.epilog

sw.bb126:                                         ; preds = %if.end120
  store i8 80, ptr %alert, align 1
  br label %crt_parse_der_failed

sw.bb127:                                         ; preds = %if.end120
  store i8 43, ptr %alert, align 1
  br label %crt_parse_der_failed

sw.default:                                       ; preds = %if.end120
  store i8 42, ptr %alert, align 1
  br label %crt_parse_der_failed

crt_parse_der_failed:                             ; preds = %sw.default, %sw.bb127, %sw.bb126
  %104 = load ptr, ptr %ssl.addr, align 8
  %105 = load i8, ptr %alert, align 1
  %call128 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %104, i8 noundef zeroext 2, i8 noundef zeroext %105)
  %106 = load ptr, ptr %ssl.addr, align 8
  %107 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %106, i32 noundef 1, ptr noundef @.str, i32 noundef 5599, ptr noundef @.str.283, i32 noundef %107)
  %108 = load i32, ptr %ret, align 4
  store i32 %108, ptr %retval, align 4
  br label %return

sw.epilog:                                        ; preds = %sw.bb
  %109 = load i64, ptr %n, align 8
  %110 = load i64, ptr %i, align 8
  %add129 = add i64 %110, %109
  store i64 %add129, ptr %i, align 8
  br label %while.cond, !llvm.loop !24

while.end:                                        ; preds = %while.cond
  %111 = load ptr, ptr %ssl.addr, align 8
  %112 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate130 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %112, i32 0, i32 14
  %113 = load ptr, ptr %session_negotiate130, align 8
  %peer_cert131 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %113, i32 0, i32 6
  %114 = load ptr, ptr %peer_cert131, align 8
  call void @mbedtls_debug_print_crt(ptr noundef %111, i32 noundef 3, ptr noundef @.str, i32 noundef 5606, ptr noundef @.str.284, ptr noundef %114)
  %115 = load ptr, ptr %ssl.addr, align 8
  %conf132 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %115, i32 0, i32 0
  %116 = load ptr, ptr %conf132, align 8
  %endpoint133 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %116, i32 0, i32 46
  %bf.load134 = load i32, ptr %endpoint133, align 4
  %bf.clear135 = and i32 %bf.load134, 1
  %cmp136 = icmp eq i32 %bf.clear135, 0
  br i1 %cmp136, label %land.lhs.true138, label %if.end174

land.lhs.true138:                                 ; preds = %while.end
  %117 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %117, i32 0, i32 2
  %118 = load i32, ptr %renego_status, align 4
  %cmp139 = icmp eq i32 %118, 1
  br i1 %cmp139, label %if.then141, label %if.end174

if.then141:                                       ; preds = %land.lhs.true138
  %119 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %119, i32 0, i32 13
  %120 = load ptr, ptr %session, align 8
  %peer_cert142 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %120, i32 0, i32 6
  %121 = load ptr, ptr %peer_cert142, align 8
  %cmp143 = icmp eq ptr %121, null
  br i1 %cmp143, label %if.then145, label %if.end147

if.then145:                                       ; preds = %if.then141
  %122 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %122, i32 noundef 1, ptr noundef @.str, i32 noundef 5618, ptr noundef @.str.285)
  %123 = load ptr, ptr %ssl.addr, align 8
  %call146 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %123, i8 noundef zeroext 2, i8 noundef zeroext 49)
  store i32 -31232, ptr %retval, align 4
  br label %return

if.end147:                                        ; preds = %if.then141
  %124 = load ptr, ptr %ssl.addr, align 8
  %session148 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %124, i32 0, i32 13
  %125 = load ptr, ptr %session148, align 8
  %peer_cert149 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %125, i32 0, i32 6
  %126 = load ptr, ptr %peer_cert149, align 8
  %raw = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %126, i32 0, i32 0
  %len = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw, i32 0, i32 1
  %127 = load i64, ptr %len, align 8
  %128 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate150 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %128, i32 0, i32 14
  %129 = load ptr, ptr %session_negotiate150, align 8
  %peer_cert151 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %129, i32 0, i32 6
  %130 = load ptr, ptr %peer_cert151, align 8
  %raw152 = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %130, i32 0, i32 0
  %len153 = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw152, i32 0, i32 1
  %131 = load i64, ptr %len153, align 8
  %cmp154 = icmp ne i64 %127, %131
  br i1 %cmp154, label %if.then171, label %lor.lhs.false156

lor.lhs.false156:                                 ; preds = %if.end147
  %132 = load ptr, ptr %ssl.addr, align 8
  %session157 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %132, i32 0, i32 13
  %133 = load ptr, ptr %session157, align 8
  %peer_cert158 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %133, i32 0, i32 6
  %134 = load ptr, ptr %peer_cert158, align 8
  %raw159 = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %134, i32 0, i32 0
  %p = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw159, i32 0, i32 2
  %135 = load ptr, ptr %p, align 8
  %136 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate160 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %136, i32 0, i32 14
  %137 = load ptr, ptr %session_negotiate160, align 8
  %peer_cert161 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %137, i32 0, i32 6
  %138 = load ptr, ptr %peer_cert161, align 8
  %raw162 = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %138, i32 0, i32 0
  %p163 = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw162, i32 0, i32 2
  %139 = load ptr, ptr %p163, align 8
  %140 = load ptr, ptr %ssl.addr, align 8
  %session164 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %140, i32 0, i32 13
  %141 = load ptr, ptr %session164, align 8
  %peer_cert165 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %141, i32 0, i32 6
  %142 = load ptr, ptr %peer_cert165, align 8
  %raw166 = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %142, i32 0, i32 0
  %len167 = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw166, i32 0, i32 1
  %143 = load i64, ptr %len167, align 8
  %call168 = call i32 @memcmp(ptr noundef %135, ptr noundef %139, i64 noundef %143) #7
  %cmp169 = icmp ne i32 %call168, 0
  br i1 %cmp169, label %if.then171, label %if.end173

if.then171:                                       ; preds = %lor.lhs.false156, %if.end147
  %144 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %144, i32 noundef 1, ptr noundef @.str, i32 noundef 5630, ptr noundef @.str.286)
  %145 = load ptr, ptr %ssl.addr, align 8
  %call172 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %145, i8 noundef zeroext 2, i8 noundef zeroext 49)
  store i32 -31232, ptr %retval, align 4
  br label %return

if.end173:                                        ; preds = %lor.lhs.false156
  br label %if.end174

if.end174:                                        ; preds = %if.end173, %land.lhs.true138, %while.end
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end174, %if.then171, %if.then145, %crt_parse_der_failed, %if.then118, %if.then96, %if.then88, %if.then75, %if.then58, %if.then33, %if.then19, %if.then14
  %146 = load i32, ptr %retval, align 4
  ret i32 %146
}

declare i32 @mbedtls_x509_crt_verify_restartable(ptr noundef, ptr noundef, ptr noundef, ptr noundef, ptr noundef, ptr noundef, ptr noundef, ptr noundef, ptr noundef) #1

declare i32 @mbedtls_pk_can_do(ptr noundef, i32 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_check_curve(ptr noundef %ssl, i32 noundef %grp_id) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %grp_id.addr = alloca i32, align 4
  %gid = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %grp_id, ptr %grp_id.addr, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %curve_list = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 27
  %2 = load ptr, ptr %curve_list, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf1, align 8
  %curve_list2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 27
  %5 = load ptr, ptr %curve_list2, align 8
  store ptr %5, ptr %gid, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.end
  %6 = load ptr, ptr %gid, align 8
  %7 = load i32, ptr %6, align 4
  %cmp3 = icmp ne i32 %7, 0
  br i1 %cmp3, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %8 = load ptr, ptr %gid, align 8
  %9 = load i32, ptr %8, align 4
  %10 = load i32, ptr %grp_id.addr, align 4
  %cmp4 = icmp eq i32 %9, %10
  br i1 %cmp4, label %if.then5, label %if.end6

if.then5:                                         ; preds = %for.body
  store i32 0, ptr %retval, align 4
  br label %return

if.end6:                                          ; preds = %for.body
  br label %for.inc

for.inc:                                          ; preds = %if.end6
  %11 = load ptr, ptr %gid, align 8
  %incdec.ptr = getelementptr inbounds i32, ptr %11, i32 1
  store ptr %incdec.ptr, ptr %gid, align 8
  br label %for.cond, !llvm.loop !25

for.end:                                          ; preds = %for.cond
  store i32 -1, ptr %retval, align 4
  br label %return

return:                                           ; preds = %for.end, %if.then5, %if.then
  %12 = load i32, ptr %retval, align 4
  ret i32 %12
}

; Function Attrs: noinline nounwind optnone uwtable
define internal ptr @mbedtls_pk_ec(ptr %pk.coerce0, ptr %pk.coerce1) #0 {
entry:
  %pk = alloca %struct.mbedtls_pk_context, align 8
  %0 = getelementptr inbounds { ptr, ptr }, ptr %pk, i32 0, i32 0
  store ptr %pk.coerce0, ptr %0, align 8
  %1 = getelementptr inbounds { ptr, ptr }, ptr %pk, i32 0, i32 1
  store ptr %pk.coerce1, ptr %1, align 8
  %pk_ctx = getelementptr inbounds %struct.mbedtls_pk_context, ptr %pk, i32 0, i32 1
  %2 = load ptr, ptr %pk_ctx, align 8
  ret ptr %2
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_check_cert_usage(ptr noundef %cert, ptr noundef %ciphersuite, i32 noundef %cert_endpoint, ptr noundef %flags) #0 {
entry:
  %cert.addr = alloca ptr, align 8
  %ciphersuite.addr = alloca ptr, align 8
  %cert_endpoint.addr = alloca i32, align 4
  %flags.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %usage = alloca i32, align 4
  %ext_oid = alloca ptr, align 8
  %ext_len = alloca i64, align 8
  store ptr %cert, ptr %cert.addr, align 8
  store ptr %ciphersuite, ptr %ciphersuite.addr, align 8
  store i32 %cert_endpoint, ptr %cert_endpoint.addr, align 4
  store ptr %flags, ptr %flags.addr, align 8
  store i32 0, ptr %ret, align 4
  store i32 0, ptr %usage, align 4
  %0 = load i32, ptr %cert_endpoint.addr, align 4
  %cmp = icmp eq i32 %0, 1
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %1 = load ptr, ptr %ciphersuite.addr, align 8
  %key_exchange = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %1, i32 0, i32 4
  %2 = load i32, ptr %key_exchange, align 8
  switch i32 %2, label %sw.epilog [
    i32 1, label %sw.bb
    i32 7, label %sw.bb
    i32 2, label %sw.bb1
    i32 3, label %sw.bb1
    i32 4, label %sw.bb1
    i32 9, label %sw.bb2
    i32 10, label %sw.bb2
    i32 0, label %sw.bb3
    i32 5, label %sw.bb3
    i32 6, label %sw.bb3
    i32 8, label %sw.bb3
    i32 11, label %sw.bb3
  ]

sw.bb:                                            ; preds = %if.then, %if.then
  store i32 32, ptr %usage, align 4
  br label %sw.epilog

sw.bb1:                                           ; preds = %if.then, %if.then, %if.then
  store i32 128, ptr %usage, align 4
  br label %sw.epilog

sw.bb2:                                           ; preds = %if.then, %if.then
  store i32 8, ptr %usage, align 4
  br label %sw.epilog

sw.bb3:                                           ; preds = %if.then, %if.then, %if.then, %if.then, %if.then
  store i32 0, ptr %usage, align 4
  br label %sw.epilog

sw.epilog:                                        ; preds = %sw.bb3, %if.then, %sw.bb2, %sw.bb1, %sw.bb
  br label %if.end

if.else:                                          ; preds = %entry
  store i32 128, ptr %usage, align 4
  br label %if.end

if.end:                                           ; preds = %if.else, %sw.epilog
  %3 = load ptr, ptr %cert.addr, align 8
  %4 = load i32, ptr %usage, align 4
  %call = call i32 @mbedtls_x509_crt_check_key_usage(ptr noundef %3, i32 noundef %4)
  %cmp4 = icmp ne i32 %call, 0
  br i1 %cmp4, label %if.then5, label %if.end6

if.then5:                                         ; preds = %if.end
  %5 = load ptr, ptr %flags.addr, align 8
  %6 = load i32, ptr %5, align 4
  %or = or i32 %6, 2048
  store i32 %or, ptr %5, align 4
  store i32 -1, ptr %ret, align 4
  br label %if.end6

if.end6:                                          ; preds = %if.then5, %if.end
  %7 = load i32, ptr %cert_endpoint.addr, align 4
  %cmp7 = icmp eq i32 %7, 1
  br i1 %cmp7, label %if.then8, label %if.else9

if.then8:                                         ; preds = %if.end6
  store ptr @.str.165, ptr %ext_oid, align 8
  store i64 8, ptr %ext_len, align 8
  br label %if.end10

if.else9:                                         ; preds = %if.end6
  store ptr @.str.166, ptr %ext_oid, align 8
  store i64 8, ptr %ext_len, align 8
  br label %if.end10

if.end10:                                         ; preds = %if.else9, %if.then8
  %8 = load ptr, ptr %cert.addr, align 8
  %9 = load ptr, ptr %ext_oid, align 8
  %10 = load i64, ptr %ext_len, align 8
  %call11 = call i32 @mbedtls_x509_crt_check_extended_key_usage(ptr noundef %8, ptr noundef %9, i64 noundef %10)
  %cmp12 = icmp ne i32 %call11, 0
  br i1 %cmp12, label %if.then13, label %if.end15

if.then13:                                        ; preds = %if.end10
  %11 = load ptr, ptr %flags.addr, align 8
  %12 = load i32, ptr %11, align 4
  %or14 = or i32 %12, 4096
  store i32 %or14, ptr %11, align 4
  store i32 -1, ptr %ret, align 4
  br label %if.end15

if.end15:                                         ; preds = %if.then13, %if.end10
  %13 = load i32, ptr %ret, align 4
  ret i32 %13
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_write_change_cipher_spec(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 5879, ptr noundef @.str.111)
  %1 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 47
  store i32 20, ptr %out_msgtype, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 48
  store i64 1, ptr %out_msglen, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 46
  %4 = load ptr, ptr %out_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %4, i64 0
  store i8 1, ptr %arrayidx, align 1
  %5 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 1
  %6 = load i32, ptr %state, align 8
  %inc = add nsw i32 %6, 1
  store i32 %inc, ptr %state, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_write_handshake_msg(ptr noundef %7)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %8 = load ptr, ptr %ssl.addr, align 8
  %9 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %8, i32 noundef 1, ptr noundef @.str, i32 noundef 5889, ptr noundef @.str.99, i32 noundef %9)
  %10 = load i32, ptr %ret, align 4
  store i32 %10, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %11, i32 noundef 2, ptr noundef @.str, i32 noundef 5893, ptr noundef @.str.112)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %12 = load i32, ptr %retval, align 4
  ret i32 %12
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_parse_change_cipher_spec(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 5902, ptr noundef @.str.113)
  %1 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_read_record(ptr noundef %1, i32 noundef 1)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %3 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %2, i32 noundef 1, ptr noundef @.str, i32 noundef 5906, ptr noundef @.str.103, i32 noundef %3)
  %4 = load i32, ptr %ret, align 4
  store i32 %4, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 30
  %6 = load i32, ptr %in_msgtype, align 8
  %cmp1 = icmp ne i32 %6, 20
  br i1 %cmp1, label %if.then2, label %if.end4

if.then2:                                         ; preds = %if.end
  %7 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %7, i32 noundef 1, ptr noundef @.str, i32 noundef 5912, ptr noundef @.str.114)
  %8 = load ptr, ptr %ssl.addr, align 8
  %call3 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %8, i8 noundef zeroext 2, i8 noundef zeroext 10)
  store i32 -30464, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  %9 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %9, i32 noundef 3, ptr noundef @.str, i32 noundef 5925, ptr noundef @.str.115)
  %10 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 19
  %11 = load ptr, ptr %transform_negotiate, align 8
  %12 = load ptr, ptr %ssl.addr, align 8
  %transform_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 16
  store ptr %11, ptr %transform_in, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 14
  %14 = load ptr, ptr %session_negotiate, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %session_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 11
  store ptr %14, ptr %session_in, align 8
  %16 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 0
  %17 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %17, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp5 = icmp eq i32 %bf.clear, 1
  br i1 %cmp5, label %if.then6, label %if.else

if.then6:                                         ; preds = %if.end4
  %18 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_dtls_replay_reset(ptr noundef %18)
  %19 = load ptr, ptr %ssl.addr, align 8
  %in_epoch = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 33
  %20 = load i16, ptr %in_epoch, align 8
  %inc = add i16 %20, 1
  store i16 %inc, ptr %in_epoch, align 8
  %conv = zext i16 %inc to i32
  %cmp7 = icmp eq i32 %conv, 0
  br i1 %cmp7, label %if.then9, label %if.end10

if.then9:                                         ; preds = %if.then6
  %21 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %21, i32 noundef 1, ptr noundef @.str, i32 noundef 5939, ptr noundef @.str.116)
  store i32 -27520, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.then6
  br label %if.end11

if.else:                                          ; preds = %if.end4
  %22 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 24
  %23 = load ptr, ptr %in_ctr, align 8
  call void @llvm.memset.p0.i64(ptr align 1 %23, i8 0, i64 8, i1 false)
  br label %if.end11

if.end11:                                         ; preds = %if.else, %if.end10
  %24 = load ptr, ptr %ssl.addr, align 8
  %25 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 19
  %26 = load ptr, ptr %transform_negotiate12, align 8
  call void @ssl_update_in_pointers(ptr noundef %24, ptr noundef %26)
  %27 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 1
  %28 = load i32, ptr %state, align 8
  %inc13 = add nsw i32 %28, 1
  store i32 %inc13, ptr %state, align 8
  %29 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %29, i32 noundef 2, ptr noundef @.str, i32 noundef 5966, ptr noundef @.str.117)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end11, %if.then9, %if.then2, %if.then
  %30 = load i32, ptr %retval, align 4
  ret i32 %30
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_dtls_replay_reset(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_window_top = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 35
  store i64 0, ptr %in_window_top, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %in_window = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 36
  store i64 0, ptr %in_window, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_update_in_pointers(ptr noundef %ssl, ptr noundef %transform) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %transform.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %transform, ptr %transform.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 25
  %3 = load ptr, ptr %in_hdr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %3, i64 3
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 24
  store ptr %add.ptr, ptr %in_ctr, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_hdr1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 25
  %6 = load ptr, ptr %in_hdr1, align 8
  %add.ptr2 = getelementptr inbounds i8, ptr %6, i64 11
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 26
  store ptr %add.ptr2, ptr %in_len, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_hdr3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 25
  %9 = load ptr, ptr %in_hdr3, align 8
  %add.ptr4 = getelementptr inbounds i8, ptr %9, i64 13
  %10 = load ptr, ptr %ssl.addr, align 8
  %in_iv = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 27
  store ptr %add.ptr4, ptr %in_iv, align 8
  br label %if.end

if.else:                                          ; preds = %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_hdr5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 25
  %12 = load ptr, ptr %in_hdr5, align 8
  %add.ptr6 = getelementptr inbounds i8, ptr %12, i64 -8
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_ctr7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 24
  store ptr %add.ptr6, ptr %in_ctr7, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %in_hdr8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 25
  %15 = load ptr, ptr %in_hdr8, align 8
  %add.ptr9 = getelementptr inbounds i8, ptr %15, i64 3
  %16 = load ptr, ptr %ssl.addr, align 8
  %in_len10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 26
  store ptr %add.ptr9, ptr %in_len10, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %in_hdr11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 25
  %18 = load ptr, ptr %in_hdr11, align 8
  %add.ptr12 = getelementptr inbounds i8, ptr %18, i64 5
  %19 = load ptr, ptr %ssl.addr, align 8
  %in_iv13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 27
  store ptr %add.ptr12, ptr %in_iv13, align 8
  br label %if.end

if.end:                                           ; preds = %if.else, %if.then
  %20 = load ptr, ptr %transform.addr, align 8
  %cmp14 = icmp ne ptr %20, null
  br i1 %cmp14, label %land.lhs.true, label %if.else20

land.lhs.true:                                    ; preds = %if.end
  %21 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 5
  %22 = load i32, ptr %minor_ver, align 8
  %cmp15 = icmp sge i32 %22, 2
  br i1 %cmp15, label %if.then16, label %if.else20

if.then16:                                        ; preds = %land.lhs.true
  %23 = load ptr, ptr %ssl.addr, align 8
  %in_iv17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 27
  %24 = load ptr, ptr %in_iv17, align 8
  %25 = load ptr, ptr %transform.addr, align 8
  %ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %25, i32 0, i32 3
  %26 = load i64, ptr %ivlen, align 8
  %add.ptr18 = getelementptr inbounds i8, ptr %24, i64 %26
  %27 = load ptr, ptr %transform.addr, align 8
  %fixed_ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %27, i32 0, i32 4
  %28 = load i64, ptr %fixed_ivlen, align 8
  %idx.neg = sub i64 0, %28
  %add.ptr19 = getelementptr inbounds i8, ptr %add.ptr18, i64 %idx.neg
  %29 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 28
  store ptr %add.ptr19, ptr %in_msg, align 8
  br label %if.end23

if.else20:                                        ; preds = %land.lhs.true, %if.end
  %30 = load ptr, ptr %ssl.addr, align 8
  %in_iv21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 27
  %31 = load ptr, ptr %in_iv21, align 8
  %32 = load ptr, ptr %ssl.addr, align 8
  %in_msg22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 28
  store ptr %31, ptr %in_msg22, align 8
  br label %if.end23

if.end23:                                         ; preds = %if.else20, %if.then16
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_optimize_checksum(ptr noundef %ssl, ptr noundef %ciphersuite_info) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %ciphersuite_info.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %ciphersuite_info, ptr %ciphersuite_info.addr, align 8
  %0 = load ptr, ptr %ciphersuite_info.addr, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 5
  %2 = load i32, ptr %minor_ver, align 8
  %cmp = icmp slt i32 %2, 3
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 15
  %4 = load ptr, ptr %handshake, align 8
  %update_checksum = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 29
  store ptr @ssl_update_checksum_md5sha1, ptr %update_checksum, align 8
  br label %if.end13

if.else:                                          ; preds = %entry
  %5 = load ptr, ptr %ciphersuite_info.addr, align 8
  %mac = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %5, i32 0, i32 3
  %6 = load i32, ptr %mac, align 4
  %cmp1 = icmp eq i32 %6, 7
  br i1 %cmp1, label %if.then2, label %if.else5

if.then2:                                         ; preds = %if.else
  %7 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 15
  %8 = load ptr, ptr %handshake3, align 8
  %update_checksum4 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 29
  store ptr @ssl_update_checksum_sha384, ptr %update_checksum4, align 8
  br label %if.end12

if.else5:                                         ; preds = %if.else
  %9 = load ptr, ptr %ciphersuite_info.addr, align 8
  %mac6 = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %9, i32 0, i32 3
  %10 = load i32, ptr %mac6, align 4
  %cmp7 = icmp ne i32 %10, 7
  br i1 %cmp7, label %if.then8, label %if.else11

if.then8:                                         ; preds = %if.else5
  %11 = load ptr, ptr %ssl.addr, align 8
  %handshake9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 15
  %12 = load ptr, ptr %handshake9, align 8
  %update_checksum10 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %12, i32 0, i32 29
  store ptr @ssl_update_checksum_sha256, ptr %update_checksum10, align 8
  br label %if.end

if.else11:                                        ; preds = %if.else5
  %13 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %13, i32 noundef 1, ptr noundef @.str, i32 noundef 5995, ptr noundef @.str.4)
  br label %if.end13

if.end:                                           ; preds = %if.then8
  br label %if.end12

if.end12:                                         ; preds = %if.end, %if.then2
  br label %if.end13

if.end13:                                         ; preds = %if.else11, %if.end12, %if.then
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_update_checksum_md5sha1(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %fin_md5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 25
  %2 = load ptr, ptr %buf.addr, align 8
  %3 = load i64, ptr %len.addr, align 8
  %call = call i32 @mbedtls_md5_update_ret(ptr noundef %fin_md5, ptr noundef %2, i64 noundef %3)
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %handshake1, align 8
  %fin_sha1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 26
  %6 = load ptr, ptr %buf.addr, align 8
  %7 = load i64, ptr %len.addr, align 8
  %call2 = call i32 @mbedtls_sha1_update_ret(ptr noundef %fin_sha1, ptr noundef %6, i64 noundef %7)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_update_checksum_sha384(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %fin_sha512 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 28
  %2 = load ptr, ptr %buf.addr, align 8
  %3 = load i64, ptr %len.addr, align 8
  %call = call i32 @mbedtls_sha512_update_ret(ptr noundef %fin_sha512, ptr noundef %2, i64 noundef %3)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_update_checksum_sha256(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %fin_sha256 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 27
  %2 = load ptr, ptr %buf.addr, align 8
  %3 = load i64, ptr %len.addr, align 8
  %call = call i32 @mbedtls_sha256_update_ret(ptr noundef %fin_sha256, ptr noundef %2, i64 noundef %3)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_reset_checksum(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %fin_md5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 25
  %call = call i32 @mbedtls_md5_starts_ret(ptr noundef %fin_md5)
  %2 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 15
  %3 = load ptr, ptr %handshake1, align 8
  %fin_sha1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 26
  %call2 = call i32 @mbedtls_sha1_starts_ret(ptr noundef %fin_sha1)
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %handshake3, align 8
  %fin_sha256 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 27
  %call4 = call i32 @mbedtls_sha256_starts_ret(ptr noundef %fin_sha256, i32 noundef 0)
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake5, align 8
  %fin_sha512 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 28
  %call6 = call i32 @mbedtls_sha512_starts_ret(ptr noundef %fin_sha512, i32 noundef 1)
  ret void
}

declare i32 @mbedtls_md5_starts_ret(ptr noundef) #1

declare i32 @mbedtls_sha1_starts_ret(ptr noundef) #1

declare i32 @mbedtls_sha256_starts_ret(ptr noundef, i32 noundef) #1

declare i32 @mbedtls_sha512_starts_ret(ptr noundef, i32 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_handshake_wrapup(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %resume = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %resume1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 36
  %2 = load i32, ptr %resume1, align 4
  store i32 %2, ptr %resume, align 4
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 3, ptr noundef @.str, i32 noundef 6336, ptr noundef @.str.118)
  %4 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 2
  %5 = load i32, ptr %renego_status, align 4
  %cmp = icmp eq i32 %5, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  %renego_status2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 2
  store i32 2, ptr %renego_status2, align 4
  %7 = load ptr, ptr %ssl.addr, align 8
  %renego_records_seen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 3
  store i32 0, ptr %renego_records_seen, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %8 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 13
  %9 = load ptr, ptr %session, align 8
  %tobool = icmp ne ptr %9, null
  br i1 %tobool, label %if.then3, label %if.end8

if.then3:                                         ; preds = %if.end
  %10 = load ptr, ptr %ssl.addr, align 8
  %session4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 13
  %11 = load ptr, ptr %session4, align 8
  %encrypt_then_mac = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %11, i32 0, i32 13
  %12 = load i32, ptr %encrypt_then_mac, align 4
  %13 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 14
  %14 = load ptr, ptr %session_negotiate, align 8
  %encrypt_then_mac5 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %14, i32 0, i32 13
  store i32 %12, ptr %encrypt_then_mac5, align 4
  %15 = load ptr, ptr %ssl.addr, align 8
  %session6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 13
  %16 = load ptr, ptr %session6, align 8
  call void @mbedtls_ssl_session_free(ptr noundef %16)
  %17 = load ptr, ptr %ssl.addr, align 8
  %session7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 13
  %18 = load ptr, ptr %session7, align 8
  call void @free(ptr noundef %18) #8
  br label %if.end8

if.end8:                                          ; preds = %if.then3, %if.end
  %19 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 14
  %20 = load ptr, ptr %session_negotiate9, align 8
  %21 = load ptr, ptr %ssl.addr, align 8
  %session10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 13
  store ptr %20, ptr %session10, align 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 14
  store ptr null, ptr %session_negotiate11, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 0
  %24 = load ptr, ptr %conf, align 8
  %f_set_cache = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %24, i32 0, i32 6
  %25 = load ptr, ptr %f_set_cache, align 8
  %cmp12 = icmp ne ptr %25, null
  br i1 %cmp12, label %land.lhs.true, label %if.end25

land.lhs.true:                                    ; preds = %if.end8
  %26 = load ptr, ptr %ssl.addr, align 8
  %session13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 13
  %27 = load ptr, ptr %session13, align 8
  %id_len = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %27, i32 0, i32 3
  %28 = load i64, ptr %id_len, align 8
  %cmp14 = icmp ne i64 %28, 0
  br i1 %cmp14, label %land.lhs.true15, label %if.end25

land.lhs.true15:                                  ; preds = %land.lhs.true
  %29 = load i32, ptr %resume, align 4
  %cmp16 = icmp eq i32 %29, 0
  br i1 %cmp16, label %if.then17, label %if.end25

if.then17:                                        ; preds = %land.lhs.true15
  %30 = load ptr, ptr %ssl.addr, align 8
  %conf18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 0
  %31 = load ptr, ptr %conf18, align 8
  %f_set_cache19 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %31, i32 0, i32 6
  %32 = load ptr, ptr %f_set_cache19, align 8
  %33 = load ptr, ptr %ssl.addr, align 8
  %conf20 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 0
  %34 = load ptr, ptr %conf20, align 8
  %p_cache = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %34, i32 0, i32 7
  %35 = load ptr, ptr %p_cache, align 8
  %36 = load ptr, ptr %ssl.addr, align 8
  %session21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 13
  %37 = load ptr, ptr %session21, align 8
  %call = call i32 %32(ptr noundef %35, ptr noundef %37)
  %cmp22 = icmp ne i32 %call, 0
  br i1 %cmp22, label %if.then23, label %if.end24

if.then23:                                        ; preds = %if.then17
  %38 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %38, i32 noundef 1, ptr noundef @.str, i32 noundef 6371, ptr noundef @.str.119)
  br label %if.end24

if.end24:                                         ; preds = %if.then23, %if.then17
  br label %if.end25

if.end25:                                         ; preds = %if.end24, %land.lhs.true15, %land.lhs.true, %if.end8
  %39 = load ptr, ptr %ssl.addr, align 8
  %conf26 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 0
  %40 = load ptr, ptr %conf26, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %40, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp27 = icmp eq i32 %bf.clear, 1
  br i1 %cmp27, label %land.lhs.true28, label %if.else

land.lhs.true28:                                  ; preds = %if.end25
  %41 = load ptr, ptr %ssl.addr, align 8
  %handshake29 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 15
  %42 = load ptr, ptr %handshake29, align 8
  %flight = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %42, i32 0, i32 17
  %43 = load ptr, ptr %flight, align 8
  %cmp30 = icmp ne ptr %43, null
  br i1 %cmp30, label %if.then31, label %if.else

if.then31:                                        ; preds = %land.lhs.true28
  %44 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_set_timer(ptr noundef %44, i32 noundef 0)
  %45 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %45, i32 noundef 3, ptr noundef @.str, i32 noundef 6383, ptr noundef @.str.120)
  br label %if.end32

if.else:                                          ; preds = %land.lhs.true28, %if.end25
  %46 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_handshake_wrapup_free_hs_transform(ptr noundef %46)
  br label %if.end32

if.end32:                                         ; preds = %if.else, %if.then31
  %47 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %47, i32 0, i32 1
  %48 = load i32, ptr %state, align 8
  %inc = add nsw i32 %48, 1
  store i32 %inc, ptr %state, align 8
  %49 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %49, i32 noundef 3, ptr noundef @.str, i32 noundef 6391, ptr noundef @.str.121)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_session_free(ptr noundef %session) #0 {
entry:
  %session.addr = alloca ptr, align 8
  store ptr %session, ptr %session.addr, align 8
  %0 = load ptr, ptr %session.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %return

if.end:                                           ; preds = %entry
  %1 = load ptr, ptr %session.addr, align 8
  %peer_cert = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %1, i32 0, i32 6
  %2 = load ptr, ptr %peer_cert, align 8
  %cmp1 = icmp ne ptr %2, null
  br i1 %cmp1, label %if.then2, label %if.end5

if.then2:                                         ; preds = %if.end
  %3 = load ptr, ptr %session.addr, align 8
  %peer_cert3 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %3, i32 0, i32 6
  %4 = load ptr, ptr %peer_cert3, align 8
  call void @mbedtls_x509_crt_free(ptr noundef %4)
  %5 = load ptr, ptr %session.addr, align 8
  %peer_cert4 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %5, i32 0, i32 6
  %6 = load ptr, ptr %peer_cert4, align 8
  call void @free(ptr noundef %6) #8
  br label %if.end5

if.end5:                                          ; preds = %if.then2, %if.end
  %7 = load ptr, ptr %session.addr, align 8
  %ticket = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %7, i32 0, i32 8
  %8 = load ptr, ptr %ticket, align 8
  call void @free(ptr noundef %8) #8
  %9 = load ptr, ptr %session.addr, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %9, i64 noundef 152)
  br label %return

return:                                           ; preds = %if.end5, %if.then
  ret void
}

; Function Attrs: nounwind
declare void @free(ptr noundef) #4

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_write_finished(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %hash_len = alloca i32, align 4
  %i = alloca i8, align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 6398, ptr noundef @.str.122)
  %1 = load ptr, ptr %ssl.addr, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 19
  %3 = load ptr, ptr %transform_negotiate, align 8
  call void @ssl_update_out_pointers(ptr noundef %1, ptr noundef %3)
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %handshake, align 8
  %calc_finished = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 31
  %6 = load ptr, ptr %calc_finished, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 46
  %9 = load ptr, ptr %out_msg, align 8
  %add.ptr = getelementptr inbounds i8, ptr %9, i64 4
  %10 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 0
  %11 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %11, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  call void %6(ptr noundef %7, ptr noundef %add.ptr, i32 noundef %bf.clear)
  %12 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 5
  %13 = load i32, ptr %minor_ver, align 8
  %cmp = icmp eq i32 %13, 0
  %14 = zext i1 %cmp to i64
  %cond = select i1 %cmp, i32 36, i32 12
  store i32 %cond, ptr %hash_len, align 4
  %15 = load i32, ptr %hash_len, align 4
  %conv = sext i32 %15 to i64
  %16 = load ptr, ptr %ssl.addr, align 8
  %verify_data_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 59
  store i64 %conv, ptr %verify_data_len, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %own_verify_data = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 60
  %arraydecay = getelementptr inbounds [12 x i8], ptr %own_verify_data, i64 0, i64 0
  %18 = load ptr, ptr %ssl.addr, align 8
  %out_msg1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 46
  %19 = load ptr, ptr %out_msg1, align 8
  %add.ptr2 = getelementptr inbounds i8, ptr %19, i64 4
  %20 = load i32, ptr %hash_len, align 4
  %conv3 = sext i32 %20 to i64
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay, ptr align 1 %add.ptr2, i64 %conv3, i1 false)
  %21 = load i32, ptr %hash_len, align 4
  %add = add nsw i32 4, %21
  %conv4 = sext i32 %add to i64
  %22 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 48
  store i64 %conv4, ptr %out_msglen, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 47
  store i32 22, ptr %out_msgtype, align 8
  %24 = load ptr, ptr %ssl.addr, align 8
  %out_msg5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 46
  %25 = load ptr, ptr %out_msg5, align 8
  %arrayidx = getelementptr inbounds i8, ptr %25, i64 0
  store i8 20, ptr %arrayidx, align 1
  %26 = load ptr, ptr %ssl.addr, align 8
  %handshake6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 15
  %27 = load ptr, ptr %handshake6, align 8
  %resume = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %27, i32 0, i32 36
  %28 = load i32, ptr %resume, align 4
  %cmp7 = icmp ne i32 %28, 0
  br i1 %cmp7, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %29 = load ptr, ptr %ssl.addr, align 8
  %conf9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 0
  %30 = load ptr, ptr %conf9, align 8
  %endpoint10 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %30, i32 0, i32 46
  %bf.load11 = load i32, ptr %endpoint10, align 4
  %bf.clear12 = and i32 %bf.load11, 1
  %cmp13 = icmp eq i32 %bf.clear12, 0
  br i1 %cmp13, label %if.then15, label %if.end

if.then15:                                        ; preds = %if.then
  %31 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 1
  store i32 15, ptr %state, align 8
  br label %if.end

if.end:                                           ; preds = %if.then15, %if.then
  %32 = load ptr, ptr %ssl.addr, align 8
  %conf16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 0
  %33 = load ptr, ptr %conf16, align 8
  %endpoint17 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %33, i32 0, i32 46
  %bf.load18 = load i32, ptr %endpoint17, align 4
  %bf.clear19 = and i32 %bf.load18, 1
  %cmp20 = icmp eq i32 %bf.clear19, 1
  br i1 %cmp20, label %if.then22, label %if.end24

if.then22:                                        ; preds = %if.end
  %34 = load ptr, ptr %ssl.addr, align 8
  %state23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %34, i32 0, i32 1
  store i32 10, ptr %state23, align 8
  br label %if.end24

if.end24:                                         ; preds = %if.then22, %if.end
  br label %if.end26

if.else:                                          ; preds = %entry
  %35 = load ptr, ptr %ssl.addr, align 8
  %state25 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 1
  %36 = load i32, ptr %state25, align 8
  %inc = add nsw i32 %36, 1
  store i32 %inc, ptr %state25, align 8
  br label %if.end26

if.end26:                                         ; preds = %if.else, %if.end24
  %37 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %37, i32 noundef 3, ptr noundef @.str, i32 noundef 6443, ptr noundef @.str.123)
  %38 = load ptr, ptr %ssl.addr, align 8
  %conf27 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 0
  %39 = load ptr, ptr %conf27, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %39, i32 0, i32 46
  %bf.load28 = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load28, 1
  %bf.clear29 = and i32 %bf.lshr, 1
  %cmp30 = icmp eq i32 %bf.clear29, 1
  br i1 %cmp30, label %if.then32, label %if.else57

if.then32:                                        ; preds = %if.end26
  %40 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %40, i32 0, i32 17
  %41 = load ptr, ptr %transform_out, align 8
  %42 = load ptr, ptr %ssl.addr, align 8
  %handshake33 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 15
  %43 = load ptr, ptr %handshake33, align 8
  %alt_transform_out = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %43, i32 0, i32 21
  store ptr %41, ptr %alt_transform_out, align 8
  %44 = load ptr, ptr %ssl.addr, align 8
  %handshake34 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %44, i32 0, i32 15
  %45 = load ptr, ptr %handshake34, align 8
  %alt_out_ctr = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %45, i32 0, i32 22
  %arraydecay35 = getelementptr inbounds [8 x i8], ptr %alt_out_ctr, i64 0, i64 0
  %46 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 50
  %arraydecay36 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr, i64 0, i64 0
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay35, ptr align 8 %arraydecay36, i64 8, i1 false)
  %47 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr37 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %47, i32 0, i32 50
  %arraydecay38 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr37, i64 0, i64 0
  %add.ptr39 = getelementptr inbounds i8, ptr %arraydecay38, i64 2
  call void @llvm.memset.p0.i64(ptr align 1 %add.ptr39, i8 0, i64 6, i1 false)
  store i8 2, ptr %i, align 1
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.then32
  %48 = load i8, ptr %i, align 1
  %conv40 = zext i8 %48 to i32
  %cmp41 = icmp sgt i32 %conv40, 0
  br i1 %cmp41, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %49 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr43 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 50
  %50 = load i8, ptr %i, align 1
  %conv44 = zext i8 %50 to i32
  %sub = sub nsw i32 %conv44, 1
  %idxprom = sext i32 %sub to i64
  %arrayidx45 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr43, i64 0, i64 %idxprom
  %51 = load i8, ptr %arrayidx45, align 1
  %inc46 = add i8 %51, 1
  store i8 %inc46, ptr %arrayidx45, align 1
  %conv47 = zext i8 %inc46 to i32
  %cmp48 = icmp ne i32 %conv47, 0
  br i1 %cmp48, label %if.then50, label %if.end51

if.then50:                                        ; preds = %for.body
  br label %for.end

if.end51:                                         ; preds = %for.body
  br label %for.inc

for.inc:                                          ; preds = %if.end51
  %52 = load i8, ptr %i, align 1
  %dec = add i8 %52, -1
  store i8 %dec, ptr %i, align 1
  br label %for.cond, !llvm.loop !26

for.end:                                          ; preds = %if.then50, %for.cond
  %53 = load i8, ptr %i, align 1
  %conv52 = zext i8 %53 to i32
  %cmp53 = icmp eq i32 %conv52, 0
  br i1 %cmp53, label %if.then55, label %if.end56

if.then55:                                        ; preds = %for.end
  %54 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %54, i32 noundef 1, ptr noundef @.str, i32 noundef 6465, ptr noundef @.str.116)
  store i32 -27520, ptr %retval, align 4
  br label %return

if.end56:                                         ; preds = %for.end
  br label %if.end60

if.else57:                                        ; preds = %if.end26
  %55 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr58 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %55, i32 0, i32 50
  %arraydecay59 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr58, i64 0, i64 0
  call void @llvm.memset.p0.i64(ptr align 8 %arraydecay59, i8 0, i64 8, i1 false)
  br label %if.end60

if.end60:                                         ; preds = %if.else57, %if.end56
  %56 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate61 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %56, i32 0, i32 19
  %57 = load ptr, ptr %transform_negotiate61, align 8
  %58 = load ptr, ptr %ssl.addr, align 8
  %transform_out62 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 17
  store ptr %57, ptr %transform_out62, align 8
  %59 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %59, i32 0, i32 14
  %60 = load ptr, ptr %session_negotiate, align 8
  %61 = load ptr, ptr %ssl.addr, align 8
  %session_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %61, i32 0, i32 12
  store ptr %60, ptr %session_out, align 8
  %62 = load ptr, ptr %ssl.addr, align 8
  %conf63 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %62, i32 0, i32 0
  %63 = load ptr, ptr %conf63, align 8
  %transport64 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %63, i32 0, i32 46
  %bf.load65 = load i32, ptr %transport64, align 4
  %bf.lshr66 = lshr i32 %bf.load65, 1
  %bf.clear67 = and i32 %bf.lshr66, 1
  %cmp68 = icmp eq i32 %bf.clear67, 1
  br i1 %cmp68, label %if.then70, label %if.end71

if.then70:                                        ; preds = %if.end60
  %64 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_ssl_send_flight_completed(ptr noundef %64)
  br label %if.end71

if.end71:                                         ; preds = %if.then70, %if.end60
  %65 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_write_handshake_msg(ptr noundef %65)
  store i32 %call, ptr %ret, align 4
  %cmp72 = icmp ne i32 %call, 0
  br i1 %cmp72, label %if.then74, label %if.end75

if.then74:                                        ; preds = %if.end71
  %66 = load ptr, ptr %ssl.addr, align 8
  %67 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %66, i32 noundef 1, ptr noundef @.str, i32 noundef 6494, ptr noundef @.str.99, i32 noundef %67)
  %68 = load i32, ptr %ret, align 4
  store i32 %68, ptr %retval, align 4
  br label %return

if.end75:                                         ; preds = %if.end71
  %69 = load ptr, ptr %ssl.addr, align 8
  %conf76 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %69, i32 0, i32 0
  %70 = load ptr, ptr %conf76, align 8
  %transport77 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %70, i32 0, i32 46
  %bf.load78 = load i32, ptr %transport77, align 4
  %bf.lshr79 = lshr i32 %bf.load78, 1
  %bf.clear80 = and i32 %bf.lshr79, 1
  %cmp81 = icmp eq i32 %bf.clear80, 1
  br i1 %cmp81, label %land.lhs.true, label %if.end87

land.lhs.true:                                    ; preds = %if.end75
  %71 = load ptr, ptr %ssl.addr, align 8
  %call83 = call i32 @mbedtls_ssl_flight_transmit(ptr noundef %71)
  store i32 %call83, ptr %ret, align 4
  %cmp84 = icmp ne i32 %call83, 0
  br i1 %cmp84, label %if.then86, label %if.end87

if.then86:                                        ; preds = %land.lhs.true
  %72 = load ptr, ptr %ssl.addr, align 8
  %73 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %72, i32 noundef 1, ptr noundef @.str, i32 noundef 6502, ptr noundef @.str.124, i32 noundef %73)
  %74 = load i32, ptr %ret, align 4
  store i32 %74, ptr %retval, align 4
  br label %return

if.end87:                                         ; preds = %land.lhs.true, %if.end75
  %75 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %75, i32 noundef 2, ptr noundef @.str, i32 noundef 6507, ptr noundef @.str.125)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end87, %if.then86, %if.then74, %if.then55
  %76 = load i32, ptr %retval, align 4
  ret i32 %76
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_parse_finished(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %hash_len = alloca i32, align 4
  %buf = alloca [12 x i8], align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 6524, ptr noundef @.str.126)
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %calc_finished = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 31
  %3 = load ptr, ptr %calc_finished, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %arraydecay = getelementptr inbounds [12 x i8], ptr %buf, i64 0, i64 0
  %5 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 0
  %6 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %6, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %xor = xor i32 %bf.clear, 1
  call void %3(ptr noundef %4, ptr noundef %arraydecay, i32 noundef %xor)
  %7 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_read_record(ptr noundef %7, i32 noundef 1)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %8 = load ptr, ptr %ssl.addr, align 8
  %9 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %8, i32 noundef 1, ptr noundef @.str, i32 noundef 6530, ptr noundef @.str.103, i32 noundef %9)
  %10 = load i32, ptr %ret, align 4
  store i32 %10, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 30
  %12 = load i32, ptr %in_msgtype, align 8
  %cmp1 = icmp ne i32 %12, 22
  br i1 %cmp1, label %if.then2, label %if.end4

if.then2:                                         ; preds = %if.end
  %13 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %13, i32 noundef 1, ptr noundef @.str, i32 noundef 6536, ptr noundef @.str.127)
  %14 = load ptr, ptr %ssl.addr, align 8
  %call3 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %14, i8 noundef zeroext 2, i8 noundef zeroext 10)
  store i32 -30464, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  store i32 12, ptr %hash_len, align 4
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 28
  %16 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %16, i64 0
  %17 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %17 to i32
  %cmp5 = icmp ne i32 %conv, 20
  br i1 %cmp5, label %if.then11, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end4
  %18 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 37
  %19 = load i64, ptr %in_hslen, align 8
  %20 = load ptr, ptr %ssl.addr, align 8
  %call7 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %20)
  %21 = load i32, ptr %hash_len, align 4
  %conv8 = zext i32 %21 to i64
  %add = add i64 %call7, %conv8
  %cmp9 = icmp ne i64 %19, %add
  br i1 %cmp9, label %if.then11, label %if.end13

if.then11:                                        ; preds = %lor.lhs.false, %if.end4
  %22 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %22, i32 noundef 1, ptr noundef @.str, i32 noundef 6553, ptr noundef @.str.127)
  %23 = load ptr, ptr %ssl.addr, align 8
  %call12 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %23, i8 noundef zeroext 2, i8 noundef zeroext 50)
  store i32 -32384, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %lor.lhs.false
  %24 = load ptr, ptr %ssl.addr, align 8
  %in_msg14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 28
  %25 = load ptr, ptr %in_msg14, align 8
  %26 = load ptr, ptr %ssl.addr, align 8
  %call15 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %26)
  %add.ptr = getelementptr inbounds i8, ptr %25, i64 %call15
  %arraydecay16 = getelementptr inbounds [12 x i8], ptr %buf, i64 0, i64 0
  %27 = load i32, ptr %hash_len, align 4
  %conv17 = zext i32 %27 to i64
  %call18 = call i32 @mbedtls_ssl_safer_memcmp(ptr noundef %add.ptr, ptr noundef %arraydecay16, i64 noundef %conv17)
  %cmp19 = icmp ne i32 %call18, 0
  br i1 %cmp19, label %if.then21, label %if.end23

if.then21:                                        ; preds = %if.end13
  %28 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %28, i32 noundef 1, ptr noundef @.str, i32 noundef 6562, ptr noundef @.str.127)
  %29 = load ptr, ptr %ssl.addr, align 8
  %call22 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %29, i8 noundef zeroext 2, i8 noundef zeroext 50)
  store i32 -32384, ptr %retval, align 4
  br label %return

if.end23:                                         ; preds = %if.end13
  %30 = load i32, ptr %hash_len, align 4
  %conv24 = zext i32 %30 to i64
  %31 = load ptr, ptr %ssl.addr, align 8
  %verify_data_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 59
  store i64 %conv24, ptr %verify_data_len, align 8
  %32 = load ptr, ptr %ssl.addr, align 8
  %peer_verify_data = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 61
  %arraydecay25 = getelementptr inbounds [12 x i8], ptr %peer_verify_data, i64 0, i64 0
  %arraydecay26 = getelementptr inbounds [12 x i8], ptr %buf, i64 0, i64 0
  %33 = load i32, ptr %hash_len, align 4
  %conv27 = zext i32 %33 to i64
  call void @llvm.memcpy.p0.p0.i64(ptr align 4 %arraydecay25, ptr align 1 %arraydecay26, i64 %conv27, i1 false)
  %34 = load ptr, ptr %ssl.addr, align 8
  %handshake28 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %34, i32 0, i32 15
  %35 = load ptr, ptr %handshake28, align 8
  %resume = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %35, i32 0, i32 36
  %36 = load i32, ptr %resume, align 4
  %cmp29 = icmp ne i32 %36, 0
  br i1 %cmp29, label %if.then31, label %if.else

if.then31:                                        ; preds = %if.end23
  %37 = load ptr, ptr %ssl.addr, align 8
  %conf32 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %37, i32 0, i32 0
  %38 = load ptr, ptr %conf32, align 8
  %endpoint33 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %38, i32 0, i32 46
  %bf.load34 = load i32, ptr %endpoint33, align 4
  %bf.clear35 = and i32 %bf.load34, 1
  %cmp36 = icmp eq i32 %bf.clear35, 0
  br i1 %cmp36, label %if.then38, label %if.end39

if.then38:                                        ; preds = %if.then31
  %39 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 1
  store i32 10, ptr %state, align 8
  br label %if.end39

if.end39:                                         ; preds = %if.then38, %if.then31
  %40 = load ptr, ptr %ssl.addr, align 8
  %conf40 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %40, i32 0, i32 0
  %41 = load ptr, ptr %conf40, align 8
  %endpoint41 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %41, i32 0, i32 46
  %bf.load42 = load i32, ptr %endpoint41, align 4
  %bf.clear43 = and i32 %bf.load42, 1
  %cmp44 = icmp eq i32 %bf.clear43, 1
  br i1 %cmp44, label %if.then46, label %if.end48

if.then46:                                        ; preds = %if.end39
  %42 = load ptr, ptr %ssl.addr, align 8
  %state47 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 1
  store i32 15, ptr %state47, align 8
  br label %if.end48

if.end48:                                         ; preds = %if.then46, %if.end39
  br label %if.end50

if.else:                                          ; preds = %if.end23
  %43 = load ptr, ptr %ssl.addr, align 8
  %state49 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %43, i32 0, i32 1
  %44 = load i32, ptr %state49, align 8
  %inc = add nsw i32 %44, 1
  store i32 %inc, ptr %state49, align 8
  br label %if.end50

if.end50:                                         ; preds = %if.else, %if.end48
  %45 = load ptr, ptr %ssl.addr, align 8
  %conf51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %45, i32 0, i32 0
  %46 = load ptr, ptr %conf51, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %46, i32 0, i32 46
  %bf.load52 = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load52, 1
  %bf.clear53 = and i32 %bf.lshr, 1
  %cmp54 = icmp eq i32 %bf.clear53, 1
  br i1 %cmp54, label %if.then56, label %if.end57

if.then56:                                        ; preds = %if.end50
  %47 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_ssl_recv_flight_completed(ptr noundef %47)
  br label %if.end57

if.end57:                                         ; preds = %if.then56, %if.end50
  %48 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %48, i32 noundef 2, ptr noundef @.str, i32 noundef 6592, ptr noundef @.str.128)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end57, %if.then21, %if.then11, %if.then2, %if.then
  %49 = load i32, ptr %retval, align 4
  ret i32 %49
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @mbedtls_ssl_safer_memcmp(ptr noundef %a, ptr noundef %b, i64 noundef %n) #0 {
entry:
  %a.addr = alloca ptr, align 8
  %b.addr = alloca ptr, align 8
  %n.addr = alloca i64, align 8
  %i = alloca i64, align 8
  %A = alloca ptr, align 8
  %B = alloca ptr, align 8
  %diff = alloca i8, align 1
  %x = alloca i8, align 1
  %y = alloca i8, align 1
  store ptr %a, ptr %a.addr, align 8
  store ptr %b, ptr %b.addr, align 8
  store i64 %n, ptr %n.addr, align 8
  %0 = load ptr, ptr %a.addr, align 8
  store ptr %0, ptr %A, align 8
  %1 = load ptr, ptr %b.addr, align 8
  store ptr %1, ptr %B, align 8
  store volatile i8 0, ptr %diff, align 1
  store i64 0, ptr %i, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %entry
  %2 = load i64, ptr %i, align 8
  %3 = load i64, ptr %n.addr, align 8
  %cmp = icmp ult i64 %2, %3
  br i1 %cmp, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %4 = load ptr, ptr %A, align 8
  %5 = load i64, ptr %i, align 8
  %arrayidx = getelementptr inbounds i8, ptr %4, i64 %5
  %6 = load volatile i8, ptr %arrayidx, align 1
  store i8 %6, ptr %x, align 1
  %7 = load ptr, ptr %B, align 8
  %8 = load i64, ptr %i, align 8
  %arrayidx1 = getelementptr inbounds i8, ptr %7, i64 %8
  %9 = load volatile i8, ptr %arrayidx1, align 1
  store i8 %9, ptr %y, align 1
  %10 = load i8, ptr %x, align 1
  %conv = zext i8 %10 to i32
  %11 = load i8, ptr %y, align 1
  %conv2 = zext i8 %11 to i32
  %xor = xor i32 %conv, %conv2
  %12 = load volatile i8, ptr %diff, align 1
  %conv3 = zext i8 %12 to i32
  %or = or i32 %conv3, %xor
  %conv4 = trunc i32 %or to i8
  store volatile i8 %conv4, ptr %diff, align 1
  br label %for.inc

for.inc:                                          ; preds = %for.body
  %13 = load i64, ptr %i, align 8
  %inc = add i64 %13, 1
  store i64 %inc, ptr %i, align 8
  br label %for.cond, !llvm.loop !27

for.end:                                          ; preds = %for.cond
  %14 = load volatile i8, ptr %diff, align 1
  %conv5 = zext i8 %14 to i32
  ret i32 %conv5
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_session_init(ptr noundef %session) #0 {
entry:
  %session.addr = alloca ptr, align 8
  store ptr %session, ptr %session.addr, align 8
  %0 = load ptr, ptr %session.addr, align 8
  call void @llvm.memset.p0.i64(ptr align 8 %0, i8 0, i64 152, i1 false)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_init(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void @llvm.memset.p0.i64(ptr align 8 %0, i8 0, i64 456, i1 false)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_setup(ptr noundef %ssl, ptr noundef %conf) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %conf.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %conf1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 0
  store ptr %0, ptr %conf1, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 41
  store ptr null, ptr %out_buf, align 8
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef 16717) #9
  %3 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 23
  store ptr %call, ptr %in_buf, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_buf2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 23
  %5 = load ptr, ptr %in_buf2, align 8
  %cmp = icmp eq ptr %5, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %6, i32 noundef 1, ptr noundef @.str, i32 noundef 6885, ptr noundef @.str.129, i32 noundef 16717)
  store i32 -32512, ptr %ret, align 4
  br label %error

if.end:                                           ; preds = %entry
  %call3 = call noalias ptr @calloc(i64 noundef 1, i64 noundef 16717) #9
  %7 = load ptr, ptr %ssl.addr, align 8
  %out_buf4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 41
  store ptr %call3, ptr %out_buf4, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %out_buf5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 41
  %9 = load ptr, ptr %out_buf5, align 8
  %cmp6 = icmp eq ptr %9, null
  br i1 %cmp6, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end
  %10 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %10, i32 noundef 1, ptr noundef @.str, i32 noundef 6893, ptr noundef @.str.129, i32 noundef 16717)
  store i32 -32512, ptr %ret, align 4
  br label %error

if.end8:                                          ; preds = %if.end
  %11 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_reset_in_out_pointers(ptr noundef %11)
  %12 = load ptr, ptr %ssl.addr, align 8
  %call9 = call i32 @ssl_handshake_init(ptr noundef %12)
  store i32 %call9, ptr %ret, align 4
  %cmp10 = icmp ne i32 %call9, 0
  br i1 %cmp10, label %if.then11, label %if.end12

if.then11:                                        ; preds = %if.end8
  br label %error

if.end12:                                         ; preds = %if.end8
  store i32 0, ptr %retval, align 4
  br label %return

error:                                            ; preds = %if.then11, %if.then7, %if.then
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_buf13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 23
  %14 = load ptr, ptr %in_buf13, align 8
  call void @free(ptr noundef %14) #8
  %15 = load ptr, ptr %ssl.addr, align 8
  %out_buf14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 41
  %16 = load ptr, ptr %out_buf14, align 8
  call void @free(ptr noundef %16) #8
  %17 = load ptr, ptr %ssl.addr, align 8
  %conf15 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 0
  store ptr null, ptr %conf15, align 8
  %18 = load ptr, ptr %ssl.addr, align 8
  %in_buf16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 23
  store ptr null, ptr %in_buf16, align 8
  %19 = load ptr, ptr %ssl.addr, align 8
  %out_buf17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 41
  store ptr null, ptr %out_buf17, align 8
  %20 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 25
  store ptr null, ptr %in_hdr, align 8
  %21 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 24
  store ptr null, ptr %in_ctr, align 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %in_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 26
  store ptr null, ptr %in_len, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %in_iv = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 27
  store ptr null, ptr %in_iv, align 8
  %24 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 28
  store ptr null, ptr %in_msg, align 8
  %25 = load ptr, ptr %ssl.addr, align 8
  %out_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 43
  store ptr null, ptr %out_hdr, align 8
  %26 = load ptr, ptr %ssl.addr, align 8
  %out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 42
  store ptr null, ptr %out_ctr, align 8
  %27 = load ptr, ptr %ssl.addr, align 8
  %out_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 44
  store ptr null, ptr %out_len, align 8
  %28 = load ptr, ptr %ssl.addr, align 8
  %out_iv = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 45
  store ptr null, ptr %out_iv, align 8
  %29 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 46
  store ptr null, ptr %out_msg, align 8
  %30 = load i32, ptr %ret, align 4
  store i32 %30, ptr %retval, align 4
  br label %return

return:                                           ; preds = %error, %if.end12
  %31 = load i32, ptr %retval, align 4
  ret i32 %31
}

; Function Attrs: nounwind allocsize(0,1)
declare noalias ptr @calloc(i64 noundef, i64 noundef) #5

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_reset_in_out_pointers(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 41
  %3 = load ptr, ptr %out_buf, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %out_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 43
  store ptr %3, ptr %out_hdr, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 23
  %6 = load ptr, ptr %in_buf, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 25
  store ptr %6, ptr %in_hdr, align 8
  br label %if.end

if.else:                                          ; preds = %entry
  %8 = load ptr, ptr %ssl.addr, align 8
  %out_buf1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 41
  %9 = load ptr, ptr %out_buf1, align 8
  %add.ptr = getelementptr inbounds i8, ptr %9, i64 8
  %10 = load ptr, ptr %ssl.addr, align 8
  %out_hdr2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 43
  store ptr %add.ptr, ptr %out_hdr2, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_buf3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 23
  %12 = load ptr, ptr %in_buf3, align 8
  %add.ptr4 = getelementptr inbounds i8, ptr %12, i64 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_hdr5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 25
  store ptr %add.ptr4, ptr %in_hdr5, align 8
  br label %if.end

if.end:                                           ; preds = %if.else, %if.then
  %14 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_update_out_pointers(ptr noundef %14, ptr noundef null)
  %15 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_update_in_pointers(ptr noundef %15, ptr noundef null)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_handshake_init(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 19
  %1 = load ptr, ptr %transform_negotiate, align 8
  %tobool = icmp ne ptr %1, null
  br i1 %tobool, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 19
  %3 = load ptr, ptr %transform_negotiate1, align 8
  call void @mbedtls_ssl_transform_free(ptr noundef %3)
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 14
  %5 = load ptr, ptr %session_negotiate, align 8
  %tobool2 = icmp ne ptr %5, null
  br i1 %tobool2, label %if.then3, label %if.end5

if.then3:                                         ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 14
  %7 = load ptr, ptr %session_negotiate4, align 8
  call void @mbedtls_ssl_session_free(ptr noundef %7)
  br label %if.end5

if.end5:                                          ; preds = %if.then3, %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 15
  %9 = load ptr, ptr %handshake, align 8
  %tobool6 = icmp ne ptr %9, null
  br i1 %tobool6, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end5
  %10 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_ssl_handshake_free(ptr noundef %10)
  br label %if.end8

if.end8:                                          ; preds = %if.then7, %if.end5
  %11 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 19
  %12 = load ptr, ptr %transform_negotiate9, align 8
  %cmp = icmp eq ptr %12, null
  br i1 %cmp, label %if.then10, label %if.end12

if.then10:                                        ; preds = %if.end8
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef 304) #9
  %13 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 19
  store ptr %call, ptr %transform_negotiate11, align 8
  br label %if.end12

if.end12:                                         ; preds = %if.then10, %if.end8
  %14 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 14
  %15 = load ptr, ptr %session_negotiate13, align 8
  %cmp14 = icmp eq ptr %15, null
  br i1 %cmp14, label %if.then15, label %if.end18

if.then15:                                        ; preds = %if.end12
  %call16 = call noalias ptr @calloc(i64 noundef 1, i64 noundef 152) #9
  %16 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 14
  store ptr %call16, ptr %session_negotiate17, align 8
  br label %if.end18

if.end18:                                         ; preds = %if.then15, %if.end12
  %17 = load ptr, ptr %ssl.addr, align 8
  %handshake19 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 15
  %18 = load ptr, ptr %handshake19, align 8
  %cmp20 = icmp eq ptr %18, null
  br i1 %cmp20, label %if.then21, label %if.end24

if.then21:                                        ; preds = %if.end18
  %call22 = call noalias ptr @calloc(i64 noundef 1, i64 noundef 2856) #9
  %19 = load ptr, ptr %ssl.addr, align 8
  %handshake23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 15
  store ptr %call22, ptr %handshake23, align 8
  br label %if.end24

if.end24:                                         ; preds = %if.then21, %if.end18
  %20 = load ptr, ptr %ssl.addr, align 8
  %handshake25 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 15
  %21 = load ptr, ptr %handshake25, align 8
  %cmp26 = icmp eq ptr %21, null
  br i1 %cmp26, label %if.then32, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end24
  %22 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate27 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 19
  %23 = load ptr, ptr %transform_negotiate27, align 8
  %cmp28 = icmp eq ptr %23, null
  br i1 %cmp28, label %if.then32, label %lor.lhs.false29

lor.lhs.false29:                                  ; preds = %lor.lhs.false
  %24 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate30 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 14
  %25 = load ptr, ptr %session_negotiate30, align 8
  %cmp31 = icmp eq ptr %25, null
  br i1 %cmp31, label %if.then32, label %if.end39

if.then32:                                        ; preds = %lor.lhs.false29, %lor.lhs.false, %if.end24
  %26 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %26, i32 noundef 1, ptr noundef @.str, i32 noundef 6699, ptr noundef @.str.300)
  %27 = load ptr, ptr %ssl.addr, align 8
  %handshake33 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 15
  %28 = load ptr, ptr %handshake33, align 8
  call void @free(ptr noundef %28) #8
  %29 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate34 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 19
  %30 = load ptr, ptr %transform_negotiate34, align 8
  call void @free(ptr noundef %30) #8
  %31 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate35 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 14
  %32 = load ptr, ptr %session_negotiate35, align 8
  call void @free(ptr noundef %32) #8
  %33 = load ptr, ptr %ssl.addr, align 8
  %handshake36 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 15
  store ptr null, ptr %handshake36, align 8
  %34 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate37 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %34, i32 0, i32 19
  store ptr null, ptr %transform_negotiate37, align 8
  %35 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate38 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 14
  store ptr null, ptr %session_negotiate38, align 8
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end39:                                         ; preds = %lor.lhs.false29
  %36 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate40 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 14
  %37 = load ptr, ptr %session_negotiate40, align 8
  call void @mbedtls_ssl_session_init(ptr noundef %37)
  %38 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate41 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 19
  %39 = load ptr, ptr %transform_negotiate41, align 8
  call void @ssl_transform_init(ptr noundef %39)
  %40 = load ptr, ptr %ssl.addr, align 8
  %handshake42 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %40, i32 0, i32 15
  %41 = load ptr, ptr %handshake42, align 8
  call void @ssl_handshake_params_init(ptr noundef %41)
  %42 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 0
  %43 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %43, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp43 = icmp eq i32 %bf.clear, 1
  br i1 %cmp43, label %if.then44, label %if.end55

if.then44:                                        ; preds = %if.end39
  %44 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %44, i32 0, i32 17
  %45 = load ptr, ptr %transform_out, align 8
  %46 = load ptr, ptr %ssl.addr, align 8
  %handshake45 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 15
  %47 = load ptr, ptr %handshake45, align 8
  %alt_transform_out = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %47, i32 0, i32 21
  store ptr %45, ptr %alt_transform_out, align 8
  %48 = load ptr, ptr %ssl.addr, align 8
  %conf46 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %48, i32 0, i32 0
  %49 = load ptr, ptr %conf46, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %49, i32 0, i32 46
  %bf.load47 = load i32, ptr %endpoint, align 4
  %bf.clear48 = and i32 %bf.load47, 1
  %cmp49 = icmp eq i32 %bf.clear48, 0
  br i1 %cmp49, label %if.then50, label %if.else

if.then50:                                        ; preds = %if.then44
  %50 = load ptr, ptr %ssl.addr, align 8
  %handshake51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %50, i32 0, i32 15
  %51 = load ptr, ptr %handshake51, align 8
  %retransmit_state = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %51, i32 0, i32 16
  store i8 0, ptr %retransmit_state, align 8
  br label %if.end54

if.else:                                          ; preds = %if.then44
  %52 = load ptr, ptr %ssl.addr, align 8
  %handshake52 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %52, i32 0, i32 15
  %53 = load ptr, ptr %handshake52, align 8
  %retransmit_state53 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %53, i32 0, i32 16
  store i8 2, ptr %retransmit_state53, align 8
  br label %if.end54

if.end54:                                         ; preds = %if.else, %if.then50
  %54 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_set_timer(ptr noundef %54, i32 noundef 0)
  br label %if.end55

if.end55:                                         ; preds = %if.end54, %if.end39
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end55, %if.then32
  %55 = load i32, ptr %retval, align 4
  ret i32 %55
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_session_reset(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_session_reset_int(ptr noundef %0, i32 noundef 0)
  ret i32 %call
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_session_reset_int(ptr noundef %ssl, i32 noundef %partial) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %partial.addr = alloca i32, align 4
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %partial, ptr %partial.addr, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 1
  store i32 0, ptr %state, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_set_timer(ptr noundef %1, i32 noundef 0)
  %2 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 2
  store i32 0, ptr %renego_status, align 4
  %3 = load ptr, ptr %ssl.addr, align 8
  %renego_records_seen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 3
  store i32 0, ptr %renego_records_seen, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %verify_data_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 59
  store i64 0, ptr %verify_data_len, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %own_verify_data = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 60
  %arraydecay = getelementptr inbounds [12 x i8], ptr %own_verify_data, i64 0, i64 0
  call void @llvm.memset.p0.i64(ptr align 8 %arraydecay, i8 0, i64 12, i1 false)
  %6 = load ptr, ptr %ssl.addr, align 8
  %peer_verify_data = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 61
  %arraydecay1 = getelementptr inbounds [12 x i8], ptr %peer_verify_data, i64 0, i64 0
  call void @llvm.memset.p0.i64(ptr align 4 %arraydecay1, i8 0, i64 12, i1 false)
  %7 = load ptr, ptr %ssl.addr, align 8
  %secure_renegotiation = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 58
  store i32 0, ptr %secure_renegotiation, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_offt = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 29
  store ptr null, ptr %in_offt, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_reset_in_out_pointers(ptr noundef %9)
  %10 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 30
  store i32 0, ptr %in_msgtype, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 31
  store i64 0, ptr %in_msglen, align 8
  %12 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 34
  store i64 0, ptr %next_record_offset, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_epoch = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 33
  store i16 0, ptr %in_epoch, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_dtls_replay_reset(ptr noundef %14)
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 37
  store i64 0, ptr %in_hslen, align 8
  %16 = load ptr, ptr %ssl.addr, align 8
  %nb_zero = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 38
  store i32 0, ptr %nb_zero, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %keep_current_message = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 39
  store i32 0, ptr %keep_current_message, align 4
  %18 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 47
  store i32 0, ptr %out_msgtype, align 8
  %19 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 48
  store i64 0, ptr %out_msglen, align 8
  %20 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 49
  store i64 0, ptr %out_left, align 8
  %21 = load ptr, ptr %ssl.addr, align 8
  %split_done = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 52
  %22 = load i8, ptr %split_done, align 2
  %conv = sext i8 %22 to i32
  %cmp = icmp ne i32 %conv, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %23 = load ptr, ptr %ssl.addr, align 8
  %split_done3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 52
  store i8 0, ptr %split_done3, align 2
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %24 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 50
  %arraydecay4 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr, i64 0, i64 0
  call void @llvm.memset.p0.i64(ptr align 8 %arraydecay4, i8 0, i64 8, i1 false)
  %25 = load ptr, ptr %ssl.addr, align 8
  %transform_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 16
  store ptr null, ptr %transform_in, align 8
  %26 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 17
  store ptr null, ptr %transform_out, align 8
  %27 = load ptr, ptr %ssl.addr, align 8
  %session_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 11
  store ptr null, ptr %session_in, align 8
  %28 = load ptr, ptr %ssl.addr, align 8
  %session_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 12
  store ptr null, ptr %session_out, align 8
  %29 = load ptr, ptr %ssl.addr, align 8
  %out_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 41
  %30 = load ptr, ptr %out_buf, align 8
  call void @llvm.memset.p0.i64(ptr align 1 %30, i8 0, i64 16717, i1 false)
  %31 = load i32, ptr %partial.addr, align 4
  %cmp5 = icmp eq i32 %31, 0
  br i1 %cmp5, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end
  %32 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 32
  store i64 0, ptr %in_left, align 8
  %33 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 23
  %34 = load ptr, ptr %in_buf, align 8
  call void @llvm.memset.p0.i64(ptr align 1 %34, i8 0, i64 16717, i1 false)
  br label %if.end8

if.end8:                                          ; preds = %if.then7, %if.end
  %35 = load ptr, ptr %ssl.addr, align 8
  %transform = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 18
  %36 = load ptr, ptr %transform, align 8
  %tobool = icmp ne ptr %36, null
  br i1 %tobool, label %if.then9, label %if.end13

if.then9:                                         ; preds = %if.end8
  %37 = load ptr, ptr %ssl.addr, align 8
  %transform10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %37, i32 0, i32 18
  %38 = load ptr, ptr %transform10, align 8
  call void @mbedtls_ssl_transform_free(ptr noundef %38)
  %39 = load ptr, ptr %ssl.addr, align 8
  %transform11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 18
  %40 = load ptr, ptr %transform11, align 8
  call void @free(ptr noundef %40) #8
  %41 = load ptr, ptr %ssl.addr, align 8
  %transform12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 18
  store ptr null, ptr %transform12, align 8
  br label %if.end13

if.end13:                                         ; preds = %if.then9, %if.end8
  %42 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %42, i32 0, i32 13
  %43 = load ptr, ptr %session, align 8
  %tobool14 = icmp ne ptr %43, null
  br i1 %tobool14, label %if.then15, label %if.end19

if.then15:                                        ; preds = %if.end13
  %44 = load ptr, ptr %ssl.addr, align 8
  %session16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %44, i32 0, i32 13
  %45 = load ptr, ptr %session16, align 8
  call void @mbedtls_ssl_session_free(ptr noundef %45)
  %46 = load ptr, ptr %ssl.addr, align 8
  %session17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 13
  %47 = load ptr, ptr %session17, align 8
  call void @free(ptr noundef %47) #8
  %48 = load ptr, ptr %ssl.addr, align 8
  %session18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %48, i32 0, i32 13
  store ptr null, ptr %session18, align 8
  br label %if.end19

if.end19:                                         ; preds = %if.then15, %if.end13
  %49 = load ptr, ptr %ssl.addr, align 8
  %alpn_chosen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 55
  store ptr null, ptr %alpn_chosen, align 8
  %50 = load i32, ptr %partial.addr, align 4
  %cmp20 = icmp eq i32 %50, 0
  br i1 %cmp20, label %if.then22, label %if.end24

if.then22:                                        ; preds = %if.end19
  %51 = load ptr, ptr %ssl.addr, align 8
  %cli_id = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %51, i32 0, i32 56
  %52 = load ptr, ptr %cli_id, align 8
  call void @free(ptr noundef %52) #8
  %53 = load ptr, ptr %ssl.addr, align 8
  %cli_id23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %53, i32 0, i32 56
  store ptr null, ptr %cli_id23, align 8
  %54 = load ptr, ptr %ssl.addr, align 8
  %cli_id_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %54, i32 0, i32 57
  store i64 0, ptr %cli_id_len, align 8
  br label %if.end24

if.end24:                                         ; preds = %if.then22, %if.end19
  %55 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_handshake_init(ptr noundef %55)
  store i32 %call, ptr %ret, align 4
  %cmp25 = icmp ne i32 %call, 0
  br i1 %cmp25, label %if.then27, label %if.end28

if.then27:                                        ; preds = %if.end24
  %56 = load i32, ptr %ret, align 4
  store i32 %56, ptr %retval, align 4
  br label %return

if.end28:                                         ; preds = %if.end24
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end28, %if.then27
  %57 = load i32, ptr %retval, align 4
  ret i32 %57
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_endpoint(ptr noundef %conf, i32 noundef %endpoint) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %endpoint.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %endpoint, ptr %endpoint.addr, align 4
  %0 = load i32, ptr %endpoint.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %endpoint1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint1, align 4
  %bf.value = and i32 %0, 1
  %bf.clear = and i32 %bf.load, -2
  %bf.set = or i32 %bf.clear, %bf.value
  store i32 %bf.set, ptr %endpoint1, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_transport(ptr noundef %conf, i32 noundef %transport) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %transport.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %transport, ptr %transport.addr, align 4
  %0 = load i32, ptr %transport.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %transport1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport1, align 4
  %bf.value = and i32 %0, 1
  %bf.shl = shl i32 %bf.value, 1
  %bf.clear = and i32 %bf.load, -3
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %transport1, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_dtls_anti_replay(ptr noundef %conf, i8 noundef signext %mode) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %mode.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %mode, ptr %mode.addr, align 1
  %0 = load i8, ptr %mode.addr, align 1
  %conv = sext i8 %0 to i32
  %1 = load ptr, ptr %conf.addr, align 8
  %anti_replay = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %anti_replay, align 4
  %bf.value = and i32 %conv, 1
  %bf.shl = shl i32 %bf.value, 12
  %bf.clear = and i32 %bf.load, -4097
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %anti_replay, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_dtls_badmac_limit(ptr noundef %conf, i32 noundef %limit) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %limit.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %limit, ptr %limit.addr, align 4
  %0 = load i32, ptr %limit.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %badmac_limit = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 40
  store i32 %0, ptr %badmac_limit, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_set_datagram_packing(ptr noundef %ssl, i32 noundef %allow_packing) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %allow_packing.addr = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %allow_packing, ptr %allow_packing.addr, align 4
  %0 = load i32, ptr %allow_packing.addr, align 4
  %tobool = icmp ne i32 %0, 0
  %lnot = xor i1 %tobool, true
  %lnot.ext = zext i1 %lnot to i32
  %conv = trunc i32 %lnot.ext to i8
  %1 = load ptr, ptr %ssl.addr, align 8
  %disable_datagram_packing = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 40
  store i8 %conv, ptr %disable_datagram_packing, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_handshake_timeout(ptr noundef %conf, i32 noundef %min, i32 noundef %max) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %min.addr = alloca i32, align 4
  %max.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %min, ptr %min.addr, align 4
  store i32 %max, ptr %max.addr, align 4
  %0 = load i32, ptr %min.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %hs_timeout_min = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 36
  store i32 %0, ptr %hs_timeout_min, align 4
  %2 = load i32, ptr %max.addr, align 4
  %3 = load ptr, ptr %conf.addr, align 8
  %hs_timeout_max = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 37
  store i32 %2, ptr %hs_timeout_max, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_authmode(ptr noundef %conf, i32 noundef %authmode) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %authmode.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %authmode, ptr %authmode.addr, align 4
  %0 = load i32, ptr %authmode.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %authmode1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %authmode1, align 4
  %bf.value = and i32 %0, 3
  %bf.shl = shl i32 %bf.value, 2
  %bf.clear = and i32 %bf.load, -13
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %authmode1, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_verify(ptr noundef %conf, ptr noundef %f_vrfy, ptr noundef %p_vrfy) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %f_vrfy.addr = alloca ptr, align 8
  %p_vrfy.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %f_vrfy, ptr %f_vrfy.addr, align 8
  store ptr %p_vrfy, ptr %p_vrfy.addr, align 8
  %0 = load ptr, ptr %f_vrfy.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %f_vrfy1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 10
  store ptr %0, ptr %f_vrfy1, align 8
  %2 = load ptr, ptr %p_vrfy.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %p_vrfy2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 11
  store ptr %2, ptr %p_vrfy2, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_rng(ptr noundef %conf, ptr noundef %f_rng, ptr noundef %p_rng) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %f_rng.addr = alloca ptr, align 8
  %p_rng.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %f_rng, ptr %f_rng.addr, align 8
  store ptr %p_rng, ptr %p_rng.addr, align 8
  %0 = load ptr, ptr %f_rng.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %f_rng1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 3
  store ptr %0, ptr %f_rng1, align 8
  %2 = load ptr, ptr %p_rng.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %p_rng2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 4
  store ptr %2, ptr %p_rng2, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_dbg(ptr noundef %conf, ptr noundef %f_dbg, ptr noundef %p_dbg) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %f_dbg.addr = alloca ptr, align 8
  %p_dbg.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %f_dbg, ptr %f_dbg.addr, align 8
  store ptr %p_dbg, ptr %p_dbg.addr, align 8
  %0 = load ptr, ptr %f_dbg.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %f_dbg1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 1
  store ptr %0, ptr %f_dbg1, align 8
  %2 = load ptr, ptr %p_dbg.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %p_dbg2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 2
  store ptr %2, ptr %p_dbg2, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_set_bio(ptr noundef %ssl, ptr noundef %p_bio, ptr noundef %f_send, ptr noundef %f_recv, ptr noundef %f_recv_timeout) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %p_bio.addr = alloca ptr, align 8
  %f_send.addr = alloca ptr, align 8
  %f_recv.addr = alloca ptr, align 8
  %f_recv_timeout.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %p_bio, ptr %p_bio.addr, align 8
  store ptr %f_send, ptr %f_send.addr, align 8
  store ptr %f_recv, ptr %f_recv.addr, align 8
  store ptr %f_recv_timeout, ptr %f_recv_timeout.addr, align 8
  %0 = load ptr, ptr %p_bio.addr, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %p_bio1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 10
  store ptr %0, ptr %p_bio1, align 8
  %2 = load ptr, ptr %f_send.addr, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %f_send2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 7
  store ptr %2, ptr %f_send2, align 8
  %4 = load ptr, ptr %f_recv.addr, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %f_recv3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 8
  store ptr %4, ptr %f_recv3, align 8
  %6 = load ptr, ptr %f_recv_timeout.addr, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %f_recv_timeout4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 9
  store ptr %6, ptr %f_recv_timeout4, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_set_mtu(ptr noundef %ssl, i16 noundef zeroext %mtu) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %mtu.addr = alloca i16, align 2
  store ptr %ssl, ptr %ssl.addr, align 8
  store i16 %mtu, ptr %mtu.addr, align 2
  %0 = load i16, ptr %mtu.addr, align 2
  %1 = load ptr, ptr %ssl.addr, align 8
  %mtu1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 51
  store i16 %0, ptr %mtu1, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_read_timeout(ptr noundef %conf, i32 noundef %timeout) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %timeout.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %timeout, ptr %timeout.addr, align 4
  %0 = load i32, ptr %timeout.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %read_timeout = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 35
  store i32 %0, ptr %read_timeout, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_set_timer_cb(ptr noundef %ssl, ptr noundef %p_timer, ptr noundef %f_set_timer, ptr noundef %f_get_timer) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %p_timer.addr = alloca ptr, align 8
  %f_set_timer.addr = alloca ptr, align 8
  %f_get_timer.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %p_timer, ptr %p_timer.addr, align 8
  store ptr %f_set_timer, ptr %f_set_timer.addr, align 8
  store ptr %f_get_timer, ptr %f_get_timer.addr, align 8
  %0 = load ptr, ptr %p_timer.addr, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %p_timer1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 20
  store ptr %0, ptr %p_timer1, align 8
  %2 = load ptr, ptr %f_set_timer.addr, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %f_set_timer2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 21
  store ptr %2, ptr %f_set_timer2, align 8
  %4 = load ptr, ptr %f_get_timer.addr, align 8
  %5 = load ptr, ptr %ssl.addr, align 8
  %f_get_timer3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 22
  store ptr %4, ptr %f_get_timer3, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_set_timer(ptr noundef %6, i32 noundef 0)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_session_cache(ptr noundef %conf, ptr noundef %p_cache, ptr noundef %f_get_cache, ptr noundef %f_set_cache) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %p_cache.addr = alloca ptr, align 8
  %f_get_cache.addr = alloca ptr, align 8
  %f_set_cache.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %p_cache, ptr %p_cache.addr, align 8
  store ptr %f_get_cache, ptr %f_get_cache.addr, align 8
  store ptr %f_set_cache, ptr %f_set_cache.addr, align 8
  %0 = load ptr, ptr %p_cache.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %p_cache1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 7
  store ptr %0, ptr %p_cache1, align 8
  %2 = load ptr, ptr %f_get_cache.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %f_get_cache2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 5
  store ptr %2, ptr %f_get_cache2, align 8
  %4 = load ptr, ptr %f_set_cache.addr, align 8
  %5 = load ptr, ptr %conf.addr, align 8
  %f_set_cache3 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 6
  store ptr %4, ptr %f_set_cache3, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_set_session(ptr noundef %ssl, ptr noundef %session) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %session.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %session, ptr %session.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %session.addr, align 8
  %cmp1 = icmp eq ptr %1, null
  br i1 %cmp1, label %if.then, label %lor.lhs.false2

lor.lhs.false2:                                   ; preds = %lor.lhs.false
  %2 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 14
  %3 = load ptr, ptr %session_negotiate, align 8
  %cmp3 = icmp eq ptr %3, null
  br i1 %cmp3, label %if.then, label %lor.lhs.false4

lor.lhs.false4:                                   ; preds = %lor.lhs.false2
  %4 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 0
  %5 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp5 = icmp ne i32 %bf.clear, 0
  br i1 %cmp5, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false4, %lor.lhs.false2, %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false4
  %6 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 14
  %7 = load ptr, ptr %session_negotiate6, align 8
  %8 = load ptr, ptr %session.addr, align 8
  %call = call i32 @ssl_session_copy(ptr noundef %7, ptr noundef %8)
  store i32 %call, ptr %ret, align 4
  %cmp7 = icmp ne i32 %call, 0
  br i1 %cmp7, label %if.then8, label %if.end9

if.then8:                                         ; preds = %if.end
  %9 = load i32, ptr %ret, align 4
  store i32 %9, ptr %retval, align 4
  br label %return

if.end9:                                          ; preds = %if.end
  %10 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 15
  %11 = load ptr, ptr %handshake, align 8
  %resume = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 36
  store i32 1, ptr %resume, align 4
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end9, %if.then8, %if.then
  %12 = load i32, ptr %retval, align 4
  ret i32 %12
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_session_copy(ptr noundef %dst, ptr noundef %src) #0 {
entry:
  %retval = alloca i32, align 4
  %dst.addr = alloca ptr, align 8
  %src.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %dst, ptr %dst.addr, align 8
  store ptr %src, ptr %src.addr, align 8
  %0 = load ptr, ptr %dst.addr, align 8
  call void @mbedtls_ssl_session_free(ptr noundef %0)
  %1 = load ptr, ptr %dst.addr, align 8
  %2 = load ptr, ptr %src.addr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %1, ptr align 8 %2, i64 152, i1 false)
  %3 = load ptr, ptr %src.addr, align 8
  %peer_cert = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %3, i32 0, i32 6
  %4 = load ptr, ptr %peer_cert, align 8
  %cmp = icmp ne ptr %4, null
  br i1 %cmp, label %if.then, label %if.end16

if.then:                                          ; preds = %entry
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef 552) #9
  %5 = load ptr, ptr %dst.addr, align 8
  %peer_cert1 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %5, i32 0, i32 6
  store ptr %call, ptr %peer_cert1, align 8
  %6 = load ptr, ptr %dst.addr, align 8
  %peer_cert2 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %6, i32 0, i32 6
  %7 = load ptr, ptr %peer_cert2, align 8
  %cmp3 = icmp eq ptr %7, null
  br i1 %cmp3, label %if.then4, label %if.end

if.then4:                                         ; preds = %if.then
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %if.then
  %8 = load ptr, ptr %dst.addr, align 8
  %peer_cert5 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %8, i32 0, i32 6
  %9 = load ptr, ptr %peer_cert5, align 8
  call void @mbedtls_x509_crt_init(ptr noundef %9)
  %10 = load ptr, ptr %dst.addr, align 8
  %peer_cert6 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %10, i32 0, i32 6
  %11 = load ptr, ptr %peer_cert6, align 8
  %12 = load ptr, ptr %src.addr, align 8
  %peer_cert7 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %12, i32 0, i32 6
  %13 = load ptr, ptr %peer_cert7, align 8
  %raw = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %13, i32 0, i32 0
  %p = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw, i32 0, i32 2
  %14 = load ptr, ptr %p, align 8
  %15 = load ptr, ptr %src.addr, align 8
  %peer_cert8 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %15, i32 0, i32 6
  %16 = load ptr, ptr %peer_cert8, align 8
  %raw9 = getelementptr inbounds %struct.mbedtls_x509_crt, ptr %16, i32 0, i32 0
  %len = getelementptr inbounds %struct.mbedtls_asn1_buf, ptr %raw9, i32 0, i32 1
  %17 = load i64, ptr %len, align 8
  %call10 = call i32 @mbedtls_x509_crt_parse_der(ptr noundef %11, ptr noundef %14, i64 noundef %17)
  store i32 %call10, ptr %ret, align 4
  %cmp11 = icmp ne i32 %call10, 0
  br i1 %cmp11, label %if.then12, label %if.end15

if.then12:                                        ; preds = %if.end
  %18 = load ptr, ptr %dst.addr, align 8
  %peer_cert13 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %18, i32 0, i32 6
  %19 = load ptr, ptr %peer_cert13, align 8
  call void @free(ptr noundef %19) #8
  %20 = load ptr, ptr %dst.addr, align 8
  %peer_cert14 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %20, i32 0, i32 6
  store ptr null, ptr %peer_cert14, align 8
  %21 = load i32, ptr %ret, align 4
  store i32 %21, ptr %retval, align 4
  br label %return

if.end15:                                         ; preds = %if.end
  br label %if.end16

if.end16:                                         ; preds = %if.end15, %entry
  %22 = load ptr, ptr %src.addr, align 8
  %ticket = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %22, i32 0, i32 8
  %23 = load ptr, ptr %ticket, align 8
  %cmp17 = icmp ne ptr %23, null
  br i1 %cmp17, label %if.then18, label %if.end28

if.then18:                                        ; preds = %if.end16
  %24 = load ptr, ptr %src.addr, align 8
  %ticket_len = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %24, i32 0, i32 9
  %25 = load i64, ptr %ticket_len, align 8
  %call19 = call noalias ptr @calloc(i64 noundef 1, i64 noundef %25) #9
  %26 = load ptr, ptr %dst.addr, align 8
  %ticket20 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %26, i32 0, i32 8
  store ptr %call19, ptr %ticket20, align 8
  %27 = load ptr, ptr %dst.addr, align 8
  %ticket21 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %27, i32 0, i32 8
  %28 = load ptr, ptr %ticket21, align 8
  %cmp22 = icmp eq ptr %28, null
  br i1 %cmp22, label %if.then23, label %if.end24

if.then23:                                        ; preds = %if.then18
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end24:                                         ; preds = %if.then18
  %29 = load ptr, ptr %dst.addr, align 8
  %ticket25 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %29, i32 0, i32 8
  %30 = load ptr, ptr %ticket25, align 8
  %31 = load ptr, ptr %src.addr, align 8
  %ticket26 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %31, i32 0, i32 8
  %32 = load ptr, ptr %ticket26, align 8
  %33 = load ptr, ptr %src.addr, align 8
  %ticket_len27 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %33, i32 0, i32 9
  %34 = load i64, ptr %ticket_len27, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %30, ptr align 1 %32, i64 %34, i1 false)
  br label %if.end28

if.end28:                                         ; preds = %if.end24, %if.end16
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end28, %if.then23, %if.then12, %if.then4
  %35 = load i32, ptr %retval, align 4
  ret i32 %35
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_ciphersuites(ptr noundef %conf, ptr noundef %ciphersuites) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %ciphersuites.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %ciphersuites, ptr %ciphersuites.addr, align 8
  %0 = load ptr, ptr %ciphersuites.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 0
  %arrayidx = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list, i64 0, i64 0
  store ptr %0, ptr %arrayidx, align 8
  %2 = load ptr, ptr %ciphersuites.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 0
  %arrayidx2 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list1, i64 0, i64 1
  store ptr %2, ptr %arrayidx2, align 8
  %4 = load ptr, ptr %ciphersuites.addr, align 8
  %5 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list3 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 0
  %arrayidx4 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list3, i64 0, i64 2
  store ptr %4, ptr %arrayidx4, align 8
  %6 = load ptr, ptr %ciphersuites.addr, align 8
  %7 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list5 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 0
  %arrayidx6 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list5, i64 0, i64 3
  store ptr %6, ptr %arrayidx6, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_ciphersuites_for_version(ptr noundef %conf, ptr noundef %ciphersuites, i32 noundef %major, i32 noundef %minor) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %ciphersuites.addr = alloca ptr, align 8
  %major.addr = alloca i32, align 4
  %minor.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %ciphersuites, ptr %ciphersuites.addr, align 8
  store i32 %major, ptr %major.addr, align 4
  store i32 %minor, ptr %minor.addr, align 4
  %0 = load i32, ptr %major.addr, align 4
  %cmp = icmp ne i32 %0, 3
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %return

if.end:                                           ; preds = %entry
  %1 = load i32, ptr %minor.addr, align 4
  %cmp1 = icmp slt i32 %1, 0
  br i1 %cmp1, label %if.then3, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end
  %2 = load i32, ptr %minor.addr, align 4
  %cmp2 = icmp sgt i32 %2, 3
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %lor.lhs.false, %if.end
  br label %return

if.end4:                                          ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ciphersuites.addr, align 8
  %4 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 0
  %5 = load i32, ptr %minor.addr, align 4
  %idxprom = sext i32 %5 to i64
  %arrayidx = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list, i64 0, i64 %idxprom
  store ptr %3, ptr %arrayidx, align 8
  br label %return

return:                                           ; preds = %if.end4, %if.then3, %if.then
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_cert_profile(ptr noundef %conf, ptr noundef %profile) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %profile.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %profile, ptr %profile.addr, align 8
  %0 = load ptr, ptr %profile.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %cert_profile = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 22
  store ptr %0, ptr %cert_profile, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_conf_own_cert(ptr noundef %conf, ptr noundef %own_cert, ptr noundef %pk_key) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %own_cert.addr = alloca ptr, align 8
  %pk_key.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %own_cert, ptr %own_cert.addr, align 8
  store ptr %pk_key, ptr %pk_key.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  %key_cert = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %0, i32 0, i32 23
  %1 = load ptr, ptr %own_cert.addr, align 8
  %2 = load ptr, ptr %pk_key.addr, align 8
  %call = call i32 @ssl_append_key_cert(ptr noundef %key_cert, ptr noundef %1, ptr noundef %2)
  ret i32 %call
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_append_key_cert(ptr noundef %head, ptr noundef %cert, ptr noundef %key) #0 {
entry:
  %retval = alloca i32, align 4
  %head.addr = alloca ptr, align 8
  %cert.addr = alloca ptr, align 8
  %key.addr = alloca ptr, align 8
  %new_cert = alloca ptr, align 8
  %cur = alloca ptr, align 8
  store ptr %head, ptr %head.addr, align 8
  store ptr %cert, ptr %cert.addr, align 8
  store ptr %key, ptr %key.addr, align 8
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef 24) #9
  store ptr %call, ptr %new_cert, align 8
  %0 = load ptr, ptr %new_cert, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %1 = load ptr, ptr %cert.addr, align 8
  %2 = load ptr, ptr %new_cert, align 8
  %cert1 = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %2, i32 0, i32 0
  store ptr %1, ptr %cert1, align 8
  %3 = load ptr, ptr %key.addr, align 8
  %4 = load ptr, ptr %new_cert, align 8
  %key2 = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %4, i32 0, i32 1
  store ptr %3, ptr %key2, align 8
  %5 = load ptr, ptr %new_cert, align 8
  %next = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %5, i32 0, i32 2
  store ptr null, ptr %next, align 8
  %6 = load ptr, ptr %head.addr, align 8
  %7 = load ptr, ptr %6, align 8
  %cmp3 = icmp eq ptr %7, null
  br i1 %cmp3, label %if.then4, label %if.else

if.then4:                                         ; preds = %if.end
  %8 = load ptr, ptr %new_cert, align 8
  %9 = load ptr, ptr %head.addr, align 8
  store ptr %8, ptr %9, align 8
  br label %if.end9

if.else:                                          ; preds = %if.end
  %10 = load ptr, ptr %head.addr, align 8
  %11 = load ptr, ptr %10, align 8
  store ptr %11, ptr %cur, align 8
  br label %while.cond

while.cond:                                       ; preds = %while.body, %if.else
  %12 = load ptr, ptr %cur, align 8
  %next5 = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %12, i32 0, i32 2
  %13 = load ptr, ptr %next5, align 8
  %cmp6 = icmp ne ptr %13, null
  br i1 %cmp6, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %14 = load ptr, ptr %cur, align 8
  %next7 = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %14, i32 0, i32 2
  %15 = load ptr, ptr %next7, align 8
  store ptr %15, ptr %cur, align 8
  br label %while.cond, !llvm.loop !28

while.end:                                        ; preds = %while.cond
  %16 = load ptr, ptr %new_cert, align 8
  %17 = load ptr, ptr %cur, align 8
  %next8 = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %17, i32 0, i32 2
  store ptr %16, ptr %next8, align 8
  br label %if.end9

if.end9:                                          ; preds = %while.end, %if.then4
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end9, %if.then
  %18 = load i32, ptr %retval, align 4
  ret i32 %18
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_ca_chain(ptr noundef %conf, ptr noundef %ca_chain, ptr noundef %ca_crl) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %ca_chain.addr = alloca ptr, align 8
  %ca_crl.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %ca_chain, ptr %ca_chain.addr, align 8
  store ptr %ca_crl, ptr %ca_crl.addr, align 8
  %0 = load ptr, ptr %ca_chain.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %ca_chain1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 24
  store ptr %0, ptr %ca_chain1, align 8
  %2 = load ptr, ptr %ca_crl.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %ca_crl2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 25
  store ptr %2, ptr %ca_crl2, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_set_hs_own_cert(ptr noundef %ssl, ptr noundef %own_cert, ptr noundef %pk_key) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %own_cert.addr = alloca ptr, align 8
  %pk_key.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %own_cert, ptr %own_cert.addr, align 8
  store ptr %pk_key, ptr %pk_key.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %sni_key_cert = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 8
  %2 = load ptr, ptr %own_cert.addr, align 8
  %3 = load ptr, ptr %pk_key.addr, align 8
  %call = call i32 @ssl_append_key_cert(ptr noundef %sni_key_cert, ptr noundef %2, ptr noundef %3)
  ret i32 %call
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_set_hs_ca_chain(ptr noundef %ssl, ptr noundef %ca_chain, ptr noundef %ca_crl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %ca_chain.addr = alloca ptr, align 8
  %ca_crl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %ca_chain, ptr %ca_chain.addr, align 8
  store ptr %ca_crl, ptr %ca_crl.addr, align 8
  %0 = load ptr, ptr %ca_chain.addr, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %sni_ca_chain = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 9
  store ptr %0, ptr %sni_ca_chain, align 8
  %3 = load ptr, ptr %ca_crl.addr, align 8
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %handshake1, align 8
  %sni_ca_crl = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 10
  store ptr %3, ptr %sni_ca_crl, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_set_hs_authmode(ptr noundef %ssl, i32 noundef %authmode) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %authmode.addr = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %authmode, ptr %authmode.addr, align 4
  %0 = load i32, ptr %authmode.addr, align 4
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %sni_authmode = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 7
  store i32 %0, ptr %sni_authmode, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_conf_psk(ptr noundef %conf, ptr noundef %psk, i64 noundef %psk_len, ptr noundef %psk_identity, i64 noundef %psk_identity_len) #0 {
entry:
  %retval = alloca i32, align 4
  %conf.addr = alloca ptr, align 8
  %psk.addr = alloca ptr, align 8
  %psk_len.addr = alloca i64, align 8
  %psk_identity.addr = alloca ptr, align 8
  %psk_identity_len.addr = alloca i64, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %psk, ptr %psk.addr, align 8
  store i64 %psk_len, ptr %psk_len.addr, align 8
  store ptr %psk_identity, ptr %psk_identity.addr, align 8
  store i64 %psk_identity_len, ptr %psk_identity_len.addr, align 8
  %0 = load ptr, ptr %psk.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %psk_identity.addr, align 8
  %cmp1 = icmp eq ptr %1, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %2 = load i64, ptr %psk_len.addr, align 8
  %cmp2 = icmp ugt i64 %2, 32
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  %3 = load i64, ptr %psk_identity_len.addr, align 8
  %shr = lshr i64 %3, 16
  %cmp5 = icmp ne i64 %shr, 0
  br i1 %cmp5, label %if.then8, label %lor.lhs.false6

lor.lhs.false6:                                   ; preds = %if.end4
  %4 = load i64, ptr %psk_identity_len.addr, align 8
  %cmp7 = icmp ugt i64 %4, 16384
  br i1 %cmp7, label %if.then8, label %if.end9

if.then8:                                         ; preds = %lor.lhs.false6, %if.end4
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end9:                                          ; preds = %lor.lhs.false6
  %5 = load ptr, ptr %conf.addr, align 8
  %psk10 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 30
  %6 = load ptr, ptr %psk10, align 8
  %cmp11 = icmp ne ptr %6, null
  br i1 %cmp11, label %if.then12, label %if.end18

if.then12:                                        ; preds = %if.end9
  %7 = load ptr, ptr %conf.addr, align 8
  %psk13 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 30
  %8 = load ptr, ptr %psk13, align 8
  %9 = load ptr, ptr %conf.addr, align 8
  %psk_len14 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %9, i32 0, i32 31
  %10 = load i64, ptr %psk_len14, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %8, i64 noundef %10)
  %11 = load ptr, ptr %conf.addr, align 8
  %psk15 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %11, i32 0, i32 30
  %12 = load ptr, ptr %psk15, align 8
  call void @free(ptr noundef %12) #8
  %13 = load ptr, ptr %conf.addr, align 8
  %psk16 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %13, i32 0, i32 30
  store ptr null, ptr %psk16, align 8
  %14 = load ptr, ptr %conf.addr, align 8
  %psk_len17 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %14, i32 0, i32 31
  store i64 0, ptr %psk_len17, align 8
  br label %if.end18

if.end18:                                         ; preds = %if.then12, %if.end9
  %15 = load ptr, ptr %conf.addr, align 8
  %psk_identity19 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %15, i32 0, i32 32
  %16 = load ptr, ptr %psk_identity19, align 8
  %cmp20 = icmp ne ptr %16, null
  br i1 %cmp20, label %if.then21, label %if.end25

if.then21:                                        ; preds = %if.end18
  %17 = load ptr, ptr %conf.addr, align 8
  %psk_identity22 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %17, i32 0, i32 32
  %18 = load ptr, ptr %psk_identity22, align 8
  call void @free(ptr noundef %18) #8
  %19 = load ptr, ptr %conf.addr, align 8
  %psk_identity23 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %19, i32 0, i32 32
  store ptr null, ptr %psk_identity23, align 8
  %20 = load ptr, ptr %conf.addr, align 8
  %psk_identity_len24 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %20, i32 0, i32 33
  store i64 0, ptr %psk_identity_len24, align 8
  br label %if.end25

if.end25:                                         ; preds = %if.then21, %if.end18
  %21 = load i64, ptr %psk_len.addr, align 8
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef %21) #9
  %22 = load ptr, ptr %conf.addr, align 8
  %psk26 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %22, i32 0, i32 30
  store ptr %call, ptr %psk26, align 8
  %cmp27 = icmp eq ptr %call, null
  br i1 %cmp27, label %if.then32, label %lor.lhs.false28

lor.lhs.false28:                                  ; preds = %if.end25
  %23 = load i64, ptr %psk_identity_len.addr, align 8
  %call29 = call noalias ptr @calloc(i64 noundef 1, i64 noundef %23) #9
  %24 = load ptr, ptr %conf.addr, align 8
  %psk_identity30 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %24, i32 0, i32 32
  store ptr %call29, ptr %psk_identity30, align 8
  %cmp31 = icmp eq ptr %call29, null
  br i1 %cmp31, label %if.then32, label %if.end37

if.then32:                                        ; preds = %lor.lhs.false28, %if.end25
  %25 = load ptr, ptr %conf.addr, align 8
  %psk33 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %25, i32 0, i32 30
  %26 = load ptr, ptr %psk33, align 8
  call void @free(ptr noundef %26) #8
  %27 = load ptr, ptr %conf.addr, align 8
  %psk_identity34 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %27, i32 0, i32 32
  %28 = load ptr, ptr %psk_identity34, align 8
  call void @free(ptr noundef %28) #8
  %29 = load ptr, ptr %conf.addr, align 8
  %psk35 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %29, i32 0, i32 30
  store ptr null, ptr %psk35, align 8
  %30 = load ptr, ptr %conf.addr, align 8
  %psk_identity36 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %30, i32 0, i32 32
  store ptr null, ptr %psk_identity36, align 8
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end37:                                         ; preds = %lor.lhs.false28
  %31 = load i64, ptr %psk_len.addr, align 8
  %32 = load ptr, ptr %conf.addr, align 8
  %psk_len38 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %32, i32 0, i32 31
  store i64 %31, ptr %psk_len38, align 8
  %33 = load i64, ptr %psk_identity_len.addr, align 8
  %34 = load ptr, ptr %conf.addr, align 8
  %psk_identity_len39 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %34, i32 0, i32 33
  store i64 %33, ptr %psk_identity_len39, align 8
  %35 = load ptr, ptr %conf.addr, align 8
  %psk40 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %35, i32 0, i32 30
  %36 = load ptr, ptr %psk40, align 8
  %37 = load ptr, ptr %psk.addr, align 8
  %38 = load ptr, ptr %conf.addr, align 8
  %psk_len41 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %38, i32 0, i32 31
  %39 = load i64, ptr %psk_len41, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %36, ptr align 1 %37, i64 %39, i1 false)
  %40 = load ptr, ptr %conf.addr, align 8
  %psk_identity42 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %40, i32 0, i32 32
  %41 = load ptr, ptr %psk_identity42, align 8
  %42 = load ptr, ptr %psk_identity.addr, align 8
  %43 = load ptr, ptr %conf.addr, align 8
  %psk_identity_len43 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %43, i32 0, i32 33
  %44 = load i64, ptr %psk_identity_len43, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %41, ptr align 1 %42, i64 %44, i1 false)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end37, %if.then32, %if.then8, %if.then3, %if.then
  %45 = load i32, ptr %retval, align 4
  ret i32 %45
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_set_hs_psk(ptr noundef %ssl, ptr noundef %psk, i64 noundef %psk_len) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %psk.addr = alloca ptr, align 8
  %psk_len.addr = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %psk, ptr %psk.addr, align 8
  store i64 %psk_len, ptr %psk_len.addr, align 8
  %0 = load ptr, ptr %psk.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 15
  %2 = load ptr, ptr %handshake, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load i64, ptr %psk_len.addr, align 8
  %cmp2 = icmp ugt i64 %3, 32
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %handshake5, align 8
  %psk6 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 4
  %6 = load ptr, ptr %psk6, align 8
  %cmp7 = icmp ne ptr %6, null
  br i1 %cmp7, label %if.then8, label %if.end17

if.then8:                                         ; preds = %if.end4
  %7 = load ptr, ptr %ssl.addr, align 8
  %handshake9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 15
  %8 = load ptr, ptr %handshake9, align 8
  %psk10 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 4
  %9 = load ptr, ptr %psk10, align 8
  %10 = load ptr, ptr %ssl.addr, align 8
  %handshake11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 15
  %11 = load ptr, ptr %handshake11, align 8
  %psk_len12 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 5
  %12 = load i64, ptr %psk_len12, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %9, i64 noundef %12)
  %13 = load ptr, ptr %ssl.addr, align 8
  %handshake13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 15
  %14 = load ptr, ptr %handshake13, align 8
  %psk14 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %14, i32 0, i32 4
  %15 = load ptr, ptr %psk14, align 8
  call void @free(ptr noundef %15) #8
  %16 = load ptr, ptr %ssl.addr, align 8
  %handshake15 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 15
  %17 = load ptr, ptr %handshake15, align 8
  %psk_len16 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %17, i32 0, i32 5
  store i64 0, ptr %psk_len16, align 8
  br label %if.end17

if.end17:                                         ; preds = %if.then8, %if.end4
  %18 = load i64, ptr %psk_len.addr, align 8
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef %18) #9
  %19 = load ptr, ptr %ssl.addr, align 8
  %handshake18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %19, i32 0, i32 15
  %20 = load ptr, ptr %handshake18, align 8
  %psk19 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %20, i32 0, i32 4
  store ptr %call, ptr %psk19, align 8
  %cmp20 = icmp eq ptr %call, null
  br i1 %cmp20, label %if.then21, label %if.end22

if.then21:                                        ; preds = %if.end17
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end22:                                         ; preds = %if.end17
  %21 = load i64, ptr %psk_len.addr, align 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %handshake23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 15
  %23 = load ptr, ptr %handshake23, align 8
  %psk_len24 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %23, i32 0, i32 5
  store i64 %21, ptr %psk_len24, align 8
  %24 = load ptr, ptr %ssl.addr, align 8
  %handshake25 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 15
  %25 = load ptr, ptr %handshake25, align 8
  %psk26 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %25, i32 0, i32 4
  %26 = load ptr, ptr %psk26, align 8
  %27 = load ptr, ptr %psk.addr, align 8
  %28 = load ptr, ptr %ssl.addr, align 8
  %handshake27 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 15
  %29 = load ptr, ptr %handshake27, align 8
  %psk_len28 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %29, i32 0, i32 5
  %30 = load i64, ptr %psk_len28, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %26, ptr align 1 %27, i64 %30, i1 false)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end22, %if.then21, %if.then3, %if.then
  %31 = load i32, ptr %retval, align 4
  ret i32 %31
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_psk_cb(ptr noundef %conf, ptr noundef %f_psk, ptr noundef %p_psk) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %f_psk.addr = alloca ptr, align 8
  %p_psk.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %f_psk, ptr %f_psk.addr, align 8
  store ptr %p_psk, ptr %p_psk.addr, align 8
  %0 = load ptr, ptr %f_psk.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %f_psk1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 12
  store ptr %0, ptr %f_psk1, align 8
  %2 = load ptr, ptr %p_psk.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %p_psk2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 13
  store ptr %2, ptr %p_psk2, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_conf_dh_param(ptr noundef %conf, ptr noundef %dhm_P, ptr noundef %dhm_G) #0 {
entry:
  %retval = alloca i32, align 4
  %conf.addr = alloca ptr, align 8
  %dhm_P.addr = alloca ptr, align 8
  %dhm_G.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %dhm_P, ptr %dhm_P.addr, align 8
  store ptr %dhm_G, ptr %dhm_G.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  %dhm_P1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %0, i32 0, i32 28
  %1 = load ptr, ptr %dhm_P.addr, align 8
  %call = call i32 @mbedtls_mpi_read_string(ptr noundef %dhm_P1, i32 noundef 16, ptr noundef %1)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %2 = load ptr, ptr %conf.addr, align 8
  %dhm_G2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %2, i32 0, i32 29
  %3 = load ptr, ptr %dhm_G.addr, align 8
  %call3 = call i32 @mbedtls_mpi_read_string(ptr noundef %dhm_G2, i32 noundef 16, ptr noundef %3)
  store i32 %call3, ptr %ret, align 4
  %cmp4 = icmp ne i32 %call3, 0
  br i1 %cmp4, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  %4 = load ptr, ptr %conf.addr, align 8
  %dhm_P5 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 28
  call void @mbedtls_mpi_free(ptr noundef %dhm_P5)
  %5 = load ptr, ptr %conf.addr, align 8
  %dhm_G6 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 29
  call void @mbedtls_mpi_free(ptr noundef %dhm_G6)
  %6 = load i32, ptr %ret, align 4
  store i32 %6, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %7 = load i32, ptr %retval, align 4
  ret i32 %7
}

declare i32 @mbedtls_mpi_read_string(ptr noundef, i32 noundef, ptr noundef) #1

declare void @mbedtls_mpi_free(ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_conf_dh_param_bin(ptr noundef %conf, ptr noundef %dhm_P, i64 noundef %P_len, ptr noundef %dhm_G, i64 noundef %G_len) #0 {
entry:
  %retval = alloca i32, align 4
  %conf.addr = alloca ptr, align 8
  %dhm_P.addr = alloca ptr, align 8
  %P_len.addr = alloca i64, align 8
  %dhm_G.addr = alloca ptr, align 8
  %G_len.addr = alloca i64, align 8
  %ret = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %dhm_P, ptr %dhm_P.addr, align 8
  store i64 %P_len, ptr %P_len.addr, align 8
  store ptr %dhm_G, ptr %dhm_G.addr, align 8
  store i64 %G_len, ptr %G_len.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  %dhm_P1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %0, i32 0, i32 28
  %1 = load ptr, ptr %dhm_P.addr, align 8
  %2 = load i64, ptr %P_len.addr, align 8
  %call = call i32 @mbedtls_mpi_read_binary(ptr noundef %dhm_P1, ptr noundef %1, i64 noundef %2)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %3 = load ptr, ptr %conf.addr, align 8
  %dhm_G2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 29
  %4 = load ptr, ptr %dhm_G.addr, align 8
  %5 = load i64, ptr %G_len.addr, align 8
  %call3 = call i32 @mbedtls_mpi_read_binary(ptr noundef %dhm_G2, ptr noundef %4, i64 noundef %5)
  store i32 %call3, ptr %ret, align 4
  %cmp4 = icmp ne i32 %call3, 0
  br i1 %cmp4, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  %6 = load ptr, ptr %conf.addr, align 8
  %dhm_P5 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %6, i32 0, i32 28
  call void @mbedtls_mpi_free(ptr noundef %dhm_P5)
  %7 = load ptr, ptr %conf.addr, align 8
  %dhm_G6 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 29
  call void @mbedtls_mpi_free(ptr noundef %dhm_G6)
  %8 = load i32, ptr %ret, align 4
  store i32 %8, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %9 = load i32, ptr %retval, align 4
  ret i32 %9
}

declare i32 @mbedtls_mpi_read_binary(ptr noundef, ptr noundef, i64 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_conf_dh_param_ctx(ptr noundef %conf, ptr noundef %dhm_ctx) #0 {
entry:
  %retval = alloca i32, align 4
  %conf.addr = alloca ptr, align 8
  %dhm_ctx.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %dhm_ctx, ptr %dhm_ctx.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  %dhm_P = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %0, i32 0, i32 28
  %1 = load ptr, ptr %dhm_ctx.addr, align 8
  %P = getelementptr inbounds %struct.mbedtls_dhm_context, ptr %1, i32 0, i32 1
  %call = call i32 @mbedtls_mpi_copy(ptr noundef %dhm_P, ptr noundef %P)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %2 = load ptr, ptr %conf.addr, align 8
  %dhm_G = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %2, i32 0, i32 29
  %3 = load ptr, ptr %dhm_ctx.addr, align 8
  %G = getelementptr inbounds %struct.mbedtls_dhm_context, ptr %3, i32 0, i32 2
  %call1 = call i32 @mbedtls_mpi_copy(ptr noundef %dhm_G, ptr noundef %G)
  store i32 %call1, ptr %ret, align 4
  %cmp2 = icmp ne i32 %call1, 0
  br i1 %cmp2, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  %4 = load ptr, ptr %conf.addr, align 8
  %dhm_P3 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 28
  call void @mbedtls_mpi_free(ptr noundef %dhm_P3)
  %5 = load ptr, ptr %conf.addr, align 8
  %dhm_G4 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 29
  call void @mbedtls_mpi_free(ptr noundef %dhm_G4)
  %6 = load i32, ptr %ret, align 4
  store i32 %6, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %7 = load i32, ptr %retval, align 4
  ret i32 %7
}

declare i32 @mbedtls_mpi_copy(ptr noundef, ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_dhm_min_bitlen(ptr noundef %conf, i32 noundef %bitlen) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %bitlen.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %bitlen, ptr %bitlen.addr, align 4
  %0 = load i32, ptr %bitlen.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %dhm_min_bitlen = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 41
  store i32 %0, ptr %dhm_min_bitlen, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_sig_hashes(ptr noundef %conf, ptr noundef %hashes) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %hashes.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %hashes, ptr %hashes.addr, align 8
  %0 = load ptr, ptr %hashes.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %sig_hashes = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 26
  store ptr %0, ptr %sig_hashes, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_curves(ptr noundef %conf, ptr noundef %curve_list) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %curve_list.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %curve_list, ptr %curve_list.addr, align 8
  %0 = load ptr, ptr %curve_list.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %curve_list1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 27
  store ptr %0, ptr %curve_list1, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_set_hostname(ptr noundef %ssl, ptr noundef %hostname) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %hostname.addr = alloca ptr, align 8
  %hostname_len = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %hostname, ptr %hostname.addr, align 8
  store i64 0, ptr %hostname_len, align 8
  %0 = load ptr, ptr %hostname.addr, align 8
  %cmp = icmp ne ptr %0, null
  br i1 %cmp, label %if.then, label %if.end3

if.then:                                          ; preds = %entry
  %1 = load ptr, ptr %hostname.addr, align 8
  %call = call i64 @strlen(ptr noundef %1) #7
  store i64 %call, ptr %hostname_len, align 8
  %2 = load i64, ptr %hostname_len, align 8
  %cmp1 = icmp ugt i64 %2, 255
  br i1 %cmp1, label %if.then2, label %if.end

if.then2:                                         ; preds = %if.then
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %if.then
  br label %if.end3

if.end3:                                          ; preds = %if.end, %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %hostname4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 54
  %4 = load ptr, ptr %hostname4, align 8
  %cmp5 = icmp ne ptr %4, null
  br i1 %cmp5, label %if.then6, label %if.end11

if.then6:                                         ; preds = %if.end3
  %5 = load ptr, ptr %ssl.addr, align 8
  %hostname7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 54
  %6 = load ptr, ptr %hostname7, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %hostname8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 54
  %8 = load ptr, ptr %hostname8, align 8
  %call9 = call i64 @strlen(ptr noundef %8) #7
  call void @mbedtls_platform_zeroize(ptr noundef %6, i64 noundef %call9)
  %9 = load ptr, ptr %ssl.addr, align 8
  %hostname10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 54
  %10 = load ptr, ptr %hostname10, align 8
  call void @free(ptr noundef %10) #8
  br label %if.end11

if.end11:                                         ; preds = %if.then6, %if.end3
  %11 = load ptr, ptr %hostname.addr, align 8
  %cmp12 = icmp eq ptr %11, null
  br i1 %cmp12, label %if.then13, label %if.else

if.then13:                                        ; preds = %if.end11
  %12 = load ptr, ptr %ssl.addr, align 8
  %hostname14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 54
  store ptr null, ptr %hostname14, align 8
  br label %if.end23

if.else:                                          ; preds = %if.end11
  %13 = load i64, ptr %hostname_len, align 8
  %add = add i64 %13, 1
  %call15 = call noalias ptr @calloc(i64 noundef 1, i64 noundef %add) #9
  %14 = load ptr, ptr %ssl.addr, align 8
  %hostname16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 54
  store ptr %call15, ptr %hostname16, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %hostname17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 54
  %16 = load ptr, ptr %hostname17, align 8
  %cmp18 = icmp eq ptr %16, null
  br i1 %cmp18, label %if.then19, label %if.end20

if.then19:                                        ; preds = %if.else
  store i32 -32512, ptr %retval, align 4
  br label %return

if.end20:                                         ; preds = %if.else
  %17 = load ptr, ptr %ssl.addr, align 8
  %hostname21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 54
  %18 = load ptr, ptr %hostname21, align 8
  %19 = load ptr, ptr %hostname.addr, align 8
  %20 = load i64, ptr %hostname_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %18, ptr align 1 %19, i64 %20, i1 false)
  %21 = load ptr, ptr %ssl.addr, align 8
  %hostname22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 54
  %22 = load ptr, ptr %hostname22, align 8
  %23 = load i64, ptr %hostname_len, align 8
  %arrayidx = getelementptr inbounds i8, ptr %22, i64 %23
  store i8 0, ptr %arrayidx, align 1
  br label %if.end23

if.end23:                                         ; preds = %if.end20, %if.then13
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end23, %if.then19, %if.then2
  %24 = load i32, ptr %retval, align 4
  ret i32 %24
}

; Function Attrs: nounwind willreturn memory(read)
declare i64 @strlen(ptr noundef) #6

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_sni(ptr noundef %conf, ptr noundef %f_sni, ptr noundef %p_sni) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %f_sni.addr = alloca ptr, align 8
  %p_sni.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %f_sni, ptr %f_sni.addr, align 8
  store ptr %p_sni, ptr %p_sni.addr, align 8
  %0 = load ptr, ptr %f_sni.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %f_sni1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 8
  store ptr %0, ptr %f_sni1, align 8
  %2 = load ptr, ptr %p_sni.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %p_sni2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 9
  store ptr %2, ptr %p_sni2, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_conf_alpn_protocols(ptr noundef %conf, ptr noundef %protos) #0 {
entry:
  %retval = alloca i32, align 4
  %conf.addr = alloca ptr, align 8
  %protos.addr = alloca ptr, align 8
  %cur_len = alloca i64, align 8
  %tot_len = alloca i64, align 8
  %p = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %protos, ptr %protos.addr, align 8
  store i64 0, ptr %tot_len, align 8
  %0 = load ptr, ptr %protos.addr, align 8
  store ptr %0, ptr %p, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %entry
  %1 = load ptr, ptr %p, align 8
  %2 = load ptr, ptr %1, align 8
  %cmp = icmp ne ptr %2, null
  br i1 %cmp, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %3 = load ptr, ptr %p, align 8
  %4 = load ptr, ptr %3, align 8
  %call = call i64 @strlen(ptr noundef %4) #7
  store i64 %call, ptr %cur_len, align 8
  %5 = load i64, ptr %cur_len, align 8
  %6 = load i64, ptr %tot_len, align 8
  %add = add i64 %6, %5
  store i64 %add, ptr %tot_len, align 8
  %7 = load i64, ptr %cur_len, align 8
  %cmp1 = icmp eq i64 %7, 0
  br i1 %cmp1, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %for.body
  %8 = load i64, ptr %cur_len, align 8
  %cmp2 = icmp ugt i64 %8, 255
  br i1 %cmp2, label %if.then, label %lor.lhs.false3

lor.lhs.false3:                                   ; preds = %lor.lhs.false
  %9 = load i64, ptr %tot_len, align 8
  %cmp4 = icmp ugt i64 %9, 65535
  br i1 %cmp4, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false3, %lor.lhs.false, %for.body
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false3
  br label %for.inc

for.inc:                                          ; preds = %if.end
  %10 = load ptr, ptr %p, align 8
  %incdec.ptr = getelementptr inbounds ptr, ptr %10, i32 1
  store ptr %incdec.ptr, ptr %p, align 8
  br label %for.cond, !llvm.loop !29

for.end:                                          ; preds = %for.cond
  %11 = load ptr, ptr %protos.addr, align 8
  %12 = load ptr, ptr %conf.addr, align 8
  %alpn_list = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %12, i32 0, i32 34
  store ptr %11, ptr %alpn_list, align 8
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %for.end, %if.then
  %13 = load i32, ptr %retval, align 4
  ret i32 %13
}

; Function Attrs: noinline nounwind optnone uwtable
define ptr @mbedtls_ssl_get_alpn_protocol(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %alpn_chosen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 55
  %1 = load ptr, ptr %alpn_chosen, align 8
  ret ptr %1
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_max_version(ptr noundef %conf, i32 noundef %major, i32 noundef %minor) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %major.addr = alloca i32, align 4
  %minor.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %major, ptr %major.addr, align 4
  store i32 %minor, ptr %minor.addr, align 4
  %0 = load i32, ptr %major.addr, align 4
  %conv = trunc i32 %0 to i8
  %1 = load ptr, ptr %conf.addr, align 8
  %max_major_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 42
  store i8 %conv, ptr %max_major_ver, align 8
  %2 = load i32, ptr %minor.addr, align 4
  %conv1 = trunc i32 %2 to i8
  %3 = load ptr, ptr %conf.addr, align 8
  %max_minor_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 43
  store i8 %conv1, ptr %max_minor_ver, align 1
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_min_version(ptr noundef %conf, i32 noundef %major, i32 noundef %minor) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %major.addr = alloca i32, align 4
  %minor.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %major, ptr %major.addr, align 4
  store i32 %minor, ptr %minor.addr, align 4
  %0 = load i32, ptr %major.addr, align 4
  %conv = trunc i32 %0 to i8
  %1 = load ptr, ptr %conf.addr, align 8
  %min_major_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 44
  store i8 %conv, ptr %min_major_ver, align 2
  %2 = load i32, ptr %minor.addr, align 4
  %conv1 = trunc i32 %2 to i8
  %3 = load ptr, ptr %conf.addr, align 8
  %min_minor_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 45
  store i8 %conv1, ptr %min_minor_ver, align 1
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_fallback(ptr noundef %conf, i8 noundef signext %fallback) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %fallback.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %fallback, ptr %fallback.addr, align 1
  %0 = load i8, ptr %fallback.addr, align 1
  %conv = sext i8 %0 to i32
  %1 = load ptr, ptr %conf.addr, align 8
  %fallback1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %fallback1, align 4
  %bf.value = and i32 %conv, 1
  %bf.shl = shl i32 %bf.value, 17
  %bf.clear = and i32 %bf.load, -131073
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %fallback1, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_cert_req_ca_list(ptr noundef %conf, i8 noundef signext %cert_req_ca_list) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %cert_req_ca_list.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %cert_req_ca_list, ptr %cert_req_ca_list.addr, align 1
  %0 = load i8, ptr %cert_req_ca_list.addr, align 1
  %conv = sext i8 %0 to i32
  %1 = load ptr, ptr %conf.addr, align 8
  %cert_req_ca_list1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %cert_req_ca_list1, align 4
  %bf.value = and i32 %conv, 1
  %bf.shl = shl i32 %bf.value, 18
  %bf.clear = and i32 %bf.load, -262145
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %cert_req_ca_list1, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_encrypt_then_mac(ptr noundef %conf, i8 noundef signext %etm) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %etm.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %etm, ptr %etm.addr, align 1
  %0 = load i8, ptr %etm.addr, align 1
  %conv = sext i8 %0 to i32
  %1 = load ptr, ptr %conf.addr, align 8
  %encrypt_then_mac = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %encrypt_then_mac, align 4
  %bf.value = and i32 %conv, 1
  %bf.shl = shl i32 %bf.value, 10
  %bf.clear = and i32 %bf.load, -1025
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %encrypt_then_mac, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_extended_master_secret(ptr noundef %conf, i8 noundef signext %ems) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %ems.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %ems, ptr %ems.addr, align 1
  %0 = load i8, ptr %ems.addr, align 1
  %conv = sext i8 %0 to i32
  %1 = load ptr, ptr %conf.addr, align 8
  %extended_ms = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %extended_ms, align 4
  %bf.value = and i32 %conv, 1
  %bf.shl = shl i32 %bf.value, 11
  %bf.clear = and i32 %bf.load, -2049
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %extended_ms, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_arc4_support(ptr noundef %conf, i8 noundef signext %arc4) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %arc4.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %arc4, ptr %arc4.addr, align 1
  %0 = load i8, ptr %arc4.addr, align 1
  %conv = sext i8 %0 to i32
  %1 = load ptr, ptr %conf.addr, align 8
  %arc4_disabled = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %arc4_disabled, align 4
  %bf.value = and i32 %conv, 1
  %bf.shl = shl i32 %bf.value, 6
  %bf.clear = and i32 %bf.load, -65
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %arc4_disabled, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_conf_max_frag_len(ptr noundef %conf, i8 noundef zeroext %mfl_code) #0 {
entry:
  %retval = alloca i32, align 4
  %conf.addr = alloca ptr, align 8
  %mfl_code.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %mfl_code, ptr %mfl_code.addr, align 1
  %0 = load i8, ptr %mfl_code.addr, align 1
  %conv = zext i8 %0 to i32
  %cmp = icmp sge i32 %conv, 5
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load i8, ptr %mfl_code.addr, align 1
  %conv2 = zext i8 %1 to i32
  %call = call i32 @ssl_mfl_code_to_length(i32 noundef %conv2)
  %cmp3 = icmp ugt i32 %call, 16384
  br i1 %cmp3, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %2 = load i8, ptr %mfl_code.addr, align 1
  %conv5 = zext i8 %2 to i32
  %3 = load ptr, ptr %conf.addr, align 8
  %mfl_code6 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 46
  %bf.load = load i32, ptr %mfl_code6, align 4
  %bf.value = and i32 %conv5, 7
  %bf.shl = shl i32 %bf.value, 7
  %bf.clear = and i32 %bf.load, -897
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %mfl_code6, align 4
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %4 = load i32, ptr %retval, align 4
  ret i32 %4
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_mfl_code_to_length(i32 noundef %mfl) #0 {
entry:
  %retval = alloca i32, align 4
  %mfl.addr = alloca i32, align 4
  store i32 %mfl, ptr %mfl.addr, align 4
  %0 = load i32, ptr %mfl.addr, align 4
  switch i32 %0, label %sw.default [
    i32 0, label %sw.bb
    i32 1, label %sw.bb1
    i32 2, label %sw.bb2
    i32 3, label %sw.bb3
    i32 4, label %sw.bb4
  ]

sw.bb:                                            ; preds = %entry
  store i32 16384, ptr %retval, align 4
  br label %return

sw.bb1:                                           ; preds = %entry
  store i32 512, ptr %retval, align 4
  br label %return

sw.bb2:                                           ; preds = %entry
  store i32 1024, ptr %retval, align 4
  br label %return

sw.bb3:                                           ; preds = %entry
  store i32 2048, ptr %retval, align 4
  br label %return

sw.bb4:                                           ; preds = %entry
  store i32 4096, ptr %retval, align 4
  br label %return

sw.default:                                       ; preds = %entry
  store i32 16384, ptr %retval, align 4
  br label %return

return:                                           ; preds = %sw.default, %sw.bb4, %sw.bb3, %sw.bb2, %sw.bb1, %sw.bb
  %1 = load i32, ptr %retval, align 4
  ret i32 %1
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_truncated_hmac(ptr noundef %conf, i32 noundef %truncate) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %truncate.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %truncate, ptr %truncate.addr, align 4
  %0 = load i32, ptr %truncate.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %trunc_hmac = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %trunc_hmac, align 4
  %bf.value = and i32 %0, 1
  %bf.shl = shl i32 %bf.value, 15
  %bf.clear = and i32 %bf.load, -32769
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %trunc_hmac, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_cbc_record_splitting(ptr noundef %conf, i8 noundef signext %split) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %split.addr = alloca i8, align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i8 %split, ptr %split.addr, align 1
  %0 = load i8, ptr %split.addr, align 1
  %conv = sext i8 %0 to i32
  %1 = load ptr, ptr %conf.addr, align 8
  %cbc_record_splitting = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %cbc_record_splitting, align 4
  %bf.value = and i32 %conv, 1
  %bf.shl = shl i32 %bf.value, 13
  %bf.clear = and i32 %bf.load, -8193
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %cbc_record_splitting, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_legacy_renegotiation(ptr noundef %conf, i32 noundef %allow_legacy) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %allow_legacy.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %allow_legacy, ptr %allow_legacy.addr, align 4
  %0 = load i32, ptr %allow_legacy.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %allow_legacy_renegotiation = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %allow_legacy_renegotiation, align 4
  %bf.value = and i32 %0, 3
  %bf.shl = shl i32 %bf.value, 4
  %bf.clear = and i32 %bf.load, -49
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %allow_legacy_renegotiation, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_renegotiation(ptr noundef %conf, i32 noundef %renegotiation) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %renegotiation.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %renegotiation, ptr %renegotiation.addr, align 4
  %0 = load i32, ptr %renegotiation.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %disable_renegotiation = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %disable_renegotiation, align 4
  %bf.value = and i32 %0, 1
  %bf.shl = shl i32 %bf.value, 14
  %bf.clear = and i32 %bf.load, -16385
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %disable_renegotiation, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_renegotiation_enforced(ptr noundef %conf, i32 noundef %max_records) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %max_records.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %max_records, ptr %max_records.addr, align 4
  %0 = load i32, ptr %max_records.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %renego_max_records = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 38
  store i32 %0, ptr %renego_max_records, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_renegotiation_period(ptr noundef %conf, ptr noundef %period) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %period.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %period, ptr %period.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  %renego_period = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %0, i32 0, i32 39
  %arraydecay = getelementptr inbounds [8 x i8], ptr %renego_period, i64 0, i64 0
  %1 = load ptr, ptr %period.addr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay, ptr align 1 %1, i64 8, i1 false)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_session_tickets(ptr noundef %conf, i32 noundef %use_tickets) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %use_tickets.addr = alloca i32, align 4
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %use_tickets, ptr %use_tickets.addr, align 4
  %0 = load i32, ptr %use_tickets.addr, align 4
  %1 = load ptr, ptr %conf.addr, align 8
  %session_tickets = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %session_tickets, align 4
  %bf.value = and i32 %0, 1
  %bf.shl = shl i32 %bf.value, 16
  %bf.clear = and i32 %bf.load, -65537
  %bf.set = or i32 %bf.clear, %bf.shl
  store i32 %bf.set, ptr %session_tickets, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_session_tickets_cb(ptr noundef %conf, ptr noundef %f_ticket_write, ptr noundef %f_ticket_parse, ptr noundef %p_ticket) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %f_ticket_write.addr = alloca ptr, align 8
  %f_ticket_parse.addr = alloca ptr, align 8
  %p_ticket.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %f_ticket_write, ptr %f_ticket_write.addr, align 8
  store ptr %f_ticket_parse, ptr %f_ticket_parse.addr, align 8
  store ptr %p_ticket, ptr %p_ticket.addr, align 8
  %0 = load ptr, ptr %f_ticket_write.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %f_ticket_write1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 17
  store ptr %0, ptr %f_ticket_write1, align 8
  %2 = load ptr, ptr %f_ticket_parse.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %f_ticket_parse2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 18
  store ptr %2, ptr %f_ticket_parse2, align 8
  %4 = load ptr, ptr %p_ticket.addr, align 8
  %5 = load ptr, ptr %conf.addr, align 8
  %p_ticket3 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 19
  store ptr %4, ptr %p_ticket3, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_conf_export_keys_cb(ptr noundef %conf, ptr noundef %f_export_keys, ptr noundef %p_export_keys) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  %f_export_keys.addr = alloca ptr, align 8
  %p_export_keys.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  store ptr %f_export_keys, ptr %f_export_keys.addr, align 8
  store ptr %p_export_keys, ptr %p_export_keys.addr, align 8
  %0 = load ptr, ptr %f_export_keys.addr, align 8
  %1 = load ptr, ptr %conf.addr, align 8
  %f_export_keys1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 20
  store ptr %0, ptr %f_export_keys1, align 8
  %2 = load ptr, ptr %p_export_keys.addr, align 8
  %3 = load ptr, ptr %conf.addr, align 8
  %p_export_keys2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 21
  store ptr %2, ptr %p_export_keys2, align 8
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i64 @mbedtls_ssl_get_bytes_avail(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_offt = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 29
  %1 = load ptr, ptr %in_offt, align 8
  %cmp = icmp eq ptr %1, null
  br i1 %cmp, label %cond.true, label %cond.false

cond.true:                                        ; preds = %entry
  br label %cond.end

cond.false:                                       ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 31
  %3 = load i64, ptr %in_msglen, align 8
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond = phi i64 [ 0, %cond.true ], [ %3, %cond.false ]
  ret i64 %cond
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_check_pending(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %keep_current_message = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 39
  %1 = load i32, ptr %keep_current_message, align 4
  %cmp = icmp eq i32 %1, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %2, i32 noundef 3, ptr noundef @.str, i32 noundef 7778, ptr noundef @.str.130)
  store i32 1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp1 = icmp eq i32 %bf.clear, 1
  br i1 %cmp1, label %land.lhs.true, label %if.end4

land.lhs.true:                                    ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 32
  %6 = load i64, ptr %in_left, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 34
  %8 = load i64, ptr %next_record_offset, align 8
  %cmp2 = icmp ugt i64 %6, %8
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %land.lhs.true
  %9 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %9, i32 noundef 3, ptr noundef @.str, i32 noundef 7790, ptr noundef @.str.131)
  store i32 1, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %land.lhs.true, %if.end
  %10 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 37
  %11 = load i64, ptr %in_hslen, align 8
  %cmp5 = icmp ugt i64 %11, 0
  br i1 %cmp5, label %land.lhs.true6, label %if.end10

land.lhs.true6:                                   ; preds = %if.end4
  %12 = load ptr, ptr %ssl.addr, align 8
  %in_hslen7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 37
  %13 = load i64, ptr %in_hslen7, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 31
  %15 = load i64, ptr %in_msglen, align 8
  %cmp8 = icmp ult i64 %13, %15
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %land.lhs.true6
  %16 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %16, i32 noundef 3, ptr noundef @.str, i32 noundef 7801, ptr noundef @.str.132)
  store i32 1, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %land.lhs.true6, %if.end4
  %17 = load ptr, ptr %ssl.addr, align 8
  %in_offt = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 29
  %18 = load ptr, ptr %in_offt, align 8
  %cmp11 = icmp ne ptr %18, null
  br i1 %cmp11, label %if.then12, label %if.end13

if.then12:                                        ; preds = %if.end10
  %19 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %19, i32 noundef 3, ptr noundef @.str, i32 noundef 7810, ptr noundef @.str.133)
  store i32 1, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %if.end10
  %20 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %20, i32 noundef 3, ptr noundef @.str, i32 noundef 7820, ptr noundef @.str.134)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end13, %if.then12, %if.then9, %if.then3, %if.then
  %21 = load i32, ptr %retval, align 4
  ret i32 %21
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_get_verify_result(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 13
  %1 = load ptr, ptr %session, align 8
  %cmp = icmp ne ptr %1, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %session1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 13
  %3 = load ptr, ptr %session1, align 8
  %verify_result = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %3, i32 0, i32 7
  %4 = load i32, ptr %verify_result, align 8
  store i32 %4, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 14
  %6 = load ptr, ptr %session_negotiate, align 8
  %cmp2 = icmp ne ptr %6, null
  br i1 %cmp2, label %if.then3, label %if.end6

if.then3:                                         ; preds = %if.end
  %7 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 14
  %8 = load ptr, ptr %session_negotiate4, align 8
  %verify_result5 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %8, i32 0, i32 7
  %9 = load i32, ptr %verify_result5, align 8
  store i32 %9, ptr %retval, align 4
  br label %return

if.end6:                                          ; preds = %if.end
  store i32 -1, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end6, %if.then3, %if.then
  %10 = load i32, ptr %retval, align 4
  ret i32 %10
}

; Function Attrs: noinline nounwind optnone uwtable
define ptr @mbedtls_ssl_get_ciphersuite(ptr noundef %ssl) #0 {
entry:
  %retval = alloca ptr, align 8
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 13
  %2 = load ptr, ptr %session, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store ptr null, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  %session2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 13
  %4 = load ptr, ptr %session2, align 8
  %ciphersuite = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %4, i32 0, i32 1
  %5 = load i32, ptr %ciphersuite, align 8
  %call = call ptr @mbedtls_ssl_get_ciphersuite_name(i32 noundef %5)
  store ptr %call, ptr %retval, align 8
  br label %return

return:                                           ; preds = %if.end, %if.then
  %6 = load ptr, ptr %retval, align 8
  ret ptr %6
}

; Function Attrs: noinline nounwind optnone uwtable
define ptr @mbedtls_ssl_get_version(ptr noundef %ssl) #0 {
entry:
  %retval = alloca ptr, align 8
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 5
  %3 = load i32, ptr %minor_ver, align 8
  switch i32 %3, label %sw.default [
    i32 2, label %sw.bb
    i32 3, label %sw.bb1
  ]

sw.bb:                                            ; preds = %if.then
  store ptr @.str.135, ptr %retval, align 8
  br label %return

sw.bb1:                                           ; preds = %if.then
  store ptr @.str.136, ptr %retval, align 8
  br label %return

sw.default:                                       ; preds = %if.then
  store ptr @.str.137, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %minor_ver2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 5
  %5 = load i32, ptr %minor_ver2, align 8
  switch i32 %5, label %sw.default7 [
    i32 0, label %sw.bb3
    i32 1, label %sw.bb4
    i32 2, label %sw.bb5
    i32 3, label %sw.bb6
  ]

sw.bb3:                                           ; preds = %if.end
  store ptr @.str.138, ptr %retval, align 8
  br label %return

sw.bb4:                                           ; preds = %if.end
  store ptr @.str.139, ptr %retval, align 8
  br label %return

sw.bb5:                                           ; preds = %if.end
  store ptr @.str.140, ptr %retval, align 8
  br label %return

sw.bb6:                                           ; preds = %if.end
  store ptr @.str.141, ptr %retval, align 8
  br label %return

sw.default7:                                      ; preds = %if.end
  store ptr @.str.142, ptr %retval, align 8
  br label %return

return:                                           ; preds = %sw.default7, %sw.bb6, %sw.bb5, %sw.bb4, %sw.bb3, %sw.default, %sw.bb1, %sw.bb
  %6 = load ptr, ptr %retval, align 8
  ret ptr %6
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_get_record_expansion(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %transform_expansion = alloca i64, align 8
  %transform = alloca ptr, align 8
  %block_size = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i64 0, ptr %transform_expansion, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 17
  %1 = load ptr, ptr %transform_out, align 8
  store ptr %1, ptr %transform, align 8
  %2 = load ptr, ptr %transform, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_hdr_len(ptr noundef %3)
  %conv = trunc i64 %call to i32
  store i32 %conv, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %4 = load ptr, ptr %transform, align 8
  %cipher_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %4, i32 0, i32 10
  %call1 = call i32 @mbedtls_cipher_get_cipher_mode(ptr noundef %cipher_ctx_enc)
  switch i32 %call1, label %sw.default [
    i32 6, label %sw.bb
    i32 8, label %sw.bb
    i32 10, label %sw.bb
    i32 7, label %sw.bb
    i32 2, label %sw.bb2
  ]

sw.bb:                                            ; preds = %if.end, %if.end, %if.end, %if.end
  %5 = load ptr, ptr %transform, align 8
  %minlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %5, i32 0, i32 2
  %6 = load i64, ptr %minlen, align 8
  store i64 %6, ptr %transform_expansion, align 8
  br label %sw.epilog

sw.bb2:                                           ; preds = %if.end
  %7 = load ptr, ptr %transform, align 8
  %cipher_ctx_enc3 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %7, i32 0, i32 10
  %call4 = call i32 @mbedtls_cipher_get_block_size(ptr noundef %cipher_ctx_enc3)
  store i32 %call4, ptr %block_size, align 4
  %8 = load ptr, ptr %transform, align 8
  %maclen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %8, i32 0, i32 5
  %9 = load i64, ptr %maclen, align 8
  %10 = load i64, ptr %transform_expansion, align 8
  %add = add i64 %10, %9
  store i64 %add, ptr %transform_expansion, align 8
  %11 = load i32, ptr %block_size, align 4
  %conv5 = zext i32 %11 to i64
  %12 = load i64, ptr %transform_expansion, align 8
  %add6 = add i64 %12, %conv5
  store i64 %add6, ptr %transform_expansion, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 5
  %14 = load i32, ptr %minor_ver, align 8
  %cmp7 = icmp sge i32 %14, 2
  br i1 %cmp7, label %if.then9, label %if.end12

if.then9:                                         ; preds = %sw.bb2
  %15 = load i32, ptr %block_size, align 4
  %conv10 = zext i32 %15 to i64
  %16 = load i64, ptr %transform_expansion, align 8
  %add11 = add i64 %16, %conv10
  store i64 %add11, ptr %transform_expansion, align 8
  br label %if.end12

if.end12:                                         ; preds = %if.then9, %sw.bb2
  br label %sw.epilog

sw.default:                                       ; preds = %if.end
  %17 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %17, i32 noundef 1, ptr noundef @.str, i32 noundef 7927, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

sw.epilog:                                        ; preds = %if.end12, %sw.bb
  %18 = load ptr, ptr %ssl.addr, align 8
  %call13 = call i64 @mbedtls_ssl_hdr_len(ptr noundef %18)
  %19 = load i64, ptr %transform_expansion, align 8
  %add14 = add i64 %call13, %19
  %conv15 = trunc i64 %add14 to i32
  store i32 %conv15, ptr %retval, align 4
  br label %return

return:                                           ; preds = %sw.epilog, %sw.default, %if.then
  %20 = load i32, ptr %retval, align 4
  ret i32 %20
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @mbedtls_cipher_get_cipher_mode(ptr noundef %ctx) #0 {
entry:
  %retval = alloca i32, align 4
  %ctx.addr = alloca ptr, align 8
  store ptr %ctx, ptr %ctx.addr, align 8
  br label %do.body

do.body:                                          ; preds = %entry
  br label %do.end

do.end:                                           ; preds = %do.body
  %0 = load ptr, ptr %ctx.addr, align 8
  %cipher_info = getelementptr inbounds %struct.mbedtls_cipher_context_t, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %cipher_info, align 8
  %cmp = icmp eq ptr %1, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %do.end
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %do.end
  %2 = load ptr, ptr %ctx.addr, align 8
  %cipher_info1 = getelementptr inbounds %struct.mbedtls_cipher_context_t, ptr %2, i32 0, i32 0
  %3 = load ptr, ptr %cipher_info1, align 8
  %mode = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %3, i32 0, i32 1
  %4 = load i32, ptr %mode, align 4
  store i32 %4, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %5 = load i32, ptr %retval, align 4
  ret i32 %5
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @mbedtls_cipher_get_block_size(ptr noundef %ctx) #0 {
entry:
  %retval = alloca i32, align 4
  %ctx.addr = alloca ptr, align 8
  store ptr %ctx, ptr %ctx.addr, align 8
  br label %do.body

do.body:                                          ; preds = %entry
  br label %do.end

do.end:                                           ; preds = %do.body
  %0 = load ptr, ptr %ctx.addr, align 8
  %cipher_info = getelementptr inbounds %struct.mbedtls_cipher_context_t, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %cipher_info, align 8
  %cmp = icmp eq ptr %1, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %do.end
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %do.end
  %2 = load ptr, ptr %ctx.addr, align 8
  %cipher_info1 = getelementptr inbounds %struct.mbedtls_cipher_context_t, ptr %2, i32 0, i32 0
  %3 = load ptr, ptr %cipher_info1, align 8
  %block_size = getelementptr inbounds %struct.mbedtls_cipher_info_t, ptr %3, i32 0, i32 6
  %4 = load i32, ptr %block_size, align 8
  store i32 %4, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %5 = load i32, ptr %retval, align 4
  ret i32 %5
}

; Function Attrs: noinline nounwind optnone uwtable
define i64 @mbedtls_ssl_get_max_frag_len(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %max_len = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %mfl_code = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %mfl_code, align 4
  %bf.lshr = lshr i32 %bf.load, 7
  %bf.clear = and i32 %bf.lshr, 7
  %call = call i32 @ssl_mfl_code_to_length(i32 noundef %bf.clear)
  %conv = zext i32 %call to i64
  store i64 %conv, ptr %max_len, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %session_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 12
  %3 = load ptr, ptr %session_out, align 8
  %cmp = icmp ne ptr %3, null
  br i1 %cmp, label %land.lhs.true, label %if.end

land.lhs.true:                                    ; preds = %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %session_out2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 12
  %5 = load ptr, ptr %session_out2, align 8
  %mfl_code3 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %5, i32 0, i32 11
  %6 = load i8, ptr %mfl_code3, align 4
  %conv4 = zext i8 %6 to i32
  %call5 = call i32 @ssl_mfl_code_to_length(i32 noundef %conv4)
  %conv6 = zext i32 %call5 to i64
  %7 = load i64, ptr %max_len, align 8
  %cmp7 = icmp ult i64 %conv6, %7
  br i1 %cmp7, label %if.then, label %if.end

if.then:                                          ; preds = %land.lhs.true
  %8 = load ptr, ptr %ssl.addr, align 8
  %session_out9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 12
  %9 = load ptr, ptr %session_out9, align 8
  %mfl_code10 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %9, i32 0, i32 11
  %10 = load i8, ptr %mfl_code10, align 4
  %conv11 = zext i8 %10 to i32
  %call12 = call i32 @ssl_mfl_code_to_length(i32 noundef %conv11)
  %conv13 = zext i32 %call12 to i64
  store i64 %conv13, ptr %max_len, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %land.lhs.true, %entry
  %11 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 14
  %12 = load ptr, ptr %session_negotiate, align 8
  %cmp14 = icmp ne ptr %12, null
  br i1 %cmp14, label %land.lhs.true16, label %if.end30

land.lhs.true16:                                  ; preds = %if.end
  %13 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 14
  %14 = load ptr, ptr %session_negotiate17, align 8
  %mfl_code18 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %14, i32 0, i32 11
  %15 = load i8, ptr %mfl_code18, align 4
  %conv19 = zext i8 %15 to i32
  %call20 = call i32 @ssl_mfl_code_to_length(i32 noundef %conv19)
  %conv21 = zext i32 %call20 to i64
  %16 = load i64, ptr %max_len, align 8
  %cmp22 = icmp ult i64 %conv21, %16
  br i1 %cmp22, label %if.then24, label %if.end30

if.then24:                                        ; preds = %land.lhs.true16
  %17 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate25 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 14
  %18 = load ptr, ptr %session_negotiate25, align 8
  %mfl_code26 = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %18, i32 0, i32 11
  %19 = load i8, ptr %mfl_code26, align 4
  %conv27 = zext i8 %19 to i32
  %call28 = call i32 @ssl_mfl_code_to_length(i32 noundef %conv27)
  %conv29 = zext i32 %call28 to i64
  store i64 %conv29, ptr %max_len, align 8
  br label %if.end30

if.end30:                                         ; preds = %if.then24, %land.lhs.true16, %if.end
  %20 = load i64, ptr %max_len, align 8
  ret i64 %20
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_get_max_out_record_payload(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %max_len = alloca i64, align 8
  %mfl = alloca i64, align 8
  %mtu = alloca i64, align 8
  %ret = alloca i32, align 4
  %overhead = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i64 16384, ptr %max_len, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_get_max_frag_len(ptr noundef %0)
  store i64 %call, ptr %mfl, align 8
  %1 = load i64, ptr %max_len, align 8
  %2 = load i64, ptr %mfl, align 8
  %cmp = icmp ugt i64 %1, %2
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %3 = load i64, ptr %mfl, align 8
  store i64 %3, ptr %max_len, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %call1 = call i64 @ssl_get_current_mtu(ptr noundef %4)
  %cmp2 = icmp ne i64 %call1, 0
  br i1 %cmp2, label %if.then3, label %if.end19

if.then3:                                         ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %call4 = call i64 @ssl_get_current_mtu(ptr noundef %5)
  store i64 %call4, ptr %mtu, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  %call5 = call i32 @mbedtls_ssl_get_record_expansion(ptr noundef %6)
  store i32 %call5, ptr %ret, align 4
  %7 = load i32, ptr %ret, align 4
  %conv = sext i32 %7 to i64
  store i64 %conv, ptr %overhead, align 8
  %8 = load i32, ptr %ret, align 4
  %cmp6 = icmp slt i32 %8, 0
  br i1 %cmp6, label %if.then8, label %if.end9

if.then8:                                         ; preds = %if.then3
  %9 = load i32, ptr %ret, align 4
  store i32 %9, ptr %retval, align 4
  br label %return

if.end9:                                          ; preds = %if.then3
  %10 = load i64, ptr %mtu, align 8
  %11 = load i64, ptr %overhead, align 8
  %cmp10 = icmp ule i64 %10, %11
  br i1 %cmp10, label %if.then12, label %if.end13

if.then12:                                        ; preds = %if.end9
  %12 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %12, i32 noundef 1, ptr noundef @.str, i32 noundef 8010, ptr noundef @.str.143)
  store i32 -28800, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %if.end9
  %13 = load i64, ptr %max_len, align 8
  %14 = load i64, ptr %mtu, align 8
  %15 = load i64, ptr %overhead, align 8
  %sub = sub i64 %14, %15
  %cmp14 = icmp ugt i64 %13, %sub
  br i1 %cmp14, label %if.then16, label %if.end18

if.then16:                                        ; preds = %if.end13
  %16 = load i64, ptr %mtu, align 8
  %17 = load i64, ptr %overhead, align 8
  %sub17 = sub i64 %16, %17
  store i64 %sub17, ptr %max_len, align 8
  br label %if.end18

if.end18:                                         ; preds = %if.then16, %if.end13
  br label %if.end19

if.end19:                                         ; preds = %if.end18, %if.end
  %18 = load i64, ptr %max_len, align 8
  %conv20 = trunc i64 %18 to i32
  store i32 %conv20, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end19, %if.then12, %if.then8
  %19 = load i32, ptr %retval, align 4
  ret i32 %19
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i64 @ssl_get_current_mtu(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i64, align 8
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp = icmp eq i32 %bf.clear, 0
  br i1 %cmp, label %land.lhs.true, label %if.end

land.lhs.true:                                    ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 1
  %3 = load i32, ptr %state, align 8
  %cmp1 = icmp eq i32 %3, 1
  br i1 %cmp1, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %land.lhs.true
  %4 = load ptr, ptr %ssl.addr, align 8
  %state2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 1
  %5 = load i32, ptr %state2, align 8
  %cmp3 = icmp eq i32 %5, 2
  br i1 %cmp3, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %land.lhs.true
  store i64 0, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %lor.lhs.false, %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 15
  %7 = load ptr, ptr %handshake, align 8
  %cmp4 = icmp eq ptr %7, null
  br i1 %cmp4, label %if.then9, label %lor.lhs.false5

lor.lhs.false5:                                   ; preds = %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %handshake6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 15
  %9 = load ptr, ptr %handshake6, align 8
  %mtu = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 24
  %10 = load i16, ptr %mtu, align 8
  %conv = zext i16 %10 to i32
  %cmp7 = icmp eq i32 %conv, 0
  br i1 %cmp7, label %if.then9, label %if.end12

if.then9:                                         ; preds = %lor.lhs.false5, %if.end
  %11 = load ptr, ptr %ssl.addr, align 8
  %mtu10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 51
  %12 = load i16, ptr %mtu10, align 8
  %conv11 = zext i16 %12 to i64
  store i64 %conv11, ptr %retval, align 8
  br label %return

if.end12:                                         ; preds = %lor.lhs.false5
  %13 = load ptr, ptr %ssl.addr, align 8
  %mtu13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 51
  %14 = load i16, ptr %mtu13, align 8
  %conv14 = zext i16 %14 to i32
  %cmp15 = icmp eq i32 %conv14, 0
  br i1 %cmp15, label %if.then17, label %if.end21

if.then17:                                        ; preds = %if.end12
  %15 = load ptr, ptr %ssl.addr, align 8
  %handshake18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 15
  %16 = load ptr, ptr %handshake18, align 8
  %mtu19 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %16, i32 0, i32 24
  %17 = load i16, ptr %mtu19, align 8
  %conv20 = zext i16 %17 to i64
  store i64 %conv20, ptr %retval, align 8
  br label %return

if.end21:                                         ; preds = %if.end12
  %18 = load ptr, ptr %ssl.addr, align 8
  %mtu22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 51
  %19 = load i16, ptr %mtu22, align 8
  %conv23 = zext i16 %19 to i32
  %20 = load ptr, ptr %ssl.addr, align 8
  %handshake24 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 15
  %21 = load ptr, ptr %handshake24, align 8
  %mtu25 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %21, i32 0, i32 24
  %22 = load i16, ptr %mtu25, align 8
  %conv26 = zext i16 %22 to i32
  %cmp27 = icmp slt i32 %conv23, %conv26
  br i1 %cmp27, label %cond.true, label %cond.false

cond.true:                                        ; preds = %if.end21
  %23 = load ptr, ptr %ssl.addr, align 8
  %mtu29 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 51
  %24 = load i16, ptr %mtu29, align 8
  %conv30 = zext i16 %24 to i32
  br label %cond.end

cond.false:                                       ; preds = %if.end21
  %25 = load ptr, ptr %ssl.addr, align 8
  %handshake31 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 15
  %26 = load ptr, ptr %handshake31, align 8
  %mtu32 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %26, i32 0, i32 24
  %27 = load i16, ptr %mtu32, align 8
  %conv33 = zext i16 %27 to i32
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond = phi i32 [ %conv30, %cond.true ], [ %conv33, %cond.false ]
  %conv34 = sext i32 %cond to i64
  store i64 %conv34, ptr %retval, align 8
  br label %return

return:                                           ; preds = %cond.end, %if.then17, %if.then9, %if.then
  %28 = load i64, ptr %retval, align 8
  ret i64 %28
}

; Function Attrs: noinline nounwind optnone uwtable
define ptr @mbedtls_ssl_get_peer_cert(ptr noundef %ssl) #0 {
entry:
  %retval = alloca ptr, align 8
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 13
  %2 = load ptr, ptr %session, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store ptr null, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  %session2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 13
  %4 = load ptr, ptr %session2, align 8
  %peer_cert = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %4, i32 0, i32 6
  %5 = load ptr, ptr %peer_cert, align 8
  store ptr %5, ptr %retval, align 8
  br label %return

return:                                           ; preds = %if.end, %if.then
  %6 = load ptr, ptr %retval, align 8
  ret ptr %6
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_get_session(ptr noundef %ssl, ptr noundef %dst) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %dst.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %dst, ptr %dst.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %dst.addr, align 8
  %cmp1 = icmp eq ptr %1, null
  br i1 %cmp1, label %if.then, label %lor.lhs.false2

lor.lhs.false2:                                   ; preds = %lor.lhs.false
  %2 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 13
  %3 = load ptr, ptr %session, align 8
  %cmp3 = icmp eq ptr %3, null
  br i1 %cmp3, label %if.then, label %lor.lhs.false4

lor.lhs.false4:                                   ; preds = %lor.lhs.false2
  %4 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 0
  %5 = load ptr, ptr %conf, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp5 = icmp ne i32 %bf.clear, 0
  br i1 %cmp5, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false4, %lor.lhs.false2, %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false4
  %6 = load ptr, ptr %dst.addr, align 8
  %7 = load ptr, ptr %ssl.addr, align 8
  %session6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 13
  %8 = load ptr, ptr %session6, align 8
  %call = call i32 @ssl_session_copy(ptr noundef %6, ptr noundef %8)
  store i32 %call, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %9 = load i32, ptr %retval, align 4
  ret i32 %9
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_handshake_step(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 -28800, ptr %ret, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %conf, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf2, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp3 = icmp eq i32 %bf.clear, 0
  br i1 %cmp3, label %if.then4, label %if.end5

if.then4:                                         ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_handshake_client_step(ptr noundef %5)
  store i32 %call, ptr %ret, align 4
  br label %if.end5

if.end5:                                          ; preds = %if.then4, %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  %conf6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 0
  %7 = load ptr, ptr %conf6, align 8
  %endpoint7 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 46
  %bf.load8 = load i32, ptr %endpoint7, align 4
  %bf.clear9 = and i32 %bf.load8, 1
  %cmp10 = icmp eq i32 %bf.clear9, 1
  br i1 %cmp10, label %if.then11, label %if.end13

if.then11:                                        ; preds = %if.end5
  %8 = load ptr, ptr %ssl.addr, align 8
  %call12 = call i32 @mbedtls_ssl_handshake_server_step(ptr noundef %8)
  store i32 %call12, ptr %ret, align 4
  br label %if.end13

if.end13:                                         ; preds = %if.then11, %if.end5
  %9 = load i32, ptr %ret, align 4
  store i32 %9, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end13, %if.then
  %10 = load i32, ptr %retval, align 4
  ret i32 %10
}

declare i32 @mbedtls_ssl_handshake_client_step(ptr noundef) #1

declare i32 @mbedtls_ssl_handshake_server_step(ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_handshake(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 0, ptr %ret, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %conf, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 8084, ptr noundef @.str.144)
  br label %while.cond

while.cond:                                       ; preds = %if.end5, %if.end
  %4 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 1
  %5 = load i32, ptr %state, align 8
  %cmp2 = icmp ne i32 %5, 16
  br i1 %cmp2, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %6 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_handshake_step(ptr noundef %6)
  store i32 %call, ptr %ret, align 4
  %7 = load i32, ptr %ret, align 4
  %cmp3 = icmp ne i32 %7, 0
  br i1 %cmp3, label %if.then4, label %if.end5

if.then4:                                         ; preds = %while.body
  br label %while.end

if.end5:                                          ; preds = %while.body
  br label %while.cond, !llvm.loop !30

while.end:                                        ; preds = %if.then4, %while.cond
  %8 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %8, i32 noundef 2, ptr noundef @.str, i32 noundef 8094, ptr noundef @.str.145)
  %9 = load i32, ptr %ret, align 4
  store i32 %9, ptr %retval, align 4
  br label %return

return:                                           ; preds = %while.end, %if.then
  %10 = load i32, ptr %retval, align 4
  ret i32 %10
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_renegotiate(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 -28800, ptr %ret, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %conf, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf2, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 46
  %bf.load = load i32, ptr %endpoint, align 4
  %bf.clear = and i32 %bf.load, 1
  %cmp3 = icmp eq i32 %bf.clear, 1
  br i1 %cmp3, label %if.then4, label %if.end12

if.then4:                                         ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 1
  %6 = load i32, ptr %state, align 8
  %cmp5 = icmp ne i32 %6, 16
  br i1 %cmp5, label %if.then6, label %if.end7

if.then6:                                         ; preds = %if.then4
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end7:                                          ; preds = %if.then4
  %7 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 2
  store i32 3, ptr %renego_status, align 4
  %8 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 49
  %9 = load i64, ptr %out_left, align 8
  %cmp8 = icmp ne i64 %9, 0
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %if.end7
  %10 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_flush_output(ptr noundef %10)
  store i32 %call, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.end7
  %11 = load ptr, ptr %ssl.addr, align 8
  %call11 = call i32 @ssl_write_hello_request(ptr noundef %11)
  store i32 %call11, ptr %retval, align 4
  br label %return

if.end12:                                         ; preds = %if.end
  %12 = load ptr, ptr %ssl.addr, align 8
  %renego_status13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 2
  %13 = load i32, ptr %renego_status13, align 4
  %cmp14 = icmp ne i32 %13, 1
  br i1 %cmp14, label %if.then15, label %if.else

if.then15:                                        ; preds = %if.end12
  %14 = load ptr, ptr %ssl.addr, align 8
  %state16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 1
  %15 = load i32, ptr %state16, align 8
  %cmp17 = icmp ne i32 %15, 16
  br i1 %cmp17, label %if.then18, label %if.end19

if.then18:                                        ; preds = %if.then15
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end19:                                         ; preds = %if.then15
  %16 = load ptr, ptr %ssl.addr, align 8
  %call20 = call i32 @ssl_start_renegotiation(ptr noundef %16)
  store i32 %call20, ptr %ret, align 4
  %cmp21 = icmp ne i32 %call20, 0
  br i1 %cmp21, label %if.then22, label %if.end23

if.then22:                                        ; preds = %if.end19
  %17 = load ptr, ptr %ssl.addr, align 8
  %18 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %17, i32 noundef 1, ptr noundef @.str, i32 noundef 8211, ptr noundef @.str.146, i32 noundef %18)
  %19 = load i32, ptr %ret, align 4
  store i32 %19, ptr %retval, align 4
  br label %return

if.end23:                                         ; preds = %if.end19
  br label %if.end28

if.else:                                          ; preds = %if.end12
  %20 = load ptr, ptr %ssl.addr, align 8
  %call24 = call i32 @mbedtls_ssl_handshake(ptr noundef %20)
  store i32 %call24, ptr %ret, align 4
  %cmp25 = icmp ne i32 %call24, 0
  br i1 %cmp25, label %if.then26, label %if.end27

if.then26:                                        ; preds = %if.else
  %21 = load ptr, ptr %ssl.addr, align 8
  %22 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %21, i32 noundef 1, ptr noundef @.str, i32 noundef 8219, ptr noundef @.str.147, i32 noundef %22)
  %23 = load i32, ptr %ret, align 4
  store i32 %23, ptr %retval, align 4
  br label %return

if.end27:                                         ; preds = %if.else
  br label %if.end28

if.end28:                                         ; preds = %if.end27, %if.end23
  %24 = load i32, ptr %ret, align 4
  store i32 %24, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end28, %if.then26, %if.then22, %if.then18, %if.end10, %if.then9, %if.then6, %if.then
  %25 = load i32, ptr %retval, align 4
  ret i32 %25
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_write_hello_request(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 8108, ptr noundef @.str.301)
  %1 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 48
  store i64 4, ptr %out_msglen, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 47
  store i32 22, ptr %out_msgtype, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 46
  %4 = load ptr, ptr %out_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %4, i64 0
  store i8 0, ptr %arrayidx, align 1
  %5 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_write_handshake_msg(ptr noundef %5)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %6 = load ptr, ptr %ssl.addr, align 8
  %7 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %6, i32 noundef 1, ptr noundef @.str, i32 noundef 8116, ptr noundef @.str.99, i32 noundef %7)
  %8 = load i32, ptr %ret, align 4
  store i32 %8, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %9 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %9, i32 noundef 2, ptr noundef @.str, i32 noundef 8120, ptr noundef @.str.302)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end, %if.then
  %10 = load i32, ptr %retval, align 4
  ret i32 %10
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_start_renegotiation(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 8139, ptr noundef @.str.303)
  %1 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_handshake_init(ptr noundef %1)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %2 = load i32, ptr %ret, align 4
  store i32 %2, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp1 = icmp eq i32 %bf.clear, 1
  br i1 %cmp1, label %land.lhs.true, label %if.end11

land.lhs.true:                                    ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 2
  %6 = load i32, ptr %renego_status, align 4
  %cmp2 = icmp eq i32 %6, 3
  br i1 %cmp2, label %if.then3, label %if.end11

if.then3:                                         ; preds = %land.lhs.true
  %7 = load ptr, ptr %ssl.addr, align 8
  %conf4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 0
  %8 = load ptr, ptr %conf4, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %8, i32 0, i32 46
  %bf.load5 = load i32, ptr %endpoint, align 4
  %bf.clear6 = and i32 %bf.load5, 1
  %cmp7 = icmp eq i32 %bf.clear6, 1
  br i1 %cmp7, label %if.then8, label %if.else

if.then8:                                         ; preds = %if.then3
  %9 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 15
  %10 = load ptr, ptr %handshake, align 8
  %out_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %10, i32 0, i32 11
  store i32 1, ptr %out_msg_seq, align 8
  br label %if.end10

if.else:                                          ; preds = %if.then3
  %11 = load ptr, ptr %ssl.addr, align 8
  %handshake9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 15
  %12 = load ptr, ptr %handshake9, align 8
  %in_msg_seq = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %12, i32 0, i32 12
  store i32 1, ptr %in_msg_seq, align 4
  br label %if.end10

if.end10:                                         ; preds = %if.else, %if.then8
  br label %if.end11

if.end11:                                         ; preds = %if.end10, %land.lhs.true, %if.end
  %13 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 1
  store i32 0, ptr %state, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %renego_status12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 2
  store i32 1, ptr %renego_status12, align 4
  %15 = load ptr, ptr %ssl.addr, align 8
  %call13 = call i32 @mbedtls_ssl_handshake(ptr noundef %15)
  store i32 %call13, ptr %ret, align 4
  %cmp14 = icmp ne i32 %call13, 0
  br i1 %cmp14, label %if.then15, label %if.end16

if.then15:                                        ; preds = %if.end11
  %16 = load ptr, ptr %ssl.addr, align 8
  %17 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %16, i32 noundef 1, ptr noundef @.str, i32 noundef 8162, ptr noundef @.str.147, i32 noundef %17)
  %18 = load i32, ptr %ret, align 4
  store i32 %18, ptr %retval, align 4
  br label %return

if.end16:                                         ; preds = %if.end11
  %19 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %19, i32 noundef 2, ptr noundef @.str, i32 noundef 8166, ptr noundef @.str.304)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end16, %if.then15, %if.then
  %20 = load i32, ptr %retval, align 4
  ret i32 %20
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_read(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  %ret = alloca i32, align 4
  %n = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %conf, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 8270, ptr noundef @.str.148)
  %4 = load ptr, ptr %ssl.addr, align 8
  %conf2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 0
  %5 = load ptr, ptr %conf2, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp3 = icmp eq i32 %bf.clear, 1
  br i1 %cmp3, label %if.then4, label %if.end19

if.then4:                                         ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_flush_output(ptr noundef %6)
  store i32 %call, ptr %ret, align 4
  %cmp5 = icmp ne i32 %call, 0
  br i1 %cmp5, label %if.then6, label %if.end7

if.then6:                                         ; preds = %if.then4
  %7 = load i32, ptr %ret, align 4
  store i32 %7, ptr %retval, align 4
  br label %return

if.end7:                                          ; preds = %if.then4
  %8 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 15
  %9 = load ptr, ptr %handshake, align 8
  %cmp8 = icmp ne ptr %9, null
  br i1 %cmp8, label %land.lhs.true, label %if.end18

land.lhs.true:                                    ; preds = %if.end7
  %10 = load ptr, ptr %ssl.addr, align 8
  %handshake9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 15
  %11 = load ptr, ptr %handshake9, align 8
  %retransmit_state = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 16
  %12 = load i8, ptr %retransmit_state, align 8
  %conv = zext i8 %12 to i32
  %cmp10 = icmp eq i32 %conv, 1
  br i1 %cmp10, label %if.then12, label %if.end18

if.then12:                                        ; preds = %land.lhs.true
  %13 = load ptr, ptr %ssl.addr, align 8
  %call13 = call i32 @mbedtls_ssl_flight_transmit(ptr noundef %13)
  store i32 %call13, ptr %ret, align 4
  %cmp14 = icmp ne i32 %call13, 0
  br i1 %cmp14, label %if.then16, label %if.end17

if.then16:                                        ; preds = %if.then12
  %14 = load i32, ptr %ret, align 4
  store i32 %14, ptr %retval, align 4
  br label %return

if.end17:                                         ; preds = %if.then12
  br label %if.end18

if.end18:                                         ; preds = %if.end17, %land.lhs.true, %if.end7
  br label %if.end19

if.end19:                                         ; preds = %if.end18, %if.end
  %15 = load ptr, ptr %ssl.addr, align 8
  %call20 = call i32 @ssl_check_ctr_renegotiate(ptr noundef %15)
  store i32 %call20, ptr %ret, align 4
  %16 = load i32, ptr %ret, align 4
  %cmp21 = icmp ne i32 %16, -27392
  br i1 %cmp21, label %land.lhs.true23, label %if.end27

land.lhs.true23:                                  ; preds = %if.end19
  %17 = load i32, ptr %ret, align 4
  %cmp24 = icmp ne i32 %17, 0
  br i1 %cmp24, label %if.then26, label %if.end27

if.then26:                                        ; preds = %land.lhs.true23
  %18 = load ptr, ptr %ssl.addr, align 8
  %19 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %18, i32 noundef 1, ptr noundef @.str, i32 noundef 8304, ptr noundef @.str.149, i32 noundef %19)
  %20 = load i32, ptr %ret, align 4
  store i32 %20, ptr %retval, align 4
  br label %return

if.end27:                                         ; preds = %land.lhs.true23, %if.end19
  %21 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 1
  %22 = load i32, ptr %state, align 8
  %cmp28 = icmp ne i32 %22, 16
  br i1 %cmp28, label %if.then30, label %if.end39

if.then30:                                        ; preds = %if.end27
  %23 = load ptr, ptr %ssl.addr, align 8
  %call31 = call i32 @mbedtls_ssl_handshake(ptr noundef %23)
  store i32 %call31, ptr %ret, align 4
  %24 = load i32, ptr %ret, align 4
  %cmp32 = icmp ne i32 %24, -27392
  br i1 %cmp32, label %land.lhs.true34, label %if.end38

land.lhs.true34:                                  ; preds = %if.then30
  %25 = load i32, ptr %ret, align 4
  %cmp35 = icmp ne i32 %25, 0
  br i1 %cmp35, label %if.then37, label %if.end38

if.then37:                                        ; preds = %land.lhs.true34
  %26 = load ptr, ptr %ssl.addr, align 8
  %27 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %26, i32 noundef 1, ptr noundef @.str, i32 noundef 8315, ptr noundef @.str.147, i32 noundef %27)
  %28 = load i32, ptr %ret, align 4
  store i32 %28, ptr %retval, align 4
  br label %return

if.end38:                                         ; preds = %land.lhs.true34, %if.then30
  br label %if.end39

if.end39:                                         ; preds = %if.end38, %if.end27
  br label %while.cond

while.cond:                                       ; preds = %if.end231, %if.end179, %if.then125, %if.then102, %if.end39
  %29 = load ptr, ptr %ssl.addr, align 8
  %in_offt = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 29
  %30 = load ptr, ptr %in_offt, align 8
  %cmp40 = icmp eq ptr %30, null
  br i1 %cmp40, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %31 = load ptr, ptr %ssl.addr, align 8
  %f_get_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 22
  %32 = load ptr, ptr %f_get_timer, align 8
  %cmp42 = icmp ne ptr %32, null
  br i1 %cmp42, label %land.lhs.true44, label %if.end51

land.lhs.true44:                                  ; preds = %while.body
  %33 = load ptr, ptr %ssl.addr, align 8
  %f_get_timer45 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 22
  %34 = load ptr, ptr %f_get_timer45, align 8
  %35 = load ptr, ptr %ssl.addr, align 8
  %p_timer = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 20
  %36 = load ptr, ptr %p_timer, align 8
  %call46 = call i32 %34(ptr noundef %36)
  %cmp47 = icmp eq i32 %call46, -1
  br i1 %cmp47, label %if.then49, label %if.end51

if.then49:                                        ; preds = %land.lhs.true44
  %37 = load ptr, ptr %ssl.addr, align 8
  %38 = load ptr, ptr %ssl.addr, align 8
  %conf50 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %38, i32 0, i32 0
  %39 = load ptr, ptr %conf50, align 8
  %read_timeout = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %39, i32 0, i32 35
  %40 = load i32, ptr %read_timeout, align 8
  call void @ssl_set_timer(ptr noundef %37, i32 noundef %40)
  br label %if.end51

if.end51:                                         ; preds = %if.then49, %land.lhs.true44, %while.body
  %41 = load ptr, ptr %ssl.addr, align 8
  %call52 = call i32 @mbedtls_ssl_read_record(ptr noundef %41, i32 noundef 1)
  store i32 %call52, ptr %ret, align 4
  %cmp53 = icmp ne i32 %call52, 0
  br i1 %cmp53, label %if.then55, label %if.end60

if.then55:                                        ; preds = %if.end51
  %42 = load i32, ptr %ret, align 4
  %cmp56 = icmp eq i32 %42, -29312
  br i1 %cmp56, label %if.then58, label %if.end59

if.then58:                                        ; preds = %if.then55
  store i32 0, ptr %retval, align 4
  br label %return

if.end59:                                         ; preds = %if.then55
  %43 = load ptr, ptr %ssl.addr, align 8
  %44 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %43, i32 noundef 1, ptr noundef @.str, i32 noundef 8335, ptr noundef @.str.103, i32 noundef %44)
  %45 = load i32, ptr %ret, align 4
  store i32 %45, ptr %retval, align 4
  br label %return

if.end60:                                         ; preds = %if.end51
  %46 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %46, i32 0, i32 31
  %47 = load i64, ptr %in_msglen, align 8
  %cmp61 = icmp eq i64 %47, 0
  br i1 %cmp61, label %land.lhs.true63, label %if.end76

land.lhs.true63:                                  ; preds = %if.end60
  %48 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %48, i32 0, i32 30
  %49 = load i32, ptr %in_msgtype, align 8
  %cmp64 = icmp eq i32 %49, 23
  br i1 %cmp64, label %if.then66, label %if.end76

if.then66:                                        ; preds = %land.lhs.true63
  %50 = load ptr, ptr %ssl.addr, align 8
  %call67 = call i32 @mbedtls_ssl_read_record(ptr noundef %50, i32 noundef 1)
  store i32 %call67, ptr %ret, align 4
  %cmp68 = icmp ne i32 %call67, 0
  br i1 %cmp68, label %if.then70, label %if.end75

if.then70:                                        ; preds = %if.then66
  %51 = load i32, ptr %ret, align 4
  %cmp71 = icmp eq i32 %51, -29312
  br i1 %cmp71, label %if.then73, label %if.end74

if.then73:                                        ; preds = %if.then70
  store i32 0, ptr %retval, align 4
  br label %return

if.end74:                                         ; preds = %if.then70
  %52 = load ptr, ptr %ssl.addr, align 8
  %53 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %52, i32 noundef 1, ptr noundef @.str, i32 noundef 8350, ptr noundef @.str.103, i32 noundef %53)
  %54 = load i32, ptr %ret, align 4
  store i32 %54, ptr %retval, align 4
  br label %return

if.end75:                                         ; preds = %if.then66
  br label %if.end76

if.end76:                                         ; preds = %if.end75, %land.lhs.true63, %if.end60
  %55 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype77 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %55, i32 0, i32 30
  %56 = load i32, ptr %in_msgtype77, align 8
  %cmp78 = icmp eq i32 %56, 22
  br i1 %cmp78, label %if.then80, label %if.else180

if.then80:                                        ; preds = %if.end76
  %57 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %57, i32 noundef 1, ptr noundef @.str, i32 noundef 8357, ptr noundef @.str.150)
  %58 = load ptr, ptr %ssl.addr, align 8
  %conf81 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 0
  %59 = load ptr, ptr %conf81, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %59, i32 0, i32 46
  %bf.load82 = load i32, ptr %endpoint, align 4
  %bf.clear83 = and i32 %bf.load82, 1
  %cmp84 = icmp eq i32 %bf.clear83, 0
  br i1 %cmp84, label %land.lhs.true86, label %if.end104

land.lhs.true86:                                  ; preds = %if.then80
  %60 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %60, i32 0, i32 28
  %61 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %61, i64 0
  %62 = load i8, ptr %arrayidx, align 1
  %conv87 = zext i8 %62 to i32
  %cmp88 = icmp ne i32 %conv87, 0
  br i1 %cmp88, label %if.then94, label %lor.lhs.false90

lor.lhs.false90:                                  ; preds = %land.lhs.true86
  %63 = load ptr, ptr %ssl.addr, align 8
  %in_hslen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %63, i32 0, i32 37
  %64 = load i64, ptr %in_hslen, align 8
  %65 = load ptr, ptr %ssl.addr, align 8
  %call91 = call i64 @mbedtls_ssl_hs_hdr_len(ptr noundef %65)
  %cmp92 = icmp ne i64 %64, %call91
  br i1 %cmp92, label %if.then94, label %if.end104

if.then94:                                        ; preds = %lor.lhs.false90, %land.lhs.true86
  %66 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %66, i32 noundef 1, ptr noundef @.str, i32 noundef 8370, ptr noundef @.str.151)
  %67 = load ptr, ptr %ssl.addr, align 8
  %conf95 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %67, i32 0, i32 0
  %68 = load ptr, ptr %conf95, align 8
  %transport96 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %68, i32 0, i32 46
  %bf.load97 = load i32, ptr %transport96, align 4
  %bf.lshr98 = lshr i32 %bf.load97, 1
  %bf.clear99 = and i32 %bf.lshr98, 1
  %cmp100 = icmp eq i32 %bf.clear99, 1
  br i1 %cmp100, label %if.then102, label %if.end103

if.then102:                                       ; preds = %if.then94
  br label %while.cond, !llvm.loop !31

if.end103:                                        ; preds = %if.then94
  store i32 -30464, ptr %retval, align 4
  br label %return

if.end104:                                        ; preds = %lor.lhs.false90, %if.then80
  %69 = load ptr, ptr %ssl.addr, align 8
  %conf105 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %69, i32 0, i32 0
  %70 = load ptr, ptr %conf105, align 8
  %endpoint106 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %70, i32 0, i32 46
  %bf.load107 = load i32, ptr %endpoint106, align 4
  %bf.clear108 = and i32 %bf.load107, 1
  %cmp109 = icmp eq i32 %bf.clear108, 1
  br i1 %cmp109, label %land.lhs.true111, label %if.end127

land.lhs.true111:                                 ; preds = %if.end104
  %71 = load ptr, ptr %ssl.addr, align 8
  %in_msg112 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %71, i32 0, i32 28
  %72 = load ptr, ptr %in_msg112, align 8
  %arrayidx113 = getelementptr inbounds i8, ptr %72, i64 0
  %73 = load i8, ptr %arrayidx113, align 1
  %conv114 = zext i8 %73 to i32
  %cmp115 = icmp ne i32 %conv114, 1
  br i1 %cmp115, label %if.then117, label %if.end127

if.then117:                                       ; preds = %land.lhs.true111
  %74 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %74, i32 noundef 1, ptr noundef @.str, i32 noundef 8387, ptr noundef @.str.152)
  %75 = load ptr, ptr %ssl.addr, align 8
  %conf118 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %75, i32 0, i32 0
  %76 = load ptr, ptr %conf118, align 8
  %transport119 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %76, i32 0, i32 46
  %bf.load120 = load i32, ptr %transport119, align 4
  %bf.lshr121 = lshr i32 %bf.load120, 1
  %bf.clear122 = and i32 %bf.lshr121, 1
  %cmp123 = icmp eq i32 %bf.clear122, 1
  br i1 %cmp123, label %if.then125, label %if.end126

if.then125:                                       ; preds = %if.then117
  br label %while.cond, !llvm.loop !31

if.end126:                                        ; preds = %if.then117
  store i32 -30464, ptr %retval, align 4
  br label %return

if.end127:                                        ; preds = %land.lhs.true111, %if.end104
  %77 = load ptr, ptr %ssl.addr, align 8
  %conf128 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %77, i32 0, i32 0
  %78 = load ptr, ptr %conf128, align 8
  %disable_renegotiation = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %78, i32 0, i32 46
  %bf.load129 = load i32, ptr %disable_renegotiation, align 4
  %bf.lshr130 = lshr i32 %bf.load129, 14
  %bf.clear131 = and i32 %bf.lshr130, 1
  %cmp132 = icmp eq i32 %bf.clear131, 0
  br i1 %cmp132, label %if.else, label %lor.lhs.false134

lor.lhs.false134:                                 ; preds = %if.end127
  %79 = load ptr, ptr %ssl.addr, align 8
  %secure_renegotiation = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %79, i32 0, i32 58
  %80 = load i32, ptr %secure_renegotiation, align 8
  %cmp135 = icmp eq i32 %80, 0
  br i1 %cmp135, label %land.lhs.true137, label %if.then144

land.lhs.true137:                                 ; preds = %lor.lhs.false134
  %81 = load ptr, ptr %ssl.addr, align 8
  %conf138 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %81, i32 0, i32 0
  %82 = load ptr, ptr %conf138, align 8
  %allow_legacy_renegotiation = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %82, i32 0, i32 46
  %bf.load139 = load i32, ptr %allow_legacy_renegotiation, align 4
  %bf.lshr140 = lshr i32 %bf.load139, 4
  %bf.clear141 = and i32 %bf.lshr140, 3
  %cmp142 = icmp eq i32 %bf.clear141, 0
  br i1 %cmp142, label %if.else, label %if.then144

if.then144:                                       ; preds = %land.lhs.true137, %lor.lhs.false134
  %83 = load ptr, ptr %ssl.addr, align 8
  %conf145 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %83, i32 0, i32 0
  %84 = load ptr, ptr %conf145, align 8
  %transport146 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %84, i32 0, i32 46
  %bf.load147 = load i32, ptr %transport146, align 4
  %bf.lshr148 = lshr i32 %bf.load147, 1
  %bf.clear149 = and i32 %bf.lshr148, 1
  %cmp150 = icmp eq i32 %bf.clear149, 1
  br i1 %cmp150, label %land.lhs.true152, label %if.end160

land.lhs.true152:                                 ; preds = %if.then144
  %85 = load ptr, ptr %ssl.addr, align 8
  %conf153 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %85, i32 0, i32 0
  %86 = load ptr, ptr %conf153, align 8
  %endpoint154 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %86, i32 0, i32 46
  %bf.load155 = load i32, ptr %endpoint154, align 4
  %bf.clear156 = and i32 %bf.load155, 1
  %cmp157 = icmp eq i32 %bf.clear156, 0
  br i1 %cmp157, label %if.then159, label %if.end160

if.then159:                                       ; preds = %land.lhs.true152
  %87 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %87, i32 0, i32 2
  store i32 3, ptr %renego_status, align 4
  br label %if.end160

if.end160:                                        ; preds = %if.then159, %land.lhs.true152, %if.then144
  %88 = load ptr, ptr %ssl.addr, align 8
  %call161 = call i32 @ssl_start_renegotiation(ptr noundef %88)
  store i32 %call161, ptr %ret, align 4
  %89 = load i32, ptr %ret, align 4
  %cmp162 = icmp ne i32 %89, -27392
  br i1 %cmp162, label %land.lhs.true164, label %if.end168

land.lhs.true164:                                 ; preds = %if.end160
  %90 = load i32, ptr %ret, align 4
  %cmp165 = icmp ne i32 %90, 0
  br i1 %cmp165, label %if.then167, label %if.end168

if.then167:                                       ; preds = %land.lhs.true164
  %91 = load ptr, ptr %ssl.addr, align 8
  %92 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %91, i32 noundef 1, ptr noundef @.str, i32 noundef 8423, ptr noundef @.str.146, i32 noundef %92)
  %93 = load i32, ptr %ret, align 4
  store i32 %93, ptr %retval, align 4
  br label %return

if.end168:                                        ; preds = %land.lhs.true164, %if.end160
  br label %if.end179

if.else:                                          ; preds = %land.lhs.true137, %if.end127
  %94 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %94, i32 noundef 3, ptr noundef @.str, i32 noundef 8434, ptr noundef @.str.153)
  %95 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %95, i32 0, i32 5
  %96 = load i32, ptr %minor_ver, align 8
  %cmp169 = icmp sge i32 %96, 1
  br i1 %cmp169, label %if.then171, label %if.else177

if.then171:                                       ; preds = %if.else
  %97 = load ptr, ptr %ssl.addr, align 8
  %call172 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %97, i8 noundef zeroext 1, i8 noundef zeroext 100)
  store i32 %call172, ptr %ret, align 4
  %cmp173 = icmp ne i32 %call172, 0
  br i1 %cmp173, label %if.then175, label %if.end176

if.then175:                                       ; preds = %if.then171
  %98 = load i32, ptr %ret, align 4
  store i32 %98, ptr %retval, align 4
  br label %return

if.end176:                                        ; preds = %if.then171
  br label %if.end178

if.else177:                                       ; preds = %if.else
  %99 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %99, i32 noundef 1, ptr noundef @.str, i32 noundef 8462, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end178:                                        ; preds = %if.end176
  br label %if.end179

if.end179:                                        ; preds = %if.end178, %if.end168
  br label %while.cond, !llvm.loop !31

if.else180:                                       ; preds = %if.end76
  %100 = load ptr, ptr %ssl.addr, align 8
  %renego_status181 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %100, i32 0, i32 2
  %101 = load i32, ptr %renego_status181, align 4
  %cmp182 = icmp eq i32 %101, 3
  br i1 %cmp182, label %if.then184, label %if.end196

if.then184:                                       ; preds = %if.else180
  %102 = load ptr, ptr %ssl.addr, align 8
  %conf185 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %102, i32 0, i32 0
  %103 = load ptr, ptr %conf185, align 8
  %renego_max_records = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %103, i32 0, i32 38
  %104 = load i32, ptr %renego_max_records, align 4
  %cmp186 = icmp sge i32 %104, 0
  br i1 %cmp186, label %if.then188, label %if.end195

if.then188:                                       ; preds = %if.then184
  %105 = load ptr, ptr %ssl.addr, align 8
  %renego_records_seen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %105, i32 0, i32 3
  %106 = load i32, ptr %renego_records_seen, align 8
  %inc = add nsw i32 %106, 1
  store i32 %inc, ptr %renego_records_seen, align 8
  %107 = load ptr, ptr %ssl.addr, align 8
  %conf189 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %107, i32 0, i32 0
  %108 = load ptr, ptr %conf189, align 8
  %renego_max_records190 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %108, i32 0, i32 38
  %109 = load i32, ptr %renego_max_records190, align 4
  %cmp191 = icmp sgt i32 %inc, %109
  br i1 %cmp191, label %if.then193, label %if.end194

if.then193:                                       ; preds = %if.then188
  %110 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %110, i32 noundef 1, ptr noundef @.str, i32 noundef 8495, ptr noundef @.str.154)
  store i32 -30464, ptr %retval, align 4
  br label %return

if.end194:                                        ; preds = %if.then188
  br label %if.end195

if.end195:                                        ; preds = %if.end194, %if.then184
  br label %if.end196

if.end196:                                        ; preds = %if.end195, %if.else180
  br label %if.end197

if.end197:                                        ; preds = %if.end196
  %111 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype198 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %111, i32 0, i32 30
  %112 = load i32, ptr %in_msgtype198, align 8
  %cmp199 = icmp eq i32 %112, 21
  br i1 %cmp199, label %if.then201, label %if.end202

if.then201:                                       ; preds = %if.end197
  %113 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %113, i32 noundef 2, ptr noundef @.str, i32 noundef 8505, ptr noundef @.str.155)
  store i32 -26880, ptr %retval, align 4
  br label %return

if.end202:                                        ; preds = %if.end197
  %114 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype203 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %114, i32 0, i32 30
  %115 = load i32, ptr %in_msgtype203, align 8
  %cmp204 = icmp ne i32 %115, 23
  br i1 %cmp204, label %if.then206, label %if.end207

if.then206:                                       ; preds = %if.end202
  %116 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %116, i32 noundef 1, ptr noundef @.str, i32 noundef 8511, ptr noundef @.str.156)
  store i32 -30464, ptr %retval, align 4
  br label %return

if.end207:                                        ; preds = %if.end202
  %117 = load ptr, ptr %ssl.addr, align 8
  %in_msg208 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %117, i32 0, i32 28
  %118 = load ptr, ptr %in_msg208, align 8
  %119 = load ptr, ptr %ssl.addr, align 8
  %in_offt209 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %119, i32 0, i32 29
  store ptr %118, ptr %in_offt209, align 8
  %120 = load ptr, ptr %ssl.addr, align 8
  %state210 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %120, i32 0, i32 1
  %121 = load i32, ptr %state210, align 8
  %cmp211 = icmp eq i32 %121, 16
  br i1 %cmp211, label %if.then213, label %if.end214

if.then213:                                       ; preds = %if.end207
  %122 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_set_timer(ptr noundef %122, i32 noundef 0)
  br label %if.end214

if.end214:                                        ; preds = %if.then213, %if.end207
  %123 = load ptr, ptr %ssl.addr, align 8
  %conf215 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %123, i32 0, i32 0
  %124 = load ptr, ptr %conf215, align 8
  %endpoint216 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %124, i32 0, i32 46
  %bf.load217 = load i32, ptr %endpoint216, align 4
  %bf.clear218 = and i32 %bf.load217, 1
  %cmp219 = icmp eq i32 %bf.clear218, 1
  br i1 %cmp219, label %land.lhs.true221, label %if.end231

land.lhs.true221:                                 ; preds = %if.end214
  %125 = load ptr, ptr %ssl.addr, align 8
  %renego_status222 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %125, i32 0, i32 2
  %126 = load i32, ptr %renego_status222, align 4
  %cmp223 = icmp eq i32 %126, 3
  br i1 %cmp223, label %if.then225, label %if.end231

if.then225:                                       ; preds = %land.lhs.true221
  %127 = load ptr, ptr %ssl.addr, align 8
  %call226 = call i32 @ssl_resend_hello_request(ptr noundef %127)
  store i32 %call226, ptr %ret, align 4
  %cmp227 = icmp ne i32 %call226, 0
  br i1 %cmp227, label %if.then229, label %if.end230

if.then229:                                       ; preds = %if.then225
  %128 = load ptr, ptr %ssl.addr, align 8
  %129 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %128, i32 noundef 1, ptr noundef @.str, i32 noundef 8532, ptr noundef @.str.38, i32 noundef %129)
  %130 = load i32, ptr %ret, align 4
  store i32 %130, ptr %retval, align 4
  br label %return

if.end230:                                        ; preds = %if.then225
  br label %if.end231

if.end231:                                        ; preds = %if.end230, %land.lhs.true221, %if.end214
  br label %while.cond, !llvm.loop !31

while.end:                                        ; preds = %while.cond
  %131 = load i64, ptr %len.addr, align 8
  %132 = load ptr, ptr %ssl.addr, align 8
  %in_msglen232 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %132, i32 0, i32 31
  %133 = load i64, ptr %in_msglen232, align 8
  %cmp233 = icmp ult i64 %131, %133
  br i1 %cmp233, label %cond.true, label %cond.false

cond.true:                                        ; preds = %while.end
  %134 = load i64, ptr %len.addr, align 8
  br label %cond.end

cond.false:                                       ; preds = %while.end
  %135 = load ptr, ptr %ssl.addr, align 8
  %in_msglen235 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %135, i32 0, i32 31
  %136 = load i64, ptr %in_msglen235, align 8
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond = phi i64 [ %134, %cond.true ], [ %136, %cond.false ]
  store i64 %cond, ptr %n, align 8
  %137 = load ptr, ptr %buf.addr, align 8
  %138 = load ptr, ptr %ssl.addr, align 8
  %in_offt236 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %138, i32 0, i32 29
  %139 = load ptr, ptr %in_offt236, align 8
  %140 = load i64, ptr %n, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %137, ptr align 1 %139, i64 %140, i1 false)
  %141 = load i64, ptr %n, align 8
  %142 = load ptr, ptr %ssl.addr, align 8
  %in_msglen237 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %142, i32 0, i32 31
  %143 = load i64, ptr %in_msglen237, align 8
  %sub = sub i64 %143, %141
  store i64 %sub, ptr %in_msglen237, align 8
  %144 = load ptr, ptr %ssl.addr, align 8
  %in_msglen238 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %144, i32 0, i32 31
  %145 = load i64, ptr %in_msglen238, align 8
  %cmp239 = icmp eq i64 %145, 0
  br i1 %cmp239, label %if.then241, label %if.else243

if.then241:                                       ; preds = %cond.end
  %146 = load ptr, ptr %ssl.addr, align 8
  %in_offt242 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %146, i32 0, i32 29
  store ptr null, ptr %in_offt242, align 8
  %147 = load ptr, ptr %ssl.addr, align 8
  %keep_current_message = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %147, i32 0, i32 39
  store i32 0, ptr %keep_current_message, align 4
  br label %if.end245

if.else243:                                       ; preds = %cond.end
  %148 = load i64, ptr %n, align 8
  %149 = load ptr, ptr %ssl.addr, align 8
  %in_offt244 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %149, i32 0, i32 29
  %150 = load ptr, ptr %in_offt244, align 8
  %add.ptr = getelementptr inbounds i8, ptr %150, i64 %148
  store ptr %add.ptr, ptr %in_offt244, align 8
  br label %if.end245

if.end245:                                        ; preds = %if.else243, %if.then241
  %151 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %151, i32 noundef 2, ptr noundef @.str, i32 noundef 8558, ptr noundef @.str.157)
  %152 = load i64, ptr %n, align 8
  %conv246 = trunc i64 %152 to i32
  store i32 %conv246, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end245, %if.then229, %if.then206, %if.then201, %if.then193, %if.else177, %if.then175, %if.then167, %if.end126, %if.end103, %if.end74, %if.then73, %if.end59, %if.then58, %if.then37, %if.then26, %if.then16, %if.then6, %if.then
  %153 = load i32, ptr %retval, align 4
  ret i32 %153
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_check_ctr_renegotiate(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ep_len = alloca i64, align 8
  %in_ctr_cmp = alloca i32, align 4
  %out_ctr_cmp = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @ssl_ep_len(ptr noundef %0)
  store i64 %call, ptr %ep_len, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 1
  %2 = load i32, ptr %state, align 8
  %cmp = icmp ne i32 %2, 16
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 2
  %4 = load i32, ptr %renego_status, align 4
  %cmp1 = icmp eq i32 %4, 3
  br i1 %cmp1, label %if.then, label %lor.lhs.false2

lor.lhs.false2:                                   ; preds = %lor.lhs.false
  %5 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 0
  %6 = load ptr, ptr %conf, align 8
  %disable_renegotiation = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %6, i32 0, i32 46
  %bf.load = load i32, ptr %disable_renegotiation, align 4
  %bf.lshr = lshr i32 %bf.load, 14
  %bf.clear = and i32 %bf.lshr, 1
  %cmp3 = icmp eq i32 %bf.clear, 0
  br i1 %cmp3, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false2, %lor.lhs.false, %entry
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false2
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 24
  %8 = load ptr, ptr %in_ctr, align 8
  %9 = load i64, ptr %ep_len, align 8
  %add.ptr = getelementptr inbounds i8, ptr %8, i64 %9
  %10 = load ptr, ptr %ssl.addr, align 8
  %conf4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 0
  %11 = load ptr, ptr %conf4, align 8
  %renego_period = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %11, i32 0, i32 39
  %arraydecay = getelementptr inbounds [8 x i8], ptr %renego_period, i64 0, i64 0
  %12 = load i64, ptr %ep_len, align 8
  %add.ptr5 = getelementptr inbounds i8, ptr %arraydecay, i64 %12
  %13 = load i64, ptr %ep_len, align 8
  %sub = sub i64 8, %13
  %call6 = call i32 @memcmp(ptr noundef %add.ptr, ptr noundef %add.ptr5, i64 noundef %sub) #7
  store i32 %call6, ptr %in_ctr_cmp, align 4
  %14 = load ptr, ptr %ssl.addr, align 8
  %cur_out_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 50
  %arraydecay7 = getelementptr inbounds [8 x i8], ptr %cur_out_ctr, i64 0, i64 0
  %15 = load i64, ptr %ep_len, align 8
  %add.ptr8 = getelementptr inbounds i8, ptr %arraydecay7, i64 %15
  %16 = load ptr, ptr %ssl.addr, align 8
  %conf9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 0
  %17 = load ptr, ptr %conf9, align 8
  %renego_period10 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %17, i32 0, i32 39
  %arraydecay11 = getelementptr inbounds [8 x i8], ptr %renego_period10, i64 0, i64 0
  %18 = load i64, ptr %ep_len, align 8
  %add.ptr12 = getelementptr inbounds i8, ptr %arraydecay11, i64 %18
  %19 = load i64, ptr %ep_len, align 8
  %sub13 = sub i64 8, %19
  %call14 = call i32 @memcmp(ptr noundef %add.ptr8, ptr noundef %add.ptr12, i64 noundef %sub13) #7
  store i32 %call14, ptr %out_ctr_cmp, align 4
  %20 = load i32, ptr %in_ctr_cmp, align 4
  %cmp15 = icmp sle i32 %20, 0
  br i1 %cmp15, label %land.lhs.true, label %if.end18

land.lhs.true:                                    ; preds = %if.end
  %21 = load i32, ptr %out_ctr_cmp, align 4
  %cmp16 = icmp sle i32 %21, 0
  br i1 %cmp16, label %if.then17, label %if.end18

if.then17:                                        ; preds = %land.lhs.true
  store i32 0, ptr %retval, align 4
  br label %return

if.end18:                                         ; preds = %land.lhs.true, %if.end
  %22 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %22, i32 noundef 1, ptr noundef @.str, i32 noundef 8254, ptr noundef @.str.305)
  %23 = load ptr, ptr %ssl.addr, align 8
  %call19 = call i32 @mbedtls_ssl_renegotiate(ptr noundef %23)
  store i32 %call19, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end18, %if.then17, %if.then
  %24 = load i32, ptr %retval, align 4
  ret i32 %24
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_write(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 8682, ptr noundef @.str.158)
  %1 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %1, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 0
  %3 = load ptr, ptr %conf, align 8
  %cmp1 = icmp eq ptr %3, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %4 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_check_ctr_renegotiate(ptr noundef %4)
  store i32 %call, ptr %ret, align 4
  %cmp2 = icmp ne i32 %call, 0
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %6 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %5, i32 noundef 1, ptr noundef @.str, i32 noundef 8690, ptr noundef @.str.149, i32 noundef %6)
  %7 = load i32, ptr %ret, align 4
  store i32 %7, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 1
  %9 = load i32, ptr %state, align 8
  %cmp5 = icmp ne i32 %9, 16
  br i1 %cmp5, label %if.then6, label %if.end11

if.then6:                                         ; preds = %if.end4
  %10 = load ptr, ptr %ssl.addr, align 8
  %call7 = call i32 @mbedtls_ssl_handshake(ptr noundef %10)
  store i32 %call7, ptr %ret, align 4
  %cmp8 = icmp ne i32 %call7, 0
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %if.then6
  %11 = load ptr, ptr %ssl.addr, align 8
  %12 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %11, i32 noundef 1, ptr noundef @.str, i32 noundef 8699, ptr noundef @.str.147, i32 noundef %12)
  %13 = load i32, ptr %ret, align 4
  store i32 %13, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.then6
  br label %if.end11

if.end11:                                         ; preds = %if.end10, %if.end4
  %14 = load ptr, ptr %ssl.addr, align 8
  %15 = load ptr, ptr %buf.addr, align 8
  %16 = load i64, ptr %len.addr, align 8
  %call12 = call i32 @ssl_write_split(ptr noundef %14, ptr noundef %15, i64 noundef %16)
  store i32 %call12, ptr %ret, align 4
  %17 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %17, i32 noundef 2, ptr noundef @.str, i32 noundef 8710, ptr noundef @.str.159)
  %18 = load i32, ptr %ret, align 4
  store i32 %18, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end11, %if.then9, %if.then3, %if.then
  %19 = load i32, ptr %retval, align 4
  ret i32 %19
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_write_split(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %cbc_record_splitting = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 46
  %bf.load = load i32, ptr %cbc_record_splitting, align 4
  %bf.lshr = lshr i32 %bf.load, 13
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp eq i32 %bf.clear, 0
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %2 = load i64, ptr %len.addr, align 8
  %cmp1 = icmp ule i64 %2, 1
  br i1 %cmp1, label %if.then, label %lor.lhs.false2

lor.lhs.false2:                                   ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 5
  %4 = load i32, ptr %minor_ver, align 8
  %cmp3 = icmp sgt i32 %4, 1
  br i1 %cmp3, label %if.then, label %lor.lhs.false4

lor.lhs.false4:                                   ; preds = %lor.lhs.false2
  %5 = load ptr, ptr %ssl.addr, align 8
  %transform_out = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 17
  %6 = load ptr, ptr %transform_out, align 8
  %cipher_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %6, i32 0, i32 10
  %call = call i32 @mbedtls_cipher_get_cipher_mode(ptr noundef %cipher_ctx_enc)
  %cmp5 = icmp ne i32 %call, 2
  br i1 %cmp5, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false4, %lor.lhs.false2, %lor.lhs.false, %entry
  %7 = load ptr, ptr %ssl.addr, align 8
  %8 = load ptr, ptr %buf.addr, align 8
  %9 = load i64, ptr %len.addr, align 8
  %call6 = call i32 @ssl_write_real(ptr noundef %7, ptr noundef %8, i64 noundef %9)
  store i32 %call6, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false4
  %10 = load ptr, ptr %ssl.addr, align 8
  %split_done = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 52
  %11 = load i8, ptr %split_done, align 2
  %conv = sext i8 %11 to i32
  %cmp7 = icmp eq i32 %conv, 0
  br i1 %cmp7, label %if.then9, label %if.end16

if.then9:                                         ; preds = %if.end
  %12 = load ptr, ptr %ssl.addr, align 8
  %13 = load ptr, ptr %buf.addr, align 8
  %call10 = call i32 @ssl_write_real(ptr noundef %12, ptr noundef %13, i64 noundef 1)
  store i32 %call10, ptr %ret, align 4
  %cmp11 = icmp sle i32 %call10, 0
  br i1 %cmp11, label %if.then13, label %if.end14

if.then13:                                        ; preds = %if.then9
  %14 = load i32, ptr %ret, align 4
  store i32 %14, ptr %retval, align 4
  br label %return

if.end14:                                         ; preds = %if.then9
  %15 = load ptr, ptr %ssl.addr, align 8
  %split_done15 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 52
  store i8 1, ptr %split_done15, align 2
  br label %if.end16

if.end16:                                         ; preds = %if.end14, %if.end
  %16 = load ptr, ptr %ssl.addr, align 8
  %17 = load ptr, ptr %buf.addr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %17, i64 1
  %18 = load i64, ptr %len.addr, align 8
  %sub = sub i64 %18, 1
  %call17 = call i32 @ssl_write_real(ptr noundef %16, ptr noundef %add.ptr, i64 noundef %sub)
  store i32 %call17, ptr %ret, align 4
  %cmp18 = icmp sle i32 %call17, 0
  br i1 %cmp18, label %if.then20, label %if.end21

if.then20:                                        ; preds = %if.end16
  %19 = load i32, ptr %ret, align 4
  store i32 %19, ptr %retval, align 4
  br label %return

if.end21:                                         ; preds = %if.end16
  %20 = load ptr, ptr %ssl.addr, align 8
  %split_done22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 52
  store i8 0, ptr %split_done22, align 2
  %21 = load i32, ptr %ret, align 4
  %add = add nsw i32 %21, 1
  store i32 %add, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end21, %if.then20, %if.then13, %if.then
  %22 = load i32, ptr %retval, align 4
  ret i32 %22
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_close_notify(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 0
  %2 = load ptr, ptr %conf, align 8
  %cmp1 = icmp eq ptr %2, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %3 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %3, i32 noundef 2, ptr noundef @.str, i32 noundef 8725, ptr noundef @.str.160)
  %4 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 49
  %5 = load i64, ptr %out_left, align 8
  %cmp2 = icmp ne i64 %5, 0
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_flush_output(ptr noundef %6)
  store i32 %call, ptr %retval, align 4
  br label %return

if.end4:                                          ; preds = %if.end
  %7 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 1
  %8 = load i32, ptr %state, align 8
  %cmp5 = icmp eq i32 %8, 16
  br i1 %cmp5, label %if.then6, label %if.end11

if.then6:                                         ; preds = %if.end4
  %9 = load ptr, ptr %ssl.addr, align 8
  %call7 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %9, i8 noundef zeroext 1, i8 noundef zeroext 0)
  store i32 %call7, ptr %ret, align 4
  %cmp8 = icmp ne i32 %call7, 0
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %if.then6
  %10 = load ptr, ptr %ssl.addr, align 8
  %11 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %10, i32 noundef 1, ptr noundef @.str, i32 noundef 8736, ptr noundef @.str.161, i32 noundef %11)
  %12 = load i32, ptr %ret, align 4
  store i32 %12, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.then6
  br label %if.end11

if.end11:                                         ; preds = %if.end10, %if.end4
  %13 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %13, i32 noundef 2, ptr noundef @.str, i32 noundef 8741, ptr noundef @.str.162)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end11, %if.then9, %if.then3, %if.then
  %14 = load i32, ptr %retval, align 4
  ret i32 %14
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_transform_free(ptr noundef %transform) #0 {
entry:
  %transform.addr = alloca ptr, align 8
  store ptr %transform, ptr %transform.addr, align 8
  %0 = load ptr, ptr %transform.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %return

if.end:                                           ; preds = %entry
  %1 = load ptr, ptr %transform.addr, align 8
  %cipher_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %1, i32 0, i32 10
  call void @mbedtls_cipher_free(ptr noundef %cipher_ctx_enc)
  %2 = load ptr, ptr %transform.addr, align 8
  %cipher_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %2, i32 0, i32 11
  call void @mbedtls_cipher_free(ptr noundef %cipher_ctx_dec)
  %3 = load ptr, ptr %transform.addr, align 8
  %md_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %3, i32 0, i32 8
  call void @mbedtls_md_free(ptr noundef %md_ctx_enc)
  %4 = load ptr, ptr %transform.addr, align 8
  %md_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %4, i32 0, i32 9
  call void @mbedtls_md_free(ptr noundef %md_ctx_dec)
  %5 = load ptr, ptr %transform.addr, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %5, i64 noundef 304)
  br label %return

return:                                           ; preds = %if.end, %if.then
  ret void
}

declare void @mbedtls_cipher_free(ptr noundef) #1

declare void @mbedtls_md_free(ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_handshake_free(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %handshake = alloca ptr, align 8
  %cur = alloca ptr, align 8
  %next = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake1, align 8
  store ptr %1, ptr %handshake, align 8
  %2 = load ptr, ptr %handshake, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %handshake, align 8
  %fin_md5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 25
  call void @mbedtls_md5_free(ptr noundef %fin_md5)
  %4 = load ptr, ptr %handshake, align 8
  %fin_sha1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 26
  call void @mbedtls_sha1_free(ptr noundef %fin_sha1)
  %5 = load ptr, ptr %handshake, align 8
  %fin_sha256 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 27
  call void @mbedtls_sha256_free(ptr noundef %fin_sha256)
  %6 = load ptr, ptr %handshake, align 8
  %fin_sha512 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 28
  call void @mbedtls_sha512_free(ptr noundef %fin_sha512)
  %7 = load ptr, ptr %handshake, align 8
  %dhm_ctx = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 1
  call void @mbedtls_dhm_free(ptr noundef %dhm_ctx)
  %8 = load ptr, ptr %handshake, align 8
  %ecdh_ctx = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 2
  call void @mbedtls_ecdh_free(ptr noundef %ecdh_ctx)
  %9 = load ptr, ptr %handshake, align 8
  %curves = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 3
  %10 = load ptr, ptr %curves, align 8
  call void @free(ptr noundef %10) #8
  %11 = load ptr, ptr %handshake, align 8
  %psk = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 4
  %12 = load ptr, ptr %psk, align 8
  %cmp2 = icmp ne ptr %12, null
  br i1 %cmp2, label %if.then3, label %if.end6

if.then3:                                         ; preds = %if.end
  %13 = load ptr, ptr %handshake, align 8
  %psk4 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %13, i32 0, i32 4
  %14 = load ptr, ptr %psk4, align 8
  %15 = load ptr, ptr %handshake, align 8
  %psk_len = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %15, i32 0, i32 5
  %16 = load i64, ptr %psk_len, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %14, i64 noundef %16)
  %17 = load ptr, ptr %handshake, align 8
  %psk5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %17, i32 0, i32 4
  %18 = load ptr, ptr %psk5, align 8
  call void @free(ptr noundef %18) #8
  br label %if.end6

if.end6:                                          ; preds = %if.then3, %if.end
  %19 = load ptr, ptr %handshake, align 8
  %sni_key_cert = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %19, i32 0, i32 8
  %20 = load ptr, ptr %sni_key_cert, align 8
  %cmp7 = icmp ne ptr %20, null
  br i1 %cmp7, label %if.then8, label %if.end12

if.then8:                                         ; preds = %if.end6
  %21 = load ptr, ptr %handshake, align 8
  %sni_key_cert9 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %21, i32 0, i32 8
  %22 = load ptr, ptr %sni_key_cert9, align 8
  store ptr %22, ptr %cur, align 8
  br label %while.cond

while.cond:                                       ; preds = %while.body, %if.then8
  %23 = load ptr, ptr %cur, align 8
  %cmp10 = icmp ne ptr %23, null
  br i1 %cmp10, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %24 = load ptr, ptr %cur, align 8
  %next11 = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %24, i32 0, i32 2
  %25 = load ptr, ptr %next11, align 8
  store ptr %25, ptr %next, align 8
  %26 = load ptr, ptr %cur, align 8
  call void @free(ptr noundef %26) #8
  %27 = load ptr, ptr %next, align 8
  store ptr %27, ptr %cur, align 8
  br label %while.cond, !llvm.loop !32

while.end:                                        ; preds = %while.cond
  br label %if.end12

if.end12:                                         ; preds = %while.end, %if.end6
  %28 = load ptr, ptr %handshake, align 8
  %verify_cookie = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %28, i32 0, i32 13
  %29 = load ptr, ptr %verify_cookie, align 8
  call void @free(ptr noundef %29) #8
  %30 = load ptr, ptr %handshake, align 8
  %flight = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %30, i32 0, i32 17
  %31 = load ptr, ptr %flight, align 8
  call void @ssl_flight_free(ptr noundef %31)
  %32 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_buffering_free(ptr noundef %32)
  %33 = load ptr, ptr %handshake, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %33, i64 noundef 2856)
  br label %return

return:                                           ; preds = %if.end12, %if.then
  ret void
}

declare void @mbedtls_md5_free(ptr noundef) #1

declare void @mbedtls_sha1_free(ptr noundef) #1

declare void @mbedtls_sha256_free(ptr noundef) #1

declare void @mbedtls_sha512_free(ptr noundef) #1

declare void @mbedtls_dhm_free(ptr noundef) #1

declare void @mbedtls_ecdh_free(ptr noundef) #1

declare void @mbedtls_x509_crt_free(ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_free(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %return

if.end:                                           ; preds = %entry
  %1 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %1, i32 noundef 2, ptr noundef @.str, i32 noundef 8934, ptr noundef @.str.163)
  %2 = load ptr, ptr %ssl.addr, align 8
  %out_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 41
  %3 = load ptr, ptr %out_buf, align 8
  %cmp1 = icmp ne ptr %3, null
  br i1 %cmp1, label %if.then2, label %if.end5

if.then2:                                         ; preds = %if.end
  %4 = load ptr, ptr %ssl.addr, align 8
  %out_buf3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 41
  %5 = load ptr, ptr %out_buf3, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %5, i64 noundef 16717)
  %6 = load ptr, ptr %ssl.addr, align 8
  %out_buf4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 41
  %7 = load ptr, ptr %out_buf4, align 8
  call void @free(ptr noundef %7) #8
  br label %if.end5

if.end5:                                          ; preds = %if.then2, %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 23
  %9 = load ptr, ptr %in_buf, align 8
  %cmp6 = icmp ne ptr %9, null
  br i1 %cmp6, label %if.then7, label %if.end10

if.then7:                                         ; preds = %if.end5
  %10 = load ptr, ptr %ssl.addr, align 8
  %in_buf8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 23
  %11 = load ptr, ptr %in_buf8, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %11, i64 noundef 16717)
  %12 = load ptr, ptr %ssl.addr, align 8
  %in_buf9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 23
  %13 = load ptr, ptr %in_buf9, align 8
  call void @free(ptr noundef %13) #8
  br label %if.end10

if.end10:                                         ; preds = %if.then7, %if.end5
  %14 = load ptr, ptr %ssl.addr, align 8
  %transform = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 18
  %15 = load ptr, ptr %transform, align 8
  %tobool = icmp ne ptr %15, null
  br i1 %tobool, label %if.then11, label %if.end14

if.then11:                                        ; preds = %if.end10
  %16 = load ptr, ptr %ssl.addr, align 8
  %transform12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 18
  %17 = load ptr, ptr %transform12, align 8
  call void @mbedtls_ssl_transform_free(ptr noundef %17)
  %18 = load ptr, ptr %ssl.addr, align 8
  %transform13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 18
  %19 = load ptr, ptr %transform13, align 8
  call void @free(ptr noundef %19) #8
  br label %if.end14

if.end14:                                         ; preds = %if.then11, %if.end10
  %20 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 15
  %21 = load ptr, ptr %handshake, align 8
  %tobool15 = icmp ne ptr %21, null
  br i1 %tobool15, label %if.then16, label %if.end20

if.then16:                                        ; preds = %if.end14
  %22 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_ssl_handshake_free(ptr noundef %22)
  %23 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 19
  %24 = load ptr, ptr %transform_negotiate, align 8
  call void @mbedtls_ssl_transform_free(ptr noundef %24)
  %25 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 14
  %26 = load ptr, ptr %session_negotiate, align 8
  call void @mbedtls_ssl_session_free(ptr noundef %26)
  %27 = load ptr, ptr %ssl.addr, align 8
  %handshake17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 15
  %28 = load ptr, ptr %handshake17, align 8
  call void @free(ptr noundef %28) #8
  %29 = load ptr, ptr %ssl.addr, align 8
  %transform_negotiate18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 19
  %30 = load ptr, ptr %transform_negotiate18, align 8
  call void @free(ptr noundef %30) #8
  %31 = load ptr, ptr %ssl.addr, align 8
  %session_negotiate19 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 14
  %32 = load ptr, ptr %session_negotiate19, align 8
  call void @free(ptr noundef %32) #8
  br label %if.end20

if.end20:                                         ; preds = %if.then16, %if.end14
  %33 = load ptr, ptr %ssl.addr, align 8
  %session = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %33, i32 0, i32 13
  %34 = load ptr, ptr %session, align 8
  %tobool21 = icmp ne ptr %34, null
  br i1 %tobool21, label %if.then22, label %if.end25

if.then22:                                        ; preds = %if.end20
  %35 = load ptr, ptr %ssl.addr, align 8
  %session23 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 13
  %36 = load ptr, ptr %session23, align 8
  call void @mbedtls_ssl_session_free(ptr noundef %36)
  %37 = load ptr, ptr %ssl.addr, align 8
  %session24 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %37, i32 0, i32 13
  %38 = load ptr, ptr %session24, align 8
  call void @free(ptr noundef %38) #8
  br label %if.end25

if.end25:                                         ; preds = %if.then22, %if.end20
  %39 = load ptr, ptr %ssl.addr, align 8
  %hostname = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 54
  %40 = load ptr, ptr %hostname, align 8
  %cmp26 = icmp ne ptr %40, null
  br i1 %cmp26, label %if.then27, label %if.end31

if.then27:                                        ; preds = %if.end25
  %41 = load ptr, ptr %ssl.addr, align 8
  %hostname28 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %41, i32 0, i32 54
  %42 = load ptr, ptr %hostname28, align 8
  %43 = load ptr, ptr %ssl.addr, align 8
  %hostname29 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %43, i32 0, i32 54
  %44 = load ptr, ptr %hostname29, align 8
  %call = call i64 @strlen(ptr noundef %44) #7
  call void @mbedtls_platform_zeroize(ptr noundef %42, i64 noundef %call)
  %45 = load ptr, ptr %ssl.addr, align 8
  %hostname30 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %45, i32 0, i32 54
  %46 = load ptr, ptr %hostname30, align 8
  call void @free(ptr noundef %46) #8
  br label %if.end31

if.end31:                                         ; preds = %if.then27, %if.end25
  %47 = load ptr, ptr %ssl.addr, align 8
  %cli_id = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %47, i32 0, i32 56
  %48 = load ptr, ptr %cli_id, align 8
  call void @free(ptr noundef %48) #8
  %49 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %49, i32 noundef 2, ptr noundef @.str, i32 noundef 8999, ptr noundef @.str.164)
  %50 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %50, i64 noundef 456)
  br label %return

return:                                           ; preds = %if.end31, %if.then
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_config_init(ptr noundef %conf) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  call void @llvm.memset.p0.i64(ptr align 8 %0, i8 0, i64 376, i1 false)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_config_defaults(ptr noundef %conf, i32 noundef %endpoint, i32 noundef %transport, i32 noundef %preset) #0 {
entry:
  %retval = alloca i32, align 4
  %conf.addr = alloca ptr, align 8
  %endpoint.addr = alloca i32, align 4
  %transport.addr = alloca i32, align 4
  %preset.addr = alloca i32, align 4
  %ret = alloca i32, align 4
  %dhm_p = alloca [256 x i8], align 16
  %dhm_g = alloca [1 x i8], align 1
  store ptr %conf, ptr %conf.addr, align 8
  store i32 %endpoint, ptr %endpoint.addr, align 4
  store i32 %transport, ptr %transport.addr, align 4
  store i32 %preset, ptr %preset.addr, align 4
  %0 = load ptr, ptr %conf.addr, align 8
  %1 = load i32, ptr %endpoint.addr, align 4
  call void @mbedtls_ssl_conf_endpoint(ptr noundef %0, i32 noundef %1)
  %2 = load ptr, ptr %conf.addr, align 8
  %3 = load i32, ptr %transport.addr, align 4
  call void @mbedtls_ssl_conf_transport(ptr noundef %2, i32 noundef %3)
  %4 = load i32, ptr %endpoint.addr, align 4
  %cmp = icmp eq i32 %4, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %5 = load ptr, ptr %conf.addr, align 8
  %authmode = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %5, i32 0, i32 46
  %bf.load = load i32, ptr %authmode, align 4
  %bf.clear = and i32 %bf.load, -13
  %bf.set = or i32 %bf.clear, 8
  store i32 %bf.set, ptr %authmode, align 4
  %6 = load ptr, ptr %conf.addr, align 8
  %session_tickets = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %6, i32 0, i32 46
  %bf.load1 = load i32, ptr %session_tickets, align 4
  %bf.clear2 = and i32 %bf.load1, -65537
  %bf.set3 = or i32 %bf.clear2, 65536
  store i32 %bf.set3, ptr %session_tickets, align 4
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %7 = load ptr, ptr %conf.addr, align 8
  %arc4_disabled = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 46
  %bf.load4 = load i32, ptr %arc4_disabled, align 4
  %bf.clear5 = and i32 %bf.load4, -65
  %bf.set6 = or i32 %bf.clear5, 64
  store i32 %bf.set6, ptr %arc4_disabled, align 4
  %8 = load ptr, ptr %conf.addr, align 8
  %encrypt_then_mac = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %8, i32 0, i32 46
  %bf.load7 = load i32, ptr %encrypt_then_mac, align 4
  %bf.clear8 = and i32 %bf.load7, -1025
  %bf.set9 = or i32 %bf.clear8, 1024
  store i32 %bf.set9, ptr %encrypt_then_mac, align 4
  %9 = load ptr, ptr %conf.addr, align 8
  %extended_ms = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %9, i32 0, i32 46
  %bf.load10 = load i32, ptr %extended_ms, align 4
  %bf.clear11 = and i32 %bf.load10, -2049
  %bf.set12 = or i32 %bf.clear11, 2048
  store i32 %bf.set12, ptr %extended_ms, align 4
  %10 = load ptr, ptr %conf.addr, align 8
  %cbc_record_splitting = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %10, i32 0, i32 46
  %bf.load13 = load i32, ptr %cbc_record_splitting, align 4
  %bf.clear14 = and i32 %bf.load13, -8193
  %bf.set15 = or i32 %bf.clear14, 8192
  store i32 %bf.set15, ptr %cbc_record_splitting, align 4
  %11 = load ptr, ptr %conf.addr, align 8
  %f_cookie_write = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %11, i32 0, i32 14
  store ptr @ssl_cookie_write_dummy, ptr %f_cookie_write, align 8
  %12 = load ptr, ptr %conf.addr, align 8
  %f_cookie_check = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %12, i32 0, i32 15
  store ptr @ssl_cookie_check_dummy, ptr %f_cookie_check, align 8
  %13 = load ptr, ptr %conf.addr, align 8
  %anti_replay = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %13, i32 0, i32 46
  %bf.load16 = load i32, ptr %anti_replay, align 4
  %bf.clear17 = and i32 %bf.load16, -4097
  %bf.set18 = or i32 %bf.clear17, 4096
  store i32 %bf.set18, ptr %anti_replay, align 4
  %14 = load ptr, ptr %conf.addr, align 8
  %cert_req_ca_list = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %14, i32 0, i32 46
  %bf.load19 = load i32, ptr %cert_req_ca_list, align 4
  %bf.clear20 = and i32 %bf.load19, -262145
  %bf.set21 = or i32 %bf.clear20, 262144
  store i32 %bf.set21, ptr %cert_req_ca_list, align 4
  %15 = load ptr, ptr %conf.addr, align 8
  %hs_timeout_min = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %15, i32 0, i32 36
  store i32 1000, ptr %hs_timeout_min, align 4
  %16 = load ptr, ptr %conf.addr, align 8
  %hs_timeout_max = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %16, i32 0, i32 37
  store i32 60000, ptr %hs_timeout_max, align 8
  %17 = load ptr, ptr %conf.addr, align 8
  %renego_max_records = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %17, i32 0, i32 38
  store i32 16, ptr %renego_max_records, align 4
  %18 = load ptr, ptr %conf.addr, align 8
  %renego_period = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %18, i32 0, i32 39
  %arraydecay = getelementptr inbounds [8 x i8], ptr %renego_period, i64 0, i64 0
  call void @llvm.memset.p0.i64(ptr align 8 %arraydecay, i8 0, i64 2, i1 false)
  %19 = load ptr, ptr %conf.addr, align 8
  %renego_period22 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %19, i32 0, i32 39
  %arraydecay23 = getelementptr inbounds [8 x i8], ptr %renego_period22, i64 0, i64 0
  %add.ptr = getelementptr inbounds i8, ptr %arraydecay23, i64 2
  call void @llvm.memset.p0.i64(ptr align 1 %add.ptr, i8 -1, i64 6, i1 false)
  %20 = load i32, ptr %endpoint.addr, align 4
  %cmp24 = icmp eq i32 %20, 1
  br i1 %cmp24, label %if.then25, label %if.end31

if.then25:                                        ; preds = %if.end
  call void @llvm.memcpy.p0.p0.i64(ptr align 16 %dhm_p, ptr align 16 @__const.mbedtls_ssl_config_defaults.dhm_p, i64 256, i1 false)
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %dhm_g, ptr align 1 @__const.mbedtls_ssl_config_defaults.dhm_g, i64 1, i1 false)
  %21 = load ptr, ptr %conf.addr, align 8
  %arraydecay26 = getelementptr inbounds [256 x i8], ptr %dhm_p, i64 0, i64 0
  %arraydecay27 = getelementptr inbounds [1 x i8], ptr %dhm_g, i64 0, i64 0
  %call = call i32 @mbedtls_ssl_conf_dh_param_bin(ptr noundef %21, ptr noundef %arraydecay26, i64 noundef 256, ptr noundef %arraydecay27, i64 noundef 1)
  store i32 %call, ptr %ret, align 4
  %cmp28 = icmp ne i32 %call, 0
  br i1 %cmp28, label %if.then29, label %if.end30

if.then29:                                        ; preds = %if.then25
  %22 = load i32, ptr %ret, align 4
  store i32 %22, ptr %retval, align 4
  br label %return

if.end30:                                         ; preds = %if.then25
  br label %if.end31

if.end31:                                         ; preds = %if.end30, %if.end
  %23 = load i32, ptr %preset.addr, align 4
  switch i32 %23, label %sw.default [
    i32 2, label %sw.bb
  ]

sw.bb:                                            ; preds = %if.end31
  %24 = load ptr, ptr %conf.addr, align 8
  %min_major_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %24, i32 0, i32 44
  store i8 3, ptr %min_major_ver, align 2
  %25 = load ptr, ptr %conf.addr, align 8
  %min_minor_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %25, i32 0, i32 45
  store i8 3, ptr %min_minor_ver, align 1
  %26 = load ptr, ptr %conf.addr, align 8
  %max_major_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %26, i32 0, i32 42
  store i8 3, ptr %max_major_ver, align 8
  %27 = load ptr, ptr %conf.addr, align 8
  %max_minor_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %27, i32 0, i32 43
  store i8 3, ptr %max_minor_ver, align 1
  %28 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %28, i32 0, i32 0
  %arrayidx = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list, i64 0, i64 3
  store ptr @ssl_preset_suiteb_ciphersuites, ptr %arrayidx, align 8
  %29 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list32 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %29, i32 0, i32 0
  %arrayidx33 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list32, i64 0, i64 2
  store ptr @ssl_preset_suiteb_ciphersuites, ptr %arrayidx33, align 8
  %30 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list34 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %30, i32 0, i32 0
  %arrayidx35 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list34, i64 0, i64 1
  store ptr @ssl_preset_suiteb_ciphersuites, ptr %arrayidx35, align 8
  %31 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list36 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %31, i32 0, i32 0
  %arrayidx37 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list36, i64 0, i64 0
  store ptr @ssl_preset_suiteb_ciphersuites, ptr %arrayidx37, align 8
  %32 = load ptr, ptr %conf.addr, align 8
  %cert_profile = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %32, i32 0, i32 22
  store ptr @mbedtls_x509_crt_profile_suiteb, ptr %cert_profile, align 8
  %33 = load ptr, ptr %conf.addr, align 8
  %sig_hashes = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %33, i32 0, i32 26
  store ptr @ssl_preset_suiteb_hashes, ptr %sig_hashes, align 8
  %34 = load ptr, ptr %conf.addr, align 8
  %curve_list = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %34, i32 0, i32 27
  store ptr @ssl_preset_suiteb_curves, ptr %curve_list, align 8
  br label %sw.epilog

sw.default:                                       ; preds = %if.end31
  %35 = load ptr, ptr %conf.addr, align 8
  %min_major_ver38 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %35, i32 0, i32 44
  store i8 3, ptr %min_major_ver38, align 2
  %36 = load ptr, ptr %conf.addr, align 8
  %min_minor_ver39 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %36, i32 0, i32 45
  store i8 1, ptr %min_minor_ver39, align 1
  %37 = load ptr, ptr %conf.addr, align 8
  %max_major_ver40 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %37, i32 0, i32 42
  store i8 3, ptr %max_major_ver40, align 8
  %38 = load ptr, ptr %conf.addr, align 8
  %max_minor_ver41 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %38, i32 0, i32 43
  store i8 3, ptr %max_minor_ver41, align 1
  %39 = load i32, ptr %transport.addr, align 4
  %cmp42 = icmp eq i32 %39, 1
  br i1 %cmp42, label %if.then43, label %if.end45

if.then43:                                        ; preds = %sw.default
  %40 = load ptr, ptr %conf.addr, align 8
  %min_minor_ver44 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %40, i32 0, i32 45
  store i8 2, ptr %min_minor_ver44, align 1
  br label %if.end45

if.end45:                                         ; preds = %if.then43, %sw.default
  %call46 = call ptr @mbedtls_ssl_list_ciphersuites()
  %41 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list47 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %41, i32 0, i32 0
  %arrayidx48 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list47, i64 0, i64 3
  store ptr %call46, ptr %arrayidx48, align 8
  %42 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list49 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %42, i32 0, i32 0
  %arrayidx50 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list49, i64 0, i64 2
  store ptr %call46, ptr %arrayidx50, align 8
  %43 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list51 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %43, i32 0, i32 0
  %arrayidx52 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list51, i64 0, i64 1
  store ptr %call46, ptr %arrayidx52, align 8
  %44 = load ptr, ptr %conf.addr, align 8
  %ciphersuite_list53 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %44, i32 0, i32 0
  %arrayidx54 = getelementptr inbounds [4 x ptr], ptr %ciphersuite_list53, i64 0, i64 0
  store ptr %call46, ptr %arrayidx54, align 8
  %45 = load ptr, ptr %conf.addr, align 8
  %cert_profile55 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %45, i32 0, i32 22
  store ptr @mbedtls_x509_crt_profile_default, ptr %cert_profile55, align 8
  %46 = load ptr, ptr %conf.addr, align 8
  %sig_hashes56 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %46, i32 0, i32 26
  store ptr @ssl_preset_default_hashes, ptr %sig_hashes56, align 8
  %call57 = call ptr @mbedtls_ecp_grp_id_list()
  %47 = load ptr, ptr %conf.addr, align 8
  %curve_list58 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %47, i32 0, i32 27
  store ptr %call57, ptr %curve_list58, align 8
  %48 = load ptr, ptr %conf.addr, align 8
  %dhm_min_bitlen = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %48, i32 0, i32 41
  store i32 1024, ptr %dhm_min_bitlen, align 4
  br label %sw.epilog

sw.epilog:                                        ; preds = %if.end45, %sw.bb
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %sw.epilog, %if.then29
  %49 = load i32, ptr %retval, align 4
  ret i32 %49
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_cookie_write_dummy(ptr noundef %ctx, ptr noundef %p, ptr noundef %end, ptr noundef %cli_id, i64 noundef %cli_id_len) #0 {
entry:
  %ctx.addr = alloca ptr, align 8
  %p.addr = alloca ptr, align 8
  %end.addr = alloca ptr, align 8
  %cli_id.addr = alloca ptr, align 8
  %cli_id_len.addr = alloca i64, align 8
  store ptr %ctx, ptr %ctx.addr, align 8
  store ptr %p, ptr %p.addr, align 8
  store ptr %end, ptr %end.addr, align 8
  store ptr %cli_id, ptr %cli_id.addr, align 8
  store i64 %cli_id_len, ptr %cli_id_len.addr, align 8
  %0 = load ptr, ptr %ctx.addr, align 8
  %1 = load ptr, ptr %p.addr, align 8
  %2 = load ptr, ptr %end.addr, align 8
  %3 = load ptr, ptr %cli_id.addr, align 8
  %4 = load i64, ptr %cli_id_len.addr, align 8
  ret i32 -28800
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_cookie_check_dummy(ptr noundef %ctx, ptr noundef %cookie, i64 noundef %cookie_len, ptr noundef %cli_id, i64 noundef %cli_id_len) #0 {
entry:
  %ctx.addr = alloca ptr, align 8
  %cookie.addr = alloca ptr, align 8
  %cookie_len.addr = alloca i64, align 8
  %cli_id.addr = alloca ptr, align 8
  %cli_id_len.addr = alloca i64, align 8
  store ptr %ctx, ptr %ctx.addr, align 8
  store ptr %cookie, ptr %cookie.addr, align 8
  store i64 %cookie_len, ptr %cookie_len.addr, align 8
  store ptr %cli_id, ptr %cli_id.addr, align 8
  store i64 %cli_id_len, ptr %cli_id_len.addr, align 8
  %0 = load ptr, ptr %ctx.addr, align 8
  %1 = load ptr, ptr %cookie.addr, align 8
  %2 = load i64, ptr %cookie_len.addr, align 8
  %3 = load ptr, ptr %cli_id.addr, align 8
  %4 = load i64, ptr %cli_id_len.addr, align 8
  ret i32 -28800
}

declare ptr @mbedtls_ssl_list_ciphersuites() #1

declare ptr @mbedtls_ecp_grp_id_list() #1

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_config_free(ptr noundef %conf) #0 {
entry:
  %conf.addr = alloca ptr, align 8
  store ptr %conf, ptr %conf.addr, align 8
  %0 = load ptr, ptr %conf.addr, align 8
  %dhm_P = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %0, i32 0, i32 28
  call void @mbedtls_mpi_free(ptr noundef %dhm_P)
  %1 = load ptr, ptr %conf.addr, align 8
  %dhm_G = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 29
  call void @mbedtls_mpi_free(ptr noundef %dhm_G)
  %2 = load ptr, ptr %conf.addr, align 8
  %psk = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %2, i32 0, i32 30
  %3 = load ptr, ptr %psk, align 8
  %cmp = icmp ne ptr %3, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %4 = load ptr, ptr %conf.addr, align 8
  %psk1 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 30
  %5 = load ptr, ptr %psk1, align 8
  %6 = load ptr, ptr %conf.addr, align 8
  %psk_len = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %6, i32 0, i32 31
  %7 = load i64, ptr %psk_len, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %5, i64 noundef %7)
  %8 = load ptr, ptr %conf.addr, align 8
  %psk2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %8, i32 0, i32 30
  %9 = load ptr, ptr %psk2, align 8
  call void @free(ptr noundef %9) #8
  %10 = load ptr, ptr %conf.addr, align 8
  %psk3 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %10, i32 0, i32 30
  store ptr null, ptr %psk3, align 8
  %11 = load ptr, ptr %conf.addr, align 8
  %psk_len4 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %11, i32 0, i32 31
  store i64 0, ptr %psk_len4, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %12 = load ptr, ptr %conf.addr, align 8
  %psk_identity = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %12, i32 0, i32 32
  %13 = load ptr, ptr %psk_identity, align 8
  %cmp5 = icmp ne ptr %13, null
  br i1 %cmp5, label %if.then6, label %if.end11

if.then6:                                         ; preds = %if.end
  %14 = load ptr, ptr %conf.addr, align 8
  %psk_identity7 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %14, i32 0, i32 32
  %15 = load ptr, ptr %psk_identity7, align 8
  %16 = load ptr, ptr %conf.addr, align 8
  %psk_identity_len = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %16, i32 0, i32 33
  %17 = load i64, ptr %psk_identity_len, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %15, i64 noundef %17)
  %18 = load ptr, ptr %conf.addr, align 8
  %psk_identity8 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %18, i32 0, i32 32
  %19 = load ptr, ptr %psk_identity8, align 8
  call void @free(ptr noundef %19) #8
  %20 = load ptr, ptr %conf.addr, align 8
  %psk_identity9 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %20, i32 0, i32 32
  store ptr null, ptr %psk_identity9, align 8
  %21 = load ptr, ptr %conf.addr, align 8
  %psk_identity_len10 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %21, i32 0, i32 33
  store i64 0, ptr %psk_identity_len10, align 8
  br label %if.end11

if.end11:                                         ; preds = %if.then6, %if.end
  %22 = load ptr, ptr %conf.addr, align 8
  %key_cert = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %22, i32 0, i32 23
  %23 = load ptr, ptr %key_cert, align 8
  call void @ssl_key_cert_free(ptr noundef %23)
  %24 = load ptr, ptr %conf.addr, align 8
  call void @mbedtls_platform_zeroize(ptr noundef %24, i64 noundef 376)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_key_cert_free(ptr noundef %key_cert) #0 {
entry:
  %key_cert.addr = alloca ptr, align 8
  %cur = alloca ptr, align 8
  %next = alloca ptr, align 8
  store ptr %key_cert, ptr %key_cert.addr, align 8
  %0 = load ptr, ptr %key_cert.addr, align 8
  store ptr %0, ptr %cur, align 8
  br label %while.cond

while.cond:                                       ; preds = %while.body, %entry
  %1 = load ptr, ptr %cur, align 8
  %cmp = icmp ne ptr %1, null
  br i1 %cmp, label %while.body, label %while.end

while.body:                                       ; preds = %while.cond
  %2 = load ptr, ptr %cur, align 8
  %next1 = getelementptr inbounds %struct.mbedtls_ssl_key_cert, ptr %2, i32 0, i32 2
  %3 = load ptr, ptr %next1, align 8
  store ptr %3, ptr %next, align 8
  %4 = load ptr, ptr %cur, align 8
  call void @free(ptr noundef %4) #8
  %5 = load ptr, ptr %next, align 8
  store ptr %5, ptr %cur, align 8
  br label %while.cond, !llvm.loop !33

while.end:                                        ; preds = %while.cond
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define zeroext i8 @mbedtls_ssl_sig_from_pk(ptr noundef %pk) #0 {
entry:
  %retval = alloca i8, align 1
  %pk.addr = alloca ptr, align 8
  store ptr %pk, ptr %pk.addr, align 8
  %0 = load ptr, ptr %pk.addr, align 8
  %call = call i32 @mbedtls_pk_can_do(ptr noundef %0, i32 noundef 1)
  %tobool = icmp ne i32 %call, 0
  br i1 %tobool, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i8 1, ptr %retval, align 1
  br label %return

if.end:                                           ; preds = %entry
  %1 = load ptr, ptr %pk.addr, align 8
  %call1 = call i32 @mbedtls_pk_can_do(ptr noundef %1, i32 noundef 4)
  %tobool2 = icmp ne i32 %call1, 0
  br i1 %tobool2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  store i8 3, ptr %retval, align 1
  br label %return

if.end4:                                          ; preds = %if.end
  store i8 0, ptr %retval, align 1
  br label %return

return:                                           ; preds = %if.end4, %if.then3, %if.then
  %2 = load i8, ptr %retval, align 1
  ret i8 %2
}

; Function Attrs: noinline nounwind optnone uwtable
define zeroext i8 @mbedtls_ssl_sig_from_pk_alg(i32 noundef %type) #0 {
entry:
  %retval = alloca i8, align 1
  %type.addr = alloca i32, align 4
  store i32 %type, ptr %type.addr, align 4
  %0 = load i32, ptr %type.addr, align 4
  switch i32 %0, label %sw.default [
    i32 1, label %sw.bb
    i32 4, label %sw.bb1
    i32 2, label %sw.bb1
  ]

sw.bb:                                            ; preds = %entry
  store i8 1, ptr %retval, align 1
  br label %return

sw.bb1:                                           ; preds = %entry, %entry
  store i8 3, ptr %retval, align 1
  br label %return

sw.default:                                       ; preds = %entry
  store i8 0, ptr %retval, align 1
  br label %return

return:                                           ; preds = %sw.default, %sw.bb1, %sw.bb
  %1 = load i8, ptr %retval, align 1
  ret i8 %1
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_pk_alg_from_sig(i8 noundef zeroext %sig) #0 {
entry:
  %retval = alloca i32, align 4
  %sig.addr = alloca i8, align 1
  store i8 %sig, ptr %sig.addr, align 1
  %0 = load i8, ptr %sig.addr, align 1
  %conv = zext i8 %0 to i32
  switch i32 %conv, label %sw.default [
    i32 1, label %sw.bb
    i32 3, label %sw.bb1
  ]

sw.bb:                                            ; preds = %entry
  store i32 1, ptr %retval, align 4
  br label %return

sw.bb1:                                           ; preds = %entry
  store i32 4, ptr %retval, align 4
  br label %return

sw.default:                                       ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %sw.default, %sw.bb1, %sw.bb
  %1 = load i32, ptr %retval, align 4
  ret i32 %1
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_sig_hash_set_find(ptr noundef %set, i32 noundef %sig_alg) #0 {
entry:
  %retval = alloca i32, align 4
  %set.addr = alloca ptr, align 8
  %sig_alg.addr = alloca i32, align 4
  store ptr %set, ptr %set.addr, align 8
  store i32 %sig_alg, ptr %sig_alg.addr, align 4
  %0 = load i32, ptr %sig_alg.addr, align 4
  switch i32 %0, label %sw.default [
    i32 1, label %sw.bb
    i32 4, label %sw.bb1
  ]

sw.bb:                                            ; preds = %entry
  %1 = load ptr, ptr %set.addr, align 8
  %rsa = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %1, i32 0, i32 0
  %2 = load i32, ptr %rsa, align 4
  store i32 %2, ptr %retval, align 4
  br label %return

sw.bb1:                                           ; preds = %entry
  %3 = load ptr, ptr %set.addr, align 8
  %ecdsa = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %3, i32 0, i32 1
  %4 = load i32, ptr %ecdsa, align 4
  store i32 %4, ptr %retval, align 4
  br label %return

sw.default:                                       ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %sw.default, %sw.bb1, %sw.bb
  %5 = load i32, ptr %retval, align 4
  ret i32 %5
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_sig_hash_set_add(ptr noundef %set, i32 noundef %sig_alg, i32 noundef %md_alg) #0 {
entry:
  %set.addr = alloca ptr, align 8
  %sig_alg.addr = alloca i32, align 4
  %md_alg.addr = alloca i32, align 4
  store ptr %set, ptr %set.addr, align 8
  store i32 %sig_alg, ptr %sig_alg.addr, align 4
  store i32 %md_alg, ptr %md_alg.addr, align 4
  %0 = load i32, ptr %sig_alg.addr, align 4
  switch i32 %0, label %sw.default [
    i32 1, label %sw.bb
    i32 4, label %sw.bb2
  ]

sw.bb:                                            ; preds = %entry
  %1 = load ptr, ptr %set.addr, align 8
  %rsa = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %1, i32 0, i32 0
  %2 = load i32, ptr %rsa, align 4
  %cmp = icmp eq i32 %2, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %sw.bb
  %3 = load i32, ptr %md_alg.addr, align 4
  %4 = load ptr, ptr %set.addr, align 8
  %rsa1 = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %4, i32 0, i32 0
  store i32 %3, ptr %rsa1, align 4
  br label %if.end

if.end:                                           ; preds = %if.then, %sw.bb
  br label %sw.epilog

sw.bb2:                                           ; preds = %entry
  %5 = load ptr, ptr %set.addr, align 8
  %ecdsa = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %5, i32 0, i32 1
  %6 = load i32, ptr %ecdsa, align 4
  %cmp3 = icmp eq i32 %6, 0
  br i1 %cmp3, label %if.then4, label %if.end6

if.then4:                                         ; preds = %sw.bb2
  %7 = load i32, ptr %md_alg.addr, align 4
  %8 = load ptr, ptr %set.addr, align 8
  %ecdsa5 = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %8, i32 0, i32 1
  store i32 %7, ptr %ecdsa5, align 4
  br label %if.end6

if.end6:                                          ; preds = %if.then4, %sw.bb2
  br label %sw.epilog

sw.default:                                       ; preds = %entry
  br label %sw.epilog

sw.epilog:                                        ; preds = %sw.default, %if.end6, %if.end
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_sig_hash_set_const_hash(ptr noundef %set, i32 noundef %md_alg) #0 {
entry:
  %set.addr = alloca ptr, align 8
  %md_alg.addr = alloca i32, align 4
  store ptr %set, ptr %set.addr, align 8
  store i32 %md_alg, ptr %md_alg.addr, align 4
  %0 = load i32, ptr %md_alg.addr, align 4
  %1 = load ptr, ptr %set.addr, align 8
  %rsa = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %1, i32 0, i32 0
  store i32 %0, ptr %rsa, align 4
  %2 = load i32, ptr %md_alg.addr, align 4
  %3 = load ptr, ptr %set.addr, align 8
  %ecdsa = getelementptr inbounds %struct.mbedtls_ssl_sig_hash_set_t, ptr %3, i32 0, i32 1
  store i32 %2, ptr %ecdsa, align 4
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_md_alg_from_hash(i8 noundef zeroext %hash) #0 {
entry:
  %retval = alloca i32, align 4
  %hash.addr = alloca i8, align 1
  store i8 %hash, ptr %hash.addr, align 1
  %0 = load i8, ptr %hash.addr, align 1
  %conv = zext i8 %0 to i32
  switch i32 %conv, label %sw.default [
    i32 1, label %sw.bb
    i32 2, label %sw.bb1
    i32 3, label %sw.bb2
    i32 4, label %sw.bb3
    i32 5, label %sw.bb4
    i32 6, label %sw.bb5
  ]

sw.bb:                                            ; preds = %entry
  store i32 3, ptr %retval, align 4
  br label %return

sw.bb1:                                           ; preds = %entry
  store i32 4, ptr %retval, align 4
  br label %return

sw.bb2:                                           ; preds = %entry
  store i32 5, ptr %retval, align 4
  br label %return

sw.bb3:                                           ; preds = %entry
  store i32 6, ptr %retval, align 4
  br label %return

sw.bb4:                                           ; preds = %entry
  store i32 7, ptr %retval, align 4
  br label %return

sw.bb5:                                           ; preds = %entry
  store i32 8, ptr %retval, align 4
  br label %return

sw.default:                                       ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %sw.default, %sw.bb5, %sw.bb4, %sw.bb3, %sw.bb2, %sw.bb1, %sw.bb
  %1 = load i32, ptr %retval, align 4
  ret i32 %1
}

; Function Attrs: noinline nounwind optnone uwtable
define zeroext i8 @mbedtls_ssl_hash_from_md_alg(i32 noundef %md) #0 {
entry:
  %retval = alloca i8, align 1
  %md.addr = alloca i32, align 4
  store i32 %md, ptr %md.addr, align 4
  %0 = load i32, ptr %md.addr, align 4
  switch i32 %0, label %sw.default [
    i32 3, label %sw.bb
    i32 4, label %sw.bb1
    i32 5, label %sw.bb2
    i32 6, label %sw.bb3
    i32 7, label %sw.bb4
    i32 8, label %sw.bb5
  ]

sw.bb:                                            ; preds = %entry
  store i8 1, ptr %retval, align 1
  br label %return

sw.bb1:                                           ; preds = %entry
  store i8 2, ptr %retval, align 1
  br label %return

sw.bb2:                                           ; preds = %entry
  store i8 3, ptr %retval, align 1
  br label %return

sw.bb3:                                           ; preds = %entry
  store i8 4, ptr %retval, align 1
  br label %return

sw.bb4:                                           ; preds = %entry
  store i8 5, ptr %retval, align 1
  br label %return

sw.bb5:                                           ; preds = %entry
  store i8 6, ptr %retval, align 1
  br label %return

sw.default:                                       ; preds = %entry
  store i8 0, ptr %retval, align 1
  br label %return

return:                                           ; preds = %sw.default, %sw.bb5, %sw.bb4, %sw.bb3, %sw.bb2, %sw.bb1, %sw.bb
  %1 = load i8, ptr %retval, align 1
  ret i8 %1
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_check_sig_hash(ptr noundef %ssl, i32 noundef %md) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %md.addr = alloca i32, align 4
  %cur = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %md, ptr %md.addr, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %sig_hashes = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 26
  %2 = load ptr, ptr %sig_hashes, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf1, align 8
  %sig_hashes2 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 26
  %5 = load ptr, ptr %sig_hashes2, align 8
  store ptr %5, ptr %cur, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.end
  %6 = load ptr, ptr %cur, align 8
  %7 = load i32, ptr %6, align 4
  %cmp3 = icmp ne i32 %7, 0
  br i1 %cmp3, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %8 = load ptr, ptr %cur, align 8
  %9 = load i32, ptr %8, align 4
  %10 = load i32, ptr %md.addr, align 4
  %cmp4 = icmp eq i32 %9, %10
  br i1 %cmp4, label %if.then5, label %if.end6

if.then5:                                         ; preds = %for.body
  store i32 0, ptr %retval, align 4
  br label %return

if.end6:                                          ; preds = %for.body
  br label %for.inc

for.inc:                                          ; preds = %if.end6
  %11 = load ptr, ptr %cur, align 8
  %incdec.ptr = getelementptr inbounds i32, ptr %11, i32 1
  store ptr %incdec.ptr, ptr %cur, align 8
  br label %for.cond, !llvm.loop !34

for.end:                                          ; preds = %for.cond
  store i32 -1, ptr %retval, align 4
  br label %return

return:                                           ; preds = %for.end, %if.then5, %if.then
  %12 = load i32, ptr %retval, align 4
  ret i32 %12
}

declare i32 @mbedtls_x509_crt_check_key_usage(ptr noundef, i32 noundef) #1

declare i32 @mbedtls_x509_crt_check_extended_key_usage(ptr noundef, ptr noundef, i64 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define void @mbedtls_ssl_read_version(ptr noundef %major, ptr noundef %minor, i32 noundef %transport, ptr noundef %ver) #0 {
entry:
  %major.addr = alloca ptr, align 8
  %minor.addr = alloca ptr, align 8
  %transport.addr = alloca i32, align 4
  %ver.addr = alloca ptr, align 8
  store ptr %major, ptr %major.addr, align 8
  store ptr %minor, ptr %minor.addr, align 8
  store i32 %transport, ptr %transport.addr, align 4
  store ptr %ver, ptr %ver.addr, align 8
  %0 = load i32, ptr %transport.addr, align 4
  %cmp = icmp eq i32 %0, 1
  br i1 %cmp, label %if.then, label %if.else

if.then:                                          ; preds = %entry
  %1 = load ptr, ptr %ver.addr, align 8
  %arrayidx = getelementptr inbounds i8, ptr %1, i64 0
  %2 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %2 to i32
  %sub = sub nsw i32 255, %conv
  %add = add nsw i32 %sub, 2
  %3 = load ptr, ptr %major.addr, align 8
  store i32 %add, ptr %3, align 4
  %4 = load ptr, ptr %ver.addr, align 8
  %arrayidx1 = getelementptr inbounds i8, ptr %4, i64 1
  %5 = load i8, ptr %arrayidx1, align 1
  %conv2 = zext i8 %5 to i32
  %sub3 = sub nsw i32 255, %conv2
  %add4 = add nsw i32 %sub3, 1
  %6 = load ptr, ptr %minor.addr, align 8
  store i32 %add4, ptr %6, align 4
  %7 = load ptr, ptr %minor.addr, align 8
  %8 = load i32, ptr %7, align 4
  %cmp5 = icmp eq i32 %8, 1
  br i1 %cmp5, label %if.then7, label %if.end

if.then7:                                         ; preds = %if.then
  %9 = load ptr, ptr %minor.addr, align 8
  %10 = load i32, ptr %9, align 4
  %inc = add nsw i32 %10, 1
  store i32 %inc, ptr %9, align 4
  br label %if.end

if.end:                                           ; preds = %if.then7, %if.then
  br label %if.end12

if.else:                                          ; preds = %entry
  %11 = load ptr, ptr %ver.addr, align 8
  %arrayidx8 = getelementptr inbounds i8, ptr %11, i64 0
  %12 = load i8, ptr %arrayidx8, align 1
  %conv9 = zext i8 %12 to i32
  %13 = load ptr, ptr %major.addr, align 8
  store i32 %conv9, ptr %13, align 4
  %14 = load ptr, ptr %ver.addr, align 8
  %arrayidx10 = getelementptr inbounds i8, ptr %14, i64 1
  %15 = load i8, ptr %arrayidx10, align 1
  %conv11 = zext i8 %15 to i32
  %16 = load ptr, ptr %minor.addr, align 8
  store i32 %conv11, ptr %16, align 4
  br label %if.end12

if.end12:                                         ; preds = %if.else, %if.end
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_set_calc_verify_md(ptr noundef %ssl, i32 noundef %md) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %md.addr = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 %md, ptr %md.addr, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 5
  %1 = load i32, ptr %minor_ver, align 8
  %cmp = icmp ne i32 %1, 3
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -26112, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %2 = load i32, ptr %md.addr, align 4
  switch i32 %2, label %sw.default [
    i32 1, label %sw.bb
    i32 2, label %sw.bb1
    i32 5, label %sw.bb2
    i32 4, label %sw.bb5
  ]

sw.bb:                                            ; preds = %if.end
  store i32 -26112, ptr %retval, align 4
  br label %return

sw.bb1:                                           ; preds = %if.end
  %3 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 15
  %4 = load ptr, ptr %handshake, align 8
  %calc_verify = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 30
  store ptr @ssl_calc_verify_tls, ptr %calc_verify, align 8
  br label %sw.epilog

sw.bb2:                                           ; preds = %if.end
  %5 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 15
  %6 = load ptr, ptr %handshake3, align 8
  %calc_verify4 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 30
  store ptr @ssl_calc_verify_tls_sha384, ptr %calc_verify4, align 8
  br label %sw.epilog

sw.bb5:                                           ; preds = %if.end
  %7 = load ptr, ptr %ssl.addr, align 8
  %handshake6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 15
  %8 = load ptr, ptr %handshake6, align 8
  %calc_verify7 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 30
  store ptr @ssl_calc_verify_tls_sha256, ptr %calc_verify7, align 8
  br label %sw.epilog

sw.default:                                       ; preds = %if.end
  store i32 -26112, ptr %retval, align 4
  br label %return

sw.epilog:                                        ; preds = %sw.bb5, %sw.bb2, %sw.bb1
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %sw.epilog, %sw.default, %sw.bb, %if.then
  %9 = load i32, ptr %retval, align 4
  ret i32 %9
}

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_get_key_exchange_md_ssl_tls(ptr noundef %ssl, ptr noundef %output, ptr noundef %data, i64 noundef %data_len) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %output.addr = alloca ptr, align 8
  %data.addr = alloca ptr, align 8
  %data_len.addr = alloca i64, align 8
  %ret = alloca i32, align 4
  %mbedtls_md5 = alloca %struct.mbedtls_md5_context, align 4
  %mbedtls_sha1 = alloca %struct.mbedtls_sha1_context, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %output, ptr %output.addr, align 8
  store ptr %data, ptr %data.addr, align 8
  store i64 %data_len, ptr %data_len.addr, align 8
  store i32 0, ptr %ret, align 4
  call void @mbedtls_md5_init(ptr noundef %mbedtls_md5)
  call void @mbedtls_sha1_init(ptr noundef %mbedtls_sha1)
  %call = call i32 @mbedtls_md5_starts_ret(ptr noundef %mbedtls_md5)
  store i32 %call, ptr %ret, align 4
  %cmp = icmp ne i32 %call, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %0 = load ptr, ptr %ssl.addr, align 8
  %1 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %0, i32 noundef 1, ptr noundef @.str, i32 noundef 9674, ptr noundef @.str.167, i32 noundef %1)
  br label %exit

if.end:                                           ; preds = %entry
  %2 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 15
  %3 = load ptr, ptr %handshake, align 8
  %randbytes = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 34
  %arraydecay = getelementptr inbounds [64 x i8], ptr %randbytes, i64 0, i64 0
  %call1 = call i32 @mbedtls_md5_update_ret(ptr noundef %mbedtls_md5, ptr noundef %arraydecay, i64 noundef 64)
  store i32 %call1, ptr %ret, align 4
  %cmp2 = icmp ne i32 %call1, 0
  br i1 %cmp2, label %if.then3, label %if.end4

if.then3:                                         ; preds = %if.end
  %4 = load ptr, ptr %ssl.addr, align 8
  %5 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %4, i32 noundef 1, ptr noundef @.str, i32 noundef 9680, ptr noundef @.str.168, i32 noundef %5)
  br label %exit

if.end4:                                          ; preds = %if.end
  %6 = load ptr, ptr %data.addr, align 8
  %7 = load i64, ptr %data_len.addr, align 8
  %call5 = call i32 @mbedtls_md5_update_ret(ptr noundef %mbedtls_md5, ptr noundef %6, i64 noundef %7)
  store i32 %call5, ptr %ret, align 4
  %cmp6 = icmp ne i32 %call5, 0
  br i1 %cmp6, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end4
  %8 = load ptr, ptr %ssl.addr, align 8
  %9 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %8, i32 noundef 1, ptr noundef @.str, i32 noundef 9685, ptr noundef @.str.168, i32 noundef %9)
  br label %exit

if.end8:                                          ; preds = %if.end4
  %10 = load ptr, ptr %output.addr, align 8
  %call9 = call i32 @mbedtls_md5_finish_ret(ptr noundef %mbedtls_md5, ptr noundef %10)
  store i32 %call9, ptr %ret, align 4
  %cmp10 = icmp ne i32 %call9, 0
  br i1 %cmp10, label %if.then11, label %if.end12

if.then11:                                        ; preds = %if.end8
  %11 = load ptr, ptr %ssl.addr, align 8
  %12 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %11, i32 noundef 1, ptr noundef @.str, i32 noundef 9690, ptr noundef @.str.169, i32 noundef %12)
  br label %exit

if.end12:                                         ; preds = %if.end8
  %call13 = call i32 @mbedtls_sha1_starts_ret(ptr noundef %mbedtls_sha1)
  store i32 %call13, ptr %ret, align 4
  %cmp14 = icmp ne i32 %call13, 0
  br i1 %cmp14, label %if.then15, label %if.end16

if.then15:                                        ; preds = %if.end12
  %13 = load ptr, ptr %ssl.addr, align 8
  %14 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %13, i32 noundef 1, ptr noundef @.str, i32 noundef 9696, ptr noundef @.str.170, i32 noundef %14)
  br label %exit

if.end16:                                         ; preds = %if.end12
  %15 = load ptr, ptr %ssl.addr, align 8
  %handshake17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 15
  %16 = load ptr, ptr %handshake17, align 8
  %randbytes18 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %16, i32 0, i32 34
  %arraydecay19 = getelementptr inbounds [64 x i8], ptr %randbytes18, i64 0, i64 0
  %call20 = call i32 @mbedtls_sha1_update_ret(ptr noundef %mbedtls_sha1, ptr noundef %arraydecay19, i64 noundef 64)
  store i32 %call20, ptr %ret, align 4
  %cmp21 = icmp ne i32 %call20, 0
  br i1 %cmp21, label %if.then22, label %if.end23

if.then22:                                        ; preds = %if.end16
  %17 = load ptr, ptr %ssl.addr, align 8
  %18 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %17, i32 noundef 1, ptr noundef @.str, i32 noundef 9702, ptr noundef @.str.171, i32 noundef %18)
  br label %exit

if.end23:                                         ; preds = %if.end16
  %19 = load ptr, ptr %data.addr, align 8
  %20 = load i64, ptr %data_len.addr, align 8
  %call24 = call i32 @mbedtls_sha1_update_ret(ptr noundef %mbedtls_sha1, ptr noundef %19, i64 noundef %20)
  store i32 %call24, ptr %ret, align 4
  %cmp25 = icmp ne i32 %call24, 0
  br i1 %cmp25, label %if.then26, label %if.end27

if.then26:                                        ; preds = %if.end23
  %21 = load ptr, ptr %ssl.addr, align 8
  %22 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %21, i32 noundef 1, ptr noundef @.str, i32 noundef 9708, ptr noundef @.str.171, i32 noundef %22)
  br label %exit

if.end27:                                         ; preds = %if.end23
  %23 = load ptr, ptr %output.addr, align 8
  %add.ptr = getelementptr inbounds i8, ptr %23, i64 16
  %call28 = call i32 @mbedtls_sha1_finish_ret(ptr noundef %mbedtls_sha1, ptr noundef %add.ptr)
  store i32 %call28, ptr %ret, align 4
  %cmp29 = icmp ne i32 %call28, 0
  br i1 %cmp29, label %if.then30, label %if.end31

if.then30:                                        ; preds = %if.end27
  %24 = load ptr, ptr %ssl.addr, align 8
  %25 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %24, i32 noundef 1, ptr noundef @.str, i32 noundef 9714, ptr noundef @.str.172, i32 noundef %25)
  br label %exit

if.end31:                                         ; preds = %if.end27
  br label %exit

exit:                                             ; preds = %if.end31, %if.then30, %if.then26, %if.then22, %if.then15, %if.then11, %if.then7, %if.then3, %if.then
  call void @mbedtls_md5_free(ptr noundef %mbedtls_md5)
  call void @mbedtls_sha1_free(ptr noundef %mbedtls_sha1)
  %26 = load i32, ptr %ret, align 4
  %cmp32 = icmp ne i32 %26, 0
  br i1 %cmp32, label %if.then33, label %if.end35

if.then33:                                        ; preds = %exit
  %27 = load ptr, ptr %ssl.addr, align 8
  %call34 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %27, i8 noundef zeroext 2, i8 noundef zeroext 80)
  br label %if.end35

if.end35:                                         ; preds = %if.then33, %exit
  %28 = load i32, ptr %ret, align 4
  ret i32 %28
}

declare void @mbedtls_md5_init(ptr noundef) #1

declare void @mbedtls_sha1_init(ptr noundef) #1

declare i32 @mbedtls_md5_update_ret(ptr noundef, ptr noundef, i64 noundef) #1

declare i32 @mbedtls_md5_finish_ret(ptr noundef, ptr noundef) #1

declare i32 @mbedtls_sha1_update_ret(ptr noundef, ptr noundef, i64 noundef) #1

declare i32 @mbedtls_sha1_finish_ret(ptr noundef, ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define i32 @mbedtls_ssl_get_key_exchange_md_tls1_2(ptr noundef %ssl, ptr noundef %hash, ptr noundef %hashlen, ptr noundef %data, i64 noundef %data_len, i32 noundef %md_alg) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %hash.addr = alloca ptr, align 8
  %hashlen.addr = alloca ptr, align 8
  %data.addr = alloca ptr, align 8
  %data_len.addr = alloca i64, align 8
  %md_alg.addr = alloca i32, align 4
  %ret = alloca i32, align 4
  %ctx = alloca %struct.mbedtls_md_context_t, align 8
  %md_info = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %hash, ptr %hash.addr, align 8
  store ptr %hashlen, ptr %hashlen.addr, align 8
  store ptr %data, ptr %data.addr, align 8
  store i64 %data_len, ptr %data_len.addr, align 8
  store i32 %md_alg, ptr %md_alg.addr, align 4
  store i32 0, ptr %ret, align 4
  %0 = load i32, ptr %md_alg.addr, align 4
  %call = call ptr @mbedtls_md_info_from_type(i32 noundef %0)
  store ptr %call, ptr %md_info, align 8
  %1 = load ptr, ptr %md_info, align 8
  %call1 = call zeroext i8 @mbedtls_md_get_size(ptr noundef %1)
  %conv = zext i8 %call1 to i64
  %2 = load ptr, ptr %hashlen.addr, align 8
  store i64 %conv, ptr %2, align 8
  call void @mbedtls_md_init(ptr noundef %ctx)
  %3 = load ptr, ptr %md_info, align 8
  %call2 = call i32 @mbedtls_md_setup(ptr noundef %ctx, ptr noundef %3, i32 noundef 0)
  store i32 %call2, ptr %ret, align 4
  %cmp = icmp ne i32 %call2, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %4 = load ptr, ptr %ssl.addr, align 8
  %5 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %4, i32 noundef 1, ptr noundef @.str, i32 noundef 9755, ptr noundef @.str.16, i32 noundef %5)
  br label %exit

if.end:                                           ; preds = %entry
  %call4 = call i32 @mbedtls_md_starts(ptr noundef %ctx)
  store i32 %call4, ptr %ret, align 4
  %cmp5 = icmp ne i32 %call4, 0
  br i1 %cmp5, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end
  %6 = load ptr, ptr %ssl.addr, align 8
  %7 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %6, i32 noundef 1, ptr noundef @.str, i32 noundef 9760, ptr noundef @.str.173, i32 noundef %7)
  br label %exit

if.end8:                                          ; preds = %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 15
  %9 = load ptr, ptr %handshake, align 8
  %randbytes = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 34
  %arraydecay = getelementptr inbounds [64 x i8], ptr %randbytes, i64 0, i64 0
  %call9 = call i32 @mbedtls_md_update(ptr noundef %ctx, ptr noundef %arraydecay, i64 noundef 64)
  store i32 %call9, ptr %ret, align 4
  %cmp10 = icmp ne i32 %call9, 0
  br i1 %cmp10, label %if.then12, label %if.end13

if.then12:                                        ; preds = %if.end8
  %10 = load ptr, ptr %ssl.addr, align 8
  %11 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %10, i32 noundef 1, ptr noundef @.str, i32 noundef 9765, ptr noundef @.str.174, i32 noundef %11)
  br label %exit

if.end13:                                         ; preds = %if.end8
  %12 = load ptr, ptr %data.addr, align 8
  %13 = load i64, ptr %data_len.addr, align 8
  %call14 = call i32 @mbedtls_md_update(ptr noundef %ctx, ptr noundef %12, i64 noundef %13)
  store i32 %call14, ptr %ret, align 4
  %cmp15 = icmp ne i32 %call14, 0
  br i1 %cmp15, label %if.then17, label %if.end18

if.then17:                                        ; preds = %if.end13
  %14 = load ptr, ptr %ssl.addr, align 8
  %15 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %14, i32 noundef 1, ptr noundef @.str, i32 noundef 9770, ptr noundef @.str.174, i32 noundef %15)
  br label %exit

if.end18:                                         ; preds = %if.end13
  %16 = load ptr, ptr %hash.addr, align 8
  %call19 = call i32 @mbedtls_md_finish(ptr noundef %ctx, ptr noundef %16)
  store i32 %call19, ptr %ret, align 4
  %cmp20 = icmp ne i32 %call19, 0
  br i1 %cmp20, label %if.then22, label %if.end23

if.then22:                                        ; preds = %if.end18
  %17 = load ptr, ptr %ssl.addr, align 8
  %18 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %17, i32 noundef 1, ptr noundef @.str, i32 noundef 9775, ptr noundef @.str.175, i32 noundef %18)
  br label %exit

if.end23:                                         ; preds = %if.end18
  br label %exit

exit:                                             ; preds = %if.end23, %if.then22, %if.then17, %if.then12, %if.then7, %if.then
  call void @mbedtls_md_free(ptr noundef %ctx)
  %19 = load i32, ptr %ret, align 4
  %cmp24 = icmp ne i32 %19, 0
  br i1 %cmp24, label %if.then26, label %if.end28

if.then26:                                        ; preds = %exit
  %20 = load ptr, ptr %ssl.addr, align 8
  %call27 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %20, i8 noundef zeroext 2, i8 noundef zeroext 80)
  br label %if.end28

if.end28:                                         ; preds = %if.then26, %exit
  %21 = load i32, ptr %ret, align 4
  ret i32 %21
}

declare void @mbedtls_md_init(ptr noundef) #1

declare i32 @mbedtls_md_starts(ptr noundef) #1

declare i32 @mbedtls_md_update(ptr noundef, ptr noundef, i64 noundef) #1

declare i32 @mbedtls_md_finish(ptr noundef, ptr noundef) #1

declare i32 @mbedtls_md_hmac_update(ptr noundef, ptr noundef, i64 noundef) #1

declare i32 @mbedtls_md_hmac_finish(ptr noundef, ptr noundef) #1

declare i32 @mbedtls_md_hmac_reset(ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @tls_prf_generic(i32 noundef %md_type, ptr noundef %secret, i64 noundef %slen, ptr noundef %label, ptr noundef %random, i64 noundef %rlen, ptr noundef %dstbuf, i64 noundef %dlen) #0 {
entry:
  %retval = alloca i32, align 4
  %md_type.addr = alloca i32, align 4
  %secret.addr = alloca ptr, align 8
  %slen.addr = alloca i64, align 8
  %label.addr = alloca ptr, align 8
  %random.addr = alloca ptr, align 8
  %rlen.addr = alloca i64, align 8
  %dstbuf.addr = alloca ptr, align 8
  %dlen.addr = alloca i64, align 8
  %nb = alloca i64, align 8
  %i = alloca i64, align 8
  %j = alloca i64, align 8
  %k = alloca i64, align 8
  %md_len = alloca i64, align 8
  %tmp = alloca [128 x i8], align 16
  %h_i = alloca [64 x i8], align 16
  %md_info = alloca ptr, align 8
  %md_ctx = alloca %struct.mbedtls_md_context_t, align 8
  %ret = alloca i32, align 4
  store i32 %md_type, ptr %md_type.addr, align 4
  store ptr %secret, ptr %secret.addr, align 8
  store i64 %slen, ptr %slen.addr, align 8
  store ptr %label, ptr %label.addr, align 8
  store ptr %random, ptr %random.addr, align 8
  store i64 %rlen, ptr %rlen.addr, align 8
  store ptr %dstbuf, ptr %dstbuf.addr, align 8
  store i64 %dlen, ptr %dlen.addr, align 8
  call void @mbedtls_md_init(ptr noundef %md_ctx)
  %0 = load i32, ptr %md_type.addr, align 4
  %call = call ptr @mbedtls_md_info_from_type(i32 noundef %0)
  store ptr %call, ptr %md_info, align 8
  %cmp = icmp eq ptr %call, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %1 = load ptr, ptr %md_info, align 8
  %call1 = call zeroext i8 @mbedtls_md_get_size(ptr noundef %1)
  %conv = zext i8 %call1 to i64
  store i64 %conv, ptr %md_len, align 8
  %2 = load i64, ptr %md_len, align 8
  %3 = load ptr, ptr %label.addr, align 8
  %call2 = call i64 @strlen(ptr noundef %3) #7
  %add = add i64 %2, %call2
  %4 = load i64, ptr %rlen.addr, align 8
  %add3 = add i64 %add, %4
  %cmp4 = icmp ult i64 128, %add3
  br i1 %cmp4, label %if.then6, label %if.end7

if.then6:                                         ; preds = %if.end
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end7:                                          ; preds = %if.end
  %5 = load ptr, ptr %label.addr, align 8
  %call8 = call i64 @strlen(ptr noundef %5) #7
  store i64 %call8, ptr %nb, align 8
  %arraydecay = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %6 = load i64, ptr %md_len, align 8
  %add.ptr = getelementptr inbounds i8, ptr %arraydecay, i64 %6
  %7 = load ptr, ptr %label.addr, align 8
  %8 = load i64, ptr %nb, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr, ptr align 1 %7, i64 %8, i1 false)
  %arraydecay9 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %9 = load i64, ptr %md_len, align 8
  %add.ptr10 = getelementptr inbounds i8, ptr %arraydecay9, i64 %9
  %10 = load i64, ptr %nb, align 8
  %add.ptr11 = getelementptr inbounds i8, ptr %add.ptr10, i64 %10
  %11 = load ptr, ptr %random.addr, align 8
  %12 = load i64, ptr %rlen.addr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr11, ptr align 1 %11, i64 %12, i1 false)
  %13 = load i64, ptr %rlen.addr, align 8
  %14 = load i64, ptr %nb, align 8
  %add12 = add i64 %14, %13
  store i64 %add12, ptr %nb, align 8
  %15 = load ptr, ptr %md_info, align 8
  %call13 = call i32 @mbedtls_md_setup(ptr noundef %md_ctx, ptr noundef %15, i32 noundef 1)
  store i32 %call13, ptr %ret, align 4
  %cmp14 = icmp ne i32 %call13, 0
  br i1 %cmp14, label %if.then16, label %if.end17

if.then16:                                        ; preds = %if.end7
  %16 = load i32, ptr %ret, align 4
  store i32 %16, ptr %retval, align 4
  br label %return

if.end17:                                         ; preds = %if.end7
  %17 = load ptr, ptr %secret.addr, align 8
  %18 = load i64, ptr %slen.addr, align 8
  %call18 = call i32 @mbedtls_md_hmac_starts(ptr noundef %md_ctx, ptr noundef %17, i64 noundef %18)
  %arraydecay19 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %19 = load i64, ptr %md_len, align 8
  %add.ptr20 = getelementptr inbounds i8, ptr %arraydecay19, i64 %19
  %20 = load i64, ptr %nb, align 8
  %call21 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %add.ptr20, i64 noundef %20)
  %arraydecay22 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %call23 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %arraydecay22)
  store i64 0, ptr %i, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc46, %if.end17
  %21 = load i64, ptr %i, align 8
  %22 = load i64, ptr %dlen.addr, align 8
  %cmp24 = icmp ult i64 %21, %22
  br i1 %cmp24, label %for.body, label %for.end48

for.body:                                         ; preds = %for.cond
  %call26 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx)
  %arraydecay27 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %23 = load i64, ptr %md_len, align 8
  %24 = load i64, ptr %nb, align 8
  %add28 = add i64 %23, %24
  %call29 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %arraydecay27, i64 noundef %add28)
  %arraydecay30 = getelementptr inbounds [64 x i8], ptr %h_i, i64 0, i64 0
  %call31 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %arraydecay30)
  %call32 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx)
  %arraydecay33 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %25 = load i64, ptr %md_len, align 8
  %call34 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx, ptr noundef %arraydecay33, i64 noundef %25)
  %arraydecay35 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  %call36 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx, ptr noundef %arraydecay35)
  %26 = load i64, ptr %i, align 8
  %27 = load i64, ptr %md_len, align 8
  %add37 = add i64 %26, %27
  %28 = load i64, ptr %dlen.addr, align 8
  %cmp38 = icmp ugt i64 %add37, %28
  br i1 %cmp38, label %cond.true, label %cond.false

cond.true:                                        ; preds = %for.body
  %29 = load i64, ptr %dlen.addr, align 8
  %30 = load i64, ptr %md_len, align 8
  %rem = urem i64 %29, %30
  br label %cond.end

cond.false:                                       ; preds = %for.body
  %31 = load i64, ptr %md_len, align 8
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond = phi i64 [ %rem, %cond.true ], [ %31, %cond.false ]
  store i64 %cond, ptr %k, align 8
  store i64 0, ptr %j, align 8
  br label %for.cond40

for.cond40:                                       ; preds = %for.inc, %cond.end
  %32 = load i64, ptr %j, align 8
  %33 = load i64, ptr %k, align 8
  %cmp41 = icmp ult i64 %32, %33
  br i1 %cmp41, label %for.body43, label %for.end

for.body43:                                       ; preds = %for.cond40
  %34 = load i64, ptr %j, align 8
  %arrayidx = getelementptr inbounds [64 x i8], ptr %h_i, i64 0, i64 %34
  %35 = load i8, ptr %arrayidx, align 1
  %36 = load ptr, ptr %dstbuf.addr, align 8
  %37 = load i64, ptr %i, align 8
  %38 = load i64, ptr %j, align 8
  %add44 = add i64 %37, %38
  %arrayidx45 = getelementptr inbounds i8, ptr %36, i64 %add44
  store i8 %35, ptr %arrayidx45, align 1
  br label %for.inc

for.inc:                                          ; preds = %for.body43
  %39 = load i64, ptr %j, align 8
  %inc = add i64 %39, 1
  store i64 %inc, ptr %j, align 8
  br label %for.cond40, !llvm.loop !35

for.end:                                          ; preds = %for.cond40
  br label %for.inc46

for.inc46:                                        ; preds = %for.end
  %40 = load i64, ptr %md_len, align 8
  %41 = load i64, ptr %i, align 8
  %add47 = add i64 %41, %40
  store i64 %add47, ptr %i, align 8
  br label %for.cond, !llvm.loop !36

for.end48:                                        ; preds = %for.cond
  call void @mbedtls_md_free(ptr noundef %md_ctx)
  %arraydecay49 = getelementptr inbounds [128 x i8], ptr %tmp, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay49, i64 noundef 128)
  %arraydecay50 = getelementptr inbounds [64 x i8], ptr %h_i, i64 0, i64 0
  call void @mbedtls_platform_zeroize(ptr noundef %arraydecay50, i64 noundef 64)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %for.end48, %if.then16, %if.then6, %if.then
  %42 = load i32, ptr %retval, align 4
  ret i32 %42
}

declare void @mbedtls_md5_clone(ptr noundef, ptr noundef) #1

declare void @mbedtls_sha1_clone(ptr noundef, ptr noundef) #1

declare void @mbedtls_sha256_init(ptr noundef) #1

declare void @mbedtls_sha256_clone(ptr noundef, ptr noundef) #1

declare i32 @mbedtls_sha256_finish_ret(ptr noundef, ptr noundef) #1

declare void @mbedtls_sha512_init(ptr noundef) #1

declare void @mbedtls_sha512_clone(ptr noundef, ptr noundef) #1

declare i32 @mbedtls_sha512_finish_ret(ptr noundef, ptr noundef) #1

declare i32 @mbedtls_cipher_crypt(ptr noundef, ptr noundef, i64 noundef, ptr noundef, i64 noundef, ptr noundef, ptr noundef) #1

declare i32 @mbedtls_cipher_auth_encrypt(ptr noundef, ptr noundef, i64 noundef, ptr noundef, i64 noundef, ptr noundef, i64 noundef, ptr noundef, ptr noundef, ptr noundef, i64 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define internal i64 @ssl_get_maximum_datagram_size(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i64, align 8
  %ssl.addr = alloca ptr, align 8
  %mtu = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @ssl_get_current_mtu(ptr noundef %0)
  store i64 %call, ptr %mtu, align 8
  %1 = load i64, ptr %mtu, align 8
  %cmp = icmp ne i64 %1, 0
  br i1 %cmp, label %land.lhs.true, label %if.end

land.lhs.true:                                    ; preds = %entry
  %2 = load i64, ptr %mtu, align 8
  %cmp1 = icmp ult i64 %2, 16717
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %land.lhs.true
  %3 = load i64, ptr %mtu, align 8
  store i64 %3, ptr %retval, align 8
  br label %return

if.end:                                           ; preds = %land.lhs.true, %entry
  store i64 16717, ptr %retval, align 8
  br label %return

return:                                           ; preds = %if.end, %if.then
  %4 = load i64, ptr %retval, align 8
  ret i64 %4
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_get_hs_frag_off(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 28
  %1 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %1, i64 6
  %2 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %2 to i32
  %shl = shl i32 %conv, 16
  %3 = load ptr, ptr %ssl.addr, align 8
  %in_msg1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 28
  %4 = load ptr, ptr %in_msg1, align 8
  %arrayidx2 = getelementptr inbounds i8, ptr %4, i64 7
  %5 = load i8, ptr %arrayidx2, align 1
  %conv3 = zext i8 %5 to i32
  %shl4 = shl i32 %conv3, 8
  %or = or i32 %shl, %shl4
  %6 = load ptr, ptr %ssl.addr, align 8
  %in_msg5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 28
  %7 = load ptr, ptr %in_msg5, align 8
  %arrayidx6 = getelementptr inbounds i8, ptr %7, i64 8
  %8 = load i8, ptr %arrayidx6, align 1
  %conv7 = zext i8 %8 to i32
  %or8 = or i32 %or, %conv7
  ret i32 %or8
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_get_hs_frag_len(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 28
  %1 = load ptr, ptr %in_msg, align 8
  %arrayidx = getelementptr inbounds i8, ptr %1, i64 9
  %2 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %2 to i32
  %shl = shl i32 %conv, 16
  %3 = load ptr, ptr %ssl.addr, align 8
  %in_msg1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 28
  %4 = load ptr, ptr %in_msg1, align 8
  %arrayidx2 = getelementptr inbounds i8, ptr %4, i64 10
  %5 = load i8, ptr %arrayidx2, align 1
  %conv3 = zext i8 %5 to i32
  %shl4 = shl i32 %conv3, 8
  %or = or i32 %shl, %shl4
  %6 = load ptr, ptr %ssl.addr, align 8
  %in_msg5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 28
  %7 = load ptr, ptr %in_msg5, align 8
  %arrayidx6 = getelementptr inbounds i8, ptr %7, i64 11
  %8 = load i8, ptr %arrayidx6, align 1
  %conv7 = zext i8 %8 to i32
  %or8 = or i32 %or, %conv7
  ret i32 %or8
}

; Function Attrs: nounwind willreturn memory(read)
declare i32 @memcmp(ptr noundef, ptr noundef, i64 noundef) #6

; Function Attrs: noinline nounwind optnone uwtable
define internal i64 @ssl_get_reassembly_buffer_size(i64 noundef %msg_len, i32 noundef %add_bitmap) #0 {
entry:
  %msg_len.addr = alloca i64, align 8
  %add_bitmap.addr = alloca i32, align 4
  %alloc_len = alloca i64, align 8
  store i64 %msg_len, ptr %msg_len.addr, align 8
  store i32 %add_bitmap, ptr %add_bitmap.addr, align 4
  store i64 12, ptr %alloc_len, align 8
  %0 = load i64, ptr %msg_len.addr, align 8
  %1 = load i64, ptr %alloc_len, align 8
  %add = add i64 %1, %0
  store i64 %add, ptr %alloc_len, align 8
  %2 = load i32, ptr %add_bitmap.addr, align 4
  %tobool = icmp ne i32 %2, 0
  br i1 %tobool, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %3 = load i64, ptr %msg_len.addr, align 8
  %div = udiv i64 %3, 8
  %4 = load i64, ptr %msg_len.addr, align 8
  %rem = urem i64 %4, 8
  %cmp = icmp ne i64 %rem, 0
  %conv = zext i1 %cmp to i32
  %conv1 = sext i32 %conv to i64
  %add2 = add i64 %div, %conv1
  %5 = load i64, ptr %alloc_len, align 8
  %add3 = add i64 %5, %add2
  store i64 %add3, ptr %alloc_len, align 8
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  %6 = load i64, ptr %alloc_len, align 8
  ret i64 %6
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_buffer_make_space(ptr noundef %ssl, i64 noundef %desired) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %desired.addr = alloca i64, align 8
  %offset = alloca i32, align 4
  %hs = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store i64 %desired, ptr %desired.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %3 = load i64, ptr %desired.addr, align 8
  %conv = trunc i64 %3 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %2, i32 noundef 2, ptr noundef @.str, i32 noundef 4502, ptr noundef @.str.232, i32 noundef %conv)
  %4 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_free_buffered_record(ptr noundef %4)
  %5 = load i64, ptr %desired.addr, align 8
  %6 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 23
  %total_bytes_buffered = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 0
  %7 = load i64, ptr %total_bytes_buffered, align 8
  %sub = sub i64 32768, %7
  %cmp = icmp ule i64 %5, %sub
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %8 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %8, i32 noundef 2, ptr noundef @.str, i32 noundef 4511, ptr noundef @.str.233)
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  store i32 3, ptr %offset, align 4
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.end
  %9 = load i32, ptr %offset, align 4
  %cmp2 = icmp sge i32 %9, 0
  br i1 %cmp2, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %10 = load ptr, ptr %ssl.addr, align 8
  %11 = load i32, ptr %offset, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %10, i32 noundef 2, ptr noundef @.str, i32 noundef 4522, ptr noundef @.str.234, i32 noundef %11)
  %12 = load ptr, ptr %ssl.addr, align 8
  %13 = load i32, ptr %offset, align 4
  %conv4 = trunc i32 %13 to i8
  call void @ssl_buffering_free_slot(ptr noundef %12, i8 noundef zeroext %conv4)
  %14 = load i64, ptr %desired.addr, align 8
  %15 = load ptr, ptr %hs, align 8
  %buffering5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %15, i32 0, i32 23
  %total_bytes_buffered6 = getelementptr inbounds %struct.anon, ptr %buffering5, i32 0, i32 0
  %16 = load i64, ptr %total_bytes_buffered6, align 8
  %sub7 = sub i64 32768, %16
  %cmp8 = icmp ule i64 %14, %sub7
  br i1 %cmp8, label %if.then10, label %if.end11

if.then10:                                        ; preds = %for.body
  %17 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %17, i32 noundef 2, ptr noundef @.str, i32 noundef 4530, ptr noundef @.str.235)
  store i32 0, ptr %retval, align 4
  br label %return

if.end11:                                         ; preds = %for.body
  br label %for.inc

for.inc:                                          ; preds = %if.end11
  %18 = load i32, ptr %offset, align 4
  %dec = add nsw i32 %18, -1
  store i32 %dec, ptr %offset, align 4
  br label %for.cond, !llvm.loop !37

for.end:                                          ; preds = %for.cond
  store i32 -1, ptr %retval, align 4
  br label %return

return:                                           ; preds = %for.end, %if.then10, %if.then
  %19 = load i32, ptr %retval, align 4
  ret i32 %19
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_bitmask_set(ptr noundef %mask, i64 noundef %offset, i64 noundef %len) #0 {
entry:
  %mask.addr = alloca ptr, align 8
  %offset.addr = alloca i64, align 8
  %len.addr = alloca i64, align 8
  %start_bits = alloca i32, align 4
  %end_bits = alloca i32, align 4
  %first_byte_idx = alloca i64, align 8
  %last_byte_idx = alloca i64, align 8
  store ptr %mask, ptr %mask.addr, align 8
  store i64 %offset, ptr %offset.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load i64, ptr %offset.addr, align 8
  %rem = urem i64 %0, 8
  %sub = sub i64 8, %rem
  %conv = trunc i64 %sub to i32
  store i32 %conv, ptr %start_bits, align 4
  %1 = load i32, ptr %start_bits, align 4
  %cmp = icmp ne i32 %1, 8
  br i1 %cmp, label %if.then, label %if.end28

if.then:                                          ; preds = %entry
  %2 = load i64, ptr %offset.addr, align 8
  %div = udiv i64 %2, 8
  store i64 %div, ptr %first_byte_idx, align 8
  %3 = load i64, ptr %len.addr, align 8
  %4 = load i32, ptr %start_bits, align 4
  %conv2 = zext i32 %4 to i64
  %cmp3 = icmp ule i64 %3, %conv2
  br i1 %cmp3, label %if.then5, label %if.end

if.then5:                                         ; preds = %if.then
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.then5
  %5 = load i64, ptr %len.addr, align 8
  %cmp6 = icmp ne i64 %5, 0
  br i1 %cmp6, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %6 = load i32, ptr %start_bits, align 4
  %conv8 = zext i32 %6 to i64
  %7 = load i64, ptr %len.addr, align 8
  %sub9 = sub i64 %conv8, %7
  %sh_prom = trunc i64 %sub9 to i32
  %shl = shl i32 1, %sh_prom
  %8 = load ptr, ptr %mask.addr, align 8
  %9 = load i64, ptr %first_byte_idx, align 8
  %arrayidx = getelementptr inbounds i8, ptr %8, i64 %9
  %10 = load i8, ptr %arrayidx, align 1
  %conv10 = zext i8 %10 to i32
  %or = or i32 %conv10, %shl
  %conv11 = trunc i32 %or to i8
  store i8 %conv11, ptr %arrayidx, align 1
  br label %for.inc

for.inc:                                          ; preds = %for.body
  %11 = load i64, ptr %len.addr, align 8
  %dec = add i64 %11, -1
  store i64 %dec, ptr %len.addr, align 8
  br label %for.cond, !llvm.loop !38

for.end:                                          ; preds = %for.cond
  br label %return

if.end:                                           ; preds = %if.then
  %12 = load i32, ptr %start_bits, align 4
  %conv12 = zext i32 %12 to i64
  %13 = load i64, ptr %offset.addr, align 8
  %add = add i64 %13, %conv12
  store i64 %add, ptr %offset.addr, align 8
  %14 = load i32, ptr %start_bits, align 4
  %conv13 = zext i32 %14 to i64
  %15 = load i64, ptr %len.addr, align 8
  %sub14 = sub i64 %15, %conv13
  store i64 %sub14, ptr %len.addr, align 8
  br label %for.cond15

for.cond15:                                       ; preds = %for.inc25, %if.end
  %16 = load i32, ptr %start_bits, align 4
  %cmp16 = icmp ne i32 %16, 0
  br i1 %cmp16, label %for.body18, label %for.end27

for.body18:                                       ; preds = %for.cond15
  %17 = load i32, ptr %start_bits, align 4
  %sub19 = sub i32 %17, 1
  %shl20 = shl i32 1, %sub19
  %18 = load ptr, ptr %mask.addr, align 8
  %19 = load i64, ptr %first_byte_idx, align 8
  %arrayidx21 = getelementptr inbounds i8, ptr %18, i64 %19
  %20 = load i8, ptr %arrayidx21, align 1
  %conv22 = zext i8 %20 to i32
  %or23 = or i32 %conv22, %shl20
  %conv24 = trunc i32 %or23 to i8
  store i8 %conv24, ptr %arrayidx21, align 1
  br label %for.inc25

for.inc25:                                        ; preds = %for.body18
  %21 = load i32, ptr %start_bits, align 4
  %dec26 = add i32 %21, -1
  store i32 %dec26, ptr %start_bits, align 4
  br label %for.cond15, !llvm.loop !39

for.end27:                                        ; preds = %for.cond15
  br label %if.end28

if.end28:                                         ; preds = %for.end27, %entry
  %22 = load i64, ptr %len.addr, align 8
  %rem29 = urem i64 %22, 8
  %conv30 = trunc i64 %rem29 to i32
  store i32 %conv30, ptr %end_bits, align 4
  %23 = load i32, ptr %end_bits, align 4
  %cmp31 = icmp ne i32 %23, 0
  br i1 %cmp31, label %if.then33, label %if.end51

if.then33:                                        ; preds = %if.end28
  %24 = load i64, ptr %offset.addr, align 8
  %25 = load i64, ptr %len.addr, align 8
  %add34 = add i64 %24, %25
  %div35 = udiv i64 %add34, 8
  store i64 %div35, ptr %last_byte_idx, align 8
  %26 = load i32, ptr %end_bits, align 4
  %conv36 = zext i32 %26 to i64
  %27 = load i64, ptr %len.addr, align 8
  %sub37 = sub i64 %27, %conv36
  store i64 %sub37, ptr %len.addr, align 8
  br label %for.cond38

for.cond38:                                       ; preds = %for.inc48, %if.then33
  %28 = load i32, ptr %end_bits, align 4
  %cmp39 = icmp ne i32 %28, 0
  br i1 %cmp39, label %for.body41, label %for.end50

for.body41:                                       ; preds = %for.cond38
  %29 = load i32, ptr %end_bits, align 4
  %sub42 = sub i32 8, %29
  %shl43 = shl i32 1, %sub42
  %30 = load ptr, ptr %mask.addr, align 8
  %31 = load i64, ptr %last_byte_idx, align 8
  %arrayidx44 = getelementptr inbounds i8, ptr %30, i64 %31
  %32 = load i8, ptr %arrayidx44, align 1
  %conv45 = zext i8 %32 to i32
  %or46 = or i32 %conv45, %shl43
  %conv47 = trunc i32 %or46 to i8
  store i8 %conv47, ptr %arrayidx44, align 1
  br label %for.inc48

for.inc48:                                        ; preds = %for.body41
  %33 = load i32, ptr %end_bits, align 4
  %dec49 = add i32 %33, -1
  store i32 %dec49, ptr %end_bits, align 4
  br label %for.cond38, !llvm.loop !40

for.end50:                                        ; preds = %for.cond38
  br label %if.end51

if.end51:                                         ; preds = %for.end50, %if.end28
  %34 = load ptr, ptr %mask.addr, align 8
  %35 = load i64, ptr %offset.addr, align 8
  %div52 = udiv i64 %35, 8
  %add.ptr = getelementptr inbounds i8, ptr %34, i64 %div52
  %36 = load i64, ptr %len.addr, align 8
  %div53 = udiv i64 %36, 8
  call void @llvm.memset.p0.i64(ptr align 1 %add.ptr, i8 -1, i64 %div53, i1 false)
  br label %return

return:                                           ; preds = %if.end51, %for.end
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_bitmask_check(ptr noundef %mask, i64 noundef %len) #0 {
entry:
  %retval = alloca i32, align 4
  %mask.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  %i = alloca i64, align 8
  store ptr %mask, ptr %mask.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  store i64 0, ptr %i, align 8
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %entry
  %0 = load i64, ptr %i, align 8
  %1 = load i64, ptr %len.addr, align 8
  %div = udiv i64 %1, 8
  %cmp = icmp ult i64 %0, %div
  br i1 %cmp, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %2 = load ptr, ptr %mask.addr, align 8
  %3 = load i64, ptr %i, align 8
  %arrayidx = getelementptr inbounds i8, ptr %2, i64 %3
  %4 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %4 to i32
  %cmp1 = icmp ne i32 %conv, 255
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %for.body
  store i32 -1, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %for.body
  br label %for.inc

for.inc:                                          ; preds = %if.end
  %5 = load i64, ptr %i, align 8
  %inc = add i64 %5, 1
  store i64 %inc, ptr %i, align 8
  br label %for.cond, !llvm.loop !41

for.end:                                          ; preds = %for.cond
  store i64 0, ptr %i, align 8
  br label %for.cond3

for.cond3:                                        ; preds = %for.inc14, %for.end
  %6 = load i64, ptr %i, align 8
  %7 = load i64, ptr %len.addr, align 8
  %rem = urem i64 %7, 8
  %cmp4 = icmp ult i64 %6, %rem
  br i1 %cmp4, label %for.body6, label %for.end16

for.body6:                                        ; preds = %for.cond3
  %8 = load ptr, ptr %mask.addr, align 8
  %9 = load i64, ptr %len.addr, align 8
  %div7 = udiv i64 %9, 8
  %arrayidx8 = getelementptr inbounds i8, ptr %8, i64 %div7
  %10 = load i8, ptr %arrayidx8, align 1
  %conv9 = zext i8 %10 to i32
  %11 = load i64, ptr %i, align 8
  %sub = sub i64 7, %11
  %sh_prom = trunc i64 %sub to i32
  %shl = shl i32 1, %sh_prom
  %and = and i32 %conv9, %shl
  %cmp10 = icmp eq i32 %and, 0
  br i1 %cmp10, label %if.then12, label %if.end13

if.then12:                                        ; preds = %for.body6
  store i32 -1, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %for.body6
  br label %for.inc14

for.inc14:                                        ; preds = %if.end13
  %12 = load i64, ptr %i, align 8
  %inc15 = add i64 %12, 1
  store i64 %inc15, ptr %i, align 8
  br label %for.cond3, !llvm.loop !42

for.end16:                                        ; preds = %for.cond3
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %for.end16, %if.then12, %if.then
  %13 = load i32, ptr %retval, align 4
  ret i32 %13
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_free_buffered_record(ptr noundef %ssl) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %hs = alloca ptr, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  %2 = load ptr, ptr %hs, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  br label %if.end12

if.end:                                           ; preds = %entry
  %3 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 23
  %future_record = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 3
  %data = getelementptr inbounds %struct.anon.0, ptr %future_record, i32 0, i32 0
  %4 = load ptr, ptr %data, align 8
  %cmp1 = icmp ne ptr %4, null
  br i1 %cmp1, label %if.then2, label %if.end12

if.then2:                                         ; preds = %if.end
  %5 = load ptr, ptr %hs, align 8
  %buffering3 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 23
  %future_record4 = getelementptr inbounds %struct.anon, ptr %buffering3, i32 0, i32 3
  %len = getelementptr inbounds %struct.anon.0, ptr %future_record4, i32 0, i32 1
  %6 = load i64, ptr %len, align 8
  %7 = load ptr, ptr %hs, align 8
  %buffering5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 23
  %total_bytes_buffered = getelementptr inbounds %struct.anon, ptr %buffering5, i32 0, i32 0
  %8 = load i64, ptr %total_bytes_buffered, align 8
  %sub = sub i64 %8, %6
  store i64 %sub, ptr %total_bytes_buffered, align 8
  %9 = load ptr, ptr %hs, align 8
  %buffering6 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 23
  %future_record7 = getelementptr inbounds %struct.anon, ptr %buffering6, i32 0, i32 3
  %data8 = getelementptr inbounds %struct.anon.0, ptr %future_record7, i32 0, i32 0
  %10 = load ptr, ptr %data8, align 8
  call void @free(ptr noundef %10) #8
  %11 = load ptr, ptr %hs, align 8
  %buffering9 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 23
  %future_record10 = getelementptr inbounds %struct.anon, ptr %buffering9, i32 0, i32 3
  %data11 = getelementptr inbounds %struct.anon.0, ptr %future_record10, i32 0, i32 0
  store ptr null, ptr %data11, align 8
  br label %if.end12

if.end12:                                         ; preds = %if.then, %if.then2, %if.end
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_load_buffered_record(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %hs = alloca ptr, align 8
  %rec = alloca ptr, align 8
  %rec_len = alloca i64, align 8
  %rec_epoch = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 0
  %3 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %3, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp = icmp ne i32 %bf.clear, 1
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %4 = load ptr, ptr %hs, align 8
  %cmp1 = icmp eq ptr %4, null
  br i1 %cmp1, label %if.then2, label %if.end3

if.then2:                                         ; preds = %if.end
  store i32 0, ptr %retval, align 4
  br label %return

if.end3:                                          ; preds = %if.end
  %5 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 23
  %future_record = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 3
  %data = getelementptr inbounds %struct.anon.0, ptr %future_record, i32 0, i32 0
  %6 = load ptr, ptr %data, align 8
  store ptr %6, ptr %rec, align 8
  %7 = load ptr, ptr %hs, align 8
  %buffering4 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 23
  %future_record5 = getelementptr inbounds %struct.anon, ptr %buffering4, i32 0, i32 3
  %len = getelementptr inbounds %struct.anon.0, ptr %future_record5, i32 0, i32 1
  %8 = load i64, ptr %len, align 8
  store i64 %8, ptr %rec_len, align 8
  %9 = load ptr, ptr %hs, align 8
  %buffering6 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 23
  %future_record7 = getelementptr inbounds %struct.anon, ptr %buffering6, i32 0, i32 3
  %epoch = getelementptr inbounds %struct.anon.0, ptr %future_record7, i32 0, i32 2
  %10 = load i32, ptr %epoch, align 8
  store i32 %10, ptr %rec_epoch, align 4
  %11 = load ptr, ptr %rec, align 8
  %cmp8 = icmp eq ptr %11, null
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %if.end3
  store i32 0, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.end3
  %12 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @ssl_next_record_is_in_datagram(ptr noundef %12)
  %cmp11 = icmp eq i32 %call, 1
  br i1 %cmp11, label %if.then12, label %if.end13

if.then12:                                        ; preds = %if.end10
  store i32 0, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %if.end10
  %13 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %13, i32 noundef 2, ptr noundef @.str, i32 noundef 4869, ptr noundef @.str.243)
  %14 = load i32, ptr %rec_epoch, align 4
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_epoch = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 33
  %16 = load i16, ptr %in_epoch, align 8
  %conv = zext i16 %16 to i32
  %cmp14 = icmp ne i32 %14, %conv
  br i1 %cmp14, label %if.then16, label %if.end17

if.then16:                                        ; preds = %if.end13
  %17 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %17, i32 noundef 2, ptr noundef @.str, i32 noundef 4873, ptr noundef @.str.244)
  br label %exit

if.end17:                                         ; preds = %if.end13
  %18 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %18, i32 noundef 2, ptr noundef @.str, i32 noundef 4877, ptr noundef @.str.245)
  %19 = load i64, ptr %rec_len, align 8
  %20 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 25
  %21 = load ptr, ptr %in_hdr, align 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 23
  %23 = load ptr, ptr %in_buf, align 8
  %sub.ptr.lhs.cast = ptrtoint ptr %21 to i64
  %sub.ptr.rhs.cast = ptrtoint ptr %23 to i64
  %sub.ptr.sub = sub i64 %sub.ptr.lhs.cast, %sub.ptr.rhs.cast
  %sub = sub i64 16717, %sub.ptr.sub
  %cmp18 = icmp ugt i64 %19, %sub
  br i1 %cmp18, label %if.then20, label %if.end21

if.then20:                                        ; preds = %if.end17
  %24 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %24, i32 noundef 1, ptr noundef @.str, i32 noundef 4883, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end21:                                         ; preds = %if.end17
  %25 = load ptr, ptr %ssl.addr, align 8
  %in_hdr22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %25, i32 0, i32 25
  %26 = load ptr, ptr %in_hdr22, align 8
  %27 = load ptr, ptr %rec, align 8
  %28 = load i64, ptr %rec_len, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %26, ptr align 1 %27, i64 %28, i1 false)
  %29 = load i64, ptr %rec_len, align 8
  %30 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 32
  store i64 %29, ptr %in_left, align 8
  %31 = load ptr, ptr %ssl.addr, align 8
  %next_record_offset = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 34
  store i64 0, ptr %next_record_offset, align 8
  %32 = load ptr, ptr %ssl.addr, align 8
  call void @ssl_free_buffered_record(ptr noundef %32)
  br label %exit

exit:                                             ; preds = %if.end21, %if.then16
  %33 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %33, i32 noundef 2, ptr noundef @.str, i32 noundef 4894, ptr noundef @.str.246)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %exit, %if.then20, %if.then12, %if.then9, %if.then2, %if.then
  %34 = load i32, ptr %retval, align 4
  ret i32 %34
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_parse_record_header(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %major_ver = alloca i32, align 4
  %minor_ver = alloca i32, align 4
  %rec_epoch = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 25
  %2 = load ptr, ptr %in_hdr, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_hdr_len(ptr noundef %3)
  call void @mbedtls_debug_print_buf(ptr noundef %0, i32 noundef 4, ptr noundef @.str, i32 noundef 4047, ptr noundef @.str.247, ptr noundef %2, i64 noundef %call)
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_hdr1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 25
  %5 = load ptr, ptr %in_hdr1, align 8
  %arrayidx = getelementptr inbounds i8, ptr %5, i64 0
  %6 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %6 to i32
  %7 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 30
  store i32 %conv, ptr %in_msgtype, align 8
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 26
  %9 = load ptr, ptr %in_len, align 8
  %arrayidx2 = getelementptr inbounds i8, ptr %9, i64 0
  %10 = load i8, ptr %arrayidx2, align 1
  %conv3 = zext i8 %10 to i32
  %shl = shl i32 %conv3, 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %in_len4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 26
  %12 = load ptr, ptr %in_len4, align 8
  %arrayidx5 = getelementptr inbounds i8, ptr %12, i64 1
  %13 = load i8, ptr %arrayidx5, align 1
  %conv6 = zext i8 %13 to i32
  %or = or i32 %shl, %conv6
  %conv7 = sext i32 %or to i64
  %14 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 31
  store i64 %conv7, ptr %in_msglen, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 0
  %16 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %16, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %17 = load ptr, ptr %ssl.addr, align 8
  %in_hdr8 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 25
  %18 = load ptr, ptr %in_hdr8, align 8
  %add.ptr = getelementptr inbounds i8, ptr %18, i64 1
  call void @mbedtls_ssl_read_version(ptr noundef %major_ver, ptr noundef %minor_ver, i32 noundef %bf.clear, ptr noundef %add.ptr)
  %19 = load ptr, ptr %ssl.addr, align 8
  %20 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype9 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 30
  %21 = load i32, ptr %in_msgtype9, align 8
  %22 = load i32, ptr %major_ver, align 4
  %23 = load i32, ptr %minor_ver, align 4
  %24 = load ptr, ptr %ssl.addr, align 8
  %in_msglen10 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 31
  %25 = load i64, ptr %in_msglen10, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %19, i32 noundef 3, ptr noundef @.str, i32 noundef 4056, ptr noundef @.str.248, i32 noundef %21, i32 noundef %22, i32 noundef %23, i64 noundef %25)
  %26 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype11 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 30
  %27 = load i32, ptr %in_msgtype11, align 8
  %cmp = icmp ne i32 %27, 22
  br i1 %cmp, label %land.lhs.true, label %if.end33

land.lhs.true:                                    ; preds = %entry
  %28 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype13 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %28, i32 0, i32 30
  %29 = load i32, ptr %in_msgtype13, align 8
  %cmp14 = icmp ne i32 %29, 21
  br i1 %cmp14, label %land.lhs.true16, label %if.end33

land.lhs.true16:                                  ; preds = %land.lhs.true
  %30 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %30, i32 0, i32 30
  %31 = load i32, ptr %in_msgtype17, align 8
  %cmp18 = icmp ne i32 %31, 20
  br i1 %cmp18, label %land.lhs.true20, label %if.end33

land.lhs.true20:                                  ; preds = %land.lhs.true16
  %32 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype21 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %32, i32 0, i32 30
  %33 = load i32, ptr %in_msgtype21, align 8
  %cmp22 = icmp ne i32 %33, 23
  br i1 %cmp22, label %if.then, label %if.end33

if.then:                                          ; preds = %land.lhs.true20
  %34 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %34, i32 noundef 1, ptr noundef @.str, i32 noundef 4064, ptr noundef @.str.249)
  %35 = load ptr, ptr %ssl.addr, align 8
  %conf24 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %35, i32 0, i32 0
  %36 = load ptr, ptr %conf24, align 8
  %transport25 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %36, i32 0, i32 46
  %bf.load26 = load i32, ptr %transport25, align 4
  %bf.lshr27 = lshr i32 %bf.load26, 1
  %bf.clear28 = and i32 %bf.lshr27, 1
  %cmp29 = icmp ne i32 %bf.clear28, 1
  br i1 %cmp29, label %if.then31, label %if.end

if.then31:                                        ; preds = %if.then
  %37 = load ptr, ptr %ssl.addr, align 8
  %call32 = call i32 @mbedtls_ssl_send_alert_message(ptr noundef %37, i8 noundef zeroext 2, i8 noundef zeroext 10)
  br label %if.end

if.end:                                           ; preds = %if.then31, %if.then
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end33:                                         ; preds = %land.lhs.true20, %land.lhs.true16, %land.lhs.true, %entry
  %38 = load i32, ptr %major_ver, align 4
  %39 = load ptr, ptr %ssl.addr, align 8
  %major_ver34 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %39, i32 0, i32 4
  %40 = load i32, ptr %major_ver34, align 4
  %cmp35 = icmp ne i32 %38, %40
  br i1 %cmp35, label %if.then37, label %if.end38

if.then37:                                        ; preds = %if.end33
  %41 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %41, i32 noundef 1, ptr noundef @.str, i32 noundef 4080, ptr noundef @.str.250)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end38:                                         ; preds = %if.end33
  %42 = load i32, ptr %minor_ver, align 4
  %43 = load ptr, ptr %ssl.addr, align 8
  %conf39 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %43, i32 0, i32 0
  %44 = load ptr, ptr %conf39, align 8
  %max_minor_ver = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %44, i32 0, i32 43
  %45 = load i8, ptr %max_minor_ver, align 1
  %conv40 = zext i8 %45 to i32
  %cmp41 = icmp sgt i32 %42, %conv40
  br i1 %cmp41, label %if.then43, label %if.end44

if.then43:                                        ; preds = %if.end38
  %46 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %46, i32 noundef 1, ptr noundef @.str, i32 noundef 4086, ptr noundef @.str.251)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end44:                                         ; preds = %if.end38
  %47 = load ptr, ptr %ssl.addr, align 8
  %in_msglen45 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %47, i32 0, i32 31
  %48 = load i64, ptr %in_msglen45, align 8
  %49 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %49, i32 0, i32 28
  %50 = load ptr, ptr %in_msg, align 8
  %51 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %51, i32 0, i32 23
  %52 = load ptr, ptr %in_buf, align 8
  %sub.ptr.lhs.cast = ptrtoint ptr %50 to i64
  %sub.ptr.rhs.cast = ptrtoint ptr %52 to i64
  %sub.ptr.sub = sub i64 %sub.ptr.lhs.cast, %sub.ptr.rhs.cast
  %sub = sub i64 16717, %sub.ptr.sub
  %cmp46 = icmp ugt i64 %48, %sub
  br i1 %cmp46, label %if.then48, label %if.end49

if.then48:                                        ; preds = %if.end44
  %53 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %53, i32 noundef 1, ptr noundef @.str, i32 noundef 4094, ptr noundef @.str.252)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end49:                                         ; preds = %if.end44
  %54 = load ptr, ptr %ssl.addr, align 8
  %conf50 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %54, i32 0, i32 0
  %55 = load ptr, ptr %conf50, align 8
  %transport51 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %55, i32 0, i32 46
  %bf.load52 = load i32, ptr %transport51, align 4
  %bf.lshr53 = lshr i32 %bf.load52, 1
  %bf.clear54 = and i32 %bf.lshr53, 1
  %cmp55 = icmp eq i32 %bf.clear54, 1
  br i1 %cmp55, label %if.then57, label %if.end130

if.then57:                                        ; preds = %if.end49
  %56 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %56, i32 0, i32 24
  %57 = load ptr, ptr %in_ctr, align 8
  %arrayidx58 = getelementptr inbounds i8, ptr %57, i64 0
  %58 = load i8, ptr %arrayidx58, align 1
  %conv59 = zext i8 %58 to i32
  %shl60 = shl i32 %conv59, 8
  %59 = load ptr, ptr %ssl.addr, align 8
  %in_ctr61 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %59, i32 0, i32 24
  %60 = load ptr, ptr %in_ctr61, align 8
  %arrayidx62 = getelementptr inbounds i8, ptr %60, i64 1
  %61 = load i8, ptr %arrayidx62, align 1
  %conv63 = zext i8 %61 to i32
  %or64 = or i32 %shl60, %conv63
  store i32 %or64, ptr %rec_epoch, align 4
  %62 = load i32, ptr %rec_epoch, align 4
  %63 = load ptr, ptr %ssl.addr, align 8
  %in_epoch = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %63, i32 0, i32 33
  %64 = load i16, ptr %in_epoch, align 8
  %conv65 = zext i16 %64 to i32
  %cmp66 = icmp ne i32 %62, %conv65
  br i1 %cmp66, label %if.then68, label %if.end103

if.then68:                                        ; preds = %if.then57
  %65 = load ptr, ptr %ssl.addr, align 8
  %66 = load ptr, ptr %ssl.addr, align 8
  %in_epoch69 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %66, i32 0, i32 33
  %67 = load i16, ptr %in_epoch69, align 8
  %conv70 = zext i16 %67 to i32
  %68 = load i32, ptr %rec_epoch, align 4
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %65, i32 noundef 1, ptr noundef @.str, i32 noundef 4120, ptr noundef @.str.253, i32 noundef %conv70, i32 noundef %68)
  %69 = load ptr, ptr %ssl.addr, align 8
  %conf71 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %69, i32 0, i32 0
  %70 = load ptr, ptr %conf71, align 8
  %endpoint = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %70, i32 0, i32 46
  %bf.load72 = load i32, ptr %endpoint, align 4
  %bf.clear73 = and i32 %bf.load72, 1
  %cmp74 = icmp eq i32 %bf.clear73, 1
  br i1 %cmp74, label %land.lhs.true76, label %if.else

land.lhs.true76:                                  ; preds = %if.then68
  %71 = load ptr, ptr %ssl.addr, align 8
  %state = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %71, i32 0, i32 1
  %72 = load i32, ptr %state, align 8
  %cmp77 = icmp eq i32 %72, 16
  br i1 %cmp77, label %land.lhs.true79, label %if.else

land.lhs.true79:                                  ; preds = %land.lhs.true76
  %73 = load i32, ptr %rec_epoch, align 4
  %cmp80 = icmp eq i32 %73, 0
  br i1 %cmp80, label %land.lhs.true82, label %if.else

land.lhs.true82:                                  ; preds = %land.lhs.true79
  %74 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype83 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %74, i32 0, i32 30
  %75 = load i32, ptr %in_msgtype83, align 8
  %cmp84 = icmp eq i32 %75, 22
  br i1 %cmp84, label %land.lhs.true86, label %if.else

land.lhs.true86:                                  ; preds = %land.lhs.true82
  %76 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %76, i32 0, i32 32
  %77 = load i64, ptr %in_left, align 8
  %cmp87 = icmp ugt i64 %77, 13
  br i1 %cmp87, label %land.lhs.true89, label %if.else

land.lhs.true89:                                  ; preds = %land.lhs.true86
  %78 = load ptr, ptr %ssl.addr, align 8
  %in_buf90 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %78, i32 0, i32 23
  %79 = load ptr, ptr %in_buf90, align 8
  %arrayidx91 = getelementptr inbounds i8, ptr %79, i64 13
  %80 = load i8, ptr %arrayidx91, align 1
  %conv92 = zext i8 %80 to i32
  %cmp93 = icmp eq i32 %conv92, 1
  br i1 %cmp93, label %if.then95, label %if.else

if.then95:                                        ; preds = %land.lhs.true89
  %81 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %81, i32 noundef 1, ptr noundef @.str, i32 noundef 4137, ptr noundef @.str.254)
  %82 = load ptr, ptr %ssl.addr, align 8
  %call96 = call i32 @ssl_handle_possible_reconnect(ptr noundef %82)
  store i32 %call96, ptr %retval, align 4
  br label %return

if.else:                                          ; preds = %land.lhs.true89, %land.lhs.true86, %land.lhs.true82, %land.lhs.true79, %land.lhs.true76, %if.then68
  %83 = load i32, ptr %rec_epoch, align 4
  %84 = load ptr, ptr %ssl.addr, align 8
  %in_epoch97 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %84, i32 0, i32 33
  %85 = load i16, ptr %in_epoch97, align 8
  %conv98 = zext i16 %85 to i32
  %add = add i32 %conv98, 1
  %cmp99 = icmp eq i32 %83, %add
  br i1 %cmp99, label %if.then101, label %if.end102

if.then101:                                       ; preds = %if.else
  %86 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %86, i32 noundef 2, ptr noundef @.str, i32 noundef 4146, ptr noundef @.str.255)
  store i32 -25728, ptr %retval, align 4
  br label %return

if.end102:                                        ; preds = %if.else
  store i32 -26368, ptr %retval, align 4
  br label %return

if.end103:                                        ; preds = %if.then57
  %87 = load i32, ptr %rec_epoch, align 4
  %88 = load ptr, ptr %ssl.addr, align 8
  %in_epoch104 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %88, i32 0, i32 33
  %89 = load i16, ptr %in_epoch104, align 8
  %conv105 = zext i16 %89 to i32
  %cmp106 = icmp eq i32 %87, %conv105
  br i1 %cmp106, label %land.lhs.true108, label %if.end113

land.lhs.true108:                                 ; preds = %if.end103
  %90 = load ptr, ptr %ssl.addr, align 8
  %call109 = call i32 @mbedtls_ssl_dtls_replay_check(ptr noundef %90)
  %cmp110 = icmp ne i32 %call109, 0
  br i1 %cmp110, label %if.then112, label %if.end113

if.then112:                                       ; preds = %land.lhs.true108
  %91 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %91, i32 noundef 1, ptr noundef @.str, i32 noundef 4159, ptr noundef @.str.256)
  store i32 -26368, ptr %retval, align 4
  br label %return

if.end113:                                        ; preds = %land.lhs.true108, %if.end103
  %92 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype114 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %92, i32 0, i32 30
  %93 = load i32, ptr %in_msgtype114, align 8
  %cmp115 = icmp eq i32 %93, 23
  br i1 %cmp115, label %land.lhs.true117, label %if.end129

land.lhs.true117:                                 ; preds = %if.end113
  %94 = load ptr, ptr %ssl.addr, align 8
  %state118 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %94, i32 0, i32 1
  %95 = load i32, ptr %state118, align 8
  %cmp119 = icmp ne i32 %95, 16
  br i1 %cmp119, label %land.lhs.true121, label %if.end129

land.lhs.true121:                                 ; preds = %land.lhs.true117
  %96 = load ptr, ptr %ssl.addr, align 8
  %renego_status = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %96, i32 0, i32 2
  %97 = load i32, ptr %renego_status, align 4
  %cmp122 = icmp eq i32 %97, 1
  br i1 %cmp122, label %land.lhs.true124, label %if.then128

land.lhs.true124:                                 ; preds = %land.lhs.true121
  %98 = load ptr, ptr %ssl.addr, align 8
  %state125 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %98, i32 0, i32 1
  %99 = load i32, ptr %state125, align 8
  %cmp126 = icmp eq i32 %99, 2
  br i1 %cmp126, label %if.end129, label %if.then128

if.then128:                                       ; preds = %land.lhs.true124, %land.lhs.true121
  %100 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %100, i32 noundef 1, ptr noundef @.str, i32 noundef 4174, ptr noundef @.str.257)
  store i32 -26368, ptr %retval, align 4
  br label %return

if.end129:                                        ; preds = %land.lhs.true124, %land.lhs.true117, %if.end113
  br label %if.end130

if.end130:                                        ; preds = %if.end129, %if.end49
  %101 = load ptr, ptr %ssl.addr, align 8
  %transform_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %101, i32 0, i32 16
  %102 = load ptr, ptr %transform_in, align 8
  %cmp131 = icmp eq ptr %102, null
  br i1 %cmp131, label %if.then133, label %if.else142

if.then133:                                       ; preds = %if.end130
  %103 = load ptr, ptr %ssl.addr, align 8
  %in_msglen134 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %103, i32 0, i32 31
  %104 = load i64, ptr %in_msglen134, align 8
  %cmp135 = icmp ult i64 %104, 1
  br i1 %cmp135, label %if.then140, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.then133
  %105 = load ptr, ptr %ssl.addr, align 8
  %in_msglen137 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %105, i32 0, i32 31
  %106 = load i64, ptr %in_msglen137, align 8
  %cmp138 = icmp ugt i64 %106, 16384
  br i1 %cmp138, label %if.then140, label %if.end141

if.then140:                                       ; preds = %lor.lhs.false, %if.then133
  %107 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %107, i32 noundef 1, ptr noundef @.str, i32 noundef 4187, ptr noundef @.str.252)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end141:                                        ; preds = %lor.lhs.false
  br label %if.end162

if.else142:                                       ; preds = %if.end130
  %108 = load ptr, ptr %ssl.addr, align 8
  %in_msglen143 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %108, i32 0, i32 31
  %109 = load i64, ptr %in_msglen143, align 8
  %110 = load ptr, ptr %ssl.addr, align 8
  %transform_in144 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %110, i32 0, i32 16
  %111 = load ptr, ptr %transform_in144, align 8
  %minlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %111, i32 0, i32 2
  %112 = load i64, ptr %minlen, align 8
  %cmp145 = icmp ult i64 %109, %112
  br i1 %cmp145, label %if.then147, label %if.end148

if.then147:                                       ; preds = %if.else142
  %113 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %113, i32 noundef 1, ptr noundef @.str, i32 noundef 4195, ptr noundef @.str.252)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end148:                                        ; preds = %if.else142
  %114 = load ptr, ptr %ssl.addr, align 8
  %minor_ver149 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %114, i32 0, i32 5
  %115 = load i32, ptr %minor_ver149, align 8
  %cmp150 = icmp sge i32 %115, 1
  br i1 %cmp150, label %land.lhs.true152, label %if.end161

land.lhs.true152:                                 ; preds = %if.end148
  %116 = load ptr, ptr %ssl.addr, align 8
  %in_msglen153 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %116, i32 0, i32 31
  %117 = load i64, ptr %in_msglen153, align 8
  %118 = load ptr, ptr %ssl.addr, align 8
  %transform_in154 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %118, i32 0, i32 16
  %119 = load ptr, ptr %transform_in154, align 8
  %minlen155 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %119, i32 0, i32 2
  %120 = load i64, ptr %minlen155, align 8
  %add156 = add i64 %120, 16384
  %add157 = add i64 %add156, 256
  %cmp158 = icmp ugt i64 %117, %add157
  br i1 %cmp158, label %if.then160, label %if.end161

if.then160:                                       ; preds = %land.lhs.true152
  %121 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %121, i32 noundef 1, ptr noundef @.str, i32 noundef 4216, ptr noundef @.str.252)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end161:                                        ; preds = %land.lhs.true152, %if.end148
  br label %if.end162

if.end162:                                        ; preds = %if.end161, %if.end141
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end162, %if.then160, %if.then147, %if.then140, %if.then128, %if.then112, %if.end102, %if.then101, %if.then95, %if.then48, %if.then43, %if.then37, %if.end
  %122 = load i32, ptr %retval, align 4
  ret i32 %122
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_buffer_future_record(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %hs = alloca ptr, align 8
  %rec_hdr_len = alloca i64, align 8
  %total_buf_sz = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  store ptr %1, ptr %hs, align 8
  store i64 13, ptr %rec_hdr_len, align 8
  %2 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %2, i32 0, i32 31
  %3 = load i64, ptr %in_msglen, align 8
  %add = add i64 13, %3
  store i64 %add, ptr %total_buf_sz, align 8
  %4 = load ptr, ptr %hs, align 8
  %cmp = icmp eq ptr %4, null
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  store i32 0, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %5, i32 0, i32 30
  %6 = load i32, ptr %in_msgtype, align 8
  %cmp1 = icmp ne i32 %6, 22
  br i1 %cmp1, label %if.then2, label %if.end3

if.then2:                                         ; preds = %if.end
  store i32 0, ptr %retval, align 4
  br label %return

if.end3:                                          ; preds = %if.end
  %7 = load ptr, ptr %hs, align 8
  %buffering = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 23
  %future_record = getelementptr inbounds %struct.anon, ptr %buffering, i32 0, i32 3
  %data = getelementptr inbounds %struct.anon.0, ptr %future_record, i32 0, i32 0
  %8 = load ptr, ptr %data, align 8
  %cmp4 = icmp ne ptr %8, null
  br i1 %cmp4, label %if.then5, label %if.end6

if.then5:                                         ; preds = %if.end3
  store i32 0, ptr %retval, align 4
  br label %return

if.end6:                                          ; preds = %if.end3
  %9 = load i64, ptr %total_buf_sz, align 8
  %10 = load ptr, ptr %hs, align 8
  %buffering7 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %10, i32 0, i32 23
  %total_bytes_buffered = getelementptr inbounds %struct.anon, ptr %buffering7, i32 0, i32 0
  %11 = load i64, ptr %total_bytes_buffered, align 8
  %sub = sub i64 32768, %11
  %cmp8 = icmp ugt i64 %9, %sub
  br i1 %cmp8, label %if.then9, label %if.end13

if.then9:                                         ; preds = %if.end6
  %12 = load ptr, ptr %ssl.addr, align 8
  %13 = load i64, ptr %total_buf_sz, align 8
  %conv = trunc i64 %13 to i32
  %14 = load ptr, ptr %hs, align 8
  %buffering10 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %14, i32 0, i32 23
  %total_bytes_buffered11 = getelementptr inbounds %struct.anon, ptr %buffering10, i32 0, i32 0
  %15 = load i64, ptr %total_bytes_buffered11, align 8
  %conv12 = trunc i64 %15 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %12, i32 noundef 2, ptr noundef @.str, i32 noundef 4923, ptr noundef @.str.260, i32 noundef %conv, i32 noundef 32768, i32 noundef %conv12)
  store i32 0, ptr %retval, align 4
  br label %return

if.end13:                                         ; preds = %if.end6
  %16 = load ptr, ptr %ssl.addr, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %in_epoch = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 33
  %18 = load i16, ptr %in_epoch, align 8
  %conv14 = zext i16 %18 to i32
  %add15 = add nsw i32 %conv14, 1
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %16, i32 noundef 2, ptr noundef @.str, i32 noundef 4929, ptr noundef @.str.261, i32 noundef %add15)
  %19 = load ptr, ptr %ssl.addr, align 8
  %20 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 25
  %21 = load ptr, ptr %in_hdr, align 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %in_msglen16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 31
  %23 = load i64, ptr %in_msglen16, align 8
  %add17 = add i64 13, %23
  call void @mbedtls_debug_print_buf(ptr noundef %19, i32 noundef 3, ptr noundef @.str, i32 noundef 4931, ptr noundef @.str.262, ptr noundef %21, i64 noundef %add17)
  %24 = load ptr, ptr %ssl.addr, align 8
  %in_epoch18 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 33
  %25 = load i16, ptr %in_epoch18, align 8
  %conv19 = zext i16 %25 to i32
  %add20 = add nsw i32 %conv19, 1
  %26 = load ptr, ptr %hs, align 8
  %buffering21 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %26, i32 0, i32 23
  %future_record22 = getelementptr inbounds %struct.anon, ptr %buffering21, i32 0, i32 3
  %epoch = getelementptr inbounds %struct.anon.0, ptr %future_record22, i32 0, i32 2
  store i32 %add20, ptr %epoch, align 8
  %27 = load i64, ptr %total_buf_sz, align 8
  %28 = load ptr, ptr %hs, align 8
  %buffering23 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %28, i32 0, i32 23
  %future_record24 = getelementptr inbounds %struct.anon, ptr %buffering23, i32 0, i32 3
  %len = getelementptr inbounds %struct.anon.0, ptr %future_record24, i32 0, i32 1
  store i64 %27, ptr %len, align 8
  %29 = load ptr, ptr %hs, align 8
  %buffering25 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %29, i32 0, i32 23
  %future_record26 = getelementptr inbounds %struct.anon, ptr %buffering25, i32 0, i32 3
  %len27 = getelementptr inbounds %struct.anon.0, ptr %future_record26, i32 0, i32 1
  %30 = load i64, ptr %len27, align 8
  %call = call noalias ptr @calloc(i64 noundef 1, i64 noundef %30) #9
  %31 = load ptr, ptr %hs, align 8
  %buffering28 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %31, i32 0, i32 23
  %future_record29 = getelementptr inbounds %struct.anon, ptr %buffering28, i32 0, i32 3
  %data30 = getelementptr inbounds %struct.anon.0, ptr %future_record29, i32 0, i32 0
  store ptr %call, ptr %data30, align 8
  %32 = load ptr, ptr %hs, align 8
  %buffering31 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %32, i32 0, i32 23
  %future_record32 = getelementptr inbounds %struct.anon, ptr %buffering31, i32 0, i32 3
  %data33 = getelementptr inbounds %struct.anon.0, ptr %future_record32, i32 0, i32 0
  %33 = load ptr, ptr %data33, align 8
  %cmp34 = icmp eq ptr %33, null
  br i1 %cmp34, label %if.then36, label %if.end37

if.then36:                                        ; preds = %if.end13
  store i32 0, ptr %retval, align 4
  br label %return

if.end37:                                         ; preds = %if.end13
  %34 = load ptr, ptr %hs, align 8
  %buffering38 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %34, i32 0, i32 23
  %future_record39 = getelementptr inbounds %struct.anon, ptr %buffering38, i32 0, i32 3
  %data40 = getelementptr inbounds %struct.anon.0, ptr %future_record39, i32 0, i32 0
  %35 = load ptr, ptr %data40, align 8
  %36 = load ptr, ptr %ssl.addr, align 8
  %in_hdr41 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 25
  %37 = load ptr, ptr %in_hdr41, align 8
  %38 = load i64, ptr %total_buf_sz, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %35, ptr align 1 %37, i64 %38, i1 false)
  %39 = load i64, ptr %total_buf_sz, align 8
  %40 = load ptr, ptr %hs, align 8
  %buffering42 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %40, i32 0, i32 23
  %total_bytes_buffered43 = getelementptr inbounds %struct.anon, ptr %buffering42, i32 0, i32 0
  %41 = load i64, ptr %total_bytes_buffered43, align 8
  %add44 = add i64 %41, %39
  store i64 %add44, ptr %total_bytes_buffered43, align 8
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end37, %if.then36, %if.then9, %if.then5, %if.then2, %if.then
  %42 = load i32, ptr %retval, align 4
  ret i32 %42
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_prepare_record_content(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %done = alloca i32, align 4
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 0, ptr %done, align 4
  %0 = load ptr, ptr %ssl.addr, align 8
  %1 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 25
  %2 = load ptr, ptr %in_hdr, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %call = call i64 @mbedtls_ssl_hdr_len(ptr noundef %3)
  %4 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 31
  %5 = load i64, ptr %in_msglen, align 8
  %add = add i64 %call, %5
  call void @mbedtls_debug_print_buf(ptr noundef %0, i32 noundef 4, ptr noundef @.str, i32 noundef 4233, ptr noundef @.str.263, ptr noundef %2, i64 noundef %add)
  %6 = load i32, ptr %done, align 4
  %tobool = icmp ne i32 %6, 0
  br i1 %tobool, label %if.end9, label %land.lhs.true

land.lhs.true:                                    ; preds = %entry
  %7 = load ptr, ptr %ssl.addr, align 8
  %transform_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %7, i32 0, i32 16
  %8 = load ptr, ptr %transform_in, align 8
  %cmp = icmp ne ptr %8, null
  br i1 %cmp, label %if.then, label %if.end9

if.then:                                          ; preds = %land.lhs.true
  %9 = load ptr, ptr %ssl.addr, align 8
  %call1 = call i32 @ssl_decrypt_buf(ptr noundef %9)
  store i32 %call1, ptr %ret, align 4
  %cmp2 = icmp ne i32 %call1, 0
  br i1 %cmp2, label %if.then3, label %if.end

if.then3:                                         ; preds = %if.then
  %10 = load ptr, ptr %ssl.addr, align 8
  %11 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %10, i32 noundef 1, ptr noundef @.str, i32 noundef 4255, ptr noundef @.str.264, i32 noundef %11)
  %12 = load i32, ptr %ret, align 4
  store i32 %12, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %if.then
  %13 = load ptr, ptr %ssl.addr, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 28
  %15 = load ptr, ptr %in_msg, align 8
  %16 = load ptr, ptr %ssl.addr, align 8
  %in_msglen4 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 31
  %17 = load i64, ptr %in_msglen4, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %13, i32 noundef 4, ptr noundef @.str, i32 noundef 4260, ptr noundef @.str.265, ptr noundef %15, i64 noundef %17)
  %18 = load ptr, ptr %ssl.addr, align 8
  %in_msglen5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %18, i32 0, i32 31
  %19 = load i64, ptr %in_msglen5, align 8
  %cmp6 = icmp ugt i64 %19, 16384
  br i1 %cmp6, label %if.then7, label %if.end8

if.then7:                                         ; preds = %if.end
  %20 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %20, i32 noundef 1, ptr noundef @.str, i32 noundef 4264, ptr noundef @.str.252)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end8:                                          ; preds = %if.end
  br label %if.end9

if.end9:                                          ; preds = %if.end8, %land.lhs.true, %entry
  %21 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 0
  %22 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %22, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp10 = icmp eq i32 %bf.clear, 1
  br i1 %cmp10, label %if.then11, label %if.end12

if.then11:                                        ; preds = %if.end9
  %23 = load ptr, ptr %ssl.addr, align 8
  call void @mbedtls_ssl_dtls_replay_update(ptr noundef %23)
  br label %if.end12

if.end12:                                         ; preds = %if.then11, %if.end9
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end12, %if.then7, %if.then3
  %24 = load i32, ptr %retval, align 4
  ret i32 %24
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_handle_possible_reconnect(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %ret = alloca i32, align 4
  %len = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 0
  %1 = load ptr, ptr %conf, align 8
  %f_cookie_write = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %1, i32 0, i32 14
  %2 = load ptr, ptr %f_cookie_write, align 8
  %3 = load ptr, ptr %ssl.addr, align 8
  %conf1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 0
  %4 = load ptr, ptr %conf1, align 8
  %f_cookie_check = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %f_cookie_check, align 8
  %6 = load ptr, ptr %ssl.addr, align 8
  %conf2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 0
  %7 = load ptr, ptr %conf2, align 8
  %p_cookie = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %7, i32 0, i32 16
  %8 = load ptr, ptr %p_cookie, align 8
  %9 = load ptr, ptr %ssl.addr, align 8
  %cli_id = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %9, i32 0, i32 56
  %10 = load ptr, ptr %cli_id, align 8
  %11 = load ptr, ptr %ssl.addr, align 8
  %cli_id_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %11, i32 0, i32 57
  %12 = load i64, ptr %cli_id_len, align 8
  %13 = load ptr, ptr %ssl.addr, align 8
  %in_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %13, i32 0, i32 23
  %14 = load ptr, ptr %in_buf, align 8
  %15 = load ptr, ptr %ssl.addr, align 8
  %in_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %15, i32 0, i32 32
  %16 = load i64, ptr %in_left, align 8
  %17 = load ptr, ptr %ssl.addr, align 8
  %out_buf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %17, i32 0, i32 41
  %18 = load ptr, ptr %out_buf, align 8
  %call = call i32 @ssl_check_dtls_clihlo_cookie(ptr noundef %2, ptr noundef %5, ptr noundef %8, ptr noundef %10, i64 noundef %12, ptr noundef %14, i64 noundef %16, ptr noundef %18, i64 noundef 16384, ptr noundef %len)
  store i32 %call, ptr %ret, align 4
  %19 = load ptr, ptr %ssl.addr, align 8
  %20 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %19, i32 noundef 2, ptr noundef @.str, i32 noundef 3996, ptr noundef @.str.258, i32 noundef %20)
  %21 = load i32, ptr %ret, align 4
  %cmp = icmp eq i32 %21, -27264
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %22 = load ptr, ptr %ssl.addr, align 8
  %f_send = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 7
  %23 = load ptr, ptr %f_send, align 8
  %24 = load ptr, ptr %ssl.addr, align 8
  %p_bio = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 10
  %25 = load ptr, ptr %p_bio, align 8
  %26 = load ptr, ptr %ssl.addr, align 8
  %out_buf3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %26, i32 0, i32 41
  %27 = load ptr, ptr %out_buf3, align 8
  %28 = load i64, ptr %len, align 8
  %call4 = call i32 %23(ptr noundef %25, ptr noundef %27, i64 noundef %28)
  store i32 -27264, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %29 = load i32, ptr %ret, align 4
  %cmp5 = icmp eq i32 %29, 0
  br i1 %cmp5, label %if.then6, label %if.end11

if.then6:                                         ; preds = %if.end
  %30 = load ptr, ptr %ssl.addr, align 8
  %call7 = call i32 @ssl_session_reset_int(ptr noundef %30, i32 noundef 1)
  store i32 %call7, ptr %ret, align 4
  %cmp8 = icmp ne i32 %call7, 0
  br i1 %cmp8, label %if.then9, label %if.end10

if.then9:                                         ; preds = %if.then6
  %31 = load ptr, ptr %ssl.addr, align 8
  %32 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %31, i32 noundef 1, ptr noundef @.str, i32 noundef 4013, ptr noundef @.str.259, i32 noundef %32)
  %33 = load i32, ptr %ret, align 4
  store i32 %33, ptr %retval, align 4
  br label %return

if.end10:                                         ; preds = %if.then6
  store i32 -26496, ptr %retval, align 4
  br label %return

if.end11:                                         ; preds = %if.end
  %34 = load i32, ptr %ret, align 4
  store i32 %34, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end11, %if.end10, %if.then9, %if.then
  %35 = load i32, ptr %retval, align 4
  ret i32 %35
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_check_dtls_clihlo_cookie(ptr noundef %f_cookie_write, ptr noundef %f_cookie_check, ptr noundef %p_cookie, ptr noundef %cli_id, i64 noundef %cli_id_len, ptr noundef %in, i64 noundef %in_len, ptr noundef %obuf, i64 noundef %buf_len, ptr noundef %olen) #0 {
entry:
  %retval = alloca i32, align 4
  %f_cookie_write.addr = alloca ptr, align 8
  %f_cookie_check.addr = alloca ptr, align 8
  %p_cookie.addr = alloca ptr, align 8
  %cli_id.addr = alloca ptr, align 8
  %cli_id_len.addr = alloca i64, align 8
  %in.addr = alloca ptr, align 8
  %in_len.addr = alloca i64, align 8
  %obuf.addr = alloca ptr, align 8
  %buf_len.addr = alloca i64, align 8
  %olen.addr = alloca ptr, align 8
  %sid_len = alloca i64, align 8
  %cookie_len = alloca i64, align 8
  %p = alloca ptr, align 8
  store ptr %f_cookie_write, ptr %f_cookie_write.addr, align 8
  store ptr %f_cookie_check, ptr %f_cookie_check.addr, align 8
  store ptr %p_cookie, ptr %p_cookie.addr, align 8
  store ptr %cli_id, ptr %cli_id.addr, align 8
  store i64 %cli_id_len, ptr %cli_id_len.addr, align 8
  store ptr %in, ptr %in.addr, align 8
  store i64 %in_len, ptr %in_len.addr, align 8
  store ptr %obuf, ptr %obuf.addr, align 8
  store i64 %buf_len, ptr %buf_len.addr, align 8
  store ptr %olen, ptr %olen.addr, align 8
  %0 = load ptr, ptr %f_cookie_write.addr, align 8
  %cmp = icmp eq ptr %0, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %1 = load ptr, ptr %f_cookie_check.addr, align 8
  %cmp1 = icmp eq ptr %1, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  store i32 -28928, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %2 = load i64, ptr %in_len.addr, align 8
  %cmp2 = icmp ult i64 %2, 61
  br i1 %cmp2, label %if.then31, label %lor.lhs.false3

lor.lhs.false3:                                   ; preds = %if.end
  %3 = load ptr, ptr %in.addr, align 8
  %arrayidx = getelementptr inbounds i8, ptr %3, i64 0
  %4 = load i8, ptr %arrayidx, align 1
  %conv = zext i8 %4 to i32
  %cmp4 = icmp ne i32 %conv, 22
  br i1 %cmp4, label %if.then31, label %lor.lhs.false6

lor.lhs.false6:                                   ; preds = %lor.lhs.false3
  %5 = load ptr, ptr %in.addr, align 8
  %arrayidx7 = getelementptr inbounds i8, ptr %5, i64 3
  %6 = load i8, ptr %arrayidx7, align 1
  %conv8 = zext i8 %6 to i32
  %cmp9 = icmp ne i32 %conv8, 0
  br i1 %cmp9, label %if.then31, label %lor.lhs.false11

lor.lhs.false11:                                  ; preds = %lor.lhs.false6
  %7 = load ptr, ptr %in.addr, align 8
  %arrayidx12 = getelementptr inbounds i8, ptr %7, i64 4
  %8 = load i8, ptr %arrayidx12, align 1
  %conv13 = zext i8 %8 to i32
  %cmp14 = icmp ne i32 %conv13, 0
  br i1 %cmp14, label %if.then31, label %lor.lhs.false16

lor.lhs.false16:                                  ; preds = %lor.lhs.false11
  %9 = load ptr, ptr %in.addr, align 8
  %arrayidx17 = getelementptr inbounds i8, ptr %9, i64 19
  %10 = load i8, ptr %arrayidx17, align 1
  %conv18 = zext i8 %10 to i32
  %cmp19 = icmp ne i32 %conv18, 0
  br i1 %cmp19, label %if.then31, label %lor.lhs.false21

lor.lhs.false21:                                  ; preds = %lor.lhs.false16
  %11 = load ptr, ptr %in.addr, align 8
  %arrayidx22 = getelementptr inbounds i8, ptr %11, i64 20
  %12 = load i8, ptr %arrayidx22, align 1
  %conv23 = zext i8 %12 to i32
  %cmp24 = icmp ne i32 %conv23, 0
  br i1 %cmp24, label %if.then31, label %lor.lhs.false26

lor.lhs.false26:                                  ; preds = %lor.lhs.false21
  %13 = load ptr, ptr %in.addr, align 8
  %arrayidx27 = getelementptr inbounds i8, ptr %13, i64 21
  %14 = load i8, ptr %arrayidx27, align 1
  %conv28 = zext i8 %14 to i32
  %cmp29 = icmp ne i32 %conv28, 0
  br i1 %cmp29, label %if.then31, label %if.end32

if.then31:                                        ; preds = %lor.lhs.false26, %lor.lhs.false21, %lor.lhs.false16, %lor.lhs.false11, %lor.lhs.false6, %lor.lhs.false3, %if.end
  store i32 -30976, ptr %retval, align 4
  br label %return

if.end32:                                         ; preds = %lor.lhs.false26
  %15 = load ptr, ptr %in.addr, align 8
  %arrayidx33 = getelementptr inbounds i8, ptr %15, i64 59
  %16 = load i8, ptr %arrayidx33, align 1
  %conv34 = zext i8 %16 to i64
  store i64 %conv34, ptr %sid_len, align 8
  %17 = load i64, ptr %sid_len, align 8
  %18 = load i64, ptr %in_len.addr, align 8
  %sub = sub i64 %18, 61
  %cmp35 = icmp ugt i64 %17, %sub
  br i1 %cmp35, label %if.then37, label %if.end38

if.then37:                                        ; preds = %if.end32
  store i32 -30976, ptr %retval, align 4
  br label %return

if.end38:                                         ; preds = %if.end32
  %19 = load ptr, ptr %in.addr, align 8
  %20 = load i64, ptr %sid_len, align 8
  %add = add i64 60, %20
  %arrayidx39 = getelementptr inbounds i8, ptr %19, i64 %add
  %21 = load i8, ptr %arrayidx39, align 1
  %conv40 = zext i8 %21 to i64
  store i64 %conv40, ptr %cookie_len, align 8
  %22 = load i64, ptr %cookie_len, align 8
  %23 = load i64, ptr %in_len.addr, align 8
  %sub41 = sub i64 %23, 60
  %cmp42 = icmp ugt i64 %22, %sub41
  br i1 %cmp42, label %if.then44, label %if.end45

if.then44:                                        ; preds = %if.end38
  store i32 -30976, ptr %retval, align 4
  br label %return

if.end45:                                         ; preds = %if.end38
  %24 = load ptr, ptr %f_cookie_check.addr, align 8
  %25 = load ptr, ptr %p_cookie.addr, align 8
  %26 = load ptr, ptr %in.addr, align 8
  %27 = load i64, ptr %sid_len, align 8
  %add.ptr = getelementptr inbounds i8, ptr %26, i64 %27
  %add.ptr46 = getelementptr inbounds i8, ptr %add.ptr, i64 61
  %28 = load i64, ptr %cookie_len, align 8
  %29 = load ptr, ptr %cli_id.addr, align 8
  %30 = load i64, ptr %cli_id_len.addr, align 8
  %call = call i32 %24(ptr noundef %25, ptr noundef %add.ptr46, i64 noundef %28, ptr noundef %29, i64 noundef %30)
  %cmp47 = icmp eq i32 %call, 0
  br i1 %cmp47, label %if.then49, label %if.end50

if.then49:                                        ; preds = %if.end45
  store i32 0, ptr %retval, align 4
  br label %return

if.end50:                                         ; preds = %if.end45
  %31 = load i64, ptr %buf_len.addr, align 8
  %cmp51 = icmp ult i64 %31, 28
  br i1 %cmp51, label %if.then53, label %if.end54

if.then53:                                        ; preds = %if.end50
  store i32 -27136, ptr %retval, align 4
  br label %return

if.end54:                                         ; preds = %if.end50
  %32 = load ptr, ptr %obuf.addr, align 8
  %33 = load ptr, ptr %in.addr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %32, ptr align 1 %33, i64 25, i1 false)
  %34 = load ptr, ptr %obuf.addr, align 8
  %arrayidx55 = getelementptr inbounds i8, ptr %34, i64 13
  store i8 3, ptr %arrayidx55, align 1
  %35 = load ptr, ptr %obuf.addr, align 8
  %arrayidx56 = getelementptr inbounds i8, ptr %35, i64 25
  store i8 -2, ptr %arrayidx56, align 1
  %36 = load ptr, ptr %obuf.addr, align 8
  %arrayidx57 = getelementptr inbounds i8, ptr %36, i64 26
  store i8 -1, ptr %arrayidx57, align 1
  %37 = load ptr, ptr %obuf.addr, align 8
  %add.ptr58 = getelementptr inbounds i8, ptr %37, i64 28
  store ptr %add.ptr58, ptr %p, align 8
  %38 = load ptr, ptr %f_cookie_write.addr, align 8
  %39 = load ptr, ptr %p_cookie.addr, align 8
  %40 = load ptr, ptr %obuf.addr, align 8
  %41 = load i64, ptr %buf_len.addr, align 8
  %add.ptr59 = getelementptr inbounds i8, ptr %40, i64 %41
  %42 = load ptr, ptr %cli_id.addr, align 8
  %43 = load i64, ptr %cli_id_len.addr, align 8
  %call60 = call i32 %38(ptr noundef %39, ptr noundef %p, ptr noundef %add.ptr59, ptr noundef %42, i64 noundef %43)
  %cmp61 = icmp ne i32 %call60, 0
  br i1 %cmp61, label %if.then63, label %if.end64

if.then63:                                        ; preds = %if.end54
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end64:                                         ; preds = %if.end54
  %44 = load ptr, ptr %p, align 8
  %45 = load ptr, ptr %obuf.addr, align 8
  %sub.ptr.lhs.cast = ptrtoint ptr %44 to i64
  %sub.ptr.rhs.cast = ptrtoint ptr %45 to i64
  %sub.ptr.sub = sub i64 %sub.ptr.lhs.cast, %sub.ptr.rhs.cast
  %46 = load ptr, ptr %olen.addr, align 8
  store i64 %sub.ptr.sub, ptr %46, align 8
  %47 = load ptr, ptr %olen.addr, align 8
  %48 = load i64, ptr %47, align 8
  %sub65 = sub i64 %48, 28
  %conv66 = trunc i64 %sub65 to i8
  %49 = load ptr, ptr %obuf.addr, align 8
  %arrayidx67 = getelementptr inbounds i8, ptr %49, i64 27
  store i8 %conv66, ptr %arrayidx67, align 1
  %50 = load ptr, ptr %olen.addr, align 8
  %51 = load i64, ptr %50, align 8
  %sub68 = sub i64 %51, 25
  %shr = lshr i64 %sub68, 16
  %conv69 = trunc i64 %shr to i8
  %52 = load ptr, ptr %obuf.addr, align 8
  %arrayidx70 = getelementptr inbounds i8, ptr %52, i64 22
  store i8 %conv69, ptr %arrayidx70, align 1
  %53 = load ptr, ptr %obuf.addr, align 8
  %arrayidx71 = getelementptr inbounds i8, ptr %53, i64 14
  store i8 %conv69, ptr %arrayidx71, align 1
  %54 = load ptr, ptr %olen.addr, align 8
  %55 = load i64, ptr %54, align 8
  %sub72 = sub i64 %55, 25
  %shr73 = lshr i64 %sub72, 8
  %conv74 = trunc i64 %shr73 to i8
  %56 = load ptr, ptr %obuf.addr, align 8
  %arrayidx75 = getelementptr inbounds i8, ptr %56, i64 23
  store i8 %conv74, ptr %arrayidx75, align 1
  %57 = load ptr, ptr %obuf.addr, align 8
  %arrayidx76 = getelementptr inbounds i8, ptr %57, i64 15
  store i8 %conv74, ptr %arrayidx76, align 1
  %58 = load ptr, ptr %olen.addr, align 8
  %59 = load i64, ptr %58, align 8
  %sub77 = sub i64 %59, 25
  %conv78 = trunc i64 %sub77 to i8
  %60 = load ptr, ptr %obuf.addr, align 8
  %arrayidx79 = getelementptr inbounds i8, ptr %60, i64 24
  store i8 %conv78, ptr %arrayidx79, align 1
  %61 = load ptr, ptr %obuf.addr, align 8
  %arrayidx80 = getelementptr inbounds i8, ptr %61, i64 16
  store i8 %conv78, ptr %arrayidx80, align 1
  %62 = load ptr, ptr %olen.addr, align 8
  %63 = load i64, ptr %62, align 8
  %sub81 = sub i64 %63, 13
  %shr82 = lshr i64 %sub81, 8
  %conv83 = trunc i64 %shr82 to i8
  %64 = load ptr, ptr %obuf.addr, align 8
  %arrayidx84 = getelementptr inbounds i8, ptr %64, i64 11
  store i8 %conv83, ptr %arrayidx84, align 1
  %65 = load ptr, ptr %olen.addr, align 8
  %66 = load i64, ptr %65, align 8
  %sub85 = sub i64 %66, 13
  %conv86 = trunc i64 %sub85 to i8
  %67 = load ptr, ptr %obuf.addr, align 8
  %arrayidx87 = getelementptr inbounds i8, ptr %67, i64 12
  store i8 %conv86, ptr %arrayidx87, align 1
  store i32 -27264, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end64, %if.then63, %if.then53, %if.then49, %if.then44, %if.then37, %if.then31, %if.then
  %68 = load i32, ptr %retval, align 4
  ret i32 %68
}

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_decrypt_buf(ptr noundef %ssl) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %mode = alloca i32, align 4
  %auth_done = alloca i32, align 4
  %padlen = alloca i64, align 8
  %correct = alloca i64, align 8
  %ret = alloca i32, align 4
  %olen = alloca i64, align 8
  %ret32 = alloca i32, align 4
  %dec_msglen = alloca i64, align 8
  %olen33 = alloca i64, align 8
  %dec_msg = alloca ptr, align 8
  %dec_msg_result = alloca ptr, align 8
  %add_data = alloca [13 x i8], align 1
  %iv = alloca [12 x i8], align 1
  %transform = alloca ptr, align 8
  %taglen = alloca i8, align 1
  %explicit_iv_len = alloca i64, align 8
  %i = alloca i8, align 1
  %ret135 = alloca i32, align 4
  %dec_msg136 = alloca ptr, align 8
  %dec_msg_result137 = alloca ptr, align 8
  %dec_msglen138 = alloca i64, align 8
  %minlen139 = alloca i64, align 8
  %olen140 = alloca i64, align 8
  %mac_expect = alloca [48 x i8], align 16
  %pseudo_hdr = alloca [13 x i8], align 1
  %i248 = alloca i8, align 1
  %pad_count = alloca i64, align 8
  %real_count = alloca i64, align 8
  %padding_idx = alloca i64, align 8
  %i328 = alloca i64, align 8
  %mac_expect379 = alloca [48 x i8], align 16
  %j = alloca i64, align 8
  %extra_run = alloca i64, align 8
  %max_len = alloca i64, align 8
  %min_len = alloca i64, align 8
  %i526 = alloca i8, align 1
  store ptr %ssl, ptr %ssl.addr, align 8
  store i32 0, ptr %auth_done, align 4
  store i64 0, ptr %padlen, align 8
  store i64 1, ptr %correct, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %0, i32 noundef 2, ptr noundef @.str, i32 noundef 1794, ptr noundef @.str.266)
  %1 = load ptr, ptr %ssl.addr, align 8
  %session_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %1, i32 0, i32 11
  %2 = load ptr, ptr %session_in, align 8
  %cmp = icmp eq ptr %2, null
  br i1 %cmp, label %if.then, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %transform_in = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %3, i32 0, i32 16
  %4 = load ptr, ptr %transform_in, align 8
  %cmp1 = icmp eq ptr %4, null
  br i1 %cmp1, label %if.then, label %if.end

if.then:                                          ; preds = %lor.lhs.false, %entry
  %5 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %5, i32 noundef 1, ptr noundef @.str, i32 noundef 1798, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %lor.lhs.false
  %6 = load ptr, ptr %ssl.addr, align 8
  %transform_in2 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %6, i32 0, i32 16
  %7 = load ptr, ptr %transform_in2, align 8
  %cipher_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %7, i32 0, i32 11
  %call = call i32 @mbedtls_cipher_get_cipher_mode(ptr noundef %cipher_ctx_dec)
  store i32 %call, ptr %mode, align 4
  %8 = load ptr, ptr %ssl.addr, align 8
  %in_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 31
  %9 = load i64, ptr %in_msglen, align 8
  %10 = load ptr, ptr %ssl.addr, align 8
  %transform_in3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %10, i32 0, i32 16
  %11 = load ptr, ptr %transform_in3, align 8
  %minlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %11, i32 0, i32 2
  %12 = load i64, ptr %minlen, align 8
  %cmp4 = icmp ult i64 %9, %12
  br i1 %cmp4, label %if.then5, label %if.end9

if.then5:                                         ; preds = %if.end
  %13 = load ptr, ptr %ssl.addr, align 8
  %14 = load ptr, ptr %ssl.addr, align 8
  %in_msglen6 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 31
  %15 = load i64, ptr %in_msglen6, align 8
  %16 = load ptr, ptr %ssl.addr, align 8
  %transform_in7 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %16, i32 0, i32 16
  %17 = load ptr, ptr %transform_in7, align 8
  %minlen8 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %17, i32 0, i32 2
  %18 = load i64, ptr %minlen8, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %13, i32 noundef 1, ptr noundef @.str, i32 noundef 1807, ptr noundef @.str.267, i64 noundef %15, i64 noundef %18)
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end9:                                          ; preds = %if.end
  %19 = load i32, ptr %mode, align 4
  %cmp10 = icmp eq i32 %19, 7
  br i1 %cmp10, label %if.then11, label %if.else

if.then11:                                        ; preds = %if.end9
  store i64 0, ptr %olen, align 8
  store i64 0, ptr %padlen, align 8
  %20 = load ptr, ptr %ssl.addr, align 8
  %transform_in12 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %20, i32 0, i32 16
  %21 = load ptr, ptr %transform_in12, align 8
  %cipher_ctx_dec13 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %21, i32 0, i32 11
  %22 = load ptr, ptr %ssl.addr, align 8
  %transform_in14 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 16
  %23 = load ptr, ptr %transform_in14, align 8
  %iv_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %23, i32 0, i32 7
  %arraydecay = getelementptr inbounds [16 x i8], ptr %iv_dec, i64 0, i64 0
  %24 = load ptr, ptr %ssl.addr, align 8
  %transform_in15 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %24, i32 0, i32 16
  %25 = load ptr, ptr %transform_in15, align 8
  %ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %25, i32 0, i32 3
  %26 = load i64, ptr %ivlen, align 8
  %27 = load ptr, ptr %ssl.addr, align 8
  %in_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %27, i32 0, i32 28
  %28 = load ptr, ptr %in_msg, align 8
  %29 = load ptr, ptr %ssl.addr, align 8
  %in_msglen16 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %29, i32 0, i32 31
  %30 = load i64, ptr %in_msglen16, align 8
  %31 = load ptr, ptr %ssl.addr, align 8
  %in_msg17 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %31, i32 0, i32 28
  %32 = load ptr, ptr %in_msg17, align 8
  %call18 = call i32 @mbedtls_cipher_crypt(ptr noundef %cipher_ctx_dec13, ptr noundef %arraydecay, i64 noundef %26, ptr noundef %28, i64 noundef %30, ptr noundef %32, ptr noundef %olen)
  store i32 %call18, ptr %ret, align 4
  %cmp19 = icmp ne i32 %call18, 0
  br i1 %cmp19, label %if.then20, label %if.end21

if.then20:                                        ; preds = %if.then11
  %33 = load ptr, ptr %ssl.addr, align 8
  %34 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %33, i32 noundef 1, ptr noundef @.str, i32 noundef 1825, ptr noundef @.str.196, i32 noundef %34)
  %35 = load i32, ptr %ret, align 4
  store i32 %35, ptr %retval, align 4
  br label %return

if.end21:                                         ; preds = %if.then11
  %36 = load ptr, ptr %ssl.addr, align 8
  %in_msglen22 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %36, i32 0, i32 31
  %37 = load i64, ptr %in_msglen22, align 8
  %38 = load i64, ptr %olen, align 8
  %cmp23 = icmp ne i64 %37, %38
  br i1 %cmp23, label %if.then24, label %if.end25

if.then24:                                        ; preds = %if.end21
  %39 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %39, i32 noundef 1, ptr noundef @.str, i32 noundef 1831, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end25:                                         ; preds = %if.end21
  br label %if.end375

if.else:                                          ; preds = %if.end9
  %40 = load i32, ptr %mode, align 4
  %cmp26 = icmp eq i32 %40, 6
  br i1 %cmp26, label %if.then31, label %lor.lhs.false27

lor.lhs.false27:                                  ; preds = %if.else
  %41 = load i32, ptr %mode, align 4
  %cmp28 = icmp eq i32 %41, 8
  br i1 %cmp28, label %if.then31, label %lor.lhs.false29

lor.lhs.false29:                                  ; preds = %lor.lhs.false27
  %42 = load i32, ptr %mode, align 4
  %cmp30 = icmp eq i32 %42, 10
  br i1 %cmp30, label %if.then31, label %if.else131

if.then31:                                        ; preds = %lor.lhs.false29, %lor.lhs.false27, %if.else
  %43 = load ptr, ptr %ssl.addr, align 8
  %transform_in34 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %43, i32 0, i32 16
  %44 = load ptr, ptr %transform_in34, align 8
  store ptr %44, ptr %transform, align 8
  %45 = load ptr, ptr %transform, align 8
  %ciphersuite_info = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %45, i32 0, i32 0
  %46 = load ptr, ptr %ciphersuite_info, align 8
  %flags = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %46, i32 0, i32 9
  %47 = load i8, ptr %flags, align 4
  %conv = zext i8 %47 to i32
  %and = and i32 %conv, 2
  %tobool = icmp ne i32 %and, 0
  %48 = zext i1 %tobool to i64
  %cond = select i1 %tobool, i32 8, i32 16
  %conv35 = trunc i32 %cond to i8
  store i8 %conv35, ptr %taglen, align 1
  %49 = load ptr, ptr %transform, align 8
  %ivlen36 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %49, i32 0, i32 3
  %50 = load i64, ptr %ivlen36, align 8
  %51 = load ptr, ptr %transform, align 8
  %fixed_ivlen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %51, i32 0, i32 4
  %52 = load i64, ptr %fixed_ivlen, align 8
  %sub = sub i64 %50, %52
  store i64 %sub, ptr %explicit_iv_len, align 8
  %53 = load ptr, ptr %ssl.addr, align 8
  %in_msglen37 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %53, i32 0, i32 31
  %54 = load i64, ptr %in_msglen37, align 8
  %55 = load i64, ptr %explicit_iv_len, align 8
  %56 = load i8, ptr %taglen, align 1
  %conv38 = zext i8 %56 to i64
  %add = add i64 %55, %conv38
  %cmp39 = icmp ult i64 %54, %add
  br i1 %cmp39, label %if.then41, label %if.end44

if.then41:                                        ; preds = %if.then31
  %57 = load ptr, ptr %ssl.addr, align 8
  %58 = load ptr, ptr %ssl.addr, align 8
  %in_msglen42 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %58, i32 0, i32 31
  %59 = load i64, ptr %in_msglen42, align 8
  %60 = load i64, ptr %explicit_iv_len, align 8
  %61 = load i8, ptr %taglen, align 1
  %conv43 = zext i8 %61 to i32
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %57, i32 noundef 1, ptr noundef @.str, i32 noundef 1862, ptr noundef @.str.268, i64 noundef %59, i64 noundef %60, i32 noundef %conv43)
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end44:                                         ; preds = %if.then31
  %62 = load ptr, ptr %ssl.addr, align 8
  %in_msglen45 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %62, i32 0, i32 31
  %63 = load i64, ptr %in_msglen45, align 8
  %64 = load i64, ptr %explicit_iv_len, align 8
  %sub46 = sub i64 %63, %64
  %65 = load i8, ptr %taglen, align 1
  %conv47 = zext i8 %65 to i64
  %sub48 = sub i64 %sub46, %conv47
  store i64 %sub48, ptr %dec_msglen, align 8
  %66 = load ptr, ptr %ssl.addr, align 8
  %in_msg49 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %66, i32 0, i32 28
  %67 = load ptr, ptr %in_msg49, align 8
  store ptr %67, ptr %dec_msg, align 8
  %68 = load ptr, ptr %ssl.addr, align 8
  %in_msg50 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %68, i32 0, i32 28
  %69 = load ptr, ptr %in_msg50, align 8
  store ptr %69, ptr %dec_msg_result, align 8
  %70 = load i64, ptr %dec_msglen, align 8
  %71 = load ptr, ptr %ssl.addr, align 8
  %in_msglen51 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %71, i32 0, i32 31
  store i64 %70, ptr %in_msglen51, align 8
  %arraydecay52 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  %72 = load ptr, ptr %ssl.addr, align 8
  %in_ctr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %72, i32 0, i32 24
  %73 = load ptr, ptr %in_ctr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %arraydecay52, ptr align 1 %73, i64 8, i1 false)
  %74 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %74, i32 0, i32 30
  %75 = load i32, ptr %in_msgtype, align 8
  %conv53 = trunc i32 %75 to i8
  %arrayidx = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 8
  store i8 %conv53, ptr %arrayidx, align 1
  %76 = load ptr, ptr %ssl.addr, align 8
  %major_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %76, i32 0, i32 4
  %77 = load i32, ptr %major_ver, align 4
  %78 = load ptr, ptr %ssl.addr, align 8
  %minor_ver = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %78, i32 0, i32 5
  %79 = load i32, ptr %minor_ver, align 8
  %80 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %80, i32 0, i32 0
  %81 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %81, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %arraydecay54 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  %add.ptr = getelementptr inbounds i8, ptr %arraydecay54, i64 9
  call void @mbedtls_ssl_write_version(i32 noundef %77, i32 noundef %79, i32 noundef %bf.clear, ptr noundef %add.ptr)
  %82 = load ptr, ptr %ssl.addr, align 8
  %in_msglen55 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %82, i32 0, i32 31
  %83 = load i64, ptr %in_msglen55, align 8
  %shr = lshr i64 %83, 8
  %and56 = and i64 %shr, 255
  %conv57 = trunc i64 %and56 to i8
  %arrayidx58 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 11
  store i8 %conv57, ptr %arrayidx58, align 1
  %84 = load ptr, ptr %ssl.addr, align 8
  %in_msglen59 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %84, i32 0, i32 31
  %85 = load i64, ptr %in_msglen59, align 8
  %and60 = and i64 %85, 255
  %conv61 = trunc i64 %and60 to i8
  %arrayidx62 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 12
  store i8 %conv61, ptr %arrayidx62, align 1
  %86 = load ptr, ptr %ssl.addr, align 8
  %arraydecay63 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %86, i32 noundef 4, ptr noundef @.str, i32 noundef 1881, ptr noundef @.str.197, ptr noundef %arraydecay63, i64 noundef 13)
  %87 = load ptr, ptr %transform, align 8
  %ivlen64 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %87, i32 0, i32 3
  %88 = load i64, ptr %ivlen64, align 8
  %cmp65 = icmp eq i64 %88, 12
  br i1 %cmp65, label %land.lhs.true, label %if.else78

land.lhs.true:                                    ; preds = %if.end44
  %89 = load ptr, ptr %transform, align 8
  %fixed_ivlen67 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %89, i32 0, i32 4
  %90 = load i64, ptr %fixed_ivlen67, align 8
  %cmp68 = icmp eq i64 %90, 4
  br i1 %cmp68, label %if.then70, label %if.else78

if.then70:                                        ; preds = %land.lhs.true
  %arraydecay71 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %91 = load ptr, ptr %transform, align 8
  %iv_dec72 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %91, i32 0, i32 7
  %arraydecay73 = getelementptr inbounds [16 x i8], ptr %iv_dec72, i64 0, i64 0
  %92 = load ptr, ptr %transform, align 8
  %fixed_ivlen74 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %92, i32 0, i32 4
  %93 = load i64, ptr %fixed_ivlen74, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %arraydecay71, ptr align 8 %arraydecay73, i64 %93, i1 false)
  %arraydecay75 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %94 = load ptr, ptr %transform, align 8
  %fixed_ivlen76 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %94, i32 0, i32 4
  %95 = load i64, ptr %fixed_ivlen76, align 8
  %add.ptr77 = getelementptr inbounds i8, ptr %arraydecay75, i64 %95
  %96 = load ptr, ptr %ssl.addr, align 8
  %in_iv = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %96, i32 0, i32 27
  %97 = load ptr, ptr %in_iv, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr77, ptr align 1 %97, i64 8, i1 false)
  br label %if.end105

if.else78:                                        ; preds = %land.lhs.true, %if.end44
  %98 = load ptr, ptr %transform, align 8
  %ivlen79 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %98, i32 0, i32 3
  %99 = load i64, ptr %ivlen79, align 8
  %cmp80 = icmp eq i64 %99, 12
  br i1 %cmp80, label %land.lhs.true82, label %if.else103

land.lhs.true82:                                  ; preds = %if.else78
  %100 = load ptr, ptr %transform, align 8
  %fixed_ivlen83 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %100, i32 0, i32 4
  %101 = load i64, ptr %fixed_ivlen83, align 8
  %cmp84 = icmp eq i64 %101, 12
  br i1 %cmp84, label %if.then86, label %if.else103

if.then86:                                        ; preds = %land.lhs.true82
  %arraydecay87 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %102 = load ptr, ptr %transform, align 8
  %iv_dec88 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %102, i32 0, i32 7
  %arraydecay89 = getelementptr inbounds [16 x i8], ptr %iv_dec88, i64 0, i64 0
  %103 = load ptr, ptr %transform, align 8
  %fixed_ivlen90 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %103, i32 0, i32 4
  %104 = load i64, ptr %fixed_ivlen90, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %arraydecay87, ptr align 8 %arraydecay89, i64 %104, i1 false)
  store i8 0, ptr %i, align 1
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %if.then86
  %105 = load i8, ptr %i, align 1
  %conv91 = zext i8 %105 to i32
  %cmp92 = icmp slt i32 %conv91, 8
  br i1 %cmp92, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %106 = load ptr, ptr %ssl.addr, align 8
  %in_ctr94 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %106, i32 0, i32 24
  %107 = load ptr, ptr %in_ctr94, align 8
  %108 = load i8, ptr %i, align 1
  %idxprom = zext i8 %108 to i64
  %arrayidx95 = getelementptr inbounds i8, ptr %107, i64 %idxprom
  %109 = load i8, ptr %arrayidx95, align 1
  %conv96 = zext i8 %109 to i32
  %110 = load i8, ptr %i, align 1
  %conv97 = zext i8 %110 to i32
  %add98 = add nsw i32 %conv97, 4
  %idxprom99 = sext i32 %add98 to i64
  %arrayidx100 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 %idxprom99
  %111 = load i8, ptr %arrayidx100, align 1
  %conv101 = zext i8 %111 to i32
  %xor = xor i32 %conv101, %conv96
  %conv102 = trunc i32 %xor to i8
  store i8 %conv102, ptr %arrayidx100, align 1
  br label %for.inc

for.inc:                                          ; preds = %for.body
  %112 = load i8, ptr %i, align 1
  %inc = add i8 %112, 1
  store i8 %inc, ptr %i, align 1
  br label %for.cond, !llvm.loop !43

for.end:                                          ; preds = %for.cond
  br label %if.end104

if.else103:                                       ; preds = %land.lhs.true82, %if.else78
  %113 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %113, i32 noundef 1, ptr noundef @.str, i32 noundef 1906, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end104:                                        ; preds = %for.end
  br label %if.end105

if.end105:                                        ; preds = %if.end104, %if.then70
  %114 = load ptr, ptr %ssl.addr, align 8
  %arraydecay106 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %115 = load ptr, ptr %transform, align 8
  %ivlen107 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %115, i32 0, i32 3
  %116 = load i64, ptr %ivlen107, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %114, i32 noundef 4, ptr noundef @.str, i32 noundef 1910, ptr noundef @.str.269, ptr noundef %arraydecay106, i64 noundef %116)
  %117 = load ptr, ptr %ssl.addr, align 8
  %118 = load ptr, ptr %dec_msg, align 8
  %119 = load i64, ptr %dec_msglen, align 8
  %add.ptr108 = getelementptr inbounds i8, ptr %118, i64 %119
  %120 = load i8, ptr %taglen, align 1
  %conv109 = zext i8 %120 to i64
  call void @mbedtls_debug_print_buf(ptr noundef %117, i32 noundef 4, ptr noundef @.str, i32 noundef 1911, ptr noundef @.str.270, ptr noundef %add.ptr108, i64 noundef %conv109)
  %121 = load ptr, ptr %ssl.addr, align 8
  %transform_in110 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %121, i32 0, i32 16
  %122 = load ptr, ptr %transform_in110, align 8
  %cipher_ctx_dec111 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %122, i32 0, i32 11
  %arraydecay112 = getelementptr inbounds [12 x i8], ptr %iv, i64 0, i64 0
  %123 = load ptr, ptr %transform, align 8
  %ivlen113 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %123, i32 0, i32 3
  %124 = load i64, ptr %ivlen113, align 8
  %arraydecay114 = getelementptr inbounds [13 x i8], ptr %add_data, i64 0, i64 0
  %125 = load ptr, ptr %dec_msg, align 8
  %126 = load i64, ptr %dec_msglen, align 8
  %127 = load ptr, ptr %dec_msg_result, align 8
  %128 = load ptr, ptr %dec_msg, align 8
  %129 = load i64, ptr %dec_msglen, align 8
  %add.ptr115 = getelementptr inbounds i8, ptr %128, i64 %129
  %130 = load i8, ptr %taglen, align 1
  %conv116 = zext i8 %130 to i64
  %call117 = call i32 @mbedtls_cipher_auth_decrypt(ptr noundef %cipher_ctx_dec111, ptr noundef %arraydecay112, i64 noundef %124, ptr noundef %arraydecay114, i64 noundef 13, ptr noundef %125, i64 noundef %126, ptr noundef %127, ptr noundef %olen33, ptr noundef %add.ptr115, i64 noundef %conv116)
  store i32 %call117, ptr %ret32, align 4
  %cmp118 = icmp ne i32 %call117, 0
  br i1 %cmp118, label %if.then120, label %if.end125

if.then120:                                       ; preds = %if.end105
  %131 = load ptr, ptr %ssl.addr, align 8
  %132 = load i32, ptr %ret32, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %131, i32 noundef 1, ptr noundef @.str, i32 noundef 1923, ptr noundef @.str.271, i32 noundef %132)
  %133 = load i32, ptr %ret32, align 4
  %cmp121 = icmp eq i32 %133, -25344
  br i1 %cmp121, label %if.then123, label %if.end124

if.then123:                                       ; preds = %if.then120
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end124:                                        ; preds = %if.then120
  %134 = load i32, ptr %ret32, align 4
  store i32 %134, ptr %retval, align 4
  br label %return

if.end125:                                        ; preds = %if.end105
  %135 = load i32, ptr %auth_done, align 4
  %inc126 = add nsw i32 %135, 1
  store i32 %inc126, ptr %auth_done, align 4
  %136 = load i64, ptr %olen33, align 8
  %137 = load i64, ptr %dec_msglen, align 8
  %cmp127 = icmp ne i64 %136, %137
  br i1 %cmp127, label %if.then129, label %if.end130

if.then129:                                       ; preds = %if.end125
  %138 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %138, i32 noundef 1, ptr noundef @.str, i32 noundef 1934, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end130:                                        ; preds = %if.end125
  br label %if.end374

if.else131:                                       ; preds = %lor.lhs.false29
  %139 = load i32, ptr %mode, align 4
  %cmp132 = icmp eq i32 %139, 2
  br i1 %cmp132, label %if.then134, label %if.else372

if.then134:                                       ; preds = %if.else131
  store i64 0, ptr %minlen139, align 8
  store i64 0, ptr %olen140, align 8
  %140 = load ptr, ptr %ssl.addr, align 8
  %minor_ver141 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %140, i32 0, i32 5
  %141 = load i32, ptr %minor_ver141, align 8
  %cmp142 = icmp sge i32 %141, 2
  br i1 %cmp142, label %if.then144, label %if.end148

if.then144:                                       ; preds = %if.then134
  %142 = load ptr, ptr %ssl.addr, align 8
  %transform_in145 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %142, i32 0, i32 16
  %143 = load ptr, ptr %transform_in145, align 8
  %ivlen146 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %143, i32 0, i32 3
  %144 = load i64, ptr %ivlen146, align 8
  %145 = load i64, ptr %minlen139, align 8
  %add147 = add i64 %145, %144
  store i64 %add147, ptr %minlen139, align 8
  br label %if.end148

if.end148:                                        ; preds = %if.then144, %if.then134
  %146 = load ptr, ptr %ssl.addr, align 8
  %in_msglen149 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %146, i32 0, i32 31
  %147 = load i64, ptr %in_msglen149, align 8
  %148 = load i64, ptr %minlen139, align 8
  %149 = load ptr, ptr %ssl.addr, align 8
  %transform_in150 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %149, i32 0, i32 16
  %150 = load ptr, ptr %transform_in150, align 8
  %ivlen151 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %150, i32 0, i32 3
  %151 = load i64, ptr %ivlen151, align 8
  %add152 = add i64 %148, %151
  %cmp153 = icmp ult i64 %147, %add152
  br i1 %cmp153, label %if.then162, label %lor.lhs.false155

lor.lhs.false155:                                 ; preds = %if.end148
  %152 = load ptr, ptr %ssl.addr, align 8
  %in_msglen156 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %152, i32 0, i32 31
  %153 = load i64, ptr %in_msglen156, align 8
  %154 = load i64, ptr %minlen139, align 8
  %155 = load ptr, ptr %ssl.addr, align 8
  %transform_in157 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %155, i32 0, i32 16
  %156 = load ptr, ptr %transform_in157, align 8
  %maclen = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %156, i32 0, i32 5
  %157 = load i64, ptr %maclen, align 8
  %add158 = add i64 %154, %157
  %add159 = add i64 %add158, 1
  %cmp160 = icmp ult i64 %153, %add159
  br i1 %cmp160, label %if.then162, label %if.end168

if.then162:                                       ; preds = %lor.lhs.false155, %if.end148
  %158 = load ptr, ptr %ssl.addr, align 8
  %159 = load ptr, ptr %ssl.addr, align 8
  %in_msglen163 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %159, i32 0, i32 31
  %160 = load i64, ptr %in_msglen163, align 8
  %161 = load ptr, ptr %ssl.addr, align 8
  %transform_in164 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %161, i32 0, i32 16
  %162 = load ptr, ptr %transform_in164, align 8
  %ivlen165 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %162, i32 0, i32 3
  %163 = load i64, ptr %ivlen165, align 8
  %164 = load ptr, ptr %ssl.addr, align 8
  %transform_in166 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %164, i32 0, i32 16
  %165 = load ptr, ptr %transform_in166, align 8
  %maclen167 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %165, i32 0, i32 5
  %166 = load i64, ptr %maclen167, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %158, i32 noundef 1, ptr noundef @.str, i32 noundef 1968, ptr noundef @.str.272, i64 noundef %160, i64 noundef %163, i64 noundef %166)
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end168:                                        ; preds = %lor.lhs.false155
  %167 = load ptr, ptr %ssl.addr, align 8
  %in_msglen169 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %167, i32 0, i32 31
  %168 = load i64, ptr %in_msglen169, align 8
  store i64 %168, ptr %dec_msglen138, align 8
  %169 = load ptr, ptr %ssl.addr, align 8
  %in_msg170 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %169, i32 0, i32 28
  %170 = load ptr, ptr %in_msg170, align 8
  store ptr %170, ptr %dec_msg136, align 8
  %171 = load ptr, ptr %ssl.addr, align 8
  %in_msg171 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %171, i32 0, i32 28
  %172 = load ptr, ptr %in_msg171, align 8
  store ptr %172, ptr %dec_msg_result137, align 8
  %173 = load ptr, ptr %ssl.addr, align 8
  %session_in172 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %173, i32 0, i32 11
  %174 = load ptr, ptr %session_in172, align 8
  %encrypt_then_mac = getelementptr inbounds %struct.mbedtls_ssl_session, ptr %174, i32 0, i32 13
  %175 = load i32, ptr %encrypt_then_mac, align 4
  %cmp173 = icmp eq i32 %175, 1
  br i1 %cmp173, label %if.then175, label %if.end233

if.then175:                                       ; preds = %if.end168
  %176 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %176, i32 noundef 3, ptr noundef @.str, i32 noundef 1985, ptr noundef @.str.204)
  %177 = load ptr, ptr %ssl.addr, align 8
  %transform_in176 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %177, i32 0, i32 16
  %178 = load ptr, ptr %transform_in176, align 8
  %maclen177 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %178, i32 0, i32 5
  %179 = load i64, ptr %maclen177, align 8
  %180 = load i64, ptr %dec_msglen138, align 8
  %sub178 = sub i64 %180, %179
  store i64 %sub178, ptr %dec_msglen138, align 8
  %181 = load ptr, ptr %ssl.addr, align 8
  %transform_in179 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %181, i32 0, i32 16
  %182 = load ptr, ptr %transform_in179, align 8
  %maclen180 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %182, i32 0, i32 5
  %183 = load i64, ptr %maclen180, align 8
  %184 = load ptr, ptr %ssl.addr, align 8
  %in_msglen181 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %184, i32 0, i32 31
  %185 = load i64, ptr %in_msglen181, align 8
  %sub182 = sub i64 %185, %183
  store i64 %sub182, ptr %in_msglen181, align 8
  %arraydecay183 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  %add.ptr184 = getelementptr inbounds i8, ptr %arraydecay183, i64 0
  %186 = load ptr, ptr %ssl.addr, align 8
  %in_ctr185 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %186, i32 0, i32 24
  %187 = load ptr, ptr %in_ctr185, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr184, ptr align 1 %187, i64 8, i1 false)
  %arraydecay186 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  %add.ptr187 = getelementptr inbounds i8, ptr %arraydecay186, i64 8
  %188 = load ptr, ptr %ssl.addr, align 8
  %in_hdr = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %188, i32 0, i32 25
  %189 = load ptr, ptr %in_hdr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %add.ptr187, ptr align 1 %189, i64 3, i1 false)
  %190 = load ptr, ptr %ssl.addr, align 8
  %in_msglen188 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %190, i32 0, i32 31
  %191 = load i64, ptr %in_msglen188, align 8
  %shr189 = lshr i64 %191, 8
  %and190 = and i64 %shr189, 255
  %conv191 = trunc i64 %and190 to i8
  %arrayidx192 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 11
  store i8 %conv191, ptr %arrayidx192, align 1
  %192 = load ptr, ptr %ssl.addr, align 8
  %in_msglen193 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %192, i32 0, i32 31
  %193 = load i64, ptr %in_msglen193, align 8
  %and194 = and i64 %193, 255
  %conv195 = trunc i64 %and194 to i8
  %arrayidx196 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 12
  store i8 %conv195, ptr %arrayidx196, align 1
  %194 = load ptr, ptr %ssl.addr, align 8
  %arraydecay197 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  call void @mbedtls_debug_print_buf(ptr noundef %194, i32 noundef 4, ptr noundef @.str, i32 noundef 1995, ptr noundef @.str.205, ptr noundef %arraydecay197, i64 noundef 13)
  %195 = load ptr, ptr %ssl.addr, align 8
  %transform_in198 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %195, i32 0, i32 16
  %196 = load ptr, ptr %transform_in198, align 8
  %md_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %196, i32 0, i32 9
  %arraydecay199 = getelementptr inbounds [13 x i8], ptr %pseudo_hdr, i64 0, i64 0
  %call200 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_dec, ptr noundef %arraydecay199, i64 noundef 13)
  %197 = load ptr, ptr %ssl.addr, align 8
  %transform_in201 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %197, i32 0, i32 16
  %198 = load ptr, ptr %transform_in201, align 8
  %md_ctx_dec202 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %198, i32 0, i32 9
  %199 = load ptr, ptr %ssl.addr, align 8
  %in_iv203 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %199, i32 0, i32 27
  %200 = load ptr, ptr %in_iv203, align 8
  %201 = load ptr, ptr %ssl.addr, align 8
  %in_msglen204 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %201, i32 0, i32 31
  %202 = load i64, ptr %in_msglen204, align 8
  %call205 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_dec202, ptr noundef %200, i64 noundef %202)
  %203 = load ptr, ptr %ssl.addr, align 8
  %transform_in206 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %203, i32 0, i32 16
  %204 = load ptr, ptr %transform_in206, align 8
  %md_ctx_dec207 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %204, i32 0, i32 9
  %arraydecay208 = getelementptr inbounds [48 x i8], ptr %mac_expect, i64 0, i64 0
  %call209 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx_dec207, ptr noundef %arraydecay208)
  %205 = load ptr, ptr %ssl.addr, align 8
  %transform_in210 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %205, i32 0, i32 16
  %206 = load ptr, ptr %transform_in210, align 8
  %md_ctx_dec211 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %206, i32 0, i32 9
  %call212 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx_dec211)
  %207 = load ptr, ptr %ssl.addr, align 8
  %208 = load ptr, ptr %ssl.addr, align 8
  %in_iv213 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %208, i32 0, i32 27
  %209 = load ptr, ptr %in_iv213, align 8
  %210 = load ptr, ptr %ssl.addr, align 8
  %in_msglen214 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %210, i32 0, i32 31
  %211 = load i64, ptr %in_msglen214, align 8
  %add.ptr215 = getelementptr inbounds i8, ptr %209, i64 %211
  %212 = load ptr, ptr %ssl.addr, align 8
  %transform_in216 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %212, i32 0, i32 16
  %213 = load ptr, ptr %transform_in216, align 8
  %maclen217 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %213, i32 0, i32 5
  %214 = load i64, ptr %maclen217, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %207, i32 noundef 4, ptr noundef @.str, i32 noundef 2004, ptr noundef @.str.273, ptr noundef %add.ptr215, i64 noundef %214)
  %215 = load ptr, ptr %ssl.addr, align 8
  %arraydecay218 = getelementptr inbounds [48 x i8], ptr %mac_expect, i64 0, i64 0
  %216 = load ptr, ptr %ssl.addr, align 8
  %transform_in219 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %216, i32 0, i32 16
  %217 = load ptr, ptr %transform_in219, align 8
  %maclen220 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %217, i32 0, i32 5
  %218 = load i64, ptr %maclen220, align 8
  call void @mbedtls_debug_print_buf(ptr noundef %215, i32 noundef 4, ptr noundef @.str, i32 noundef 2006, ptr noundef @.str.274, ptr noundef %arraydecay218, i64 noundef %218)
  %219 = load ptr, ptr %ssl.addr, align 8
  %in_iv221 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %219, i32 0, i32 27
  %220 = load ptr, ptr %in_iv221, align 8
  %221 = load ptr, ptr %ssl.addr, align 8
  %in_msglen222 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %221, i32 0, i32 31
  %222 = load i64, ptr %in_msglen222, align 8
  %add.ptr223 = getelementptr inbounds i8, ptr %220, i64 %222
  %arraydecay224 = getelementptr inbounds [48 x i8], ptr %mac_expect, i64 0, i64 0
  %223 = load ptr, ptr %ssl.addr, align 8
  %transform_in225 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %223, i32 0, i32 16
  %224 = load ptr, ptr %transform_in225, align 8
  %maclen226 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %224, i32 0, i32 5
  %225 = load i64, ptr %maclen226, align 8
  %call227 = call i32 @mbedtls_ssl_safer_memcmp(ptr noundef %add.ptr223, ptr noundef %arraydecay224, i64 noundef %225)
  %cmp228 = icmp ne i32 %call227, 0
  br i1 %cmp228, label %if.then230, label %if.end231

if.then230:                                       ; preds = %if.then175
  %226 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %226, i32 noundef 1, ptr noundef @.str, i32 noundef 2011, ptr noundef @.str.275)
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end231:                                        ; preds = %if.then175
  %227 = load i32, ptr %auth_done, align 4
  %inc232 = add nsw i32 %227, 1
  store i32 %inc232, ptr %auth_done, align 4
  br label %if.end233

if.end233:                                        ; preds = %if.end231, %if.end168
  %228 = load ptr, ptr %ssl.addr, align 8
  %in_msglen234 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %228, i32 0, i32 31
  %229 = load i64, ptr %in_msglen234, align 8
  %230 = load ptr, ptr %ssl.addr, align 8
  %transform_in235 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %230, i32 0, i32 16
  %231 = load ptr, ptr %transform_in235, align 8
  %ivlen236 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %231, i32 0, i32 3
  %232 = load i64, ptr %ivlen236, align 8
  %rem = urem i64 %229, %232
  %cmp237 = icmp ne i64 %rem, 0
  br i1 %cmp237, label %if.then239, label %if.end243

if.then239:                                       ; preds = %if.end233
  %233 = load ptr, ptr %ssl.addr, align 8
  %234 = load ptr, ptr %ssl.addr, align 8
  %in_msglen240 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %234, i32 0, i32 31
  %235 = load i64, ptr %in_msglen240, align 8
  %236 = load ptr, ptr %ssl.addr, align 8
  %transform_in241 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %236, i32 0, i32 16
  %237 = load ptr, ptr %transform_in241, align 8
  %ivlen242 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %237, i32 0, i32 3
  %238 = load i64, ptr %ivlen242, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %233, i32 noundef 1, ptr noundef @.str, i32 noundef 2025, ptr noundef @.str.276, i64 noundef %235, i64 noundef %238)
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end243:                                        ; preds = %if.end233
  %239 = load ptr, ptr %ssl.addr, align 8
  %minor_ver244 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %239, i32 0, i32 5
  %240 = load i32, ptr %minor_ver244, align 8
  %cmp245 = icmp sge i32 %240, 2
  br i1 %cmp245, label %if.then247, label %if.end273

if.then247:                                       ; preds = %if.end243
  %241 = load ptr, ptr %ssl.addr, align 8
  %transform_in249 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %241, i32 0, i32 16
  %242 = load ptr, ptr %transform_in249, align 8
  %ivlen250 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %242, i32 0, i32 3
  %243 = load i64, ptr %ivlen250, align 8
  %244 = load i64, ptr %dec_msglen138, align 8
  %sub251 = sub i64 %244, %243
  store i64 %sub251, ptr %dec_msglen138, align 8
  %245 = load ptr, ptr %ssl.addr, align 8
  %transform_in252 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %245, i32 0, i32 16
  %246 = load ptr, ptr %transform_in252, align 8
  %ivlen253 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %246, i32 0, i32 3
  %247 = load i64, ptr %ivlen253, align 8
  %248 = load ptr, ptr %ssl.addr, align 8
  %in_msglen254 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %248, i32 0, i32 31
  %249 = load i64, ptr %in_msglen254, align 8
  %sub255 = sub i64 %249, %247
  store i64 %sub255, ptr %in_msglen254, align 8
  store i8 0, ptr %i248, align 1
  br label %for.cond256

for.cond256:                                      ; preds = %for.inc270, %if.then247
  %250 = load i8, ptr %i248, align 1
  %conv257 = zext i8 %250 to i64
  %251 = load ptr, ptr %ssl.addr, align 8
  %transform_in258 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %251, i32 0, i32 16
  %252 = load ptr, ptr %transform_in258, align 8
  %ivlen259 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %252, i32 0, i32 3
  %253 = load i64, ptr %ivlen259, align 8
  %cmp260 = icmp ult i64 %conv257, %253
  br i1 %cmp260, label %for.body262, label %for.end272

for.body262:                                      ; preds = %for.cond256
  %254 = load ptr, ptr %ssl.addr, align 8
  %in_iv263 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %254, i32 0, i32 27
  %255 = load ptr, ptr %in_iv263, align 8
  %256 = load i8, ptr %i248, align 1
  %idxprom264 = zext i8 %256 to i64
  %arrayidx265 = getelementptr inbounds i8, ptr %255, i64 %idxprom264
  %257 = load i8, ptr %arrayidx265, align 1
  %258 = load ptr, ptr %ssl.addr, align 8
  %transform_in266 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %258, i32 0, i32 16
  %259 = load ptr, ptr %transform_in266, align 8
  %iv_dec267 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %259, i32 0, i32 7
  %260 = load i8, ptr %i248, align 1
  %idxprom268 = zext i8 %260 to i64
  %arrayidx269 = getelementptr inbounds [16 x i8], ptr %iv_dec267, i64 0, i64 %idxprom268
  store i8 %257, ptr %arrayidx269, align 1
  br label %for.inc270

for.inc270:                                       ; preds = %for.body262
  %261 = load i8, ptr %i248, align 1
  %inc271 = add i8 %261, 1
  store i8 %inc271, ptr %i248, align 1
  br label %for.cond256, !llvm.loop !44

for.end272:                                       ; preds = %for.cond256
  br label %if.end273

if.end273:                                        ; preds = %for.end272, %if.end243
  %262 = load ptr, ptr %ssl.addr, align 8
  %transform_in274 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %262, i32 0, i32 16
  %263 = load ptr, ptr %transform_in274, align 8
  %cipher_ctx_dec275 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %263, i32 0, i32 11
  %264 = load ptr, ptr %ssl.addr, align 8
  %transform_in276 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %264, i32 0, i32 16
  %265 = load ptr, ptr %transform_in276, align 8
  %iv_dec277 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %265, i32 0, i32 7
  %arraydecay278 = getelementptr inbounds [16 x i8], ptr %iv_dec277, i64 0, i64 0
  %266 = load ptr, ptr %ssl.addr, align 8
  %transform_in279 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %266, i32 0, i32 16
  %267 = load ptr, ptr %transform_in279, align 8
  %ivlen280 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %267, i32 0, i32 3
  %268 = load i64, ptr %ivlen280, align 8
  %269 = load ptr, ptr %dec_msg136, align 8
  %270 = load i64, ptr %dec_msglen138, align 8
  %271 = load ptr, ptr %dec_msg_result137, align 8
  %call281 = call i32 @mbedtls_cipher_crypt(ptr noundef %cipher_ctx_dec275, ptr noundef %arraydecay278, i64 noundef %268, ptr noundef %269, i64 noundef %270, ptr noundef %271, ptr noundef %olen140)
  store i32 %call281, ptr %ret135, align 4
  %cmp282 = icmp ne i32 %call281, 0
  br i1 %cmp282, label %if.then284, label %if.end285

if.then284:                                       ; preds = %if.end273
  %272 = load ptr, ptr %ssl.addr, align 8
  %273 = load i32, ptr %ret135, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %272, i32 noundef 1, ptr noundef @.str, i32 noundef 2050, ptr noundef @.str.196, i32 noundef %273)
  %274 = load i32, ptr %ret135, align 4
  store i32 %274, ptr %retval, align 4
  br label %return

if.end285:                                        ; preds = %if.end273
  %275 = load i64, ptr %dec_msglen138, align 8
  %276 = load i64, ptr %olen140, align 8
  %cmp286 = icmp ne i64 %275, %276
  br i1 %cmp286, label %if.then288, label %if.end289

if.then288:                                       ; preds = %if.end285
  %277 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %277, i32 noundef 1, ptr noundef @.str, i32 noundef 2056, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end289:                                        ; preds = %if.end285
  %278 = load ptr, ptr %ssl.addr, align 8
  %minor_ver290 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %278, i32 0, i32 5
  %279 = load i32, ptr %minor_ver290, align 8
  %cmp291 = icmp slt i32 %279, 2
  br i1 %cmp291, label %if.then293, label %if.end303

if.then293:                                       ; preds = %if.end289
  %280 = load ptr, ptr %ssl.addr, align 8
  %transform_in294 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %280, i32 0, i32 16
  %281 = load ptr, ptr %transform_in294, align 8
  %iv_dec295 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %281, i32 0, i32 7
  %arraydecay296 = getelementptr inbounds [16 x i8], ptr %iv_dec295, i64 0, i64 0
  %282 = load ptr, ptr %ssl.addr, align 8
  %transform_in297 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %282, i32 0, i32 16
  %283 = load ptr, ptr %transform_in297, align 8
  %cipher_ctx_dec298 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %283, i32 0, i32 11
  %iv299 = getelementptr inbounds %struct.mbedtls_cipher_context_t, ptr %cipher_ctx_dec298, i32 0, i32 7
  %arraydecay300 = getelementptr inbounds [16 x i8], ptr %iv299, i64 0, i64 0
  %284 = load ptr, ptr %ssl.addr, align 8
  %transform_in301 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %284, i32 0, i32 16
  %285 = load ptr, ptr %transform_in301, align 8
  %ivlen302 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %285, i32 0, i32 3
  %286 = load i64, ptr %ivlen302, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 8 %arraydecay296, ptr align 8 %arraydecay300, i64 %286, i1 false)
  br label %if.end303

if.end303:                                        ; preds = %if.then293, %if.end289
  %287 = load ptr, ptr %ssl.addr, align 8
  %in_msg304 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %287, i32 0, i32 28
  %288 = load ptr, ptr %in_msg304, align 8
  %289 = load ptr, ptr %ssl.addr, align 8
  %in_msglen305 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %289, i32 0, i32 31
  %290 = load i64, ptr %in_msglen305, align 8
  %sub306 = sub i64 %290, 1
  %arrayidx307 = getelementptr inbounds i8, ptr %288, i64 %sub306
  %291 = load i8, ptr %arrayidx307, align 1
  %conv308 = zext i8 %291 to i32
  %add309 = add nsw i32 1, %conv308
  %conv310 = sext i32 %add309 to i64
  store i64 %conv310, ptr %padlen, align 8
  %292 = load ptr, ptr %ssl.addr, align 8
  %in_msglen311 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %292, i32 0, i32 31
  %293 = load i64, ptr %in_msglen311, align 8
  %294 = load ptr, ptr %ssl.addr, align 8
  %transform_in312 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %294, i32 0, i32 16
  %295 = load ptr, ptr %transform_in312, align 8
  %maclen313 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %295, i32 0, i32 5
  %296 = load i64, ptr %maclen313, align 8
  %297 = load i64, ptr %padlen, align 8
  %add314 = add i64 %296, %297
  %cmp315 = icmp ult i64 %293, %add314
  br i1 %cmp315, label %land.lhs.true317, label %if.end321

land.lhs.true317:                                 ; preds = %if.end303
  %298 = load i32, ptr %auth_done, align 4
  %cmp318 = icmp eq i32 %298, 0
  br i1 %cmp318, label %if.then320, label %if.end321

if.then320:                                       ; preds = %land.lhs.true317
  store i64 0, ptr %padlen, align 8
  store i64 0, ptr %correct, align 8
  br label %if.end321

if.end321:                                        ; preds = %if.then320, %land.lhs.true317, %if.end303
  %299 = load ptr, ptr %ssl.addr, align 8
  %minor_ver322 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %299, i32 0, i32 5
  %300 = load i32, ptr %minor_ver322, align 8
  %cmp323 = icmp sgt i32 %300, 0
  br i1 %cmp323, label %if.then325, label %if.else368

if.then325:                                       ; preds = %if.end321
  store i64 0, ptr %pad_count, align 8
  store i64 1, ptr %real_count, align 8
  %301 = load ptr, ptr %ssl.addr, align 8
  %in_msglen326 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %301, i32 0, i32 31
  %302 = load i64, ptr %in_msglen326, align 8
  %303 = load i64, ptr %padlen, align 8
  %sub327 = sub i64 %302, %303
  store i64 %sub327, ptr %padding_idx, align 8
  %304 = load i64, ptr %padlen, align 8
  %305 = load ptr, ptr %ssl.addr, align 8
  %in_msglen329 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %305, i32 0, i32 31
  %306 = load i64, ptr %in_msglen329, align 8
  %cmp330 = icmp ule i64 %304, %306
  %conv331 = zext i1 %cmp330 to i32
  %conv332 = sext i32 %conv331 to i64
  %307 = load i64, ptr %correct, align 8
  %and333 = and i64 %307, %conv332
  store i64 %and333, ptr %correct, align 8
  %308 = load i64, ptr %padding_idx, align 8
  %309 = load ptr, ptr %ssl.addr, align 8
  %transform_in334 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %309, i32 0, i32 16
  %310 = load ptr, ptr %transform_in334, align 8
  %maclen335 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %310, i32 0, i32 5
  %311 = load i64, ptr %maclen335, align 8
  %add336 = add i64 16384, %311
  %cmp337 = icmp ule i64 %308, %add336
  %conv338 = zext i1 %cmp337 to i32
  %conv339 = sext i32 %conv338 to i64
  %312 = load i64, ptr %correct, align 8
  %and340 = and i64 %312, %conv339
  store i64 %and340, ptr %correct, align 8
  %313 = load i64, ptr %correct, align 8
  %314 = load i64, ptr %padding_idx, align 8
  %mul = mul i64 %314, %313
  store i64 %mul, ptr %padding_idx, align 8
  store i64 0, ptr %i328, align 8
  br label %for.cond341

for.cond341:                                      ; preds = %for.inc359, %if.then325
  %315 = load i64, ptr %i328, align 8
  %cmp342 = icmp ult i64 %315, 256
  br i1 %cmp342, label %for.body344, label %for.end361

for.body344:                                      ; preds = %for.cond341
  %316 = load i64, ptr %i328, align 8
  %317 = load i64, ptr %padlen, align 8
  %cmp345 = icmp ult i64 %316, %317
  %conv346 = zext i1 %cmp345 to i32
  %conv347 = sext i32 %conv346 to i64
  %318 = load i64, ptr %real_count, align 8
  %and348 = and i64 %318, %conv347
  store i64 %and348, ptr %real_count, align 8
  %319 = load i64, ptr %real_count, align 8
  %320 = load ptr, ptr %ssl.addr, align 8
  %in_msg349 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %320, i32 0, i32 28
  %321 = load ptr, ptr %in_msg349, align 8
  %322 = load i64, ptr %padding_idx, align 8
  %323 = load i64, ptr %i328, align 8
  %add350 = add i64 %322, %323
  %arrayidx351 = getelementptr inbounds i8, ptr %321, i64 %add350
  %324 = load i8, ptr %arrayidx351, align 1
  %conv352 = zext i8 %324 to i64
  %325 = load i64, ptr %padlen, align 8
  %sub353 = sub i64 %325, 1
  %cmp354 = icmp eq i64 %conv352, %sub353
  %conv355 = zext i1 %cmp354 to i32
  %conv356 = sext i32 %conv355 to i64
  %mul357 = mul i64 %319, %conv356
  %326 = load i64, ptr %pad_count, align 8
  %add358 = add i64 %326, %mul357
  store i64 %add358, ptr %pad_count, align 8
  br label %for.inc359

for.inc359:                                       ; preds = %for.body344
  %327 = load i64, ptr %i328, align 8
  %inc360 = add i64 %327, 1
  store i64 %inc360, ptr %i328, align 8
  br label %for.cond341, !llvm.loop !45

for.end361:                                       ; preds = %for.cond341
  %328 = load i64, ptr %pad_count, align 8
  %329 = load i64, ptr %padlen, align 8
  %cmp362 = icmp eq i64 %328, %329
  %conv363 = zext i1 %cmp362 to i32
  %conv364 = sext i32 %conv363 to i64
  %330 = load i64, ptr %correct, align 8
  %and365 = and i64 %330, %conv364
  store i64 %and365, ptr %correct, align 8
  %331 = load i64, ptr %correct, align 8
  %mul366 = mul i64 %331, 511
  %332 = load i64, ptr %padlen, align 8
  %and367 = and i64 %332, %mul366
  store i64 %and367, ptr %padlen, align 8
  br label %if.end369

if.else368:                                       ; preds = %if.end321
  %333 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %333, i32 noundef 1, ptr noundef @.str, i32 noundef 2147, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end369:                                        ; preds = %for.end361
  %334 = load i64, ptr %padlen, align 8
  %335 = load ptr, ptr %ssl.addr, align 8
  %in_msglen370 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %335, i32 0, i32 31
  %336 = load i64, ptr %in_msglen370, align 8
  %sub371 = sub i64 %336, %334
  store i64 %sub371, ptr %in_msglen370, align 8
  br label %if.end373

if.else372:                                       ; preds = %if.else131
  %337 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %337, i32 noundef 1, ptr noundef @.str, i32 noundef 2157, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end373:                                        ; preds = %if.end369
  br label %if.end374

if.end374:                                        ; preds = %if.end373, %if.end130
  br label %if.end375

if.end375:                                        ; preds = %if.end374, %if.end25
  %338 = load i32, ptr %auth_done, align 4
  %cmp376 = icmp eq i32 %338, 0
  br i1 %cmp376, label %if.then378, label %if.end485

if.then378:                                       ; preds = %if.end375
  %339 = load ptr, ptr %ssl.addr, align 8
  %transform_in380 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %339, i32 0, i32 16
  %340 = load ptr, ptr %transform_in380, align 8
  %maclen381 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %340, i32 0, i32 5
  %341 = load i64, ptr %maclen381, align 8
  %342 = load ptr, ptr %ssl.addr, align 8
  %in_msglen382 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %342, i32 0, i32 31
  %343 = load i64, ptr %in_msglen382, align 8
  %sub383 = sub i64 %343, %341
  store i64 %sub383, ptr %in_msglen382, align 8
  %344 = load ptr, ptr %ssl.addr, align 8
  %in_msglen384 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %344, i32 0, i32 31
  %345 = load i64, ptr %in_msglen384, align 8
  %shr385 = lshr i64 %345, 8
  %conv386 = trunc i64 %shr385 to i8
  %346 = load ptr, ptr %ssl.addr, align 8
  %in_len = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %346, i32 0, i32 26
  %347 = load ptr, ptr %in_len, align 8
  %arrayidx387 = getelementptr inbounds i8, ptr %347, i64 0
  store i8 %conv386, ptr %arrayidx387, align 1
  %348 = load ptr, ptr %ssl.addr, align 8
  %in_msglen388 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %348, i32 0, i32 31
  %349 = load i64, ptr %in_msglen388, align 8
  %conv389 = trunc i64 %349 to i8
  %350 = load ptr, ptr %ssl.addr, align 8
  %in_len390 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %350, i32 0, i32 26
  %351 = load ptr, ptr %in_len390, align 8
  %arrayidx391 = getelementptr inbounds i8, ptr %351, i64 1
  store i8 %conv389, ptr %arrayidx391, align 1
  %352 = load ptr, ptr %ssl.addr, align 8
  %minor_ver392 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %352, i32 0, i32 5
  %353 = load i32, ptr %minor_ver392, align 8
  %cmp393 = icmp sgt i32 %353, 0
  br i1 %cmp393, label %if.then395, label %if.else471

if.then395:                                       ; preds = %if.then378
  store i64 0, ptr %extra_run, align 8
  %354 = load ptr, ptr %ssl.addr, align 8
  %in_msglen396 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %354, i32 0, i32 31
  %355 = load i64, ptr %in_msglen396, align 8
  %356 = load i64, ptr %padlen, align 8
  %add397 = add i64 %355, %356
  store i64 %add397, ptr %max_len, align 8
  %357 = load i64, ptr %max_len, align 8
  %cmp398 = icmp ugt i64 %357, 256
  br i1 %cmp398, label %cond.true, label %cond.false

cond.true:                                        ; preds = %if.then395
  %358 = load i64, ptr %max_len, align 8
  %sub400 = sub i64 %358, 256
  br label %cond.end

cond.false:                                       ; preds = %if.then395
  br label %cond.end

cond.end:                                         ; preds = %cond.false, %cond.true
  %cond401 = phi i64 [ %sub400, %cond.true ], [ 0, %cond.false ]
  store i64 %cond401, ptr %min_len, align 8
  %359 = load ptr, ptr %ssl.addr, align 8
  %transform_in402 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %359, i32 0, i32 16
  %360 = load ptr, ptr %transform_in402, align 8
  %ciphersuite_info403 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %360, i32 0, i32 0
  %361 = load ptr, ptr %ciphersuite_info403, align 8
  %mac = getelementptr inbounds %struct.mbedtls_ssl_ciphersuite_t, ptr %361, i32 0, i32 3
  %362 = load i32, ptr %mac, align 4
  switch i32 %362, label %sw.default [
    i32 3, label %sw.bb
    i32 4, label %sw.bb
    i32 6, label %sw.bb
    i32 7, label %sw.bb413
  ]

sw.bb:                                            ; preds = %cond.end, %cond.end, %cond.end
  %363 = load ptr, ptr %ssl.addr, align 8
  %in_msglen404 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %363, i32 0, i32 31
  %364 = load i64, ptr %in_msglen404, align 8
  %add405 = add i64 13, %364
  %365 = load i64, ptr %padlen, align 8
  %add406 = add i64 %add405, %365
  %add407 = add i64 %add406, 8
  %div = udiv i64 %add407, 64
  %366 = load ptr, ptr %ssl.addr, align 8
  %in_msglen408 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %366, i32 0, i32 31
  %367 = load i64, ptr %in_msglen408, align 8
  %add409 = add i64 13, %367
  %add410 = add i64 %add409, 8
  %div411 = udiv i64 %add410, 64
  %sub412 = sub i64 %div, %div411
  store i64 %sub412, ptr %extra_run, align 8
  br label %sw.epilog

sw.bb413:                                         ; preds = %cond.end
  %368 = load ptr, ptr %ssl.addr, align 8
  %in_msglen414 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %368, i32 0, i32 31
  %369 = load i64, ptr %in_msglen414, align 8
  %add415 = add i64 13, %369
  %370 = load i64, ptr %padlen, align 8
  %add416 = add i64 %add415, %370
  %add417 = add i64 %add416, 16
  %div418 = udiv i64 %add417, 128
  %371 = load ptr, ptr %ssl.addr, align 8
  %in_msglen419 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %371, i32 0, i32 31
  %372 = load i64, ptr %in_msglen419, align 8
  %add420 = add i64 13, %372
  %add421 = add i64 %add420, 16
  %div422 = udiv i64 %add421, 128
  %sub423 = sub i64 %div418, %div422
  store i64 %sub423, ptr %extra_run, align 8
  br label %sw.epilog

sw.default:                                       ; preds = %cond.end
  %373 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %373, i32 noundef 1, ptr noundef @.str, i32 noundef 2257, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

sw.epilog:                                        ; preds = %sw.bb413, %sw.bb
  %374 = load i64, ptr %correct, align 8
  %mul424 = mul i64 %374, 255
  %375 = load i64, ptr %extra_run, align 8
  %and425 = and i64 %375, %mul424
  store i64 %and425, ptr %extra_run, align 8
  %376 = load ptr, ptr %ssl.addr, align 8
  %transform_in426 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %376, i32 0, i32 16
  %377 = load ptr, ptr %transform_in426, align 8
  %md_ctx_dec427 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %377, i32 0, i32 9
  %378 = load ptr, ptr %ssl.addr, align 8
  %in_ctr428 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %378, i32 0, i32 24
  %379 = load ptr, ptr %in_ctr428, align 8
  %call429 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_dec427, ptr noundef %379, i64 noundef 8)
  %380 = load ptr, ptr %ssl.addr, align 8
  %transform_in430 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %380, i32 0, i32 16
  %381 = load ptr, ptr %transform_in430, align 8
  %md_ctx_dec431 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %381, i32 0, i32 9
  %382 = load ptr, ptr %ssl.addr, align 8
  %in_hdr432 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %382, i32 0, i32 25
  %383 = load ptr, ptr %in_hdr432, align 8
  %call433 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_dec431, ptr noundef %383, i64 noundef 3)
  %384 = load ptr, ptr %ssl.addr, align 8
  %transform_in434 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %384, i32 0, i32 16
  %385 = load ptr, ptr %transform_in434, align 8
  %md_ctx_dec435 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %385, i32 0, i32 9
  %386 = load ptr, ptr %ssl.addr, align 8
  %in_len436 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %386, i32 0, i32 26
  %387 = load ptr, ptr %in_len436, align 8
  %call437 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_dec435, ptr noundef %387, i64 noundef 2)
  %388 = load ptr, ptr %ssl.addr, align 8
  %transform_in438 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %388, i32 0, i32 16
  %389 = load ptr, ptr %transform_in438, align 8
  %md_ctx_dec439 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %389, i32 0, i32 9
  %390 = load ptr, ptr %ssl.addr, align 8
  %in_msg440 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %390, i32 0, i32 28
  %391 = load ptr, ptr %in_msg440, align 8
  %392 = load ptr, ptr %ssl.addr, align 8
  %in_msglen441 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %392, i32 0, i32 31
  %393 = load i64, ptr %in_msglen441, align 8
  %call442 = call i32 @mbedtls_md_hmac_update(ptr noundef %md_ctx_dec439, ptr noundef %391, i64 noundef %393)
  %394 = load ptr, ptr %ssl.addr, align 8
  %in_msg443 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %394, i32 0, i32 28
  %395 = load ptr, ptr %in_msg443, align 8
  %396 = load ptr, ptr %ssl.addr, align 8
  %in_msglen444 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %396, i32 0, i32 31
  %397 = load i64, ptr %in_msglen444, align 8
  %add.ptr445 = getelementptr inbounds i8, ptr %395, i64 %397
  %398 = load i64, ptr %padlen, align 8
  call void @ssl_read_memory(ptr noundef %add.ptr445, i64 noundef %398)
  %399 = load ptr, ptr %ssl.addr, align 8
  %transform_in446 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %399, i32 0, i32 16
  %400 = load ptr, ptr %transform_in446, align 8
  %md_ctx_dec447 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %400, i32 0, i32 9
  %arraydecay448 = getelementptr inbounds [48 x i8], ptr %mac_expect379, i64 0, i64 0
  %call449 = call i32 @mbedtls_md_hmac_finish(ptr noundef %md_ctx_dec447, ptr noundef %arraydecay448)
  store i64 0, ptr %j, align 8
  br label %for.cond450

for.cond450:                                      ; preds = %for.inc459, %sw.epilog
  %401 = load i64, ptr %j, align 8
  %402 = load i64, ptr %extra_run, align 8
  %add451 = add i64 %402, 1
  %cmp452 = icmp ult i64 %401, %add451
  br i1 %cmp452, label %for.body454, label %for.end461

for.body454:                                      ; preds = %for.cond450
  %403 = load ptr, ptr %ssl.addr, align 8
  %transform_in455 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %403, i32 0, i32 16
  %404 = load ptr, ptr %transform_in455, align 8
  %md_ctx_dec456 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %404, i32 0, i32 9
  %405 = load ptr, ptr %ssl.addr, align 8
  %in_msg457 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %405, i32 0, i32 28
  %406 = load ptr, ptr %in_msg457, align 8
  %call458 = call i32 @mbedtls_md_process(ptr noundef %md_ctx_dec456, ptr noundef %406)
  br label %for.inc459

for.inc459:                                       ; preds = %for.body454
  %407 = load i64, ptr %j, align 8
  %inc460 = add i64 %407, 1
  store i64 %inc460, ptr %j, align 8
  br label %for.cond450, !llvm.loop !46

for.end461:                                       ; preds = %for.cond450
  %408 = load ptr, ptr %ssl.addr, align 8
  %transform_in462 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %408, i32 0, i32 16
  %409 = load ptr, ptr %transform_in462, align 8
  %md_ctx_dec463 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %409, i32 0, i32 9
  %call464 = call i32 @mbedtls_md_hmac_reset(ptr noundef %md_ctx_dec463)
  %410 = load ptr, ptr %ssl.addr, align 8
  %in_msg465 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %410, i32 0, i32 28
  %411 = load ptr, ptr %in_msg465, align 8
  %412 = load i64, ptr %min_len, align 8
  %add.ptr466 = getelementptr inbounds i8, ptr %411, i64 %412
  %413 = load i64, ptr %max_len, align 8
  %414 = load i64, ptr %min_len, align 8
  %sub467 = sub i64 %413, %414
  %415 = load ptr, ptr %ssl.addr, align 8
  %transform_in468 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %415, i32 0, i32 16
  %416 = load ptr, ptr %transform_in468, align 8
  %maclen469 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %416, i32 0, i32 5
  %417 = load i64, ptr %maclen469, align 8
  %add470 = add i64 %sub467, %417
  call void @ssl_read_memory(ptr noundef %add.ptr466, i64 noundef %add470)
  br label %if.end472

if.else471:                                       ; preds = %if.then378
  %418 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %418, i32 noundef 1, ptr noundef @.str, i32 noundef 2292, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end472:                                        ; preds = %for.end461
  %419 = load ptr, ptr %ssl.addr, align 8
  %in_msg473 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %419, i32 0, i32 28
  %420 = load ptr, ptr %in_msg473, align 8
  %421 = load ptr, ptr %ssl.addr, align 8
  %in_msglen474 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %421, i32 0, i32 31
  %422 = load i64, ptr %in_msglen474, align 8
  %add.ptr475 = getelementptr inbounds i8, ptr %420, i64 %422
  %arraydecay476 = getelementptr inbounds [48 x i8], ptr %mac_expect379, i64 0, i64 0
  %423 = load ptr, ptr %ssl.addr, align 8
  %transform_in477 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %423, i32 0, i32 16
  %424 = load ptr, ptr %transform_in477, align 8
  %maclen478 = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %424, i32 0, i32 5
  %425 = load i64, ptr %maclen478, align 8
  %call479 = call i32 @mbedtls_ssl_safer_memcmp(ptr noundef %add.ptr475, ptr noundef %arraydecay476, i64 noundef %425)
  %cmp480 = icmp ne i32 %call479, 0
  br i1 %cmp480, label %if.then482, label %if.end483

if.then482:                                       ; preds = %if.end472
  store i64 0, ptr %correct, align 8
  br label %if.end483

if.end483:                                        ; preds = %if.then482, %if.end472
  %426 = load i32, ptr %auth_done, align 4
  %inc484 = add nsw i32 %426, 1
  store i32 %inc484, ptr %auth_done, align 4
  br label %if.end485

if.end485:                                        ; preds = %if.end483, %if.end375
  %427 = load i64, ptr %correct, align 8
  %cmp486 = icmp eq i64 %427, 0
  br i1 %cmp486, label %if.then488, label %if.end489

if.then488:                                       ; preds = %if.end485
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end489:                                        ; preds = %if.end485
  %428 = load i32, ptr %auth_done, align 4
  %cmp490 = icmp ne i32 %428, 1
  br i1 %cmp490, label %if.then492, label %if.end493

if.then492:                                       ; preds = %if.end489
  %429 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %429, i32 noundef 1, ptr noundef @.str, i32 noundef 2323, ptr noundef @.str.4)
  store i32 -27648, ptr %retval, align 4
  br label %return

if.end493:                                        ; preds = %if.end489
  %430 = load ptr, ptr %ssl.addr, align 8
  %in_msglen494 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %430, i32 0, i32 31
  %431 = load i64, ptr %in_msglen494, align 8
  %cmp495 = icmp eq i64 %431, 0
  br i1 %cmp495, label %if.then497, label %if.else514

if.then497:                                       ; preds = %if.end493
  %432 = load ptr, ptr %ssl.addr, align 8
  %minor_ver498 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %432, i32 0, i32 5
  %433 = load i32, ptr %minor_ver498, align 8
  %cmp499 = icmp eq i32 %433, 3
  br i1 %cmp499, label %land.lhs.true501, label %if.end507

land.lhs.true501:                                 ; preds = %if.then497
  %434 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype502 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %434, i32 0, i32 30
  %435 = load i32, ptr %in_msgtype502, align 8
  %cmp503 = icmp ne i32 %435, 23
  br i1 %cmp503, label %if.then505, label %if.end507

if.then505:                                       ; preds = %land.lhs.true501
  %436 = load ptr, ptr %ssl.addr, align 8
  %437 = load ptr, ptr %ssl.addr, align 8
  %in_msgtype506 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %437, i32 0, i32 30
  %438 = load i32, ptr %in_msgtype506, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %436, i32 noundef 1, ptr noundef @.str, i32 noundef 2334, ptr noundef @.str.277, i32 noundef %438)
  store i32 -29184, ptr %retval, align 4
  br label %return

if.end507:                                        ; preds = %land.lhs.true501, %if.then497
  %439 = load ptr, ptr %ssl.addr, align 8
  %nb_zero = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %439, i32 0, i32 38
  %440 = load i32, ptr %nb_zero, align 8
  %inc508 = add nsw i32 %440, 1
  store i32 %inc508, ptr %nb_zero, align 8
  %441 = load ptr, ptr %ssl.addr, align 8
  %nb_zero509 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %441, i32 0, i32 38
  %442 = load i32, ptr %nb_zero509, align 8
  %cmp510 = icmp sgt i32 %442, 3
  br i1 %cmp510, label %if.then512, label %if.end513

if.then512:                                       ; preds = %if.end507
  %443 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %443, i32 noundef 1, ptr noundef @.str, i32 noundef 2348, ptr noundef @.str.278)
  store i32 -29056, ptr %retval, align 4
  br label %return

if.end513:                                        ; preds = %if.end507
  br label %if.end516

if.else514:                                       ; preds = %if.end493
  %444 = load ptr, ptr %ssl.addr, align 8
  %nb_zero515 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %444, i32 0, i32 38
  store i32 0, ptr %nb_zero515, align 8
  br label %if.end516

if.end516:                                        ; preds = %if.else514, %if.end513
  %445 = load ptr, ptr %ssl.addr, align 8
  %conf517 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %445, i32 0, i32 0
  %446 = load ptr, ptr %conf517, align 8
  %transport518 = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %446, i32 0, i32 46
  %bf.load519 = load i32, ptr %transport518, align 4
  %bf.lshr520 = lshr i32 %bf.load519, 1
  %bf.clear521 = and i32 %bf.lshr520, 1
  %cmp522 = icmp eq i32 %bf.clear521, 1
  br i1 %cmp522, label %if.then524, label %if.else525

if.then524:                                       ; preds = %if.end516
  br label %if.end552

if.else525:                                       ; preds = %if.end516
  store i8 8, ptr %i526, align 1
  br label %for.cond527

for.cond527:                                      ; preds = %for.inc544, %if.else525
  %447 = load i8, ptr %i526, align 1
  %conv528 = zext i8 %447 to i64
  %448 = load ptr, ptr %ssl.addr, align 8
  %call529 = call i64 @ssl_ep_len(ptr noundef %448)
  %cmp530 = icmp ugt i64 %conv528, %call529
  br i1 %cmp530, label %for.body532, label %for.end545

for.body532:                                      ; preds = %for.cond527
  %449 = load ptr, ptr %ssl.addr, align 8
  %in_ctr533 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %449, i32 0, i32 24
  %450 = load ptr, ptr %in_ctr533, align 8
  %451 = load i8, ptr %i526, align 1
  %conv534 = zext i8 %451 to i32
  %sub535 = sub nsw i32 %conv534, 1
  %idxprom536 = sext i32 %sub535 to i64
  %arrayidx537 = getelementptr inbounds i8, ptr %450, i64 %idxprom536
  %452 = load i8, ptr %arrayidx537, align 1
  %inc538 = add i8 %452, 1
  store i8 %inc538, ptr %arrayidx537, align 1
  %conv539 = zext i8 %inc538 to i32
  %cmp540 = icmp ne i32 %conv539, 0
  br i1 %cmp540, label %if.then542, label %if.end543

if.then542:                                       ; preds = %for.body532
  br label %for.end545

if.end543:                                        ; preds = %for.body532
  br label %for.inc544

for.inc544:                                       ; preds = %if.end543
  %453 = load i8, ptr %i526, align 1
  %dec = add i8 %453, -1
  store i8 %dec, ptr %i526, align 1
  br label %for.cond527, !llvm.loop !47

for.end545:                                       ; preds = %if.then542, %for.cond527
  %454 = load i8, ptr %i526, align 1
  %conv546 = zext i8 %454 to i64
  %455 = load ptr, ptr %ssl.addr, align 8
  %call547 = call i64 @ssl_ep_len(ptr noundef %455)
  %cmp548 = icmp eq i64 %conv546, %call547
  br i1 %cmp548, label %if.then550, label %if.end551

if.then550:                                       ; preds = %for.end545
  %456 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %456, i32 noundef 1, ptr noundef @.str, i32 noundef 2371, ptr noundef @.str.279)
  store i32 -27520, ptr %retval, align 4
  br label %return

if.end551:                                        ; preds = %for.end545
  br label %if.end552

if.end552:                                        ; preds = %if.end551, %if.then524
  %457 = load ptr, ptr %ssl.addr, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %457, i32 noundef 2, ptr noundef @.str, i32 noundef 2376, ptr noundef @.str.280)
  store i32 0, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end552, %if.then550, %if.then512, %if.then505, %if.then492, %if.then488, %if.else471, %sw.default, %if.else372, %if.else368, %if.then288, %if.then284, %if.then239, %if.then230, %if.then162, %if.then129, %if.end124, %if.then123, %if.else103, %if.then41, %if.then24, %if.then20, %if.then5, %if.then
  %458 = load i32, ptr %retval, align 4
  ret i32 %458
}

declare i32 @mbedtls_cipher_auth_decrypt(ptr noundef, ptr noundef, i64 noundef, ptr noundef, i64 noundef, ptr noundef, i64 noundef, ptr noundef, ptr noundef, ptr noundef, i64 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_read_memory(ptr noundef %p, i64 noundef %len) #0 {
entry:
  %p.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  %acc = alloca i8, align 1
  %force = alloca i8, align 1
  store ptr %p, ptr %p.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  store i8 0, ptr %acc, align 1
  br label %for.cond

for.cond:                                         ; preds = %for.inc, %entry
  %0 = load i64, ptr %len.addr, align 8
  %cmp = icmp ne i64 %0, 0
  br i1 %cmp, label %for.body, label %for.end

for.body:                                         ; preds = %for.cond
  %1 = load ptr, ptr %p.addr, align 8
  %2 = load i8, ptr %1, align 1
  %conv = zext i8 %2 to i32
  %3 = load i8, ptr %acc, align 1
  %conv1 = zext i8 %3 to i32
  %xor = xor i32 %conv1, %conv
  %conv2 = trunc i32 %xor to i8
  store i8 %conv2, ptr %acc, align 1
  br label %for.inc

for.inc:                                          ; preds = %for.body
  %4 = load ptr, ptr %p.addr, align 8
  %incdec.ptr = getelementptr inbounds i8, ptr %4, i32 1
  store ptr %incdec.ptr, ptr %p.addr, align 8
  %5 = load i64, ptr %len.addr, align 8
  %dec = add i64 %5, -1
  store i64 %dec, ptr %len.addr, align 8
  br label %for.cond, !llvm.loop !48

for.end:                                          ; preds = %for.cond
  %6 = load i8, ptr %acc, align 1
  store volatile i8 %6, ptr %force, align 1
  %7 = load volatile i8, ptr %force, align 1
  ret void
}

declare i32 @mbedtls_md_process(ptr noundef, ptr noundef) #1

declare void @mbedtls_x509_crt_init(ptr noundef) #1

declare i32 @mbedtls_x509_crt_parse_der(ptr noundef, ptr noundef, i64 noundef) #1

declare i32 @mbedtls_sha256_update_ret(ptr noundef, ptr noundef, i64 noundef) #1

declare i32 @mbedtls_sha512_update_ret(ptr noundef, ptr noundef, i64 noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_transform_init(ptr noundef %transform) #0 {
entry:
  %transform.addr = alloca ptr, align 8
  store ptr %transform, ptr %transform.addr, align 8
  %0 = load ptr, ptr %transform.addr, align 8
  call void @llvm.memset.p0.i64(ptr align 8 %0, i8 0, i64 304, i1 false)
  %1 = load ptr, ptr %transform.addr, align 8
  %cipher_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %1, i32 0, i32 10
  call void @mbedtls_cipher_init(ptr noundef %cipher_ctx_enc)
  %2 = load ptr, ptr %transform.addr, align 8
  %cipher_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %2, i32 0, i32 11
  call void @mbedtls_cipher_init(ptr noundef %cipher_ctx_dec)
  %3 = load ptr, ptr %transform.addr, align 8
  %md_ctx_enc = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %3, i32 0, i32 8
  call void @mbedtls_md_init(ptr noundef %md_ctx_enc)
  %4 = load ptr, ptr %transform.addr, align 8
  %md_ctx_dec = getelementptr inbounds %struct.mbedtls_ssl_transform, ptr %4, i32 0, i32 9
  call void @mbedtls_md_init(ptr noundef %md_ctx_dec)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_handshake_params_init(ptr noundef %handshake) #0 {
entry:
  %handshake.addr = alloca ptr, align 8
  store ptr %handshake, ptr %handshake.addr, align 8
  %0 = load ptr, ptr %handshake.addr, align 8
  call void @llvm.memset.p0.i64(ptr align 8 %0, i8 0, i64 2856, i1 false)
  %1 = load ptr, ptr %handshake.addr, align 8
  %fin_md5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 25
  call void @mbedtls_md5_init(ptr noundef %fin_md5)
  %2 = load ptr, ptr %handshake.addr, align 8
  %fin_sha1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %2, i32 0, i32 26
  call void @mbedtls_sha1_init(ptr noundef %fin_sha1)
  %3 = load ptr, ptr %handshake.addr, align 8
  %fin_md51 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %3, i32 0, i32 25
  %call = call i32 @mbedtls_md5_starts_ret(ptr noundef %fin_md51)
  %4 = load ptr, ptr %handshake.addr, align 8
  %fin_sha12 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %4, i32 0, i32 26
  %call3 = call i32 @mbedtls_sha1_starts_ret(ptr noundef %fin_sha12)
  %5 = load ptr, ptr %handshake.addr, align 8
  %fin_sha256 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 27
  call void @mbedtls_sha256_init(ptr noundef %fin_sha256)
  %6 = load ptr, ptr %handshake.addr, align 8
  %fin_sha2564 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %6, i32 0, i32 27
  %call5 = call i32 @mbedtls_sha256_starts_ret(ptr noundef %fin_sha2564, i32 noundef 0)
  %7 = load ptr, ptr %handshake.addr, align 8
  %fin_sha512 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %7, i32 0, i32 28
  call void @mbedtls_sha512_init(ptr noundef %fin_sha512)
  %8 = load ptr, ptr %handshake.addr, align 8
  %fin_sha5126 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %8, i32 0, i32 28
  %call7 = call i32 @mbedtls_sha512_starts_ret(ptr noundef %fin_sha5126, i32 noundef 1)
  %9 = load ptr, ptr %handshake.addr, align 8
  %update_checksum = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 29
  store ptr @ssl_update_checksum_start, ptr %update_checksum, align 8
  %10 = load ptr, ptr %handshake.addr, align 8
  %hash_algs = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %10, i32 0, i32 0
  call void @mbedtls_ssl_sig_hash_set_init(ptr noundef %hash_algs)
  %11 = load ptr, ptr %handshake.addr, align 8
  %dhm_ctx = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %11, i32 0, i32 1
  call void @mbedtls_dhm_init(ptr noundef %dhm_ctx)
  %12 = load ptr, ptr %handshake.addr, align 8
  %ecdh_ctx = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %12, i32 0, i32 2
  call void @mbedtls_ecdh_init(ptr noundef %ecdh_ctx)
  %13 = load ptr, ptr %handshake.addr, align 8
  %sni_authmode = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %13, i32 0, i32 7
  store i32 3, ptr %sni_authmode, align 8
  ret void
}

declare void @mbedtls_cipher_init(ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define internal void @ssl_update_checksum_start(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %handshake = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %0, i32 0, i32 15
  %1 = load ptr, ptr %handshake, align 8
  %fin_md5 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %1, i32 0, i32 25
  %2 = load ptr, ptr %buf.addr, align 8
  %3 = load i64, ptr %len.addr, align 8
  %call = call i32 @mbedtls_md5_update_ret(ptr noundef %fin_md5, ptr noundef %2, i64 noundef %3)
  %4 = load ptr, ptr %ssl.addr, align 8
  %handshake1 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %4, i32 0, i32 15
  %5 = load ptr, ptr %handshake1, align 8
  %fin_sha1 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %5, i32 0, i32 26
  %6 = load ptr, ptr %buf.addr, align 8
  %7 = load i64, ptr %len.addr, align 8
  %call2 = call i32 @mbedtls_sha1_update_ret(ptr noundef %fin_sha1, ptr noundef %6, i64 noundef %7)
  %8 = load ptr, ptr %ssl.addr, align 8
  %handshake3 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 15
  %9 = load ptr, ptr %handshake3, align 8
  %fin_sha256 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %9, i32 0, i32 27
  %10 = load ptr, ptr %buf.addr, align 8
  %11 = load i64, ptr %len.addr, align 8
  %call4 = call i32 @mbedtls_sha256_update_ret(ptr noundef %fin_sha256, ptr noundef %10, i64 noundef %11)
  %12 = load ptr, ptr %ssl.addr, align 8
  %handshake5 = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %12, i32 0, i32 15
  %13 = load ptr, ptr %handshake5, align 8
  %fin_sha512 = getelementptr inbounds %struct.mbedtls_ssl_handshake_params, ptr %13, i32 0, i32 28
  %14 = load ptr, ptr %buf.addr, align 8
  %15 = load i64, ptr %len.addr, align 8
  %call6 = call i32 @mbedtls_sha512_update_ret(ptr noundef %fin_sha512, ptr noundef %14, i64 noundef %15)
  ret void
}

; Function Attrs: noinline nounwind optnone uwtable
define internal void @mbedtls_ssl_sig_hash_set_init(ptr noundef %set) #0 {
entry:
  %set.addr = alloca ptr, align 8
  store ptr %set, ptr %set.addr, align 8
  %0 = load ptr, ptr %set.addr, align 8
  call void @mbedtls_ssl_sig_hash_set_const_hash(ptr noundef %0, i32 noundef 0)
  ret void
}

declare void @mbedtls_dhm_init(ptr noundef) #1

declare void @mbedtls_ecdh_init(ptr noundef) #1

; Function Attrs: noinline nounwind optnone uwtable
define internal i32 @ssl_write_real(ptr noundef %ssl, ptr noundef %buf, i64 noundef %len) #0 {
entry:
  %retval = alloca i32, align 4
  %ssl.addr = alloca ptr, align 8
  %buf.addr = alloca ptr, align 8
  %len.addr = alloca i64, align 8
  %ret = alloca i32, align 4
  %max_len = alloca i64, align 8
  store ptr %ssl, ptr %ssl.addr, align 8
  store ptr %buf, ptr %buf.addr, align 8
  store i64 %len, ptr %len.addr, align 8
  %0 = load ptr, ptr %ssl.addr, align 8
  %call = call i32 @mbedtls_ssl_get_max_out_record_payload(ptr noundef %0)
  store i32 %call, ptr %ret, align 4
  %1 = load i32, ptr %ret, align 4
  %conv = sext i32 %1 to i64
  store i64 %conv, ptr %max_len, align 8
  %2 = load i32, ptr %ret, align 4
  %cmp = icmp slt i32 %2, 0
  br i1 %cmp, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %3 = load ptr, ptr %ssl.addr, align 8
  %4 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %3, i32 noundef 1, ptr noundef @.str, i32 noundef 8583, ptr noundef @.str.306, i32 noundef %4)
  %5 = load i32, ptr %ret, align 4
  store i32 %5, ptr %retval, align 4
  br label %return

if.end:                                           ; preds = %entry
  %6 = load i64, ptr %len.addr, align 8
  %7 = load i64, ptr %max_len, align 8
  %cmp2 = icmp ugt i64 %6, %7
  br i1 %cmp2, label %if.then4, label %if.end9

if.then4:                                         ; preds = %if.end
  %8 = load ptr, ptr %ssl.addr, align 8
  %conf = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %8, i32 0, i32 0
  %9 = load ptr, ptr %conf, align 8
  %transport = getelementptr inbounds %struct.mbedtls_ssl_config, ptr %9, i32 0, i32 46
  %bf.load = load i32, ptr %transport, align 4
  %bf.lshr = lshr i32 %bf.load, 1
  %bf.clear = and i32 %bf.lshr, 1
  %cmp5 = icmp eq i32 %bf.clear, 1
  br i1 %cmp5, label %if.then7, label %if.else

if.then7:                                         ; preds = %if.then4
  %10 = load ptr, ptr %ssl.addr, align 8
  %11 = load i64, ptr %len.addr, align 8
  %12 = load i64, ptr %max_len, align 8
  call void (ptr, i32, ptr, i32, ptr, ...) @mbedtls_debug_print_msg(ptr noundef %10, i32 noundef 1, ptr noundef @.str, i32 noundef 8594, ptr noundef @.str.307, i64 noundef %11, i64 noundef %12)
  store i32 -28928, ptr %retval, align 4
  br label %return

if.else:                                          ; preds = %if.then4
  %13 = load i64, ptr %max_len, align 8
  store i64 %13, ptr %len.addr, align 8
  br label %if.end8

if.end8:                                          ; preds = %if.else
  br label %if.end9

if.end9:                                          ; preds = %if.end8, %if.end
  %14 = load ptr, ptr %ssl.addr, align 8
  %out_left = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %14, i32 0, i32 49
  %15 = load i64, ptr %out_left, align 8
  %cmp10 = icmp ne i64 %15, 0
  br i1 %cmp10, label %if.then12, label %if.else18

if.then12:                                        ; preds = %if.end9
  %16 = load ptr, ptr %ssl.addr, align 8
  %call13 = call i32 @mbedtls_ssl_flush_output(ptr noundef %16)
  store i32 %call13, ptr %ret, align 4
  %cmp14 = icmp ne i32 %call13, 0
  br i1 %cmp14, label %if.then16, label %if.end17

if.then16:                                        ; preds = %if.then12
  %17 = load ptr, ptr %ssl.addr, align 8
  %18 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %17, i32 noundef 1, ptr noundef @.str, i32 noundef 8612, ptr noundef @.str.67, i32 noundef %18)
  %19 = load i32, ptr %ret, align 4
  store i32 %19, ptr %retval, align 4
  br label %return

if.end17:                                         ; preds = %if.then12
  br label %if.end24

if.else18:                                        ; preds = %if.end9
  %20 = load i64, ptr %len.addr, align 8
  %21 = load ptr, ptr %ssl.addr, align 8
  %out_msglen = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %21, i32 0, i32 48
  store i64 %20, ptr %out_msglen, align 8
  %22 = load ptr, ptr %ssl.addr, align 8
  %out_msgtype = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %22, i32 0, i32 47
  store i32 23, ptr %out_msgtype, align 8
  %23 = load ptr, ptr %ssl.addr, align 8
  %out_msg = getelementptr inbounds %struct.mbedtls_ssl_context, ptr %23, i32 0, i32 46
  %24 = load ptr, ptr %out_msg, align 8
  %25 = load ptr, ptr %buf.addr, align 8
  %26 = load i64, ptr %len.addr, align 8
  call void @llvm.memcpy.p0.p0.i64(ptr align 1 %24, ptr align 1 %25, i64 %26, i1 false)
  %27 = load ptr, ptr %ssl.addr, align 8
  %call19 = call i32 @mbedtls_ssl_write_record(ptr noundef %27, i8 noundef zeroext 1)
  store i32 %call19, ptr %ret, align 4
  %cmp20 = icmp ne i32 %call19, 0
  br i1 %cmp20, label %if.then22, label %if.end23

if.then22:                                        ; preds = %if.else18
  %28 = load ptr, ptr %ssl.addr, align 8
  %29 = load i32, ptr %ret, align 4
  call void @mbedtls_debug_print_ret(ptr noundef %28, i32 noundef 1, ptr noundef @.str, i32 noundef 8629, ptr noundef @.str.52, i32 noundef %29)
  %30 = load i32, ptr %ret, align 4
  store i32 %30, ptr %retval, align 4
  br label %return

if.end23:                                         ; preds = %if.else18
  br label %if.end24

if.end24:                                         ; preds = %if.end23, %if.end17
  %31 = load i64, ptr %len.addr, align 8
  %conv25 = trunc i64 %31 to i32
  store i32 %conv25, ptr %retval, align 4
  br label %return

return:                                           ; preds = %if.end24, %if.then22, %if.then16, %if.then7, %if.then
  %32 = load i32, ptr %retval, align 4
  ret i32 %32
}

attributes #0 = { noinline nounwind optnone uwtable "frame-pointer"="all" "min-legal-vector-width"="0" "no-trapping-math"="true" "stack-protector-buffer-size"="8" "target-cpu"="x86-64" "target-features"="+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87" "tune-cpu"="generic" }
attributes #1 = { "frame-pointer"="all" "no-trapping-math"="true" "stack-protector-buffer-size"="8" "target-cpu"="x86-64" "target-features"="+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87" "tune-cpu"="generic" }
attributes #2 = { nocallback nofree nounwind willreturn memory(argmem: readwrite) }
attributes #3 = { nocallback nofree nounwind willreturn memory(argmem: write) }
attributes #4 = { nounwind "frame-pointer"="all" "no-trapping-math"="true" "stack-protector-buffer-size"="8" "target-cpu"="x86-64" "target-features"="+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87" "tune-cpu"="generic" }
attributes #5 = { nounwind allocsize(0,1) "frame-pointer"="all" "no-trapping-math"="true" "stack-protector-buffer-size"="8" "target-cpu"="x86-64" "target-features"="+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87" "tune-cpu"="generic" }
attributes #6 = { nounwind willreturn memory(read) "frame-pointer"="all" "no-trapping-math"="true" "stack-protector-buffer-size"="8" "target-cpu"="x86-64" "target-features"="+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87" "tune-cpu"="generic" }
attributes #7 = { nounwind willreturn memory(read) }
attributes #8 = { nounwind }
attributes #9 = { nounwind allocsize(0,1) }

!llvm.module.flags = !{!0, !1, !2, !3}
!llvm.ident = !{!4}

!0 = !{i32 1, !"wchar_size", i32 4}
!1 = !{i32 8, !"PIC Level", i32 2}
!2 = !{i32 7, !"uwtable", i32 2}
!3 = !{i32 7, !"frame-pointer", i32 2}
!4 = !{!"clang version 18.0.0 (https://github.com/llvm-ml/llvm-project b452eb491a2ae09c12cc88b715f003377cec543b)"}
!5 = distinct !{!5, !6}
!6 = !{!"llvm.loop.mustprogress"}
!7 = distinct !{!7, !6}
!8 = distinct !{!8, !6}
!9 = distinct !{!9, !6}
!10 = distinct !{!10, !6}
!11 = distinct !{!11, !6}
!12 = distinct !{!12, !6}
!13 = distinct !{!13, !6}
!14 = distinct !{!14, !6}
!15 = distinct !{!15, !6}
!16 = distinct !{!16, !6}
!17 = distinct !{!17, !6}
!18 = distinct !{!18, !6}
!19 = distinct !{!19, !6}
!20 = distinct !{!20, !6}
!21 = distinct !{!21, !6}
!22 = distinct !{!22, !6}
!23 = distinct !{!23, !6}
!24 = distinct !{!24, !6}
!25 = distinct !{!25, !6}
!26 = distinct !{!26, !6}
!27 = distinct !{!27, !6}
!28 = distinct !{!28, !6}
!29 = distinct !{!29, !6}
!30 = distinct !{!30, !6}
!31 = distinct !{!31, !6}
!32 = distinct !{!32, !6}
!33 = distinct !{!33, !6}
!34 = distinct !{!34, !6}
!35 = distinct !{!35, !6}
!36 = distinct !{!36, !6}
!37 = distinct !{!37, !6}
!38 = distinct !{!38, !6}
!39 = distinct !{!39, !6}
!40 = distinct !{!40, !6}
!41 = distinct !{!41, !6}
!42 = distinct !{!42, !6}
!43 = distinct !{!43, !6}
!44 = distinct !{!44, !6}
!45 = distinct !{!45, !6}
!46 = distinct !{!46, !6}
!47 = distinct !{!47, !6}
!48 = distinct !{!48, !6}
